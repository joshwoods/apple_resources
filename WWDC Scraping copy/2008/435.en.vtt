WEBVTT

00:00:22.170 --> 00:00:23.260
All right, so let's get started.

00:00:23.260 --> 00:00:25.600
Let's have a look back.

00:00:25.790 --> 00:00:29.850
So we've had wireless in
Mac OS ever since Mac OS 9,

00:00:30.070 --> 00:00:33.560
and as far back as that,
you could actually make some

00:00:33.560 --> 00:00:36.670
AppleScript calls against our
dictionary to do really basic tasks,

00:00:36.720 --> 00:00:38.310
scanning, joining networks.

00:00:38.370 --> 00:00:40.590
We even had some controls
for the base station,

00:00:40.590 --> 00:00:42.910
so you'd be able to dial
your base station back when

00:00:42.910 --> 00:00:44.250
modems roamed the earth.

00:00:45.400 --> 00:00:48.400
Starting with Mac OS X,
the interface that you use,

00:00:48.400 --> 00:00:51.110
that we use internally to
talk to AirPort went private,

00:00:51.130 --> 00:00:55.060
and it has been that way
pretty much until today.

00:00:55.060 --> 00:00:58.120
So starting with Snow Leopard,
we're going to have a public

00:00:58.230 --> 00:01:01.540
API that will allow you to
access the AirPort interface.

00:01:01.570 --> 00:01:04.070
This includes scanning,
connecting the networks,

00:01:04.150 --> 00:01:08.560
and a bunch of other features we'll talk
about over the course of the session.

00:01:09.420 --> 00:01:10.800
All right, so why are we doing this?

00:01:10.800 --> 00:01:16.290
There are out there right now, in fact,
some of you in the audience may

00:01:16.300 --> 00:01:22.420
have written tools that using the
private API go out and perform scans,

00:01:22.520 --> 00:01:23.460
okay?

00:01:23.460 --> 00:01:25.160
Now, these are important tools.

00:01:25.160 --> 00:01:26.100
There's a lot of them.

00:01:26.100 --> 00:01:29.940
And people use them a lot in these
self-help scenarios where they're

00:01:29.940 --> 00:01:32.880
trying to figure out what's going on
with their wireless network and trying

00:01:32.880 --> 00:01:35.160
to find solutions for themselves.

00:01:35.720 --> 00:01:39.220
So we really wanted to provide a way
for people to sort of more easily

00:01:39.220 --> 00:01:42.120
write these tools out of the box,
and we want to enable some

00:01:42.120 --> 00:01:44.940
other utilities that we're going
to talk about in the session.

00:01:47.470 --> 00:01:49.040
So, airport utilities.

00:01:49.110 --> 00:01:51.360
So, here we've got a really
simple scanning utility.

00:01:51.580 --> 00:01:54.030
It takes a look around at all
the available wireless networks,

00:01:54.040 --> 00:01:57.770
reports back the sort of detailed
information that you need when you're

00:01:57.770 --> 00:01:59.900
in a sort of self-help scenario.

00:02:00.030 --> 00:02:03.450
So, our first demo and our first portion
of the thing is we're going to talk

00:02:03.450 --> 00:02:07.680
about how to build one of these,
the specific steps you need to take.

00:02:08.610 --> 00:02:14.180
And for the more sort of complicated,
secure, modern enterprise network,

00:02:14.180 --> 00:02:17.130
there's a few other things you're going
to need to know to get those set up.

00:02:17.270 --> 00:02:20.740
So besides the utilities that exist,
the other use case we really want to

00:02:20.790 --> 00:02:26.590
take care of is people in education and
enterprise environments who want to write

00:02:26.780 --> 00:02:30.690
configuration tools to help you really,
you know, make it easy for your users to

00:02:30.690 --> 00:02:33.710
get set up and onto your network.

00:02:34.800 --> 00:02:36.940
Okay, so for our first demo,
we're just going to have

00:02:36.940 --> 00:02:38.910
a quick look around,
okay?

00:02:39.080 --> 00:02:40.370
So we have to get set up.

00:02:40.490 --> 00:02:42.500
Obviously, there's some set up to do.

00:02:42.500 --> 00:02:44.820
Once we do that,
we're going to have a peek at the

00:02:44.820 --> 00:02:47.000
status of the interface as it exists.

00:02:47.140 --> 00:02:49.540
We're going to do some simple scanning.

00:02:51.190 --> 00:02:52.600
Look at those scan results.

00:02:52.690 --> 00:02:55.510
And then finally, of course,
with any good piece of API,

00:02:55.710 --> 00:02:59.200
there's some cleanup work to
be done once we're finished.

00:02:59.360 --> 00:03:01.460
So let's get going with setup.

00:03:02.500 --> 00:03:04.840
So to use the AirPort API--
and this is in your seed.

00:03:04.840 --> 00:03:08.770
If you have your seed builds,
go look in System Library Frameworks

00:03:08.770 --> 00:03:10.520
for the AirPort framework.

00:03:10.730 --> 00:03:12.940
There's going to be an AirPort
reference the entire time

00:03:12.940 --> 00:03:14.660
you're working with this API.

00:03:14.790 --> 00:03:18.320
And this reference is an opaque
pointer type that we use that you can

00:03:18.320 --> 00:03:20.380
use to access a particular interface.

00:03:20.460 --> 00:03:21.930
So the first thing you
need to do is create one.

00:03:22.130 --> 00:03:25.030
So AirPort create ref will
initialize a reference for

00:03:25.030 --> 00:03:27.550
you and get it ready to use.

00:03:27.990 --> 00:03:31.200
Once you've got the reference,
you need to bind it to an interface.

00:03:31.330 --> 00:03:34.750
Now,
we ship systems right now with either

00:03:34.750 --> 00:03:37.260
zero or one AirPort interface in them.

00:03:37.260 --> 00:03:38.900
This interface supports multiples.

00:03:39.100 --> 00:03:42.360
And for the most part, users have these,
all the laptops do,

00:03:42.520 --> 00:03:45.160
but some of the machines,
in particular our tower

00:03:45.240 --> 00:03:47.110
demo systems here,
do not.

00:03:47.280 --> 00:03:51.840
So it's important when you're doing these
kinds of utilities to check and see if

00:03:51.910 --> 00:03:54.540
you have an interface available at all.

00:03:54.540 --> 00:03:55.990
Some of your users may not have them.

00:03:56.900 --> 00:03:59.260
Once you've got the list, and remember,
it's either going to be empty

00:03:59.260 --> 00:04:01.900
or it's going to have the
primary AirPort interface in it,

00:04:01.900 --> 00:04:03.960
you can bind your reference to it.

00:04:04.080 --> 00:04:06.010
So you pass the reference,
and this calling convention

00:04:06.010 --> 00:04:06.870
is used throughout.

00:04:06.870 --> 00:04:08.180
The reference is the first argument.

00:04:08.180 --> 00:04:10.370
And in this case,
we're passing in the string,

00:04:10.370 --> 00:04:12.080
which is just the interface name.

00:04:12.090 --> 00:04:14.800
So EN1 most of the time.

00:04:17.540 --> 00:04:18.560
Okay.

00:04:18.710 --> 00:04:22.500
Once we've got the interface set up,
we've bound it to our primary interface,

00:04:22.500 --> 00:04:24.390
we can do some really
simple status operations.

00:04:24.410 --> 00:04:26.660
And really the most
fundamental piece of status is,

00:04:26.740 --> 00:04:28.380
hey, is this thing on?

00:04:28.630 --> 00:04:29.270
All right.

00:04:29.470 --> 00:04:32.610
So AirPort getPower takes that
reference that you've created and

00:04:32.610 --> 00:04:37.400
initialized and gives you the Boolean,
is the power on or off?

00:04:37.400 --> 00:04:38.300
So it's pretty important.

00:04:38.410 --> 00:04:41.220
If there's no power,
you're not going to get a lot of

00:04:41.760 --> 00:04:44.150
information back from any of these calls.

00:04:45.040 --> 00:04:47.750
Once you determine the power zone,
if it's off, by the way,

00:04:47.760 --> 00:04:50.250
there's a corresponding AirPort
set power call that you can

00:04:50.260 --> 00:04:51.580
use to bring the interface up.

00:04:51.670 --> 00:04:55.260
Once you've done that,
you can copy the status, okay?

00:04:55.260 --> 00:05:00.980
And this gives you some really
good information about what the...

00:05:01.470 --> 00:05:04.190
What the card is doing at the moment,
whether you're connected to

00:05:04.190 --> 00:05:07.640
an interface or to a network,
excuse me, what if you are,

00:05:07.640 --> 00:05:11.320
what the network name is, the particular
BSS ID you're associated to,

00:05:11.320 --> 00:05:14.450
all of your transmit power and
signal and noise information

00:05:14.450 --> 00:05:16.190
for your current connection.

00:05:16.200 --> 00:05:21.380
Copying the status is a
relatively inexpensive operation,

00:05:21.530 --> 00:05:26.990
so we want to do it always before we
start scanning so that we know what state

00:05:26.990 --> 00:05:26.990
we're in before we do any real work.

00:05:27.400 --> 00:05:29.840
which takes us right to scanning.

00:05:29.840 --> 00:05:34.250
This is really the heart of the
API because this allows you to go out,

00:05:34.250 --> 00:05:37.160
look around, and find the wireless
networks in your vicinity.

00:05:37.160 --> 00:05:42.250
So airport create scan results
takes that reference that we

00:05:42.250 --> 00:05:45.770
went to the trouble to set up,
takes the dictionary of arguments.

00:05:45.880 --> 00:05:48.690
Now, most of the time you're just
going to pass in null here.

00:05:48.700 --> 00:05:50.770
We'll talk about some of the
special cases a little later,

00:05:50.780 --> 00:05:53.200
ways you can control the
scan a little further.

00:05:53.200 --> 00:05:56.520
And then you get your array
of results back out of that.

00:05:57.120 --> 00:05:59.440
Now, you should be aware this
call can take a little while,

00:05:59.440 --> 00:06:00.320
and we'll see that in the demo.

00:06:00.320 --> 00:06:05.260
We're pushing seven or eight seconds,
depending on what hardware you have.

00:06:05.330 --> 00:06:06.710
So we'll talk a little
bit more about that,

00:06:06.710 --> 00:06:07.000
too.

00:06:07.000 --> 00:06:08.250
All right.

00:06:08.790 --> 00:06:11.420
Okay, so that list of results,
what's in there?

00:06:11.660 --> 00:06:13.910
It's a bunch of dictionaries,
and each of the dictionaries

00:06:13.910 --> 00:06:15.160
we call a scan record,
okay?

00:06:15.160 --> 00:06:17.330
And it's got keys and values.

00:06:17.330 --> 00:06:19.820
You'll see in the framework
there's airporkeys.h,

00:06:19.860 --> 00:06:23.000
which contains, you know,
the list of keys for particular features

00:06:23.000 --> 00:06:26.460
and descriptions of them so that you
have something to sort of go from.

00:06:26.460 --> 00:06:30.500
But generally, it's the network's
information and capabilities,

00:06:30.630 --> 00:06:34.790
how much signal and noise there was on
the radio end when we were measuring,

00:06:35.020 --> 00:06:38.700
and a bunch of other detailed
info we'll see in the demo here.

00:06:40.010 --> 00:06:41.900
Okay, cleanup, very important.

00:06:41.980 --> 00:06:44.770
All of the calls that you're making
here are giving you a copy of these

00:06:45.020 --> 00:06:47.250
lists or objects or dictionaries.

00:06:47.260 --> 00:06:49.150
So these are CF types.

00:06:49.280 --> 00:06:50.660
You need to CF release
them when you're done.

00:06:50.660 --> 00:06:54.460
When you're done with the AirPort ref,
and you can keep this thing

00:06:54.460 --> 00:06:57.310
around for the lifetime of
your application and reuse it,

00:06:57.310 --> 00:06:59.540
it's more efficient that way,
you call AirPort release ref,

00:06:59.540 --> 00:07:01.460
and that'll allow us,
that'll give us a chance to

00:07:01.460 --> 00:07:03.810
clean up everything we need
to clean up on the back end.

00:07:04.910 --> 00:07:06.920
Okay, so, you know,
remember to try not to

00:07:07.130 --> 00:07:08.310
sweep things under the rug.

00:07:08.310 --> 00:07:10.820
It's always best to
clean up after yourself.

00:07:10.840 --> 00:07:13.660
All right,
and that brings us to our first demo.

00:07:16.690 --> 00:07:18.570
Thank you.

00:07:18.860 --> 00:07:21.080
OK, so here we have a
little demo application.

00:07:21.080 --> 00:07:23.150
I left it running from earlier.

00:07:23.340 --> 00:07:26.520
This already has the
status information in here.

00:07:26.640 --> 00:07:29.910
And if this little pointer works,
you can see--

00:07:30.370 --> 00:07:31.660
We've got what state the interface is in.

00:07:31.660 --> 00:07:34.800
Right now we're not
connected to anything.

00:07:34.800 --> 00:07:39.890
You can see what PHY mode we're in,
whether the power's on,

00:07:40.150 --> 00:07:42.640
The actual BSS ID that you're
associated to in this point,

00:07:42.700 --> 00:07:45.660
it's all zeros because we're
not connected to anything.

00:07:46.190 --> 00:07:48.440
Transmit power flags.

00:07:48.590 --> 00:07:51.920
So this is the info information for
when you're not connected to a network.

00:07:52.020 --> 00:07:55.400
You get a little more out of
this when you are connected.

00:07:55.620 --> 00:07:59.730
Let's have a peek here,
and we'll start up the scanner.

00:08:00.250 --> 00:08:02.370
All right, so here we've got a
really simple scanner,

00:08:02.370 --> 00:08:04.740
similar to the one you saw on the slides.

00:08:04.740 --> 00:08:06.280
It's got a lot of options, though.

00:08:06.280 --> 00:08:08.770
So we're going to kick off a scan.

00:08:09.390 --> 00:08:10.970
So remember I said this
takes a few seconds,

00:08:10.970 --> 00:08:12.020
and you can see the delay there.

00:08:12.020 --> 00:08:13.960
All right.

00:08:13.990 --> 00:08:16.560
Thanks, whoever set up that one.

00:08:19.010 --> 00:08:25.500
So each of these rows here
is one of the scan records.

00:08:25.500 --> 00:08:27.300
So we're going to go right
across the top here and have a

00:08:27.300 --> 00:08:28.390
look at each of them as they go.

00:08:28.400 --> 00:08:30.740
The SSID string is our interpretation.

00:08:30.740 --> 00:08:33.180
We've parsed out the
SSID into a string for you.

00:08:33.220 --> 00:08:35.560
So that one's set up and ready to go.

00:08:35.680 --> 00:08:39.460
BSSID is the basic
service set identifier.

00:08:39.460 --> 00:08:43.400
That's going to be the wireless
MAC address of the base station

00:08:43.400 --> 00:08:45.900
that's sending out the probe frame.

00:08:47.220 --> 00:08:51.730
The channel number, of course, you know,
channels below, 14 and below,

00:08:51.730 --> 00:08:53.980
are the 2.5 gigahertz channels.

00:08:53.980 --> 00:08:57.260
Higher channels are 5 gigahertz.

00:08:57.300 --> 00:08:58.570
BSSID is the basic
service set identifier.

00:08:58.980 --> 00:09:02.170
RSSI, which is the Received
Signal Strength Indicator,

00:09:02.300 --> 00:09:04.490
that tells you how the signal's doing.

00:09:04.610 --> 00:09:07.870
It's given in DBM,
and I encourage you to look that

00:09:07.870 --> 00:09:09.400
up to see how to interpret it.

00:09:09.400 --> 00:09:13.490
It's a fairly complicated thing
if you're not familiar with

00:09:13.490 --> 00:09:16.510
radio information front end.

00:09:16.670 --> 00:09:19.310
Noise, of course, very important.

00:09:19.510 --> 00:09:21.560
Your beacon interval,
which is sort of a technical detail

00:09:21.560 --> 00:09:23.830
you may or may not be interested in.

00:09:23.980 --> 00:09:25.950
This capabilities field here,
if you look at the

00:09:25.950 --> 00:09:30.400
AirPorT var.h in the thing,
this is a bit field and it tells you

00:09:30.730 --> 00:09:32.040
what the network's capable of doing.

00:09:32.040 --> 00:09:34.960
So what protocols it's supporting,
what types of security.

00:09:34.960 --> 00:09:38.590
You can parse that sort of
information out of there.

00:09:39.660 --> 00:09:42.090
The channel flags,
if you're not content to find

00:09:42.090 --> 00:09:44.620
out from the channel number,
you can determine from the

00:09:44.620 --> 00:09:48.070
channel flags whether you've got
a 2.4 or 5 gigahertz network.

00:09:48.260 --> 00:09:51.120
And for our equipment that's
operating in 5 gigahertz,

00:09:51.170 --> 00:09:54.060
you can tell whether it's a
single or double wide channel,

00:09:54.060 --> 00:09:57.760
so HT40 or just a 20
megahertz basic channel.

00:09:59.950 --> 00:10:02.800
The age column here,
if you get a cached set

00:10:02.800 --> 00:10:04.910
of scan results back,
so if more than one

00:10:04.910 --> 00:10:07.330
process asks for a scan,
you might get a slightly

00:10:07.330 --> 00:10:09.590
older version of it,
and that's to keep from using

00:10:09.600 --> 00:10:10.960
too much air time on our end.

00:10:11.000 --> 00:10:14.570
So this will indicate to
you how old this record is.

00:10:14.600 --> 00:10:15.840
Usually it's going to be zero.

00:10:17.300 --> 00:10:22.450
The mode information for the element,
this HT elements present tells you

00:10:22.450 --> 00:10:25.700
if there's--if using wide channels.

00:10:25.700 --> 00:10:28.360
This next column here,
this is the actual data of

00:10:28.360 --> 00:10:30.200
the information elements.

00:10:30.200 --> 00:10:32.700
So you can see it's not
particularly human readable,

00:10:32.700 --> 00:10:36.200
but if you have a custom information
element that you're looking for,

00:10:36.200 --> 00:10:41.390
you can get it out of this
property of the dictionary.

00:10:42.270 --> 00:10:43.360
What rates are supported?

00:10:43.360 --> 00:10:47.100
You can see the actual
bytes of the SSID string.

00:10:47.100 --> 00:10:50.360
If you didn't like our decoding,
you can try it yourself.

00:10:50.360 --> 00:10:51.040
Here are the bytes.

00:10:51.090 --> 00:10:52.780
You can go ahead and have a peek at that.

00:10:52.990 --> 00:10:55.120
And then finally,
this one on the right here,

00:10:55.120 --> 00:10:59.400
and this one's by far the largest,
this is a parsed-out version of

00:10:59.400 --> 00:11:02.290
the 802.11d information element.

00:11:02.300 --> 00:11:03.960
Okay,
so that's a public information element,

00:11:03.960 --> 00:11:07.740
and it tells you where the base
station thinks it is in the world,

00:11:07.740 --> 00:11:11.640
what country code it has assigned to it,
and what its capabilities and

00:11:11.640 --> 00:11:13.080
channel set availability are.

00:11:13.080 --> 00:11:15.360
So there's really a lot
of information in there.

00:11:15.360 --> 00:11:17.400
It's kind of compressed down
through this table view here,

00:11:17.400 --> 00:11:21.960
but you can see that just from scanning,
we've picked up, you know,

00:11:21.960 --> 00:11:25.100
quite a bit of good background
information on our wireless environment,

00:11:25.100 --> 00:11:29.690
and we can use that
to help our users out.

00:11:29.750 --> 00:11:30.600
Slides, please.

00:11:34.610 --> 00:11:36.990
Okay.

00:11:37.130 --> 00:11:38.100
So we saw the demo.

00:11:38.300 --> 00:11:39.740
So that's a really simple scanner.

00:11:39.740 --> 00:11:43.280
This thing's a fairly
small chunk of code.

00:11:43.510 --> 00:11:45.900
We want to look at now
a real setup assistant.

00:11:45.900 --> 00:11:49.800
So this is a much more
complicated set of tasks here.

00:11:49.810 --> 00:11:53.330
We have--we may want to
do some directed scanning.

00:11:53.410 --> 00:11:56.100
If we know what network we're
looking for ahead of time,

00:11:56.180 --> 00:11:58.100
we can optimize our
scanning to get some better,

00:11:58.100 --> 00:12:01.890
more specific results that
we care about in particular.

00:12:01.900 --> 00:12:03.600
If we're still just
doing broadcast scans,

00:12:03.620 --> 00:12:06.860
there'll be some information on how
to filter the results that come back,

00:12:06.890 --> 00:12:07.320
okay?

00:12:07.490 --> 00:12:10.900
So you can get a pretty good-sized list
depending on what environment you're in.

00:12:11.050 --> 00:12:13.900
So you may want to cut
that down a little bit.

00:12:14.040 --> 00:12:15.040
How to connect to a network.

00:12:15.150 --> 00:12:16.600
So this is a pretty critical feature,
right?

00:12:16.600 --> 00:12:18.700
Once you've done all the scanning,
what are you gonna do?

00:12:18.700 --> 00:12:19.860
You need to get associated.

00:12:19.980 --> 00:12:22.820
So we're gonna get into
how to achieve that.

00:12:23.300 --> 00:12:25.160
Once you've connected,
you may want to monitor the

00:12:25.250 --> 00:12:27.040
connection to make sure it looks good.

00:12:27.150 --> 00:12:28.390
Keep an eye on things.

00:12:28.460 --> 00:12:30.870
So check your signal strength out.

00:12:31.410 --> 00:12:34.740
For some things on the interface,
it's more efficient to listen for events.

00:12:34.840 --> 00:12:35.600
And we'll talk about that.

00:12:35.600 --> 00:12:40.970
And this is actually pretty important
because one of the things that we're

00:12:41.020 --> 00:12:45.730
going to talk about in the third
part of this is things that you can

00:12:45.730 --> 00:12:51.160
do to help your application perform
well and put less load in the system.

00:12:51.160 --> 00:12:51.840
And this is a big one.

00:12:51.840 --> 00:12:51.840
So event-based in general, of course,
is more efficient.

00:12:51.840 --> 00:12:51.840
And we've got some
information for you there.

00:12:52.320 --> 00:12:55.060
And finally, we're going to take a brief
look at setting and preferences,

00:12:55.090 --> 00:12:59.780
getting some information about the
join mode and some other things.

00:13:00.370 --> 00:13:02.960
Okay, so for directed scanning,
you remember we talked about

00:13:02.990 --> 00:13:07.020
AirPort create scan results,
which takes a dictionary of arguments,

00:13:07.020 --> 00:13:07.540
okay?

00:13:07.540 --> 00:13:09.940
So one of the things you
may be interested to do with

00:13:09.940 --> 00:13:11.540
this is directed scanning.

00:13:11.540 --> 00:13:15.740
And this is where you request a scan,
not of every network that's visible,

00:13:15.740 --> 00:13:17.490
but of a particular network.

00:13:17.500 --> 00:13:21.000
And you can scan either by the SSID,
which is the network name,

00:13:21.000 --> 00:13:25.930
or you can scan if you're looking for one
specific piece of equipment by the BSSID,

00:13:25.950 --> 00:13:27.620
so the actual hardware identifier.

00:13:28.810 --> 00:13:31.670
And these scans can actually run
faster because once we find the

00:13:31.670 --> 00:13:33.500
network that we're looking for,
we know we're done.

00:13:33.500 --> 00:13:37.070
And you can even further specify
these if you have some more

00:13:37.180 --> 00:13:39.360
information about the network.

00:13:39.360 --> 00:13:40.720
Like, for instance,
if you know what channel

00:13:40.720 --> 00:13:42.780
you're looking for,
you can provide an array of channels.

00:13:42.820 --> 00:13:45.250
And that's really going to speed
up the scan time because the

00:13:45.350 --> 00:13:48.050
fewer channels we have to scan,
the faster it goes,

00:13:48.050 --> 00:13:49.190
the quicker you get your results.

00:13:51.400 --> 00:13:54.180
So if you are scanning for the BSSID,
you're going to get either

00:13:54.180 --> 00:13:55.830
one result or nothing,
right?

00:13:55.890 --> 00:13:59.240
The base station is either
visible or it's not visible.

00:13:59.240 --> 00:14:01.790
If you're scanning for an SSID,
you may get multiples.

00:14:01.890 --> 00:14:05.800
For instance, the network here has many,
many base stations, but one SSID.

00:14:05.850 --> 00:14:08.560
So you get every station that
was visible from the point

00:14:08.560 --> 00:14:10.560
at which you did your scan.

00:14:14.080 --> 00:14:16.160
All right, filtering your scan results.

00:14:16.220 --> 00:14:18.770
So the keys that you're going
to find the most helpful to

00:14:18.770 --> 00:14:22.120
dig through this list are,
and these are taken right out of there,

00:14:22.120 --> 00:14:23.400
are this SSID string.

00:14:23.400 --> 00:14:25.760
Okay, so this is the name of the network.

00:14:26.230 --> 00:14:28.800
Obviously, if you know the name,
it's pretty easy to search for that.

00:14:28.860 --> 00:14:29.830
The security type.

00:14:29.830 --> 00:14:33.020
Okay, so there's a security type field,
and that'll tell you sort of

00:14:33.020 --> 00:14:35.850
the human readable security,
whether it's an open system,

00:14:35.850 --> 00:14:36.780
a web network.

00:14:36.930 --> 00:14:39.910
And that's probably the most critical one
if you're in an enterprise environment.

00:14:39.980 --> 00:14:42.220
You want to get the right network,
and you want to make sure it

00:14:42.260 --> 00:14:43.570
has the right security type.

00:14:44.050 --> 00:14:45.240
before you present it to your user.

00:14:45.390 --> 00:14:47.530
Make sure it's what you're expecting.

00:14:47.760 --> 00:14:50.290
And then finally,
and we saw this in the previous example,

00:14:50.480 --> 00:14:52.940
the information elements
that the vendor provides.

00:14:52.940 --> 00:14:55.790
So this comes through
as that binary blob.

00:14:55.790 --> 00:14:59.040
You may have to do some parsing
to get your particular bit or

00:14:59.090 --> 00:15:01.210
piece of information out of there.

00:15:01.400 --> 00:15:08.900
But if you have custom hardware,
if you have some vendor hardware that you

00:15:08.900 --> 00:15:11.080
know has a custom information element,
you can also use that

00:15:11.080 --> 00:15:11.080
to do your scanning.

00:15:13.330 --> 00:15:16.310
All right,
so getting connected to a network.

00:15:16.320 --> 00:15:17.880
After scanning,
this is probably one of the more

00:15:17.880 --> 00:15:21.580
important features of the API,
because it allows you to actually get

00:15:21.580 --> 00:15:25.760
your user connected and move them onto
the packets flowing portion of their day,

00:15:25.760 --> 00:15:28.310
which is what they're really after.

00:15:28.640 --> 00:15:31.860
So AirPorr associate
here takes the reference,

00:15:31.860 --> 00:15:33.440
as does every other call.

00:15:33.440 --> 00:15:34.640
It takes the network record.

00:15:34.710 --> 00:15:37.430
So that's the scan record
that you got back from a scan.

00:15:37.540 --> 00:15:41.440
So you may find that it's
best to do a directed scan,

00:15:41.440 --> 00:15:44.400
even if you know the network name,
so that you'll get the information

00:15:44.400 --> 00:15:45.660
to make the associate faster.

00:15:45.660 --> 00:15:48.530
And that's knowing what channel
that we're on and knowing what

00:15:48.590 --> 00:15:51.300
security type really speed up
the process of getting connected.

00:15:51.300 --> 00:15:54.980
So it's worth taking the time
to do that directed scan ahead.

00:15:56.140 --> 00:15:58.000
And then finally,
there's a results dictionary.

00:15:58.000 --> 00:15:59.840
That's sort of for future implementation.

00:15:59.840 --> 00:16:02.270
If there's any information
about the association that

00:16:02.270 --> 00:16:04.600
we think you need to know,
we're gonna stash it in

00:16:04.610 --> 00:16:05.900
there for the future.

00:16:06.760 --> 00:16:09.940
Big things that you might sneak
into this arguments dictionary.

00:16:09.990 --> 00:16:11.260
The really obvious one is the password.

00:16:11.260 --> 00:16:14.080
So if it's a secure network,
you need to provide that.

00:16:14.130 --> 00:16:17.040
If it's an enterprise security network,
you may need to provide the

00:16:17.040 --> 00:16:18.440
username and the password.

00:16:18.440 --> 00:16:22.500
You may also need to provide
the 802.1x profile information

00:16:22.500 --> 00:16:26.580
that it's going to use,
so the authentication types especially.

00:16:26.580 --> 00:16:30.780
And that's what we're going to get into
a little bit more in this demo here.

00:16:31.280 --> 00:16:33.200
And finally,
if you're looking to disconnect,

00:16:33.200 --> 00:16:37.060
just unplug for a little bit,
there's AirPorT Disassociate.

00:16:37.150 --> 00:16:39.380
And that'll actually, you know,
it's like unplugging your Ethernet.

00:16:39.380 --> 00:16:41.210
It's going to drop your
wireless connection for you.

00:16:41.400 --> 00:16:44.610
So if you ever have need of it,
it's there for you.

00:16:44.690 --> 00:16:47.990
And look at our next slide.

00:16:49.370 --> 00:16:53.300
Once you've established a connection,
you get a good error code back,

00:16:53.300 --> 00:16:55.070
you might want to keep an eye on it.

00:16:55.110 --> 00:16:57.160
Okay, so there's several things that
you're going to change over

00:16:57.250 --> 00:16:58.710
time or as you move around,
right?

00:16:58.790 --> 00:17:00.480
The signal strength can come and go.

00:17:00.480 --> 00:17:04.140
You can roam to different access points,
change your BSS ID.

00:17:04.140 --> 00:17:09.360
So we looked at AirPort copy
status a little earlier,

00:17:09.360 --> 00:17:12.350
and it has facilities in
there for getting these

00:17:12.460 --> 00:17:13.360
kinds of bits of information.

00:17:13.360 --> 00:17:15.790
So the connected network name we saw,
or we didn't see because

00:17:15.790 --> 00:17:16.900
we weren't connected.

00:17:17.760 --> 00:17:19.580
The op mode that the card is in.

00:17:19.580 --> 00:17:24.200
So most of the time,
the card is a client, okay?

00:17:24.200 --> 00:17:29.460
You can, if you want, start up an IBSS,
and then the card goes into IBSS mode,

00:17:29.460 --> 00:17:30.740
which is a different operations mode.

00:17:30.740 --> 00:17:31.800
Okay.

00:17:32.090 --> 00:17:35.790
If the user turns on internet sharing,
you're going to find yourself suddenly

00:17:35.920 --> 00:17:38.580
in software base station mode,
where the card's acting as

00:17:38.680 --> 00:17:40.080
a software base station.

00:17:40.250 --> 00:17:42.510
So checking the status,
making sure you know what's going on

00:17:42.510 --> 00:17:44.700
with the interface is a really good idea.

00:17:44.850 --> 00:17:48.520
If you're a software base station,
it's probably a bad idea to try and join

00:17:48.520 --> 00:17:51.940
another network before you turn that off.

00:17:52.110 --> 00:17:54.880
And then the one that probably
is most interesting to people is,

00:17:54.900 --> 00:17:56.020
what's the signal and noise?

00:17:56.040 --> 00:17:57.510
How good is my connection?

00:17:57.520 --> 00:18:00.610
What should I be expecting
in terms of performance here?

00:18:00.680 --> 00:18:05.400
So that's the most popular
feature by a long shot.

00:18:06.320 --> 00:18:09.470
Okay, so getting the status of an
interface is fairly inexpensive,

00:18:09.530 --> 00:18:11.200
but it's not free.

00:18:11.320 --> 00:18:14.200
And there are some things,
there are a lot of things about your

00:18:14.200 --> 00:18:16.150
status that only change very rarely.

00:18:16.200 --> 00:18:20.200
So roaming, for instance,
happens infrequently.

00:18:20.200 --> 00:18:22.200
Interface power events happen.

00:18:22.200 --> 00:18:26.200
It would be really nice if we could get
notified of these things asynchronously,

00:18:26.200 --> 00:18:29.200
okay, because we don't want to sit and
poll the interface repeatedly.

00:18:29.200 --> 00:18:32.200
So for that,
we have AirPorT event monitor start

00:18:32.200 --> 00:18:35.180
and AirPorT event monitor stop.

00:18:35.200 --> 00:18:38.200
Takes that AirPorT reference.

00:18:38.200 --> 00:18:41.200
You're going to provide a
callback function pointer,

00:18:41.200 --> 00:18:45.200
your own context pointer if you need one,
and then provide an array of event

00:18:45.200 --> 00:18:47.200
types that you're interested in.

00:18:47.200 --> 00:18:48.200
And these are in the header.

00:18:48.200 --> 00:18:50.190
As you can see, there's a list.

00:18:50.300 --> 00:18:52.350
Principally, the things you're going
to be looking out for are,

00:18:52.350 --> 00:18:53.200
like I said, the power changes.

00:18:53.200 --> 00:18:57.200
So if someone turns the power on and off,
you're going to get a notification.

00:18:57.200 --> 00:18:58.190
Link changes.

00:18:58.200 --> 00:19:01.200
If we wander out of distance of one
access point and you lose our link,

00:19:01.200 --> 00:19:03.180
you're going to get a notification.

00:19:03.290 --> 00:19:05.330
Similarly, if you come back into range
into range and we find one,

00:19:05.340 --> 00:19:07.700
you'll get the link out message.

00:19:08.060 --> 00:19:17.030
Op mode changes like we talked about
previously if you go from IBSS to

00:19:17.030 --> 00:19:17.590
BSS to SWBSS in any given day.

00:19:19.770 --> 00:19:22.750
And it's important to keep in mind
that when these events are delivered,

00:19:22.750 --> 00:19:24.540
it's a good time to check your status,
OK?

00:19:24.540 --> 00:19:27.070
Because you get an event in,
you'll know what it is.

00:19:27.280 --> 00:19:29.270
You can check your status
then to update things like

00:19:29.340 --> 00:19:31.860
what station am I attached to.

00:19:32.100 --> 00:19:35.020
Signal strength is one you do have
to keep an eye on yourself manually

00:19:35.020 --> 00:19:37.030
if you want to monitor it over time.

00:19:37.320 --> 00:19:39.120
No need to check every second.

00:19:39.120 --> 00:19:41.970
Every five or 10 seconds will do fine.

00:19:42.960 --> 00:19:43.180
Okay.

00:19:43.180 --> 00:19:44.940
So preferences.

00:19:44.940 --> 00:19:46.700
We're going to talk about
this one pretty quickly.

00:19:46.700 --> 00:19:49.580
There's two calls here,
one to copy a preference value

00:19:49.580 --> 00:19:51.320
and one to set a preference value.

00:19:51.320 --> 00:19:54.010
And this allows you to
look at things like,

00:19:54.010 --> 00:19:56.170
well, even the power settings.

00:19:56.170 --> 00:19:59.880
Is the power setting on so that
the interface is going to come

00:19:59.950 --> 00:20:02.160
up when you restart the machine?

00:20:02.160 --> 00:20:05.680
Whether you're going to be
in a particular join mode.

00:20:05.680 --> 00:20:09.550
And then also you can get
information here about the

00:20:09.550 --> 00:20:11.940
list of preferred networks.

00:20:11.940 --> 00:20:12.600
Okay.

00:20:12.900 --> 00:20:14.690
And we're going to add -- we
don't have it -- we didn't

00:20:14.690 --> 00:20:16.890
get it quite into the seed,
but we're going to add the ability

00:20:16.900 --> 00:20:19.380
for you to set a preferred network
without actually associating to it.

00:20:19.530 --> 00:20:22.440
So for the enterprise demo
that we're going to show you,

00:20:22.530 --> 00:20:24.730
it's all live,
but there's definitely a case that we

00:20:24.730 --> 00:20:27.900
want to support where you're configuring
a bunch of machines and you're offline.

00:20:27.900 --> 00:20:33.400
You don't actually -- in the presence of
the network that you want to configure.

00:20:33.660 --> 00:20:33.960
Okay.

00:20:34.210 --> 00:20:36.400
So that's our second demo.

00:20:38.700 --> 00:20:42.360
All right, we still have our
channel information here,

00:20:42.360 --> 00:20:44.900
so let's bring up this assistant.

00:20:46.340 --> 00:20:48.650
So this is a really simple
step through assistant.

00:20:48.710 --> 00:20:51.900
We're going to go through
the process of scanning,

00:20:52.270 --> 00:20:54.740
looking at our network list,
making association,

00:20:54.790 --> 00:20:56.980
and then having a peek at it.

00:20:56.980 --> 00:20:58.760
So we've got our first screen here.

00:20:58.960 --> 00:21:00.680
So now we're going into
our scanning phase.

00:21:00.680 --> 00:21:03.520
And this takes a few
minutes-- or a few seconds,

00:21:03.520 --> 00:21:07.110
excuse me-- just as it
does in the other demo.

00:21:07.120 --> 00:21:10.260
Now I happen to have a
1x network here with me.

00:21:10.260 --> 00:21:12.690
And you can tell that by the name.

00:21:14.510 --> 00:21:15.600
OK.

00:21:15.720 --> 00:21:17.640
So we've detected that
we have a 1x network.

00:21:17.730 --> 00:21:20.380
We want the username and password.

00:21:26.500 --> 00:21:30.500
You may want to use
this password one time.

00:21:30.500 --> 00:21:32.060
So we provide a checkbox here for this.

00:21:32.140 --> 00:21:34.840
If you have a network that
has two-factor authentication,

00:21:34.840 --> 00:21:37.140
you have a secure ID card,
you probably don't want

00:21:37.140 --> 00:21:38.320
the password saved.

00:21:38.350 --> 00:21:41.590
In this case, it's just a password,
so we're going to uncheck that.

00:21:41.720 --> 00:21:44.320
On the previous screen,
you missed there's a checkbox also.

00:21:44.320 --> 00:21:45.780
I should have stopped
for a second longer.

00:21:45.780 --> 00:21:47.760
It says, hey, do we want to remember
this network or not?

00:21:47.780 --> 00:21:50.500
And this is another parameter that
you can give to the associate call

00:21:50.500 --> 00:21:53.250
to say whether or not this thing
gets added to the preferred list.

00:21:53.880 --> 00:21:55.400
So we have that checked.

00:21:55.430 --> 00:21:58.110
And let's go ahead and try and associate.

00:22:01.240 --> 00:22:02.020
And we made it.

00:22:02.190 --> 00:22:07.180
So here you can see we have the
network's name and it's keeping

00:22:07.180 --> 00:22:08.100
an eye on the signal here.

00:22:08.100 --> 00:22:12.620
As the signal changes,
it'll animate a little so you can see

00:22:12.620 --> 00:22:16.580
how well it's receiving the signal.

00:22:16.580 --> 00:22:16.580
Okay?

00:22:16.970 --> 00:22:19.620
So, and this is using a lot,
this is using the techniques that we

00:22:19.620 --> 00:22:24.520
just talked about in the previous slides
here to get you through to this endpoint.

00:22:24.520 --> 00:22:27.200
All right.

00:22:27.250 --> 00:22:27.840
Slides, please.

00:22:36.130 --> 00:22:38.470
So we talked about a
really simple scanner,

00:22:38.470 --> 00:22:42.690
OK, and we talked about this slightly
more complicated enterprise assistant

00:22:42.690 --> 00:22:44.760
that uses the associate calls.

00:22:45.200 --> 00:22:46.680
For this part of the presentation,
I want to talk to you a little

00:22:46.680 --> 00:22:50.710
bit about managing the shared,
precious shared resource that

00:22:50.710 --> 00:22:53.370
is the AirPort interface.

00:22:53.470 --> 00:22:58.280
We, like any network interface,
there's a lot of competition,

00:22:58.300 --> 00:23:00.970
or there's a lot of different
people that are using it.

00:23:00.980 --> 00:23:03.870
And especially because this is
the primary interface that a lot

00:23:03.870 --> 00:23:05.220
of people use today to connect.

00:23:05.290 --> 00:23:09.270
I mean, you get a MacBook out of the box,
the first thing you do is flip it open,

00:23:09.290 --> 00:23:12.040
and you get connected
to a wireless network.

00:23:12.160 --> 00:23:14.920
So as we're using this API,
there's some things we really

00:23:14.920 --> 00:23:16.490
have to take in to be mindful of.

00:23:16.700 --> 00:23:17.140
All right.

00:23:17.140 --> 00:23:19.860
And the first one is sort of
take a look before you scan.

00:23:19.920 --> 00:23:23.590
We talked about checking your
status before you break into a scan.

00:23:23.600 --> 00:23:28.000
And that's really important because
you're going to be behaving differently

00:23:28.390 --> 00:23:30.550
when you're connected than when
you're not connected in terms of

00:23:30.580 --> 00:23:35.010
how often you perform a scan if
you're performing it repeatedly.

00:23:35.210 --> 00:23:37.730
The second one,
we touched on this a little bit earlier,

00:23:37.730 --> 00:23:39.700
is that scanning does take time.

00:23:39.790 --> 00:23:41.140
It used to be that it was very fast.

00:23:41.240 --> 00:23:42.440
It's getting long-- it's long now.

00:23:42.440 --> 00:23:43.440
It's getting longer.

00:23:43.490 --> 00:23:47.760
We'll talk a little bit about why that
is and what you can do to mitigate that.

00:23:47.960 --> 00:23:50.120
And the third, this is, you know,
true of all programming,

00:23:50.120 --> 00:23:51.510
is preparing for failure.

00:23:51.680 --> 00:23:53.580
And this is, you know,
sort of an especially

00:23:53.580 --> 00:23:57.490
important consideration where
we may or may not have cards.

00:23:57.730 --> 00:24:00.090
There's a lot that can go wrong here.

00:24:00.380 --> 00:24:01.120
All right.

00:24:01.260 --> 00:24:03.190
So look before you scan.

00:24:03.860 --> 00:24:05.600
Copy status, copy status, copy status.

00:24:05.840 --> 00:24:09.890
Always have a look at what your card
is doing before you start scanning.

00:24:10.000 --> 00:24:11.750
Listen to the notifications, okay?

00:24:11.850 --> 00:24:14.000
There are times when it's
just not appropriate to scan.

00:24:14.000 --> 00:24:16.400
If you're in base station
mode particularly,

00:24:16.400 --> 00:24:19.660
it doesn't make a lot of sense
to go off and do your scanning.

00:24:19.660 --> 00:24:23.640
There's a lot of useful info,
but the big thing,

00:24:23.640 --> 00:24:29.070
the thing that you're going to base
most of your decision-making on is are

00:24:29.070 --> 00:24:29.070
you currently connected to a network,
okay?

00:24:29.730 --> 00:24:33.130
So if you are connected, scan less, okay,
and much less.

00:24:33.130 --> 00:24:38.260
So every 45 to 60 seconds
is pretty reasonable.

00:24:38.260 --> 00:24:40.480
So you're going to get, you know,
updates every minute or so.

00:24:40.480 --> 00:24:43.370
This is unless you're
driving around in a car,

00:24:43.420 --> 00:24:47.640
that's probably a pretty reasonable
amount of time to wait before you

00:24:47.730 --> 00:24:50.130
update your network environment.

00:24:51.140 --> 00:24:53.900
So if you're disconnected, scan less,
okay.

00:24:53.900 --> 00:24:57.340
So scanning does take time,
as we're about to talk about,

00:24:57.350 --> 00:24:58.980
but it also, you know, uses energy.

00:24:58.980 --> 00:25:01.530
So if you're on a battery,
you're using power to scan.

00:25:01.540 --> 00:25:05.430
And if you're out and about, now,
if you're not connected,

00:25:05.430 --> 00:25:09.080
you're not going to be
interrupting network traffic.

00:25:09.080 --> 00:25:12.460
And the reason we say to scan so
infrequently is that when you scan,

00:25:12.460 --> 00:25:15.490
we can't move packets to the
network that we're connected to,

00:25:15.490 --> 00:25:16.180
okay.

00:25:16.180 --> 00:25:18.500
So if you're disconnected,
you can get away with scanning

00:25:18.500 --> 00:25:21.100
a little bit more often,
but really every 30 seconds.

00:25:21.140 --> 00:25:23.870
That should be sufficient.

00:25:26.850 --> 00:25:30.370
So doing the scanning takes some time.

00:25:30.560 --> 00:25:34.140
When we first started,
when the first AirPorts cards came out,

00:25:34.140 --> 00:25:39.180
you could scan the whole 2.4 gigahertz
spectrum in less than a second.

00:25:39.440 --> 00:25:40.700
And that's great.

00:25:40.700 --> 00:25:44.280
We got a lot of tools that were written
around that assumption that it was

00:25:44.370 --> 00:25:46.760
going to take that long and no longer.

00:25:46.780 --> 00:25:51.180
When we started introducing
802.11a and n technology and the

00:25:51.180 --> 00:25:56.880
5 gigahertz band that they use,
scans started taking a lot longer.

00:25:56.890 --> 00:25:58.720
There's a couple of reasons for this.

00:25:58.830 --> 00:26:01.520
So one of them is simply that we
have more channels to look at.

00:26:01.520 --> 00:26:03.800
It takes longer to get
through all of them.

00:26:03.810 --> 00:26:06.020
The other one is that a lot
of the newer channels are

00:26:06.020 --> 00:26:08.160
what we call passive channels.

00:26:08.160 --> 00:26:10.970
So these are frequencies
that got recycled.

00:26:10.980 --> 00:26:16.190
A lot of them came from
aviation radar systems.

00:26:16.510 --> 00:26:19.610
And we need to be careful when
we're using them that we don't

00:26:19.610 --> 00:26:23.420
start broadcasting on frequencies
that some incumbent is using.

00:26:23.640 --> 00:26:25.130
So.

00:26:25.290 --> 00:26:27.750
In the 5 GHz band,
we spend a lot of time looking,

00:26:27.750 --> 00:26:29.360
checking to make sure it's okay.

00:26:29.360 --> 00:26:32.130
We don't want to mess with
anyone's radar systems.

00:26:32.140 --> 00:26:35.710
But as a result,
it's taking longer and longer to scan.

00:26:35.720 --> 00:26:39.270
And as we add frequencies,
most of the ones that we add are

00:26:39.270 --> 00:26:40.670
being reused from some other source.

00:26:40.720 --> 00:26:44.080
So you can expect it to
continue to take a while.

00:26:44.080 --> 00:26:48.370
On some of our most recent machines,
we're looking at close to 7

00:26:48.490 --> 00:26:52.440
or 8 seconds to perform a full
broadcast scan of 2.4 or 5 gig,

00:26:52.440 --> 00:26:54.200
all the passive channels.

00:26:55.200 --> 00:26:57.840
How long it takes really depends.

00:26:57.840 --> 00:27:00.990
So all the time I'm giving you right now,
we're talking about

00:27:01.110 --> 00:27:02.500
United States systems.

00:27:02.500 --> 00:27:06.400
If you go outside the United States,
where the list of channels is different,

00:27:06.400 --> 00:27:08.460
there are different rules about
which ones can be scanned,

00:27:08.460 --> 00:27:10.200
these times can get even longer.

00:27:10.200 --> 00:27:14.100
So one thing that you can do,
as I highly suggest this,

00:27:14.100 --> 00:27:18.090
is just put a little clock,
measure how long it takes you

00:27:18.110 --> 00:27:22.820
to perform a particular scan,
and use that to set your timers.

00:27:23.750 --> 00:27:26.200
Because it's not going to
be the same everywhere.

00:27:26.200 --> 00:27:29.230
And you really want to make sure
that you're not interfering with

00:27:29.320 --> 00:27:31.260
nearby devices by scanning too much.

00:27:31.260 --> 00:27:34.010
You want to make sure you're
not interfering with your own

00:27:34.010 --> 00:27:35.590
device by scanning too much.

00:27:36.740 --> 00:27:37.520
All right.

00:27:37.700 --> 00:27:38.360
Prepare for failure.

00:27:38.360 --> 00:27:40.920
This is, you know,
pretty important in all programming,

00:27:40.920 --> 00:27:41.800
but especially here.

00:27:41.800 --> 00:27:45.320
So we already talked about some
machines do not have AirPort interfaces.

00:27:45.320 --> 00:27:47.100
Okay.

00:27:47.100 --> 00:27:49.890
For those machines that do have one,
the hardware is installed,

00:27:49.890 --> 00:27:52.830
it's plugged in, it's powered up,
it might not be configured.

00:27:52.830 --> 00:27:53.440
Okay.

00:27:53.440 --> 00:27:56.610
So, you know, there's people using their
network control panel can,

00:27:56.610 --> 00:27:58.660
you know,
remove an interface from the list,

00:27:58.660 --> 00:27:59.560
deconfigure it.

00:27:59.740 --> 00:28:02.920
Even if it has been configured,
it might be disabled.

00:28:02.920 --> 00:28:03.520
Right.

00:28:03.520 --> 00:28:06.580
In both those cases,
you need to check the power on the card.

00:28:06.600 --> 00:28:09.110
the power will be turned off.

00:28:09.490 --> 00:28:12.290
Now, let's say you've got a card.

00:28:12.290 --> 00:28:13.090
It's been configured.

00:28:13.090 --> 00:28:13.540
It's enabled.

00:28:13.540 --> 00:28:14.660
That's kind of the default state.

00:28:14.660 --> 00:28:17.520
This is the way the laptops ship,
or the AirPort machines ship.

00:28:17.740 --> 00:28:20.300
You might find when you scan,
you get an error code

00:28:20.360 --> 00:28:22.060
back that comes as eBusy.

00:28:22.060 --> 00:28:24.960
And eBusy is a code that we
use to indicate that we're kind

00:28:25.040 --> 00:28:26.860
of doing something right now.

00:28:26.860 --> 00:28:27.890
We're using the interface.

00:28:27.900 --> 00:28:30.730
So what you need to do,
and typically this is

00:28:30.730 --> 00:28:33.580
when you open the lid,
the laptop wakes up,

00:28:33.650 --> 00:28:36.120
it's going to start looking
around for networks to join.

00:28:36.980 --> 00:28:39.740
During that searching process,
it's going to mark the interface as busy.

00:28:39.740 --> 00:28:43.000
Your scans will come back
with this result code.

00:28:43.000 --> 00:28:46.230
So if you see this,
the thing to do is just back off.

00:28:46.230 --> 00:28:49.840
Give us five or ten seconds to see if
we can't get the user onto the network.

00:28:50.020 --> 00:28:55.680
And then start your scan process again
and look to see if it's free now.

00:28:57.380 --> 00:28:59.310
Some of the operations that
we talked about are going to

00:28:59.310 --> 00:29:01.540
require administrative privilege,
okay?

00:29:01.730 --> 00:29:11.020
So in the network control panel,
you know there's the little checkbox that

00:29:11.020 --> 00:29:11.020
says require administrative privilege
to modify the AirPort interface.

00:29:13.760 --> 00:29:16.970
When you run across one of those
restricted features and you make

00:29:17.040 --> 00:29:20.060
one of the calls in the API,
you may have to wait for the user

00:29:20.060 --> 00:29:21.910
to authorize or not authorize.

00:29:22.000 --> 00:29:24.960
Okay, so you might block for a few
seconds or as long as it takes the

00:29:25.000 --> 00:29:26.540
user to remember their password.

00:29:26.540 --> 00:29:28.690
So be prepared for that.

00:29:28.720 --> 00:29:32.840
And particularly association,
creating IBSS networks, for instance,

00:29:32.840 --> 00:29:36.530
is another one where those are
restricted for various reasons.

00:29:36.540 --> 00:29:40.020
Keep an eye out for these conditions.

00:29:40.640 --> 00:29:42.750
Some of these calls,
particularly scanning,

00:29:42.770 --> 00:29:43.780
do take a long time.

00:29:43.780 --> 00:29:47.080
Don't do them in your UI thread because
you will block your user interface.

00:29:49.420 --> 00:29:51.850
All right, so that's kind of all the
admonitions we have for today.

00:29:52.090 --> 00:29:53.800
This is an evolving system.

00:29:53.970 --> 00:29:54.950
Please send us some feedback.

00:29:55.060 --> 00:30:01.100
We have an email address,
airportapi-feedback@group.apple.com.

00:30:01.100 --> 00:30:03.400
You can send us, you know,
if you have information

00:30:03.400 --> 00:30:06.400
about what you're doing,
we always like to hear that.

00:30:06.400 --> 00:30:08.400
If there's features that
you need that don't appear,

00:30:08.400 --> 00:30:10.400
please let us know.

00:30:10.400 --> 00:30:11.900
And this is, you know,
how we're gonna hear back

00:30:11.900 --> 00:30:14.200
from you to help improve this.

00:30:15.680 --> 00:30:16.380
OK, resources.

00:30:16.470 --> 00:30:19.160
So I've mentioned a couple times
the actual framework itself.

00:30:19.180 --> 00:30:20.440
Go look through the headers.

00:30:20.500 --> 00:30:23.650
There's lots of good information in
there on the specifics of what some of

00:30:23.650 --> 00:30:27.190
these keys do and some of the information
you can get we didn't get into.

00:30:27.280 --> 00:30:32.580
Things like create IBSS we didn't
really have a chance to get into deeply.

00:30:33.060 --> 00:30:35.640
Code examples-- we're going
to post the source for the

00:30:35.640 --> 00:30:39.340
examples for the demonstration
here to developer.apple.com.

00:30:39.360 --> 00:30:42.590
Give us a little time to
get those up and worked out.

00:30:42.760 --> 00:30:47.200
And finally, if you have questions about
the protocols themselves,

00:30:47.200 --> 00:30:50.440
so 802.11, the family has really
grown over the years.

00:30:50.440 --> 00:30:55.420
There's a lot more going on than
there used to be when it was just 11b.

00:30:55.420 --> 00:30:58.640
Go to IEEE Explorer,
and you can actually get,

00:30:58.640 --> 00:31:02.630
for everything up to, I think,
the current end draft may not

00:31:02.710 --> 00:31:05.430
be available publicly yet,
but you can get the detailed

00:31:05.430 --> 00:31:07.140
information about all these protocols.

00:31:07.380 --> 00:31:10.310
So some of the bit fields that we talked
about that you see in scan records,

00:31:10.310 --> 00:31:13.200
you'll have very detailed
explanations about what's in there.

00:31:13.200 --> 00:31:17.100
So IEEE Explorer is the place
to go if you need protocol-level

00:31:17.100 --> 00:31:20.980
information that's not going
to be covered by this API.

00:31:24.080 --> 00:31:26.490
Okay, even more information.

00:31:26.620 --> 00:31:29.700
Mark Tozer is our developer and
wireless technologies evangelist.

00:31:29.810 --> 00:31:32.290
You can -- his email and
contact information is here.

00:31:32.480 --> 00:31:34.990
And Rich Kubota is our
DTS representative.

00:31:35.040 --> 00:31:36.490
So these guys have been great.

00:31:36.500 --> 00:31:38.020
They really -- you know,
they're here to help you

00:31:38.020 --> 00:31:38.980
guys out as developers.

00:31:38.990 --> 00:31:41.620
So get in touch with them.

00:31:41.620 --> 00:31:45.230
Let them know what you're looking for.

00:31:45.550 --> 00:31:48.940
And also use that feedback email.

00:31:48.940 --> 00:31:50.490
We'll give you a second
to write down those names.

00:31:51.880 --> 00:31:52.590
All right.

00:31:52.710 --> 00:31:53.860
So thanks, everyone, for coming out.

00:31:53.860 --> 00:31:55.800
It's great to have a chance to do this.

00:31:55.870 --> 00:31:58.390
I want to say thank you to the
whole AirPorT team from Apple for

00:31:58.390 --> 00:32:00.590
making this all possible,
and then also the network

00:32:00.590 --> 00:32:01.780
operations team here.

00:32:01.780 --> 00:32:05.360
They did a great job for the show
getting you all off the wire.

00:32:05.360 --> 00:32:06.940
So thanks, everybody.