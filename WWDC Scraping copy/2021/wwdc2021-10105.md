# Wwdc2021 10105

## Transcript

More Videos

Streaming is available in most browsers,and in the Developer app.

About

Transcript

Secure login with iCloud Keychain verification codesLearn how you can support on-device verification codes in your app or website for a more secure sign-in experience. We'll explore the latest updates to the iCloud Keychain password manager and discover how verification codes, AutoFill, iCloud Keychain sync, and two-tap setup simplify the multi-step sign-in process. We'll show you how to support this process in your apps and websites.ResourcesApple Platform SecurityLearn more about enhancing SMS-delivered code security with domain-bound codesSecuring Logins with iCloud Keychain Verification CodesHD VideoSD VideoRelated VideosWWDC21Move beyond passwordsSimplify sign in for your tvOS apps

Learn how you can support on-device verification codes in your app or website for a more secure sign-in experience. We'll explore the latest updates to the iCloud Keychain password manager and discover how verification codes, AutoFill, iCloud Keychain sync, and two-tap setup simplify the multi-step sign-in process. We'll show you how to support this process in your apps and websites.

Apple Platform Security

Learn more about enhancing SMS-delivered code security with domain-bound codes

Securing Logins with iCloud Keychain Verification Codes

HD VideoSD Video

HD Video

SD Video

Move beyond passwords

Simplify sign in for your tvOS apps

Search this videoâ€¦Hi. I'm Eryn Wells, an engineeron the Authentication Experience Team.If your app or website ever asks someone for a password,then you know that account securityis critically important.In this video, I'm gonna talk abouthow to keep your customer's accounts more secureand how to make signing in with verification codeseven easier with the new verification code generatorbuilt into iCloud Keychain.This is a big topic,and I'm gonna break it down into three important parts.First, we'll talk about passwords,some of the security problems they have,and how multistep authenticationhelps address some of those problems.Second,I'll talk about time-based verification codes,including a brand-new authenticatorwe've built into iCloud Keychainin iOS 15 and macOS Monterey.Finally, I'll take a step backto discuss the beginning of a big changehappening in the world of authentication,as well as some other opportunitiesto improve how people sign in with verification codes.OK, let's talk about passwords and multistep authentication.Passwords are everywhere,and people understand how to use them.However,it turns out they're difficult to use correctly.In fact, it's easier to misuse passwordsthan to use them correctly.People frequently reuse passwordsacross multiple websitesor choose passwords that are easy to guess.It's also pretty easy for an attackerto convince someone to give up their password.So services are faced with a dilemma:How do we add security to our users' accountswhile still making it easy to log in?Many services add steps to their log-in flows.They ask for additional pieces of informationto confirm someone's identity.Adding steps like this reduces the chancethat an attacker with someone's passwordwill be able to access that person's account.It also means the attacker won't automatically have accessto any other accountswhere that person used the same password.Verification codes are a common additional step.Services ask for these codesafter someone has entered their user name and password.These codes are either delivered over SMS, email,or a push notification,or they're generated by an authenticator appon the person's phoneor with a hardware key fob.An essential feature of these codesis that they're single use.Since they're not intended to be memorized or stored,they're not susceptible to reuse like passwords are.Verification codes do still require a humanto enter the code, though,so they're still prone to phishingin the same way that passwords are.The most common way by farthat verification codes are delivered is with SMS.Almost everyone who has a cell phonecan receive a text message,and people understand sending and receiving texts.AutoFill made it even easier to use these codes.Just one tap fills a code into any text field.But there are still real problemswith verification codes delivered over SMS.For one thing, they're not very secure.They're vulnerable to snooping on carrier networksand SIM-swapping attacks,where an attacker can receive messagesmeant for someone else.People tend to take for grantedthat text messages will come and go without error,but they do require network access.So if someone's on an airplane or away from strong service,it might take a long time for a message to arriveor it may not arrive at all.Finally,SMS messages have a cost,both to send and to receive.So sending millions of these messagescan really add up.Another way verification codes are doneis with on-device code generators.The algorithm for doing this is defined in RFC 6238and is called "Time-Based One-Time Passwords,"or "TOTP."It takes a secret key and a timeand produces a short numeric codebased on those bits of information.Typically,an authenticator app or hardware devicegenerates the codes.It doesn't require any communication with the service.It all happens on the device.This is a huge benefit in terms of security and user experience.Codes are valid for a short amount of time,typically 30 seconds or so.And it results in lower costsfor both services and customersbecause no one has to send or receive SMS messages.The challenge with TOTPis that it tends to be a bit more complicated to set up.Services have to share a secret keywith their customers,along with several other parameters,so that the customer's device can start generating codes.A typical setup process involves displaying a QR codeon one device,downloading an authenticator app on another device,and then scanning the QR code with that app.This is a cumbersome process,and it's difficult to explain to people.Generating codes on-device is a better experiencefor everyone,but it does still have some pesky issues around setup.We took a careful look at some of those difficultiesand developed a new feature of iCloud Keychainthat brings a streamlined setup experiencetogether with AutoFillinto something really fantastic.New in iOS 15and macOS Monterey,we've built time-based verification code generatorsinto iCloud Keychain Password Manager,and I am so excited to show you how this works.We started with the basics:looking up and copying codesto use on this device or another device.These are important features of any authenticator app.But AutoFill really makes this shine.Just like with codes delivered over SMS,AutoFill fills generated verification codeswith a single tap.Because codes are immediately available,your customers get a more streamlined,reliable sign-in experience,and you get to reduce the costs of sending SMS messages.One of my favorite parts of this featureis how easy it can be to set up a new verification code.When you add a special link or a buttonto your TOTP setup pages,someone using iOS 15 or macOS Montereywill be able to set up a new verification codeon the same device with just a couple taps.It's really, really easy.Finally, verification codes are syncedacross all of a person's devices,and they're securely backed up with iCloud Keychain.So they don't have to pull out their iPhoneto fill a verification codewhen they're signing in to an account on their Mac.This is great for account recovery too.When verification codes are safely backed up in iCloud,losing a device no longer means losing access to accounts.As a reminder,everything in iCloud Keychain is end-to-end encrypted,so no one except the owner of the account--not Apple or anyone else--can access them.Devices with iCloud Keychain enabledare protected by Face ID, Touch ID, or a passcode.And every Apple device has the highest level of securitysupported by the operating system.So Keychain data is safe,no matter which device a person has in the moment.Apple's Platform Security Guide describes all of thisand a lot more in great detail.There are a few easy things you can doto ensure your customers have the best possible experiencesetting up and filling codes.For your setup flows, there are two things,and for your log-in flows, there's just one.Let's talk a little about each one.Being able to set up a new verification codewith just a few taps is a big deal.Hundreds of millions of iPhone usersare going to be able to do thisas soon as they update to iOS 15.You can make it super easyto set up verification codes on their devicesby adding a link or a buttonthat does this to your setup screens.If you already have infrastructureto support logging in with TOTP codes,you might be familiar with otpauth: URLs.These URLs contain all of the information requiredto set up a code generator,including the base32-encoded secret key,the number of digits in each code,the period of time that each code is valid for,and an issuer fieldthat you should set to your domain name.iCloud Keychain uses this field to suggest an accountto add the verification code to.This is the same URL that you encode into the QR codesthat are a common part of the TOTP setup process.You can link directlyto the iCloud Keychain Password Managerby prefixing the URL with "apple-".You can take this apple otpauth: URLand put it in an anchor tag on your web page.And in apps, you have two options.You can create a link by adding the "link" attributeto an NSAttributedStringthat you assign to a textView's attributedString property,or you can open the URL in response to a button tapwith the open API on the window scene.You can checkwhether the system can open apple otpauth: URLswith an availability check.On previous versions of iOS,you should hide setup buttons and remove setup URLs.The second thing you can do during setupis to use raster images like JPGs, PNGs, or GIFsfor QR codes intended to be scanned by other TOTP apps.Safari uses on-device image analysisto detect QR codesand decode the information they contain.If Safari determinesthat the QR code contains an otpauth: URL,it will offer to set up the code generatorin the context menu for the QR code image.The last thing to do concerns text fieldsfor entering generated codes.To ensure that AutoFill knowsexactly where to fill user names, passwords,and verification codes,annotate those text fields with content types.You can do this in SwiftUIwith the textContentType view modifier,in UIKit with the textContentType propertyon UITextFields,in AppKit apps with the contentType propertyon NSTextFields,and on the web, you can set the auto-complete attributeto "one-time-code" on input elements.So now, I wanna take a step back.Let's look at the big picture of authenticationand talk a little abouthow to make your existing infrastructure more secure.Authentication mechanisms exist on a spectrum,increasing in strength and security as you move along.Passwords are the traditional baselinefor the industry,and there are a number of waysthat services reinforce password-based log-in flows.Two of the most common are Passwords + Codesdelivered over SMSand Passwords + Codes generated with TOTP.An additional decision services makeis whether to use a federated sign-in providerthat delegates the entire process of authenticationto another service.Federated authentication options are basedon all the same mechanisms as traditional methodsbut require people to keep track of fewer passwords.When implemented on robust, secure infrastructure--as is the case with Sign in with Apple--they can also be more securethan those traditional mechanisms.A step beyond any of theseis to get rid of passwords altogether.The WebAuthentication standard, or "WebAuthn,"does exactly this.Instead,it uses public key cryptography to keep accounts safe.iOS 15 and macOS Monterey contain a previewof this technologythat offers a usable replacement for passwords.My teammate Garrett has a video about itthat you should definitely check out.As our whole industry continues to workon building that future without passwords,there is still real valuein taking steps to improve the securityof the infrastructure you already haveand may continue to have for a while.Anything you can do to keep people safer online is good.One step you can take concerns verification codesdelivered over SMS.As you're evaluating adopting time-based verification codes,you might still need to send codes with SMS.In iOS 14 and macOS Big Sur,we introduced a simple mechanismfor making your SMS codes more resistant to phishingby adding domain bindings to your messages.A domain binding is a way of communicating with AutoFillthat the code in this message is meant for a particular domain.When the code is bound in this way,AutoFill will only offer the codeif the domain it's bound tomatches the domain of the web pageor one of your app's associated domains.In apps, this works on the same mechanismsas associated domains and universal links.So if you've already configured your appsfor those technologies,you're all set to add domain bindings.You can learn more about this in an article we publishedabout enhancing the security of SMS codes with domain bindings.Now that you know all about verification codes,go and do these two important things.First,adopt time-based verification codesin your apps and websites.Add support to your back ends,and encourage your customers to use theminstead of getting codes over SMS.Second,if you are continuing to support SMS verification codes,add domain bindings to your messages.Thank you for watching.[music]

Hi. I'm Eryn Wells, an engineeron the Authentication Experience Team.If your app or website ever asks someone for a password,then you know that account securityis critically important.In this video, I'm gonna talk abouthow to keep your customer's accounts more secureand how to make signing in with verification codeseven easier with the new verification code generatorbuilt into iCloud Keychain.

This is a big topic,and I'm gonna break it down into three important parts.First, we'll talk about passwords,some of the security problems they have,and how multistep authenticationhelps address some of those problems.Second,I'll talk about time-based verification codes,including a brand-new authenticatorwe've built into iCloud Keychainin iOS 15 and macOS Monterey.Finally, I'll take a step backto discuss the beginning of a big changehappening in the world of authentication,as well as some other opportunitiesto improve how people sign in with verification codes.

OK, let's talk about passwords and multistep authentication.

Passwords are everywhere,and people understand how to use them.However,it turns out they're difficult to use correctly.In fact, it's easier to misuse passwordsthan to use them correctly.People frequently reuse passwordsacross multiple websitesor choose passwords that are easy to guess.It's also pretty easy for an attackerto convince someone to give up their password.So services are faced with a dilemma:How do we add security to our users' accountswhile still making it easy to log in?Many services add steps to their log-in flows.They ask for additional pieces of informationto confirm someone's identity.Adding steps like this reduces the chancethat an attacker with someone's passwordwill be able to access that person's account.It also means the attacker won't automatically have accessto any other accountswhere that person used the same password.Verification codes are a common additional step.Services ask for these codesafter someone has entered their user name and password.These codes are either delivered over SMS, email,or a push notification,or they're generated by an authenticator appon the person's phoneor with a hardware key fob.

An essential feature of these codesis that they're single use.Since they're not intended to be memorized or stored,they're not susceptible to reuse like passwords are.Verification codes do still require a humanto enter the code, though,so they're still prone to phishingin the same way that passwords are.The most common way by farthat verification codes are delivered is with SMS.Almost everyone who has a cell phonecan receive a text message,and people understand sending and receiving texts.

AutoFill made it even easier to use these codes.Just one tap fills a code into any text field.But there are still real problemswith verification codes delivered over SMS.For one thing, they're not very secure.They're vulnerable to snooping on carrier networksand SIM-swapping attacks,where an attacker can receive messagesmeant for someone else.

People tend to take for grantedthat text messages will come and go without error,but they do require network access.So if someone's on an airplane or away from strong service,it might take a long time for a message to arriveor it may not arrive at all.

Finally,SMS messages have a cost,both to send and to receive.So sending millions of these messagescan really add up.Another way verification codes are doneis with on-device code generators.The algorithm for doing this is defined in RFC 6238and is called "Time-Based One-Time Passwords,"or "TOTP."It takes a secret key and a timeand produces a short numeric codebased on those bits of information.Typically,an authenticator app or hardware devicegenerates the codes.It doesn't require any communication with the service.It all happens on the device.

This is a huge benefit in terms of security and user experience.Codes are valid for a short amount of time,typically 30 seconds or so.And it results in lower costsfor both services and customersbecause no one has to send or receive SMS messages.

The challenge with TOTPis that it tends to be a bit more complicated to set up.Services have to share a secret keywith their customers,along with several other parameters,so that the customer's device can start generating codes.A typical setup process involves displaying a QR codeon one device,downloading an authenticator app on another device,and then scanning the QR code with that app.This is a cumbersome process,and it's difficult to explain to people.Generating codes on-device is a better experiencefor everyone,but it does still have some pesky issues around setup.We took a careful look at some of those difficultiesand developed a new feature of iCloud Keychainthat brings a streamlined setup experiencetogether with AutoFillinto something really fantastic.

New in iOS 15and macOS Monterey,we've built time-based verification code generatorsinto iCloud Keychain Password Manager,and I am so excited to show you how this works.

We started with the basics:looking up and copying codesto use on this device or another device.These are important features of any authenticator app.

But AutoFill really makes this shine.Just like with codes delivered over SMS,AutoFill fills generated verification codeswith a single tap.Because codes are immediately available,your customers get a more streamlined,reliable sign-in experience,and you get to reduce the costs of sending SMS messages.

One of my favorite parts of this featureis how easy it can be to set up a new verification code.When you add a special link or a buttonto your TOTP setup pages,someone using iOS 15 or macOS Montereywill be able to set up a new verification codeon the same device with just a couple taps.It's really, really easy.

Finally, verification codes are syncedacross all of a person's devices,and they're securely backed up with iCloud Keychain.So they don't have to pull out their iPhoneto fill a verification codewhen they're signing in to an account on their Mac.This is great for account recovery too.When verification codes are safely backed up in iCloud,losing a device no longer means losing access to accounts.As a reminder,everything in iCloud Keychain is end-to-end encrypted,so no one except the owner of the account--not Apple or anyone else--can access them.

Devices with iCloud Keychain enabledare protected by Face ID, Touch ID, or a passcode.And every Apple device has the highest level of securitysupported by the operating system.So Keychain data is safe,no matter which device a person has in the moment.Apple's Platform Security Guide describes all of thisand a lot more in great detail.

There are a few easy things you can doto ensure your customers have the best possible experiencesetting up and filling codes.For your setup flows, there are two things,and for your log-in flows, there's just one.Let's talk a little about each one.

Being able to set up a new verification codewith just a few taps is a big deal.Hundreds of millions of iPhone usersare going to be able to do thisas soon as they update to iOS 15.You can make it super easyto set up verification codes on their devicesby adding a link or a buttonthat does this to your setup screens.

If you already have infrastructureto support logging in with TOTP codes,you might be familiar with otpauth: URLs.These URLs contain all of the information requiredto set up a code generator,including the base32-encoded secret key,the number of digits in each code,the period of time that each code is valid for,and an issuer fieldthat you should set to your domain name.iCloud Keychain uses this field to suggest an accountto add the verification code to.

This is the same URL that you encode into the QR codesthat are a common part of the TOTP setup process.You can link directlyto the iCloud Keychain Password Managerby prefixing the URL with "apple-".

You can take this apple otpauth: URLand put it in an anchor tag on your web page.And in apps, you have two options.You can create a link by adding the "link" attributeto an NSAttributedStringthat you assign to a textView's attributedString property,or you can open the URL in response to a button tapwith the open API on the window scene.You can checkwhether the system can open apple otpauth: URLswith an availability check.On previous versions of iOS,you should hide setup buttons and remove setup URLs.

The second thing you can do during setupis to use raster images like JPGs, PNGs, or GIFsfor QR codes intended to be scanned by other TOTP apps.Safari uses on-device image analysisto detect QR codesand decode the information they contain.If Safari determinesthat the QR code contains an otpauth: URL,it will offer to set up the code generatorin the context menu for the QR code image.

The last thing to do concerns text fieldsfor entering generated codes.To ensure that AutoFill knowsexactly where to fill user names, passwords,and verification codes,annotate those text fields with content types.You can do this in SwiftUIwith the textContentType view modifier,in UIKit with the textContentType propertyon UITextFields,in AppKit apps with the contentType propertyon NSTextFields,and on the web, you can set the auto-complete attributeto "one-time-code" on input elements.So now, I wanna take a step back.Let's look at the big picture of authenticationand talk a little abouthow to make your existing infrastructure more secure.

Authentication mechanisms exist on a spectrum,increasing in strength and security as you move along.Passwords are the traditional baselinefor the industry,and there are a number of waysthat services reinforce password-based log-in flows.Two of the most common are Passwords + Codesdelivered over SMSand Passwords + Codes generated with TOTP.

An additional decision services makeis whether to use a federated sign-in providerthat delegates the entire process of authenticationto another service.Federated authentication options are basedon all the same mechanisms as traditional methodsbut require people to keep track of fewer passwords.When implemented on robust, secure infrastructure--as is the case with Sign in with Apple--they can also be more securethan those traditional mechanisms.

A step beyond any of theseis to get rid of passwords altogether.The WebAuthentication standard, or "WebAuthn,"does exactly this.Instead,it uses public key cryptography to keep accounts safe.iOS 15 and macOS Monterey contain a previewof this technologythat offers a usable replacement for passwords.My teammate Garrett has a video about itthat you should definitely check out.

As our whole industry continues to workon building that future without passwords,there is still real valuein taking steps to improve the securityof the infrastructure you already haveand may continue to have for a while.Anything you can do to keep people safer online is good.

One step you can take concerns verification codesdelivered over SMS.As you're evaluating adopting time-based verification codes,you might still need to send codes with SMS.

In iOS 14 and macOS Big Sur,we introduced a simple mechanismfor making your SMS codes more resistant to phishingby adding domain bindings to your messages.A domain binding is a way of communicating with AutoFillthat the code in this message is meant for a particular domain.When the code is bound in this way,AutoFill will only offer the codeif the domain it's bound tomatches the domain of the web pageor one of your app's associated domains.In apps, this works on the same mechanismsas associated domains and universal links.So if you've already configured your appsfor those technologies,you're all set to add domain bindings.

You can learn more about this in an article we publishedabout enhancing the security of SMS codes with domain bindings.

Now that you know all about verification codes,go and do these two important things.First,adopt time-based verification codesin your apps and websites.Add support to your back ends,and encourage your customers to use theminstead of getting codes over SMS.Second,if you are continuing to support SMS verification codes,add domain bindings to your messages.

Thank you for watching.[music]

## Code Samples

