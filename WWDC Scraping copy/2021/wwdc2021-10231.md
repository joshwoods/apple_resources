# Wwdc2021 10231

## Transcript

More Videos

Streaming is available in most browsers,and in the Developer app.

About

Transcript

Code

Donate intents and expand your app’s presenceDiscover how you can make key parts of your app available for someone at exactly the right moment — without them ever needing to open it. Learn how to craft and donate intents to the system, helping you surface relevant and contextual information about your app in Siri, Focus, Shortcuts, the Smart Stack, and more. We'll explore how the system intelligently identifies information and show you techniques for structuring intents to help increase engagement and visibility for your app.ResourcesDonating ShortcutsHD VideoSD VideoRelated VideosWWDC21Add intelligence to your widgetsDesign great actions for Shortcuts, Siri, and SuggestionsSend communication and Time Sensitive notificationsWWDC20Add configuration and intelligence to your widgetsWWDC18Introduction to Siri Shortcuts

Discover how you can make key parts of your app available for someone at exactly the right moment — without them ever needing to open it. Learn how to craft and donate intents to the system, helping you surface relevant and contextual information about your app in Siri, Focus, Shortcuts, the Smart Stack, and more. We'll explore how the system intelligently identifies information and show you techniques for structuring intents to help increase engagement and visibility for your app.

Donating Shortcuts

HD VideoSD Video

HD Video

SD Video

Add intelligence to your widgets

Design great actions for Shortcuts, Siri, and Suggestions

Send communication and Time Sensitive notifications

Add configuration and intelligence to your widgets

Introduction to Siri Shortcuts

Search this video…♪ Bass music playing ♪♪Ryan Chapman: Hello and welcome to WWDC.Hi, I'm Ryan Chapman,and I work on the Proactive Intelligence team.Today I'll be talking to you about how you can expandyour app's presence with intent donations.Our device's operating systems have becomeincreasingly integrated with the apps people use day to day.This collaboration between the system and appsis at the heart of an intelligent system experiencethat gives our users superpowers.One of the primary ways your apps can participatein this collaboration and expand your app's presenceand capabilities throughout the systemis by donating intents.In this session, I'll define what intent donations are,walk you through the life of an intent donation,and then talk to you about how you canstructure your donations for successand ultimately expand your app's presence across the system.Let's go ahead and start out with understandingwhat intent donations are.Three years ago in iOS 12, we introduced Shortcuts.Shortcuts let you expose the capabilities of your appas actions.They enable people to use your app's featuresin new ways and places across the operating system.It's a really powerful way to engage your usersand expand your presence beyond the confines of your app.Every action that you expose should be accelerative,by performing a key function of your app.That means it should take somethingthat the user already wanted to do with your appand help them do it even faster.And next, every action that you exposeshould be repeatable and of persistent interest to the user.That means it should be somethingthat the user might want to do multiple times.It's not a good idea to expose an actionfor something that someone might only want to doonce or twice.And you should also only expose actionsthat are stateless and executable at any time,because you can't rely on someonebeing in a particular statebefore your action will be ready for use.To learn more about what makes a great action,be sure to check out the session called,"Design great actions for Shortcuts,Siri, and Suggestions" from WWDC 2021.So once you've decided what actions to expose,you're ready to check out the Shortcuts APIs.There are two APIS that you can useto adopt shortcuts for your app.The first is NSUserActivity.NSUserActivity is a lightweight wayto represent the state of your app,and it integrates with other Apple featureslike Spotlight and Handoff.And the second is intents.Intents are a way of representing, in detail,a type of action that your app can perform,and Siri includes a bunch of great built-in intentsthat support a range of capabilitiesthat you can use to integrate with the system.Intents also supports the ability for you to defineyour own custom intents for use with Shortcuts.To learn more about both APIsand how to adopt shortcuts for your app,be sure to watch the "Introduction to Siri Shortcuts"session at WWDC 2018.For this session, I'll be focusing on Intents,going over new and existing opportunities for youto offer your app's capabilities throughout the system.The first step toward making an intent donationis to decide what type of intent you'd like to adopt.Siri includes many great built-in intents,like for messaging, reservations, media, and more.There is also the ability to define custom intentsin Xcode for Shortcuts.So if the action that you want to build correspondsto one of the default built-in SiriKit intents,then you should adopt that.But, otherwise, you can define your ownusing an intent definition file in Xcode.Once you've decided which intent you'd like to adoptand defined it in your app,you can start making intent donations.An intent donation is the act of telling the systemwhen a person performs an action in your app.The system will store these donationsand use them to expand your app's capabilitiesand presence throughout the system.Apps that donate intents show up in placesthroughout the system like Suggestions, Shortcuts,Focus, Smart Stack, and Siri.Now that you understand at a high levelwhat an intent donation is, let's make this more concreteby going through the life of an intent donationusing an example.Let's use the example of checking the weatherin the Weather app.For this app, checking the weather at a particular locationis the key capability of the appthat I'd like to expose an action for.This app already has an existing widgetthat I'd like to make configurable using my intent,so someone can select the citythey'd like to see the weather for in the widget.Let's go ahead and learn how to define a check weather intent,how to donate it to the system,and how the system uses the donation.The first step to defining an intent in Xcodeis to create an intent definition file.To do this, I'll add a new file......and select the SiriKit Intent Definition File.Then I'll select any targetsthat I want to use the custom intent in,and confirm that I'd like to createthe intent definition file.Once the intent definition file is created,I can define the intent.There wasn't an existing built-in system intentto check the weather,so I can go ahead and add a new intent.I'll call the intent "Check Weather."From here, I can begin defining the intent.I'll start by checkingthe "Intent is eligible for widgets" optionbecause I'd like to allow this intentto work as a configuration for my app's existing widget.The system will also be able to use my intent donationsto power Smart Stack widget intelligence.If you want your intent to also support the Shortcuts app,check the "Intent is user-configurablein the Shortcuts app and Add to Siri" option.I'll uncheck this option for this demoand just focus on widgets and Suggestions.I'll also leave the"Intent is eligible for Siri Suggestions" option checkedbecause I'd like the system to use my donationsto surface Siri Suggestions for my intent.Next I need to define the parameters of my intent.I can define just one parameterfor the location to check the weather in.Next I need to select the parameter's type.This location represents an object in my appcorresponding to the city the app has the weather for,so I'm going to use a custom typeto represent this parameter.I can go ahead and create a custom type for a citythat has an identifier and displayString.Let's go back to our location parameter.You can see that the type of the locationis the new custom City type.I'll keep the option for allowing usersto edit the value in widgets, because I'd like this intentto be used for widget configuration.Since this intent won't support running in Siri for this demo,I'll uncheck the "Siri can ask for value when run" option.When people configure the widget,the list of weather locationswill need to be provided by the app and will changedepending on which cities that person has savedso I will check the "Options are provided dynamically" checkbox.Finally, I just need to definethe supported parameter combinations for Suggestions.The system reads the intent definition fileto determine the intent and parameter combinationsthat an app supports for prediction.In this case, the app supports an intentwith a location parameter set.I'll go ahead and add that parameteras a supported combination.Then I'll define the summary that is shown in Suggestions.And that's it.I've defined the custom intent to check the weatherthat can be used by widgets and Suggestions.With the intent defined, I just need to donate the intentto the system whenever someone checks the weatherfor a specific location in the app.To donate the intent, I create an instanceof the intent class and set its parameter values.After creating the intent, I create an instanceof an INInteraction object, passing in the intent,then call the interaction object's donate methodto donate the intent to the system.Behind the scenes, the system stores these donations over timealong with the context the person was inwhen the intent was donated.As they continue to check the weather in the Weather app,the app continues to make intent donations.In this case, they have been checking the weatherin Cupertino and in San Diego.The system uses the intent parameters to determinewhether the intents are equivalent or not.As shown by the color of the donations,the two Cupertino donations are equivalentand are different from the two San Diego donations.In practice, the system also receives donationsfrom many other apps on the person's device.If at any time you'd like to delete donations,you can delete a single donation or a group of donationsusing our deletion APIs.If someone has, for example,removed the San Diego weather locationfrom their stored weather locations,then you can delete intentsassociated with the San Diego location.It's important to delete donationsso people don't get suggestions for actions in your appthat are no longer relevant.When donating the intent,the INInteraction identifier and group identifiercan be used to later delete one or more INInteractionsthat you've donated.You can either pass in an array of identifiersto delete individual interactions,or you can pass in the group identifierto delete a group of interactions.So how are all of these intent donations used by the system?Let's take a high level view of the donation historythe system sees across multiple days.Here you can see three days of donations for a personand the donations that occurred throughout the day,starting with when they woke up.The system uses machine learning and on-device intelligenceto find patterns in the dataand predict what intent is relevantgiven a person's current context and past behavioral patterns.In this case, you can see that this person has a patternassociated with checking the weather after they wake up.The on-device intelligence integrates withuser-facing features to expose your app's capabilitiesand presence to the user.Let's look at some examples of where this exposure takes place.Before we do that, it's worth notingthat all of the machine learning and intelligenceis performed on-device in a privacy-preserving manner,meaning Apple does not collect any datathat can be used to personally identify a user.With that said, let's return to our weather example.I can use the intent I definedto make the app's existing widget configurable.After configuring the widget to use the intent,people will be able to select the locationthey'd like to see the weather for in the widget.With the app donating intentsthat match the widget's configuration intent,the system is now able to provide peoplewith Smart Stack widget intelligence for the app.Let's say there is a person who has a Home screen configurationwith a Smart Stack.New in iOS 15, the Smart Stack supports Widget Suggestions,which allow the system to suggest widgetsthe user doesn't have in their stackby placing them on top of the stack at just the right time.To determine whether a widget should be suggestedand the correct time to make the suggestion,the system leverages the intent donationsthat match your widget configuration intent.In the weather example, after the person woke up,the Smart Stack placed the Weather widgeton the top of the stack at just the right time.This is a great way for people to discover your widgetand to deliver glanceable information.If they already had the Weather widget in their stack,then it would have rotated to the Weather widget instead.To learn more about how to add configurationand intelligence to your widgets,watch the WWDC session from 2020.Your intent donations also power the on-device intelligencebehind Siri Suggestions that are shown in Lock screen,in Spotlight search,and in the Siri Suggestions widget.These suggestions allow peopleto perform the key capabilities of your app with one tap.Your intents can also be used in the built-in Shortcuts appas a part of a simple or complex multi-step shortcutacross macOS, iOS, and watchOS.And donations are also used to determine what actionsget suggested to people in the Shortcuts App Gallery.People can also set up a voice shortcutto execute your custom intents just by asking Siri.If you chose to use the built-in INSendMessageIntent,your intent donations are used by sharing suggestionsto make it really easy for usersto get content to the people and groups that matter most to them.New in iOS 15, when you donate INSendMessageIntents,the system uses the people in your donationsto determine who is strongly associatedwith the user's current Focus.These strong associations can be used to make suggestionsto add certain people to their allowed notifications listwhen they receive messages from them.In this case, you can see that Aga is suggestedas a person who this user should consider addingto their allowed notifications list for Work Focusbased on that person's past interactions with Aga.If you choose to use the built-inINGetReservationDetailsIntent,your intent donations will be used to notify userswhen it's time to leave for their restaurant reservationbased on current traffic conditionsand when it's time to check in for their flight.People will also see Siri Suggestionswhen they open Maps, which makes it super convenientto get directions to the airport with just one tap.New in iOS 15, if you choose to use the built-inINPlayMediaIntent, your intent donationswill be shown in the new Now Playing UI in Lock screen,Control Center, and in the Home app.This is a fantastic way for users to start listening toor watching their favorite content from your app.People may consume periodical media content like podcasts,TV shows, or movies in your app.In these cases, you can use the INUpcomingMediaManager APIto provide the system a list of media intentsfor content that the user hasn't listened to or watched,so might be interested in.The system combines the past media donationswith your app's upcoming mediato make better media suggestions.Your intents can also be surfaced on the Siri Watch Faceusing the INRelevantShortcut API.The INRelevantShortcut API enables you to exposerelevance information to the systemsuch as a time or a locationfor when your shortcut should be shown on the watch face.To learn more about how to expose your shortcutson the Siri Watch Face,watch the "Siri Shortcuts on the Siri Watch Face"WWDC session from 2018.New in iOS 15, the widgetKind propertywas added to the INRelevantShortcut objectso you can hint to the system when to showthe corresponding widget in a Smart Stack.To learn more about this property and how to use it,watch the "Add intelligence to your widgets" sessionfrom WWDC 2021.To summarize, we've taken a lookat the life of intent donations and seen how they are usedto expand your app's presence and capabilitiesthroughout the systemto an increasing number of places like the Smart Stack,Focus, Suggestions, Shortcuts, and Siri.Now that we've looked at the life of an intent donation,let's talk in more detail abouthow you can structure your donations for successand ultimately expand your app's presence across the system.Let's use a new example of ordering coffee in a coffee app.So far I've defined an order coffee intentand exposed two parameters:the size of the coffee and the coffee item.In this case, we have a large iced latte.Let's take a look at what could go wrongif I include the order date in my intent donation.It starts off OK, with a donation coming infor a large iced latte on June 7, 2021.But once the date changes,the intent's date parameter has a new value,and the system treats the second donationas a completely different intent,despite both donations having the same item and size.The system continues to treat the donationsdifferently over time and you can seethat they're not equivalent across the days,based on the donation's colors.If you look at a high-level view of the donation historythe system sees across multiple days,you can see that there's no meaningful patternthe system can find for ordering a large iced latte.Let's take a look at how I filled outthe intent definition file to understand what went wrong.I defined the three parameters for item, size, and date.And I added a supported parameter combinationwith all three parameters.This tells the system that it should use all three parametersto determine how to find patternsacross intent donations for prediction.In this case, including the date in the supported combinationwith the item and sizeprevented the system from properly finding a patternacross the donations.To resolve this issue,I can instead define a supported combination that includesonly the size and item parameters.By doing this, the system knows that it should only usethe item and size parameters when comparing intent donationsto find patterns over time.Now, the system will see a donation for a large iced latte,not including the date anymore.Then on the second day,the system sees an equivalent donationfor a large iced latte.And same on the third day.If you look at a high-level view of the donation history again,you can see that there is now a patternassociated with ordering a large iced lattejust after waking up.To maximize the benefit of your donations,please ensure your intent donationsare likely to be repeatedand the intent payload you're donatingis consistent across donations.That means don't include timestamps.In summary, the system has become increasingly integratedwith the apps we use day to dayand intent donations are a key integration point.Benefit from donating intents by expanding your app'scapabilities and presence across the system.Thank you for listeningand I hope you have a great rest of your WWDC 2021.♪

♪ Bass music playing ♪♪Ryan Chapman: Hello and welcome to WWDC.Hi, I'm Ryan Chapman,and I work on the Proactive Intelligence team.Today I'll be talking to you about how you can expandyour app's presence with intent donations.Our device's operating systems have becomeincreasingly integrated with the apps people use day to day.This collaboration between the system and appsis at the heart of an intelligent system experiencethat gives our users superpowers.One of the primary ways your apps can participatein this collaboration and expand your app's presenceand capabilities throughout the systemis by donating intents.In this session, I'll define what intent donations are,walk you through the life of an intent donation,and then talk to you about how you canstructure your donations for successand ultimately expand your app's presence across the system.Let's go ahead and start out with understandingwhat intent donations are.Three years ago in iOS 12, we introduced Shortcuts.Shortcuts let you expose the capabilities of your appas actions.They enable people to use your app's featuresin new ways and places across the operating system.It's a really powerful way to engage your usersand expand your presence beyond the confines of your app.Every action that you expose should be accelerative,by performing a key function of your app.That means it should take somethingthat the user already wanted to do with your appand help them do it even faster.And next, every action that you exposeshould be repeatable and of persistent interest to the user.That means it should be somethingthat the user might want to do multiple times.It's not a good idea to expose an actionfor something that someone might only want to doonce or twice.And you should also only expose actionsthat are stateless and executable at any time,because you can't rely on someonebeing in a particular statebefore your action will be ready for use.To learn more about what makes a great action,be sure to check out the session called,"Design great actions for Shortcuts,Siri, and Suggestions" from WWDC 2021.So once you've decided what actions to expose,you're ready to check out the Shortcuts APIs.There are two APIS that you can useto adopt shortcuts for your app.The first is NSUserActivity.NSUserActivity is a lightweight wayto represent the state of your app,and it integrates with other Apple featureslike Spotlight and Handoff.And the second is intents.Intents are a way of representing, in detail,a type of action that your app can perform,and Siri includes a bunch of great built-in intentsthat support a range of capabilitiesthat you can use to integrate with the system.Intents also supports the ability for you to defineyour own custom intents for use with Shortcuts.To learn more about both APIsand how to adopt shortcuts for your app,be sure to watch the "Introduction to Siri Shortcuts"session at WWDC 2018.For this session, I'll be focusing on Intents,going over new and existing opportunities for youto offer your app's capabilities throughout the system.The first step toward making an intent donationis to decide what type of intent you'd like to adopt.Siri includes many great built-in intents,like for messaging, reservations, media, and more.There is also the ability to define custom intentsin Xcode for Shortcuts.So if the action that you want to build correspondsto one of the default built-in SiriKit intents,then you should adopt that.But, otherwise, you can define your ownusing an intent definition file in Xcode.Once you've decided which intent you'd like to adoptand defined it in your app,you can start making intent donations.An intent donation is the act of telling the systemwhen a person performs an action in your app.The system will store these donationsand use them to expand your app's capabilitiesand presence throughout the system.Apps that donate intents show up in placesthroughout the system like Suggestions, Shortcuts,Focus, Smart Stack, and Siri.Now that you understand at a high levelwhat an intent donation is, let's make this more concreteby going through the life of an intent donationusing an example.Let's use the example of checking the weatherin the Weather app.For this app, checking the weather at a particular locationis the key capability of the appthat I'd like to expose an action for.This app already has an existing widgetthat I'd like to make configurable using my intent,so someone can select the citythey'd like to see the weather for in the widget.Let's go ahead and learn how to define a check weather intent,how to donate it to the system,and how the system uses the donation.The first step to defining an intent in Xcodeis to create an intent definition file.To do this, I'll add a new file...

...and select the SiriKit Intent Definition File.Then I'll select any targetsthat I want to use the custom intent in,and confirm that I'd like to createthe intent definition file.Once the intent definition file is created,I can define the intent.There wasn't an existing built-in system intentto check the weather,so I can go ahead and add a new intent.I'll call the intent "Check Weather."From here, I can begin defining the intent.I'll start by checkingthe "Intent is eligible for widgets" optionbecause I'd like to allow this intentto work as a configuration for my app's existing widget.The system will also be able to use my intent donationsto power Smart Stack widget intelligence.If you want your intent to also support the Shortcuts app,check the "Intent is user-configurablein the Shortcuts app and Add to Siri" option.I'll uncheck this option for this demoand just focus on widgets and Suggestions.I'll also leave the"Intent is eligible for Siri Suggestions" option checkedbecause I'd like the system to use my donationsto surface Siri Suggestions for my intent.Next I need to define the parameters of my intent.I can define just one parameterfor the location to check the weather in.Next I need to select the parameter's type.This location represents an object in my appcorresponding to the city the app has the weather for,so I'm going to use a custom typeto represent this parameter.I can go ahead and create a custom type for a citythat has an identifier and displayString.

Let's go back to our location parameter.You can see that the type of the locationis the new custom City type.I'll keep the option for allowing usersto edit the value in widgets, because I'd like this intentto be used for widget configuration.Since this intent won't support running in Siri for this demo,I'll uncheck the "Siri can ask for value when run" option.When people configure the widget,the list of weather locationswill need to be provided by the app and will changedepending on which cities that person has savedso I will check the "Options are provided dynamically" checkbox.Finally, I just need to definethe supported parameter combinations for Suggestions.The system reads the intent definition fileto determine the intent and parameter combinationsthat an app supports for prediction.In this case, the app supports an intentwith a location parameter set.I'll go ahead and add that parameteras a supported combination.Then I'll define the summary that is shown in Suggestions.And that's it.I've defined the custom intent to check the weatherthat can be used by widgets and Suggestions.With the intent defined, I just need to donate the intentto the system whenever someone checks the weatherfor a specific location in the app.To donate the intent, I create an instanceof the intent class and set its parameter values.After creating the intent, I create an instanceof an INInteraction object, passing in the intent,then call the interaction object's donate methodto donate the intent to the system.Behind the scenes, the system stores these donations over timealong with the context the person was inwhen the intent was donated.As they continue to check the weather in the Weather app,the app continues to make intent donations.In this case, they have been checking the weatherin Cupertino and in San Diego.The system uses the intent parameters to determinewhether the intents are equivalent or not.As shown by the color of the donations,the two Cupertino donations are equivalentand are different from the two San Diego donations.In practice, the system also receives donationsfrom many other apps on the person's device.If at any time you'd like to delete donations,you can delete a single donation or a group of donationsusing our deletion APIs.If someone has, for example,removed the San Diego weather locationfrom their stored weather locations,then you can delete intentsassociated with the San Diego location.It's important to delete donationsso people don't get suggestions for actions in your appthat are no longer relevant.When donating the intent,the INInteraction identifier and group identifiercan be used to later delete one or more INInteractionsthat you've donated.You can either pass in an array of identifiersto delete individual interactions,or you can pass in the group identifierto delete a group of interactions.So how are all of these intent donations used by the system?Let's take a high level view of the donation historythe system sees across multiple days.Here you can see three days of donations for a personand the donations that occurred throughout the day,starting with when they woke up.The system uses machine learning and on-device intelligenceto find patterns in the dataand predict what intent is relevantgiven a person's current context and past behavioral patterns.In this case, you can see that this person has a patternassociated with checking the weather after they wake up.The on-device intelligence integrates withuser-facing features to expose your app's capabilitiesand presence to the user.Let's look at some examples of where this exposure takes place.Before we do that, it's worth notingthat all of the machine learning and intelligenceis performed on-device in a privacy-preserving manner,meaning Apple does not collect any datathat can be used to personally identify a user.With that said, let's return to our weather example.I can use the intent I definedto make the app's existing widget configurable.After configuring the widget to use the intent,people will be able to select the locationthey'd like to see the weather for in the widget.With the app donating intentsthat match the widget's configuration intent,the system is now able to provide peoplewith Smart Stack widget intelligence for the app.Let's say there is a person who has a Home screen configurationwith a Smart Stack.New in iOS 15, the Smart Stack supports Widget Suggestions,which allow the system to suggest widgetsthe user doesn't have in their stackby placing them on top of the stack at just the right time.To determine whether a widget should be suggestedand the correct time to make the suggestion,the system leverages the intent donationsthat match your widget configuration intent.In the weather example, after the person woke up,the Smart Stack placed the Weather widgeton the top of the stack at just the right time.This is a great way for people to discover your widgetand to deliver glanceable information.If they already had the Weather widget in their stack,then it would have rotated to the Weather widget instead.To learn more about how to add configurationand intelligence to your widgets,watch the WWDC session from 2020.Your intent donations also power the on-device intelligencebehind Siri Suggestions that are shown in Lock screen,in Spotlight search,and in the Siri Suggestions widget.These suggestions allow peopleto perform the key capabilities of your app with one tap.Your intents can also be used in the built-in Shortcuts appas a part of a simple or complex multi-step shortcutacross macOS, iOS, and watchOS.And donations are also used to determine what actionsget suggested to people in the Shortcuts App Gallery.People can also set up a voice shortcutto execute your custom intents just by asking Siri.If you chose to use the built-in INSendMessageIntent,your intent donations are used by sharing suggestionsto make it really easy for usersto get content to the people and groups that matter most to them.New in iOS 15, when you donate INSendMessageIntents,the system uses the people in your donationsto determine who is strongly associatedwith the user's current Focus.These strong associations can be used to make suggestionsto add certain people to their allowed notifications listwhen they receive messages from them.In this case, you can see that Aga is suggestedas a person who this user should consider addingto their allowed notifications list for Work Focusbased on that person's past interactions with Aga.If you choose to use the built-inINGetReservationDetailsIntent,your intent donations will be used to notify userswhen it's time to leave for their restaurant reservationbased on current traffic conditionsand when it's time to check in for their flight.People will also see Siri Suggestionswhen they open Maps, which makes it super convenientto get directions to the airport with just one tap.New in iOS 15, if you choose to use the built-inINPlayMediaIntent, your intent donationswill be shown in the new Now Playing UI in Lock screen,Control Center, and in the Home app.This is a fantastic way for users to start listening toor watching their favorite content from your app.People may consume periodical media content like podcasts,TV shows, or movies in your app.In these cases, you can use the INUpcomingMediaManager APIto provide the system a list of media intentsfor content that the user hasn't listened to or watched,so might be interested in.The system combines the past media donationswith your app's upcoming mediato make better media suggestions.Your intents can also be surfaced on the Siri Watch Faceusing the INRelevantShortcut API.The INRelevantShortcut API enables you to exposerelevance information to the systemsuch as a time or a locationfor when your shortcut should be shown on the watch face.To learn more about how to expose your shortcutson the Siri Watch Face,watch the "Siri Shortcuts on the Siri Watch Face"WWDC session from 2018.New in iOS 15, the widgetKind propertywas added to the INRelevantShortcut objectso you can hint to the system when to showthe corresponding widget in a Smart Stack.To learn more about this property and how to use it,watch the "Add intelligence to your widgets" sessionfrom WWDC 2021.To summarize, we've taken a lookat the life of intent donations and seen how they are usedto expand your app's presence and capabilitiesthroughout the systemto an increasing number of places like the Smart Stack,Focus, Suggestions, Shortcuts, and Siri.Now that we've looked at the life of an intent donation,let's talk in more detail abouthow you can structure your donations for successand ultimately expand your app's presence across the system.Let's use a new example of ordering coffee in a coffee app.So far I've defined an order coffee intentand exposed two parameters:the size of the coffee and the coffee item.In this case, we have a large iced latte.Let's take a look at what could go wrongif I include the order date in my intent donation.It starts off OK, with a donation coming infor a large iced latte on June 7, 2021.But once the date changes,the intent's date parameter has a new value,and the system treats the second donationas a completely different intent,despite both donations having the same item and size.The system continues to treat the donationsdifferently over time and you can seethat they're not equivalent across the days,based on the donation's colors.If you look at a high-level view of the donation historythe system sees across multiple days,you can see that there's no meaningful patternthe system can find for ordering a large iced latte.Let's take a look at how I filled outthe intent definition file to understand what went wrong.I defined the three parameters for item, size, and date.And I added a supported parameter combinationwith all three parameters.This tells the system that it should use all three parametersto determine how to find patternsacross intent donations for prediction.In this case, including the date in the supported combinationwith the item and sizeprevented the system from properly finding a patternacross the donations.To resolve this issue,I can instead define a supported combination that includesonly the size and item parameters.By doing this, the system knows that it should only usethe item and size parameters when comparing intent donationsto find patterns over time.Now, the system will see a donation for a large iced latte,not including the date anymore.Then on the second day,the system sees an equivalent donationfor a large iced latte.And same on the third day.If you look at a high-level view of the donation history again,you can see that there is now a patternassociated with ordering a large iced lattejust after waking up.To maximize the benefit of your donations,please ensure your intent donationsare likely to be repeatedand the intent payload you're donatingis consistent across donations.That means don't include timestamps.In summary, the system has become increasingly integratedwith the apps we use day to dayand intent donations are a key integration point.Benefit from donating intents by expanding your app'scapabilities and presence across the system.Thank you for listeningand I hope you have a great rest of your WWDC 2021.♪

0:01 -Intent donation example

0:02 -Intent deletion example

0:03 -Intent donation example 2

## Code Samples

```swift
// Donate your intent.



let
 intent 
=
 
CheckWeatherIntent
()
intent.location 
=
 weatherLocation


let
 interaction 
=
 
INInteraction
(intent: intent, response: 
nil
)
interaction.donate { (error) 
in

    
// Handle the error.

}
```

```swift
// Donate your intent.


let
 interaction 
=
 
INInteraction
(intent: intent, response: response)
interaction.identifier 
=
 
"68753A44-4D6F-1226-9C60-0050E4C00067"

interaction.groupIdentifier 
=
 
"san-diego"

interaction.donate { (error) 
in

    
// Handle the error.

}


// Delete individual donations.


INInteraction
.delete(with: [
"68753A44-4D6F-1226-9C60-0050E4C00067"
]) { (error) 
in

    
// Handle the error.

}


// Delete group donations.


INInteraction
.delete(with: 
"san-diego"
) { (error) 
in

    
// Handle the error.

}
```

```swift
// Donate your intent.



let
 intent 
=
 
OrderCoffeeIntent
()
intent.item 
=
 item
intent.size 
=
 size
intent.date 
=
 date


let
 interaction 
=
 
INInteraction
(intent: intent, response: 
nil
)
interaction.donate { (error) 
in

    
// Handle the error.

}
```

