# Wwdc2021 10123

## Transcript

More Videos

Streaming is available in most browsers,and in the Developer app.

About

Transcript

Meet the Screen Time APIExplore the Screen Time API and learn how you can build apps that support customized parental controls — all while putting privacy first. Learn how you can use key features like core restrictions and device activity monitoring to create safe, secure experiences in your app while providing measurable control for parents and guardians.ResourcesDeviceActivityFamilyControlsManage Settings on Devices in a Family Sharing GroupManagedSettingsHD VideoSD VideoRelated VideosWWDC21Get ready for iCloud Private RelayTuesday@WWDC21

Explore the Screen Time API and learn how you can build apps that support customized parental controls — all while putting privacy first. Learn how you can use key features like core restrictions and device activity monitoring to create safe, secure experiences in your app while providing measurable control for parents and guardians.

DeviceActivity

FamilyControls

Manage Settings on Devices in a Family Sharing Group

ManagedSettings

HD VideoSD Video

HD Video

SD Video

Get ready for iCloud Private Relay

Tuesday@WWDC21

Search this video…Welcome to WWDC.I'm Christopher Skogen,an engineer on the Screen Time team,and I'm here to talk to you about the new Screen Time API.It's been three yearssince Apple introduced Screen Time for iOS.And it has been a giant step forwardfor improving our customers' and families' relationshipswith their devices.Over the last three years,Screen Time brought some great new abilitiesto iPhone, iPad, and Mac.Screen Time helps you keep track of how often youand your family use apps and websites,manage time by setting limits, share usage with family membersto provide a view of how your devices are being used,and finally, you can also managewho your children communicate with and more.We've also heard from many of you that you'd liketo leverage some of these capabilitiesin your own parental controls apps.So we've created the Screen Time API.It brings the core Screen Time functionality to your appsso you can create dynamic new experiences for your customers.First off, the API will be available on iOS and iPadOS 15.It is 100% Swift and SwiftUI codefor easy integration into your modern Swift applications.The Screen Time API was designed and builtwith three guiding principles.First, provide a modern, on-device frameworkfor direct API access to existing restrictions.Our second guiding principle was to protect user privacy.Since Screen Time handlessome very sensitive personal informationsuch as apps you've used or web sites you've visited,Screen Time has always taken a very privacy-centric approach.For instance, there is no way for anyoneoutside of your family or even Appleto know which sites you've visited or what apps you use.For the new API, we continued this approachto privacy, and your customers' usage datawill be invisible outside of their device.And finally, our third guiding principle wasto ensure that you, the developers,can create fantastic new dynamic parental controls experiences.It's no coincidence that our three guiding principlesled us to create three new frameworks.The three frameworks, taken together,comprise the Screen Time API.First, Managed Settings.Managed Settings gives your app direct accessto the same restrictions available in Screen Time.Second, Family Controls.Family Controls drives our privacy policy.And finally, Device Activity.Device Activity allows you to go beyond Screen Timeby giving your app great new abilitiesto run code without launching your app.Let's take a closer look at all three frameworks.Let's start with Managed Settings.Your app needs a better way to restrict what a child can dowith their devices and ensurethat those restrictions remain in placeuntil the parent or guardian says otherwise.With Managed Settings, your app can set a numberof restrictions, like locking accounts in place,or preventing a password change, filter web traffic,or shield applications, much like Screen Time does,but customized with your app's branding and functionality.Next is Family Controls.By leveraging Family Sharing, Family Controls prevents accessto the Screen Time API without guardian approval.Once your app has been approved by the guardian,it cannot be removed from the devicewithout guardian approval.Additionally, Family Controls provides opaque tokensthat represent apps and websites.These tokens are used throughout the Screen Time APIto monitor or restrict usage and ensure that no oneoutside of a single Family Sharing groupwill know what apps and websites are being used.And finally, Device Activity.This framework allows you to go beyond Screen Timeby giving your app new ways to monitor web and app usageand execute your code when needed.Because your app is a parental control app,it is very unlikely that a child will have a reasonto run your app on their device.So how do you execute your code to set restrictions?The answer is Device Activity schedules and events.Device Activity schedules are time windowsthat call an extension in your applicationat the start and end of the time window.Events are usage monitors that call your extensionwhen the user on the device reaches a usage thresholdin a Device Activity schedule.Your app simply declares what type of usageit cares about and when it cares.Combining all three frameworks together looks like this.After your app is installedon both the guardian's and the child's devices,the guardian opens the app on the child's device.Your app authorizes with Family Controls.Later, your app on the guardian's devicechooses settings, restrictions, and rules.Your app sends that information to the child's device.And then on the child's device,your app creates Schedules and Events with Device Activity.The Device Activity extension in your app gets calledwhen the schedule occurs or the events happen.From the extension,set restrictions with Managed Settings.This is a good time to introduce Nolan.Nolan is working on a great new demo app, Homework,and he'll walk you through how Homeworkuses the Screen Time API.Hi, I'm Nolan,an engineer on the Screen Time team.I'd like to introduce you to my demo app, Homework.Homework encourages good habitsby restricting a child's access to certain appsuntil they accumulate usagein other apps the guardian wants them to use.To make Homework functional,I'm gonna use all three frameworksin the Screen Time API.First, I'll walk you through requesting authorizationfor Family Controls.Next up, I'll shield the discouraged appsselected by the guardian on a reoccurring schedule.Then I'll show you how to remove those shieldsafter accumulating enough encouraged app usage.Finally, I'll customize the shields used by Homeworkto fit the app's branding and functionality.I'll start with the project setupand authorizing Family Controls.In order to set up my Xcode projectto include Family Controls capability,I'll go to the Project editor, select the app target,and under Signing and Capabilities,click the plus button.I'll search for Family Controls to find the capabilityand add it to my project.Now that the capability has been added, I'm ready to code.The first thing Homework needs to do is request authorizationfor Family Controls.I'll use the shared authorization centerin the Family Controls framework to make this requestwhen my app launches.The request can either result in success or failure.Calling this function will require a guardianin the family to approve Family Controls for Homework.Since my app has never run on this iPhone before,requestAuthorization will askfor a guardian's approval with an alert.Tapping on Allow will then prompt the guardianto authenticate with their Apple IDand password to continue.Once a guardian has successfully authenticated,calling requestAuthorization will not promptwith an alert again but instead silently return success.To prevent misuse, requestAuthorizationwill return failure if the signed-in iCloud isis not a child using Family Sharing.It's just that easy to get your app readyto use the Screen Time API.Thanks, Nolan.We just saw our demo app, Homework,authorizing with Family Controls.Authorizing with Family Controls alsogrants other magic powers to your app.For instance, once the device is authorized,the user can no longer sign out of iCloud.Also, on-device web content filtersbuilt with the Network Extensions frameworkcan be included in your app and will be installed automaticallyand cannot be removed.This gives your app the ability to filter web trafficon the device.One of the challenges in writing a parental controls appis getting your code to run on the child's devicewhen the child will likely never run your app.For the Screen Time API,we created a new way to perform background code executionwith Device Activity.A Device Activity extension will be your primary wayto interact with the rest of the Screen Time API.Let's go back to Nolan to see how Homework can run codeon a repeating schedule to restrict a child's deviceby placing a Screen Time shield over some apps.Nolan.Thanks, Chris.Next up with Homework is shielding the appsthe guardian has chosen to discourageon a reoccurring schedule.Since I cannot count on my app to be runningon the child's device,I will use a Device Activity Scheduleto set the application shield restriction every day,even when Homework hasn't runsince being setup by the guardian.When my Device Activity Schedule fires,Device Activity will call into a new extension point.Homework will include an extensionfor this extension pointwhere I will set the restriction to shield apps.Implementing an extension for this extension pointrequires you to subclass DeviceActivityMonitoras the principle class.Here, I've overridden two methodsin my extension's principle class:intervalDidStart and intervalDidEnd.These functions will be called the first time the deviceis used after the start and end of my schedule.I'm going to leave the implementationof these functions empty until I've configuredmy Device Activity schedule from Homework's main app.Now that my Device Activity monitorextension is set up from the main app,I need to create a Device Activity nameand a Device Activity schedule.The Device Activity name is how I can referencethe activity from within my extension.And the Device Activity schedule represents the time boundsin which my extension will monitor for activity.Here I've set the name of my activity to "daily,"and I've set my schedule to start and end at midnight.I will also set this schedule to repeat.Finally, I can create a Device Activity centerand call startMonitoring with the activity nameand schedule I've just defined.With these few lines of code, my Device Activity monitorextension will be called with the activity namewhenever the schedule starts and ends.Another ingredient to shielding appsis figuring out what the guardian wants to discourage.The Family Controls framework has a SwiftUI elementjust for the job: The family activity picker.From the main app's UI, I can showthe family activity picker and allow the guardianto choose from a list of apps, websites,and categories used by the family.Once the guardian has made their selection,Homework can use opaque tokens returned by the pickerto set restrictions on apps, websites,and categories each token represents.Here, I've added the familyActivityPickerview modifier to a Button in the app,and I've bound the picker's selection parameterto a property in the app's model.This will update my modelwhenever the guardian's selection is updated in the UI.Now that I have the guardian's discouraged app selection storedin my app's model, I'll jump backto the Device Activity Monitor extension.First, I'll drop in an import for the Managed Settings moduleto get access to the application shield restriction.Then in intervalDidStart, I can pull the selectionout of the app's model and configurethe application shield restriction accordingly.And in intervalDidEnd, I can remove the restrictionby setting it to nil.With these simple modifications,Homework will shield the guardian selecteddiscouraged apps every day from midnight to midnight.Back to you, Chris.Thanks, Nolan.Shielding is not the only restriction availablein Managed Settings.We could also choose to set any number of restrictionsat the beginning or end of a Device Activity Schedule.For instance, your app could chooseto prevent account creation or removal, completely block appsand websites, or deny media content by age.Speaking of media restrictions,Managed Settings also provides an API that allows any appto read the restrictions for Movies and TV content.No Family Controls authorization is required.These functions are ideal for any media appto check if a device should be limiting the contentpresented to the user.In the Homework demo app, the restrictions were setat midnight every day, but what if you wantto change restrictions based upon app or web usage?Device Activity has another feature that willallow your app to do just that: Device Activity events.These events are configured with the same tokens you sawfrom the family activity picker and allow you to execute codewhen the usage limits are reached.These events are registered alongside the schedulesthat Nolan showed us in the last segment.Now let's go check in with Nolan and see how these events work.I want to remove the application shield restrictionnot only when Homework's schedule endsbut also when the child accumulates enough usagefor a set of guardian-selected encouraged apps.To do that, I'll need to monitor the usageof these encouraged apps by configuring Device Activityto additionally call into my Device Activity monitorextension when a usage threshold is met.Here, I'll define a Device Activity event nameto be "encouraged."This name is how I can reference the eventfrom within my extension.And then I'll define my encouraged eventto include the set of guardian-selectedencouraged apps and the threshold of usage desired.Finally, I'll update the call to startMonitoringto included the event I just defined.Now that I am monitoring for Device Activity eventsfrom the main app, my Device Activity monitorextension is going to be called whenever anyof those events meet their usage threshold.The function eventDidReachThresholdwill be called with the Device Activity Event Nameand the DeviceActivityName to identify which event firedfor which scheduled activity.In Homework, I want to set the application shield restrictionto nil when the extension gets notified for this event.Setting this restriction to nil will remove the shieldfrom any of the previously shielded apps.Back to Chris.In the previous section,the discouraged apps were shieldedwith a default Screen Time shield.But you'll likely want to get your own brandingand style in these shields.You'll also probably want to haveyour own action handlers for the shield's buttons.We've got the tools for both.Custom shields allow youto create a unique branded experience.To customize the shields,you'll need to implement two new extension pointsdefined in Managed Settings.One extension point allows you to customize the lookof the shield by changing background material,titles, icon, and appearance of the buttons.And another extension pointallows you to create custom button handlers.Let's go back to Nolanand see how you would customize your shields.To configure the look and feel of the custom shieldsfor Homework, I need to startby subclassing ShieldConfigurationProvideras the principle class of the extension.Configuration is the only functionyou'll need to override here.This function is passed a reference to the applicationthat is currently being shielded,and it is expected to return a ShieldConfiguration struct.The ShieldConfiguration struct allows youto define the background effect, background color,icon, title, subtitle, primary button label,primary button background color, and secondary button label.Wow, that's a lot of customization.Once this struct is configured and returned by myshield configuration provider extension,the operating system will automatically displaythese customizations over any app shielded by Homework.Now that we've styled the shields,I can use the second extension pointin Managed Settings to configure the action handlersfor the primary and secondary buttons.In this new extension, I'll subclassShieldActionHandler as the principle classand override the function handle.The handle function is toldwhether the primary button actionor secondary button action was pressedand which application is currently being shielded.You are required to call the function's completion handlerwith a sshield action response.The response can either be to close the shielded applicationor defer action and redraw the shield configuration.The ability to defer action in the shield is very powerfulbecause it gives the shield the chance to updateits appearance while it waits for a signal on how to proceed.For instance, it can be used to indicatethat the shield is waiting for a guardian's actionwhen the child taps Ask for Access here.With the addition of these custom shields,my demo app, Homework, is complete.The guardian can choose apps to shield,such as games or entertainment, and remove the shieldonce the child has done enough positive screen time,like reading, learning, or being creative.Thanks for joining mein building this awesome new demo app.Now back to Chris.Today we learned how our three goals--to provide restrictions, protect privacy,and enable new dynamic experiences--were delivered with the three frameworksthat make up the Screen Time API.Managed Settings allows your appto enforce settings and restrictions.Device Activity allows your app to run code on a scheduleor on usage events even when your app is not being used.And finally, Family Controls, which grants accessto Managed Settings and Device Activityand protects the privacy of your users,guaranteeing that only the guardians will knowwhat the child is doing.Like all frameworks, the Screen Time API willcontinue to evolve based on feedback from you.So give these a try and let us know how they door don't support your unique use cases.Thanks for joining us today.Enjoy WWDC 2021.[music]

Welcome to WWDC.

I'm Christopher Skogen,an engineer on the Screen Time team,and I'm here to talk to you about the new Screen Time API.It's been three yearssince Apple introduced Screen Time for iOS.And it has been a giant step forwardfor improving our customers' and families' relationshipswith their devices.

Over the last three years,Screen Time brought some great new abilitiesto iPhone, iPad, and Mac.Screen Time helps you keep track of how often youand your family use apps and websites,manage time by setting limits, share usage with family membersto provide a view of how your devices are being used,and finally, you can also managewho your children communicate with and more.We've also heard from many of you that you'd liketo leverage some of these capabilitiesin your own parental controls apps.

So we've created the Screen Time API.

It brings the core Screen Time functionality to your appsso you can create dynamic new experiences for your customers.First off, the API will be available on iOS and iPadOS 15.It is 100% Swift and SwiftUI codefor easy integration into your modern Swift applications.

The Screen Time API was designed and builtwith three guiding principles.

First, provide a modern, on-device frameworkfor direct API access to existing restrictions.Our second guiding principle was to protect user privacy.Since Screen Time handlessome very sensitive personal informationsuch as apps you've used or web sites you've visited,Screen Time has always taken a very privacy-centric approach.For instance, there is no way for anyoneoutside of your family or even Appleto know which sites you've visited or what apps you use.For the new API, we continued this approachto privacy, and your customers' usage datawill be invisible outside of their device.And finally, our third guiding principle wasto ensure that you, the developers,can create fantastic new dynamic parental controls experiences.It's no coincidence that our three guiding principlesled us to create three new frameworks.The three frameworks, taken together,comprise the Screen Time API.First, Managed Settings.

Managed Settings gives your app direct accessto the same restrictions available in Screen Time.Second, Family Controls.Family Controls drives our privacy policy.

And finally, Device Activity.Device Activity allows you to go beyond Screen Timeby giving your app great new abilitiesto run code without launching your app.

Let's take a closer look at all three frameworks.Let's start with Managed Settings.Your app needs a better way to restrict what a child can dowith their devices and ensurethat those restrictions remain in placeuntil the parent or guardian says otherwise.With Managed Settings, your app can set a numberof restrictions, like locking accounts in place,or preventing a password change, filter web traffic,or shield applications, much like Screen Time does,but customized with your app's branding and functionality.Next is Family Controls.By leveraging Family Sharing, Family Controls prevents accessto the Screen Time API without guardian approval.Once your app has been approved by the guardian,it cannot be removed from the devicewithout guardian approval.Additionally, Family Controls provides opaque tokensthat represent apps and websites.

These tokens are used throughout the Screen Time APIto monitor or restrict usage and ensure that no oneoutside of a single Family Sharing groupwill know what apps and websites are being used.And finally, Device Activity.

This framework allows you to go beyond Screen Timeby giving your app new ways to monitor web and app usageand execute your code when needed.Because your app is a parental control app,it is very unlikely that a child will have a reasonto run your app on their device.So how do you execute your code to set restrictions?The answer is Device Activity schedules and events.Device Activity schedules are time windowsthat call an extension in your applicationat the start and end of the time window.Events are usage monitors that call your extensionwhen the user on the device reaches a usage thresholdin a Device Activity schedule.Your app simply declares what type of usageit cares about and when it cares.

Combining all three frameworks together looks like this.

After your app is installedon both the guardian's and the child's devices,the guardian opens the app on the child's device.Your app authorizes with Family Controls.Later, your app on the guardian's devicechooses settings, restrictions, and rules.Your app sends that information to the child's device.And then on the child's device,your app creates Schedules and Events with Device Activity.The Device Activity extension in your app gets calledwhen the schedule occurs or the events happen.

From the extension,set restrictions with Managed Settings.

This is a good time to introduce Nolan.Nolan is working on a great new demo app, Homework,and he'll walk you through how Homeworkuses the Screen Time API.Hi, I'm Nolan,an engineer on the Screen Time team.I'd like to introduce you to my demo app, Homework.Homework encourages good habitsby restricting a child's access to certain appsuntil they accumulate usagein other apps the guardian wants them to use.To make Homework functional,I'm gonna use all three frameworksin the Screen Time API.

First, I'll walk you through requesting authorizationfor Family Controls.Next up, I'll shield the discouraged appsselected by the guardian on a reoccurring schedule.Then I'll show you how to remove those shieldsafter accumulating enough encouraged app usage.Finally, I'll customize the shields used by Homeworkto fit the app's branding and functionality.I'll start with the project setupand authorizing Family Controls.

In order to set up my Xcode projectto include Family Controls capability,I'll go to the Project editor, select the app target,and under Signing and Capabilities,click the plus button.I'll search for Family Controls to find the capabilityand add it to my project.

Now that the capability has been added, I'm ready to code.The first thing Homework needs to do is request authorizationfor Family Controls.I'll use the shared authorization centerin the Family Controls framework to make this requestwhen my app launches.

The request can either result in success or failure.Calling this function will require a guardianin the family to approve Family Controls for Homework.

Since my app has never run on this iPhone before,requestAuthorization will askfor a guardian's approval with an alert.Tapping on Allow will then prompt the guardianto authenticate with their Apple IDand password to continue.

Once a guardian has successfully authenticated,calling requestAuthorization will not promptwith an alert again but instead silently return success.To prevent misuse, requestAuthorizationwill return failure if the signed-in iCloud isis not a child using Family Sharing.It's just that easy to get your app readyto use the Screen Time API.

Thanks, Nolan.We just saw our demo app, Homework,authorizing with Family Controls.Authorizing with Family Controls alsogrants other magic powers to your app.For instance, once the device is authorized,the user can no longer sign out of iCloud.

Also, on-device web content filtersbuilt with the Network Extensions frameworkcan be included in your app and will be installed automaticallyand cannot be removed.This gives your app the ability to filter web trafficon the device.

One of the challenges in writing a parental controls appis getting your code to run on the child's devicewhen the child will likely never run your app.For the Screen Time API,we created a new way to perform background code executionwith Device Activity.A Device Activity extension will be your primary wayto interact with the rest of the Screen Time API.Let's go back to Nolan to see how Homework can run codeon a repeating schedule to restrict a child's deviceby placing a Screen Time shield over some apps.

Nolan.Thanks, Chris.

Next up with Homework is shielding the appsthe guardian has chosen to discourageon a reoccurring schedule.

Since I cannot count on my app to be runningon the child's device,I will use a Device Activity Scheduleto set the application shield restriction every day,even when Homework hasn't runsince being setup by the guardian.

When my Device Activity Schedule fires,Device Activity will call into a new extension point.

Homework will include an extensionfor this extension pointwhere I will set the restriction to shield apps.Implementing an extension for this extension pointrequires you to subclass DeviceActivityMonitoras the principle class.

Here, I've overridden two methodsin my extension's principle class:intervalDidStart and intervalDidEnd.

These functions will be called the first time the deviceis used after the start and end of my schedule.

I'm going to leave the implementationof these functions empty until I've configuredmy Device Activity schedule from Homework's main app.

Now that my Device Activity monitorextension is set up from the main app,I need to create a Device Activity nameand a Device Activity schedule.The Device Activity name is how I can referencethe activity from within my extension.And the Device Activity schedule represents the time boundsin which my extension will monitor for activity.Here I've set the name of my activity to "daily,"and I've set my schedule to start and end at midnight.

I will also set this schedule to repeat.Finally, I can create a Device Activity centerand call startMonitoring with the activity nameand schedule I've just defined.With these few lines of code, my Device Activity monitorextension will be called with the activity namewhenever the schedule starts and ends.

Another ingredient to shielding appsis figuring out what the guardian wants to discourage.The Family Controls framework has a SwiftUI elementjust for the job: The family activity picker.From the main app's UI, I can showthe family activity picker and allow the guardianto choose from a list of apps, websites,and categories used by the family.

Once the guardian has made their selection,Homework can use opaque tokens returned by the pickerto set restrictions on apps, websites,and categories each token represents.Here, I've added the familyActivityPickerview modifier to a Button in the app,and I've bound the picker's selection parameterto a property in the app's model.This will update my modelwhenever the guardian's selection is updated in the UI.Now that I have the guardian's discouraged app selection storedin my app's model, I'll jump backto the Device Activity Monitor extension.First, I'll drop in an import for the Managed Settings moduleto get access to the application shield restriction.Then in intervalDidStart, I can pull the selectionout of the app's model and configurethe application shield restriction accordingly.And in intervalDidEnd, I can remove the restrictionby setting it to nil.

With these simple modifications,Homework will shield the guardian selecteddiscouraged apps every day from midnight to midnight.

Back to you, Chris.Thanks, Nolan.

Shielding is not the only restriction availablein Managed Settings.

We could also choose to set any number of restrictionsat the beginning or end of a Device Activity Schedule.

For instance, your app could chooseto prevent account creation or removal, completely block appsand websites, or deny media content by age.

Speaking of media restrictions,Managed Settings also provides an API that allows any appto read the restrictions for Movies and TV content.

No Family Controls authorization is required.

These functions are ideal for any media appto check if a device should be limiting the contentpresented to the user.In the Homework demo app, the restrictions were setat midnight every day, but what if you wantto change restrictions based upon app or web usage?Device Activity has another feature that willallow your app to do just that: Device Activity events.These events are configured with the same tokens you sawfrom the family activity picker and allow you to execute codewhen the usage limits are reached.These events are registered alongside the schedulesthat Nolan showed us in the last segment.Now let's go check in with Nolan and see how these events work.I want to remove the application shield restrictionnot only when Homework's schedule endsbut also when the child accumulates enough usagefor a set of guardian-selected encouraged apps.To do that, I'll need to monitor the usageof these encouraged apps by configuring Device Activityto additionally call into my Device Activity monitorextension when a usage threshold is met.

Here, I'll define a Device Activity event nameto be "encouraged."This name is how I can reference the eventfrom within my extension.

And then I'll define my encouraged eventto include the set of guardian-selectedencouraged apps and the threshold of usage desired.

Finally, I'll update the call to startMonitoringto included the event I just defined.

Now that I am monitoring for Device Activity eventsfrom the main app, my Device Activity monitorextension is going to be called whenever anyof those events meet their usage threshold.The function eventDidReachThresholdwill be called with the Device Activity Event Nameand the DeviceActivityName to identify which event firedfor which scheduled activity.In Homework, I want to set the application shield restrictionto nil when the extension gets notified for this event.Setting this restriction to nil will remove the shieldfrom any of the previously shielded apps.Back to Chris.In the previous section,the discouraged apps were shieldedwith a default Screen Time shield.But you'll likely want to get your own brandingand style in these shields.

You'll also probably want to haveyour own action handlers for the shield's buttons.We've got the tools for both.Custom shields allow youto create a unique branded experience.To customize the shields,you'll need to implement two new extension pointsdefined in Managed Settings.One extension point allows you to customize the lookof the shield by changing background material,titles, icon, and appearance of the buttons.And another extension pointallows you to create custom button handlers.Let's go back to Nolanand see how you would customize your shields.To configure the look and feel of the custom shieldsfor Homework, I need to startby subclassing ShieldConfigurationProvideras the principle class of the extension.Configuration is the only functionyou'll need to override here.This function is passed a reference to the applicationthat is currently being shielded,and it is expected to return a ShieldConfiguration struct.

The ShieldConfiguration struct allows youto define the background effect, background color,icon, title, subtitle, primary button label,primary button background color, and secondary button label.Wow, that's a lot of customization.Once this struct is configured and returned by myshield configuration provider extension,the operating system will automatically displaythese customizations over any app shielded by Homework.

Now that we've styled the shields,I can use the second extension pointin Managed Settings to configure the action handlersfor the primary and secondary buttons.In this new extension, I'll subclassShieldActionHandler as the principle classand override the function handle.

The handle function is toldwhether the primary button actionor secondary button action was pressedand which application is currently being shielded.

You are required to call the function's completion handlerwith a sshield action response.The response can either be to close the shielded applicationor defer action and redraw the shield configuration.

The ability to defer action in the shield is very powerfulbecause it gives the shield the chance to updateits appearance while it waits for a signal on how to proceed.

For instance, it can be used to indicatethat the shield is waiting for a guardian's actionwhen the child taps Ask for Access here.

With the addition of these custom shields,my demo app, Homework, is complete.The guardian can choose apps to shield,such as games or entertainment, and remove the shieldonce the child has done enough positive screen time,like reading, learning, or being creative.Thanks for joining mein building this awesome new demo app.Now back to Chris.

Today we learned how our three goals--to provide restrictions, protect privacy,and enable new dynamic experiences--were delivered with the three frameworksthat make up the Screen Time API.Managed Settings allows your appto enforce settings and restrictions.Device Activity allows your app to run code on a scheduleor on usage events even when your app is not being used.And finally, Family Controls, which grants accessto Managed Settings and Device Activityand protects the privacy of your users,guaranteeing that only the guardians will knowwhat the child is doing.Like all frameworks, the Screen Time API willcontinue to evolve based on feedback from you.So give these a try and let us know how they door don't support your unique use cases.Thanks for joining us today.Enjoy WWDC 2021.[music]

## Code Samples

