# Wwdc2021 10085

## Transcript

More Videos

Streaming is available in most browsers,and in the Developer app.

About

Transcript

Code

Apple’s privacy pillars in focusAt Apple, we believe that privacy is a fundamental human right. Learn about our four pillars of privacy, how we brought these principles together to design iCloud Private Relay, and how you can approach building privacy in your app in line with those fundamentals. Explore how you can build data minimization, on-device processing, transparency and control, and security protections right into your app.ResourcesApp Store Guidelines: User Privacy and Data UseHuman Interface Guidelines: Accessing User DataIntroducing Private Click Measurement, PCMHD VideoSD VideoRelated VideosTech TalksDo more with less dataWWDC22Explore App Tracking TransparencyWWDC21Analyze HTTP traffic in InstrumentsGet ready for iCloud Private RelayMeet privacy-preserving ad attributionMeet the Location ButtonMonday@WWDC21What's new in UIKit

At Apple, we believe that privacy is a fundamental human right. Learn about our four pillars of privacy, how we brought these principles together to design iCloud Private Relay, and how you can approach building privacy in your app in line with those fundamentals. Explore how you can build data minimization, on-device processing, transparency and control, and security protections right into your app.

App Store Guidelines: User Privacy and Data Use

Human Interface Guidelines: Accessing User Data

Introducing Private Click Measurement, PCM

HD VideoSD Video

HD Video

SD Video

Do more with less data

Explore App Tracking Transparency

Analyze HTTP traffic in Instruments

Get ready for iCloud Private Relay

Meet privacy-preserving ad attribution

Meet the Location Button

Monday@WWDC21

What's new in UIKit

Search this video…Hi, everyone.I'm Lauren from Privacy Engineering,and welcome to "Apple's privacy pillars in focus."At Apple,we believe that privacy is a fundamental human right.Our devices are an important part of entertaining usand connecting us to one another,especially when we have had to stay connectedfrom a distance.And what people share from within these experiencesshould be up to them.When people understand what happens with their dataand are in control,they are more likely to engage with your experiencesand let your app become a trusted part of their life.So, we have to work together to make surethat great features and great privacy aren't a tradeoff.This isn't always easy, so in iOS 15 and macOS Monterey,we are continuing to provide innovative toolsthat make it easier for you to protect peoplewhile building features that they will love.In this video, we will walk you throughApple's approach to privacy and introduce new technologiesthat make building new featureswhile respecting people's choices as simple as ever.Improving the privacy protections of your appcan seem like a lofty goal,or you may not even know where to start,so we've simplified engineering privacyinto a series of principles and related questionsthat you can ask yourself that guide how to design products.So, what's our approach to privacy?At Apple, we have four fundamental privacy pillars.The first is data minimization,which requesting and only usingdata that you actually need.The second is on-device processing,which is processing data locallywithout sending it to a server.The third is transparency and control,which is providing peoplewith a clear understandingand control overhow their data is used.And finally, security protectionshelp enforce the privacy protectionson our platform.In practice, these guidelines translate to a seriesof questions that you can ask yourself about your features.For data minimization, do I need this datain order to make my feature great?For on-device processing,why does the server need visibility into this data?For transparency and control,what are we gonna use this data for,and how do we communicate that to people?And Finally, for security protections,how is this data protected in transit and at rest?Garrett and I will walk you through the new featuresthat you can adopt to only collectthe data that you need, protect your user's data,and a few technologies that may inspire youto think about new opportunities for privacy in your app.And then, Elliot will dive into how Private Relay worksand how we applied the pillars to shape its design.Let's start with data minimization in iOS 15.The places that people go can reveal a lot about their lives.Your app may have great experiencesthat rely on location.But people may be skeptical of granting your applocation access right away.In iOS 13, we provided a new way for peopleto try out location features in your appby selecting Allow Once.But this experience can result in repetitive prompts.In iOS 15, there is a new way to build location-based featuresthat more seamlessly blend in with your app's experience,while allowing people to choose when they share location.You can now add a Share Current Location buttonright into your app's experience.When people tap on it, your app will receiveaccess to their location for that session,just like Allow Once.For many apps, only a few features may rely on location.Adopting the location button is a great way for youto build trust with people accessing location when theyinteract with the features that actually need it.When people tap this button for the first time,they'll learn how it works and select whetherthe app will have precise or approximate location.The location arrow on the top leftwill then appear to signal to peoplethat your app has received their location.Next time they tap a location button in your app,it will just work, without any prompts.The location permission is session-basedand will last until they leave the app.This works just like allow-once accessbut is so seamlessthat it's a great replacement for while-in-use!Compared to while-in-use, location buttons let youoffer a lower-commitment way for peopleto try out your location-based features.The button can be customizedto fit in with the rest ofyour app by setting propertieson the CLLocationButton.Some aspects of the buttonthat you can customizeinclude background color,text and location arrow color,and rounded corners.These location buttons are built to ensure that people intendto provide location to the app when the button is pressed.The consistent string and iconography enables themto be easily recognizable, and limitations on contrast,size, and shape ensures that they are visible.This means that iOS can confirm that the buttonwas tapped directly.Location buttons are supported on watchOS,iOS, iPadOS, and macOS with Catalyst.Often, people have to make a big choice aboutlocation access right when they open your app.The location button gives people more precise controlover when their location is used,while ensuring a more seamless user experience.Using the same technology as the location button,secure paste confirmsthat the paste button was tapped directly.Now, the OS can reliably distinguishuser-triggered pastes from programmatic pastesthat are initiated by the app.In iOS 14, the paste-transparency noticelet people know when apps access the pasteboard.This also helped you learn when an SDK included in your appmay have accessed the pasteboard unexpectedly.The transparency notice is no longer neededwhen people paste through the edit options.The notice will only be shown in the UI if the userdid not initiate the paste themselves in the edit menuor through their keyboard.To improve your experience,shift towards only user-initiated pastes.If you need to access the pasteboard,you can use the data detectors to confirmthat the content in the pasteboard isrelevant to your application before you access it.The next pillar is on-device processing.On-device processing is a fundamental building blockto core features, like Face ID, quick-type suggestions,and measuring blood-oxygen level.The main benefit of on-device processing is that you canbuild amazing features using sensitive data,without sending it to your server.In iOS 15, we applied this principle to Siri in a big way.Siri is a great example of how we deliver powerful featureswith industry-leading privacy built in.From the beginning, Siri has always been designedto protect your privacy.Audio recordings are not stored by default.Your requests are associated with a random identifier,not your Apple ID.And we work to keep your personal informationon your device.However, running large machine-learning models,like those used by Siri,typically requires racks of servers.But around the time we released iOS 12,we also added the Apple Neural Engineto our hardware.The Apple Neural Engine has enabled us to movemore components of Siri on-device.In iOS 13, we introduced the abilityto generate the Siri Voice entirely on-device.This means that it became possible for Siri's responseto your request to not leave your device.In iOS 14, we introduced on-device keyboard dictation.This was the first high-quality speech-to-text modelthat we ran on-device.One concern that people still havewith voice assistants is unwanted voice recording.To help address this concern,we are moving all automatic speech recognition modelsfor Siri to run entirely on-device.By bringing on-device speech recognition to Siri,this means that, by default, the audio of your requestswill not leave your iPhone or iPad.This new innovation is another stepin the right direction for on-device processing.Moving Siri automatic speech recognition modelson-device is a great example of how designing for privacyenables great new features.On-device processing means that Siri is incredibly fast.By no longer sending requests to the server and processingon-device, instead, Siri can respond to your requests faster.And now, you can even make some requests while offline.The Apple Neural Engine has been a key partof moving more Siri processing on-device.In iOS 15, you can take advantageof the Apple Neural Engine, too.New in iOS 15, you can use the CreateMLframework to train models right on an iPhone or iPad.Now, you can personalize models to each personwho uses your app,leaving sensitive data, like photos,all on their device.Check out the Machine Learning team's talk,"Build dynamic iOS apps with the Create ML framework,"to learn more.Next, Garrett will tell you about transparencyand control on iOS 15 and macOS Monterey.Thanks, Lauren!Building clear transparency and understandable controlsinto your app can help you build trust with people.Knowing how you plan to use their email,photos, or health data, or who you plan to share it withgives people the comfort to explore your app's featuresand use your app more fully.So, today, we're going to talk through a numberof examples of transparency and control on our platforms,making sure you know what steps to take for your app.First, we'll talk aboutemail-related transparency and control features.You may have thought twice before providingyour email address to a service before.People who use your app can have the same apprehension.They may be worried that their information willbe shared with others or used to link their purchasesor behavior across apps and websites.In iOS 13, Sign in With Apple introduceda new way to sign in to apps and websites,allowing people to hide their names or email addresses.In iOS 15, these benefits are available everywhere,using Hide My Email with iCloud+.From Safari, where people can easilygenerate a new email address when filling in a form,to right in Mail, while composing a new message.And these can come in from other channels.Anywhere you receive email addressesmight have a Hide My Email address.When one of your customers uses Hide My Email,your email will land right in their inbox.Make sure to respect their decision and only requestadditional information, like their name,if needed for your experience.In order to make email rich and engaging,emails often contain remotely-hosted images.When a mail program displays one of those emails,remote images are fetched, revealing when, roughly where,and on what kind of device the mail was opened.Many marketing emails now include unique image URLsfor each user, or even invisible pixels,specifically to link this information to peoplewhen they read their messages.This resulted in people choosing between text-only emailsto preserve privacy, or rendering emailswith full content, but revealing mail activity.In iOS 15, we're introducing Mail Privacy Protection.People can choose to have iOS privately loadremote message content, hiding their mail activity.This is really cool!And it's great news for you.More people will read your emails,with all the images and visuals you included.If you've been using remote images to measure the impactof your campaigns, there are a few changes to be aware of.Since Mail content may be loaded automatically after delivery,the time of Mail viewing will no longer be correct.And since that content is loaded without revealing people'sIP addresses and without detailed headers,the location and type of device reading the Mailaren't revealed.And you'll see your emails as being opened,regardless of if the user read it or not.Next up in transparency and control,we'll take a quick tour through focus and indicators.New in iOS 15, if you have a communication app,you can assist people in Do Not Disturbor another Focusby requesting access to read their availability,then sharing that status within your app's experience.To request access to status,you'll need a NSFocusStatusUsageDescriptionkey in your app's Info.plist,and the User NotificationsCommunication capability enabled in Xcode.For more information on Focus, check out"Send communication and Time Sensitive notifications."In macOS Monterey, we've complemented the cameraindicator light with a recording indicator.Now, any time the built in microphone,or W1 or H1 audio device, is listening,people can see that with an orange dot in the status bar.Of course, part of building trust is not abusing it.Make sure your app runs the microphoneonly when it makes sense to people.As an example, if your app has a mute button,stop receiving audio from the system when muted.Make sure to test your app on macOS Montereyto make sure it behaves the way people will expect.Also, you can easily confirmthat no third-party SDKs in your appare listening unexpectedly.Next, let's look at tools that providetransparency for recent app behavior.App Privacy Report will enable people to understandwhat's going on with their everyday applicationsand will be available in an upcoming software update.It will reveal to people when your app accesses user dataand sensors, such as Location, Photos, or Contactsand show who your app may be sharing data withby listing all the domains your app contacts,as well as the domains that websites accessedwithin your app contact.App Privacy Report will be in Privacy Settingsand can be enabled by people to better understandthe apps they have installed.If people want to clear usage history,they can just turn it back off again.It's also important to note that App Privacy Reportwill not record ephemeral WebKit sessions by web browsers,such as Private Browsing Mode in Safari.In iOS 15, Record App Activity provides export functionalityfor you to better understand your apps' behaviors.So, you'll want to grab the iOS 15 betaand turn on Record App Activity to get a head starton what people will see for your appin the App Privacy Report feature.Then, when you select Save App Activity,iOS will produce a JSON file.You should review the content of this JSON fileto confirm your app behaves as expected.So, let's take a look.The JSON will have a list of stream dictionaries,one for each time a binary accessed user data and sensors,like location or camera.Here's an example of a single access.First, search for all instances of the bundle IDsof all your app's binaries.From there, the timestamps can help youtie those accesses to your software behavior.To see all the domains you've contacted,look below the section marker in JSON:there's a final dictionary.This uses bundle IDs for keys, so there's one dictionaryfor each of your app's executables.From there, you can see all domain contacts,when they were initiated, and if they were app or user-initiated.Now, let me show you the difference betweena connection by an app and a connection by a website.Connections made by SafariViewControllerand ASWebAuthenticationSessionsare automatically tagged as connections by websites.You can also manually tag connectionsas being caused by a websiteif a connection is made on behalf of third-party contentand isn't core to app functionality.At standard layers, we've added an attributionenum to manually tag a connection.You'll need to specify "user."If you don't specify,connections will be marked as app traffic.This enum exists in NSMutableURLRequests,where you'll want to supply the MainDocumentURL,in NWConnection in the Network framework,and sockets.You can also tag connectionsvia convenience methods in other Apple frameworks,such as LinkPresentation and AVFoundation.WKWebView has added new methods to pass an NSURLRequest,so you can tag your connections appropriately.For more info, see "Explore WKWebView additions."App Privacy Report existsto provide transparency on app behaviors.And Record App Activity is a great tool to help youunderstand what people will see when App Privacy Reportbecomes available in an upcoming software update.Your app should access only data the user would expectand at the times they would expect.This is another opportunityto really build trust with your users,as they can understand more of what your application does.Also, Record App Activity is a good wayto better understand the behavior of the SDKsyou've put in your appsand confirm their practices align with yours.Integrate Record App Activity into your QA passes,and confirm that only the data you expect to accessis present in the App Activity JSON.And for our final section of transparency and control,I'd like to walk through a few existing areaswhere we frequently see questions from developers.In late 2020,Privacy Nutrition Labels went live.Labels are designed to bring transparencyin a glanceable format.Knowing what your app will do with their data makes iteasier for people to trust you and engage with your app.We know how hard building good privacy isand that the best work can be invisible.Your label is a place you can show off the hard work you doto protect people.Labels need to be inclusive of all your practices,all features, and all OS versions per platform.Labels must line up with your App Tracking Transparency usage,which brings me to the next topic.App Tracking Transparency was announced at WWDC 2020and was required beginning in spring 2021 with iOS 14.5.Now, people can chose whether they want to betracked across apps and websites.This lets people more easily trust new apps,and existing ones, too.To request permission, you'll need to providea purpose string explaining why you want to track.You can further explain by puttingadditional information ahead of that prompt.If you choose to take this approach,there are a few details to keep in mind.For example, you shouldn't pre-prompt with a yes or no.For more information,refer to our Human Interface Guidelines.Now, some things to keep in mind.Tracking is about linking user data across apps and websitesfor advertising purposes or sharing with data brokers.For the detailed definition,see the User Privacy and Data Use page.App Tracking Transparency is aboutmore than the IDFA, or Identifier For Advertising.The IDFA is one way to track, but App Tracking Transparencyrequires you to ask permission for any tracking.As part of your app's functionality,you might collect names, email addresses,or other identifiers.Linking data using this informationis also considered tracking.Fingerprinting, or the collectionof multiple bits of informationto generate a stable device identity,is disallowed by the developer program license agreement,even if people give you permission to track.If tracking is denied, all app functionalitymust still be available.Make sure that your App Tracking Transparency usageis reflected in your Nutrition Label.Many of you embed third-party SDKsto avoid reimplementing functionality or to takeadvantage of helpful third-party services.You need to be aware of what those SDKs are doing.You're responsible for the behavior of your whole app.If an SDK collects data, you need toput that behavior on your Privacy Label.If an SDK is going to track,you need to get people's permissionbefore calling those methods.Many SDKs have documentationrelated to the Privacy Nutrition Label.You can also reach out to them to ask.We know that advertising is a key part of how ourdevelopers thrive, so we've been hard at workbuilding privacy-preserving ad-attribution technologies.If you run ads in your app,pay for ads to grow your customer base,or work directly in the ad ecosystem,here are some of the improvements.We added conversion values and the source appswhen possible, hardened fraud resilience,provided credit for alternate advertising flows,launched privacy-preserving web attribution,provided accounting for lost conversions,further hardened our privacy protections,and now, with iOS 15, we've addeda specific pingback to you so you can measuread campaign performance without help from the ad network.For more information on all these changes, check out"Meetprivacy-preserving ad attribution."And that wraps up our tourthrough the transparency and control pillarand all the actions you'll need to take with your apps.The final privacy pillar is security.Security is a vital part of some of the most well-knownfeatures on our platform, such as ensuring only the personthat you are iMessaging can read your messages.As an example of how security enables privacy,the iMessaging privacy assuranceis upheld by end-to-end encryption.If you use CloudKit for your app,we've got some new security measures in store for you.You have always been able to have CKAssetsautomatically encrypted at rest with CloudKit.In iOS 15, we provide functionalityso you're able to have other data typessimilarly protected with strong encryptionby just calling a function.This means that where you were previously handling encryptionof user data yourselves, now we will provide the encryptionand key management for all data types stored in iCloud.We're now supporting strings, numbers,dates, CLLocation and Arrays.And it's really easy!You just set the key value pair on the recordusing the encryptedValues API,and CKModifyRecordsOperation to save.And to retrieve the encrypted value,just call CKFetchRecordsOperationwith the same encryptedValues property.And now, I'll hand it off to Elliotto talk about Private Relay, and how the privacy pillarshelped shape its design decisions.Thanks, Garrett!We use the internet throughout our lives to express ourselves,to connect us to work and school, order food,and to help us learn new things at developer conferences.Wi-Fi in a hotel, cellular on the go,and even the internet in our homes--wherever you go, and whatever network you use,privacy on the internet has never been more important.Let's walk through my Sunday morningafter recently moving to Cupertino.After drinking a pot of coffee, I sit down on my broken couchand decide it's time to get a new one.I like the couches at Apple Park,so I open my Mac and browse to Furniture Site in Safarito find some similar styles.As soon as I connect,Furniture Site has my IP address.Which can be used to determine which city I live in,so Cupertino is also added to my activity profile.Behind the scenes, Furniture Site,like many other websites,gathers information about me to share with data brokers.Furniture Site contributes the data about my couch browsingand my IP address is used to combine all of the otherbits of data collected about me from many other places.When combined, the bits and pieces forma comprehensive profile about what I do on the web.Adding it all together, the profile that is builtrepresents a very personal and up-to-date snapshot aboutwho I am and what's going on in my life right now.My profile even includes personal details,like my email address, and even my home addressthat I shared to have a table delivered.I never provided some of this informationintentionally or wanted it to be shared.This kind of browsing history can't be clearedor reset and isn't even stored on my own devices.Not only can this data be used to serve adson other sites that I visit, it can be usedto influence my behavior without me knowing.Later on Sunday, I started researchinglawn mowers on Lawn Mower Site.Using my IP address and other profile information,I was served an ad about the couch that I looked at.Two days later, I received a couch catalogin the mail from Furniture Site.Internet tracking doesn't always stay on the internet.With a detailed profile,tracking can transition to physical space.Tracking reduces trust and can lead peopleto limit what they do on your website.Networks and equipment makers are able to collectthis type of information, too,even discover behavior patternsfrom people who use your website or app.Technologies like TLS and encrypted DNShelp protect behavior patterns and your users' datafrom being exposed to network providers.You should adopt these technologies.To learn more about how to use built-in ways to protectinternet privacy in apps, check the "Enable Encrypted DNS"and "Boost performance and security with modern networking"videos from WWDC 2020.In iOS 15 and macOS Monterey, we are introducingiCloud Private Relay, a new internet privacy service.Included in iCloud+, Private Relay makes sureevery internet connection you make is encrypted,and your IP address no longer identifies youor gives away your location to websites in Safari.And the best part, with Private Relay's unique design,no one, including Apple,can see both who you are and which websites you visit.Let's briefly explore how Private Relay workswhen I shop for my new home.First, when making a connection to Furniture Site,two different Proxy operators in the Private Relay Networkare randomly picked so that no single operatorhas control or can see the whole picture.The proxy that accepts my connection fromthe internet is called the Ingress Proxy.The Ingress Proxy prevents other serversfrom seeing my IP addressand encrypts my internet trafficto prevent my network providerfrom knowing what I'm up to.The relay back to the internet is providedby the Egress Proxy, which prevents the Ingress Proxyfrom seeing what website I'm contacting.Private Relay manages network access in a waythat doesn't require identity or account information,using RSA Blinded Signatures.A cryptographic blinding operation,performed by my device, lets me redeem itfor network access, without giving awayany information about my account or who's making the connection.Using the public key from the Token server,a Private Relay Proxy can quickly verifynetwork access permission.Before making a connection,the Private Relay Access Token Server provides a bundleof different tokens to my device.This gives me access to any proxy operator I choose,whenever I need it.To enforce the separation of information betweenthe proxies I picked, the connection is builtusing multiple layers of encryption.The proxies remove layer-by-layerwhen the connection passes through.Only my device can decrypt every layer,which is required to know that I am accessing the Furniture Site.When making the connection,the Egress Proxy randomly selects an IP address to use.This helps to prevent linking my couch searchto my lawn mower search, or my recent table delivery.Over time, Private Relay connectionsare automatically created and reusedto provide IP address tracking protectionand good performance.The way Private Relay hides my IP addresshas one more privacy benefit.Since my home IP address can be geo-coded to my rough location,the Ingress Proxy can share that location with me.This lets me inform the Egress Proxywhich group of IP addresses to choose between.This is a great example of great features and great privacy.Websites can provide local content in Safari,while my precise location stays hidden.Remember, the Ingress Proxy is the only onethat can see my IP address,The Ingress Proxy converts my IP addressto the same IP-based areathat lawnmower site would have seen,then returns an approximated version back.In this example, the Ingress Proxy sends back"Bay Area, California," which is forwarded to the Egress Proxyto help it pick from a group of IP addressesthat are assigned to that general area.With a regional IP address, sites that I contactcan still find nearby stores.Let's visualize how this works.When I connect, both sites see connectionscoming from an IP address that maps to my general area.The dots on the map represent possiblePrivate Relay IP address locationsthat are shared by everyone in the region.When the "Use Country and Time Zone" optionis selected in iCloud Internet Privacy settings,no hint is provided to the Egress Proxy.So, it picks a random IP address from the groupthat represents the much larger regionthat belongs to the Ingress Proxy.As a result, websites will see connectionsbeing made from a broad regional area.The same set of IP addresses are used by everyone in the region.With the more generalized location setting,the Lawn Mower Site can now see a randomized location,which, for me, can be places like Los Angelesinstead of Cupertino.Privacy on the internet gets even betterwhen Private Relay and Hide My Email are used togetherto prevent websites from using your IP and email addressto track your activity across the web.We've gone over how iCloud Private Relay demonstrateskey concepts from our privacy pillars.The data minimization concept is illustrated byusing unlinkable tokens for network access.Only devices are able to process and decryptall of the encryption layers in a Private Relay connection.IP address protections enhance controlover tracking on the internet.Layered encryption and strong security enforces controlover who can access internet browsing content.Our privacy pillars have helped us every step of the waywhen designing iCloud Private Relay.Back to Lauren.Thanks, Elliot.Great features and great privacy becomes easierwhen we all work together.We hope that learning about the new improvements in iOS 15and how Apple builds privacy into our products,like Private Relay, has inspired you to consideropportunities for innovation when building your app.To better protect people's data, encrypt new assets in CloudKit.For seamless location-based features,adopt the Share Current Location button.Lastly, check your Record App Activity logto prepare for the App Privacy Reportand ensure it aligns with your nutrition label.Apple builds tools with privacy in mindso that you can build great appsfor anyone on the platform.Having an ecosystem where people are excitedto explore new apps and try new featureswhile feeling in control of how their data is being usedrelies on all of us doing our best work.iOS 15 and macOS Monterey provide more control and insightthan ever before, and we're so excited to see what you build.[upbeat music]

Hi, everyone.I'm Lauren from Privacy Engineering,and welcome to "Apple's privacy pillars in focus."At Apple,we believe that privacy is a fundamental human right.Our devices are an important part of entertaining usand connecting us to one another,especially when we have had to stay connectedfrom a distance.And what people share from within these experiencesshould be up to them.When people understand what happens with their dataand are in control,they are more likely to engage with your experiencesand let your app become a trusted part of their life.So, we have to work together to make surethat great features and great privacy aren't a tradeoff.This isn't always easy, so in iOS 15 and macOS Monterey,we are continuing to provide innovative toolsthat make it easier for you to protect peoplewhile building features that they will love.In this video, we will walk you throughApple's approach to privacy and introduce new technologiesthat make building new featureswhile respecting people's choices as simple as ever.

Improving the privacy protections of your appcan seem like a lofty goal,or you may not even know where to start,so we've simplified engineering privacyinto a series of principles and related questionsthat you can ask yourself that guide how to design products.

So, what's our approach to privacy?At Apple, we have four fundamental privacy pillars.The first is data minimization,which requesting and only usingdata that you actually need.The second is on-device processing,which is processing data locallywithout sending it to a server.The third is transparency and control,which is providing peoplewith a clear understandingand control overhow their data is used.And finally, security protectionshelp enforce the privacy protectionson our platform.In practice, these guidelines translate to a seriesof questions that you can ask yourself about your features.For data minimization, do I need this datain order to make my feature great?For on-device processing,why does the server need visibility into this data?For transparency and control,what are we gonna use this data for,and how do we communicate that to people?And Finally, for security protections,how is this data protected in transit and at rest?Garrett and I will walk you through the new featuresthat you can adopt to only collectthe data that you need, protect your user's data,and a few technologies that may inspire youto think about new opportunities for privacy in your app.And then, Elliot will dive into how Private Relay worksand how we applied the pillars to shape its design.Let's start with data minimization in iOS 15.The places that people go can reveal a lot about their lives.Your app may have great experiencesthat rely on location.But people may be skeptical of granting your applocation access right away.

In iOS 13, we provided a new way for peopleto try out location features in your appby selecting Allow Once.But this experience can result in repetitive prompts.In iOS 15, there is a new way to build location-based featuresthat more seamlessly blend in with your app's experience,while allowing people to choose when they share location.You can now add a Share Current Location buttonright into your app's experience.When people tap on it, your app will receiveaccess to their location for that session,just like Allow Once.For many apps, only a few features may rely on location.Adopting the location button is a great way for youto build trust with people accessing location when theyinteract with the features that actually need it.When people tap this button for the first time,they'll learn how it works and select whetherthe app will have precise or approximate location.

The location arrow on the top leftwill then appear to signal to peoplethat your app has received their location.Next time they tap a location button in your app,it will just work, without any prompts.The location permission is session-basedand will last until they leave the app.This works just like allow-once accessbut is so seamlessthat it's a great replacement for while-in-use!Compared to while-in-use, location buttons let youoffer a lower-commitment way for peopleto try out your location-based features.The button can be customizedto fit in with the rest ofyour app by setting propertieson the CLLocationButton.Some aspects of the buttonthat you can customizeinclude background color,text and location arrow color,and rounded corners.These location buttons are built to ensure that people intendto provide location to the app when the button is pressed.The consistent string and iconography enables themto be easily recognizable, and limitations on contrast,size, and shape ensures that they are visible.This means that iOS can confirm that the buttonwas tapped directly.Location buttons are supported on watchOS,iOS, iPadOS, and macOS with Catalyst.Often, people have to make a big choice aboutlocation access right when they open your app.The location button gives people more precise controlover when their location is used,while ensuring a more seamless user experience.Using the same technology as the location button,secure paste confirmsthat the paste button was tapped directly.Now, the OS can reliably distinguishuser-triggered pastes from programmatic pastesthat are initiated by the app.

In iOS 14, the paste-transparency noticelet people know when apps access the pasteboard.This also helped you learn when an SDK included in your appmay have accessed the pasteboard unexpectedly.

The transparency notice is no longer neededwhen people paste through the edit options.The notice will only be shown in the UI if the userdid not initiate the paste themselves in the edit menuor through their keyboard.To improve your experience,shift towards only user-initiated pastes.If you need to access the pasteboard,you can use the data detectors to confirmthat the content in the pasteboard isrelevant to your application before you access it.The next pillar is on-device processing.On-device processing is a fundamental building blockto core features, like Face ID, quick-type suggestions,and measuring blood-oxygen level.The main benefit of on-device processing is that you canbuild amazing features using sensitive data,without sending it to your server.

In iOS 15, we applied this principle to Siri in a big way.Siri is a great example of how we deliver powerful featureswith industry-leading privacy built in.From the beginning, Siri has always been designedto protect your privacy.Audio recordings are not stored by default.Your requests are associated with a random identifier,not your Apple ID.And we work to keep your personal informationon your device.However, running large machine-learning models,like those used by Siri,typically requires racks of servers.But around the time we released iOS 12,we also added the Apple Neural Engineto our hardware.The Apple Neural Engine has enabled us to movemore components of Siri on-device.

In iOS 13, we introduced the abilityto generate the Siri Voice entirely on-device.This means that it became possible for Siri's responseto your request to not leave your device.

In iOS 14, we introduced on-device keyboard dictation.This was the first high-quality speech-to-text modelthat we ran on-device.One concern that people still havewith voice assistants is unwanted voice recording.To help address this concern,we are moving all automatic speech recognition modelsfor Siri to run entirely on-device.By bringing on-device speech recognition to Siri,this means that, by default, the audio of your requestswill not leave your iPhone or iPad.This new innovation is another stepin the right direction for on-device processing.Moving Siri automatic speech recognition modelson-device is a great example of how designing for privacyenables great new features.On-device processing means that Siri is incredibly fast.By no longer sending requests to the server and processingon-device, instead, Siri can respond to your requests faster.And now, you can even make some requests while offline.

The Apple Neural Engine has been a key partof moving more Siri processing on-device.In iOS 15, you can take advantageof the Apple Neural Engine, too.New in iOS 15, you can use the CreateMLframework to train models right on an iPhone or iPad.Now, you can personalize models to each personwho uses your app,leaving sensitive data, like photos,all on their device.Check out the Machine Learning team's talk,"Build dynamic iOS apps with the Create ML framework,"to learn more.Next, Garrett will tell you about transparencyand control on iOS 15 and macOS Monterey.Thanks, Lauren!Building clear transparency and understandable controlsinto your app can help you build trust with people.Knowing how you plan to use their email,photos, or health data, or who you plan to share it withgives people the comfort to explore your app's featuresand use your app more fully.So, today, we're going to talk through a numberof examples of transparency and control on our platforms,making sure you know what steps to take for your app.

First, we'll talk aboutemail-related transparency and control features.

You may have thought twice before providingyour email address to a service before.People who use your app can have the same apprehension.They may be worried that their information willbe shared with others or used to link their purchasesor behavior across apps and websites.In iOS 13, Sign in With Apple introduceda new way to sign in to apps and websites,allowing people to hide their names or email addresses.

In iOS 15, these benefits are available everywhere,using Hide My Email with iCloud+.From Safari, where people can easilygenerate a new email address when filling in a form,to right in Mail, while composing a new message.

And these can come in from other channels.Anywhere you receive email addressesmight have a Hide My Email address.When one of your customers uses Hide My Email,your email will land right in their inbox.Make sure to respect their decision and only requestadditional information, like their name,if needed for your experience.In order to make email rich and engaging,emails often contain remotely-hosted images.When a mail program displays one of those emails,remote images are fetched, revealing when, roughly where,and on what kind of device the mail was opened.Many marketing emails now include unique image URLsfor each user, or even invisible pixels,specifically to link this information to peoplewhen they read their messages.This resulted in people choosing between text-only emailsto preserve privacy, or rendering emailswith full content, but revealing mail activity.In iOS 15, we're introducing Mail Privacy Protection.People can choose to have iOS privately loadremote message content, hiding their mail activity.This is really cool!And it's great news for you.More people will read your emails,with all the images and visuals you included.If you've been using remote images to measure the impactof your campaigns, there are a few changes to be aware of.Since Mail content may be loaded automatically after delivery,the time of Mail viewing will no longer be correct.And since that content is loaded without revealing people'sIP addresses and without detailed headers,the location and type of device reading the Mailaren't revealed.And you'll see your emails as being opened,regardless of if the user read it or not.Next up in transparency and control,we'll take a quick tour through focus and indicators.

New in iOS 15, if you have a communication app,you can assist people in Do Not Disturbor another Focusby requesting access to read their availability,then sharing that status within your app's experience.To request access to status,you'll need a NSFocusStatusUsageDescriptionkey in your app's Info.plist,and the User NotificationsCommunication capability enabled in Xcode.For more information on Focus, check out"Send communication and Time Sensitive notifications."In macOS Monterey, we've complemented the cameraindicator light with a recording indicator.Now, any time the built in microphone,or W1 or H1 audio device, is listening,people can see that with an orange dot in the status bar.Of course, part of building trust is not abusing it.Make sure your app runs the microphoneonly when it makes sense to people.As an example, if your app has a mute button,stop receiving audio from the system when muted.Make sure to test your app on macOS Montereyto make sure it behaves the way people will expect.Also, you can easily confirmthat no third-party SDKs in your appare listening unexpectedly.Next, let's look at tools that providetransparency for recent app behavior.

App Privacy Report will enable people to understandwhat's going on with their everyday applicationsand will be available in an upcoming software update.It will reveal to people when your app accesses user dataand sensors, such as Location, Photos, or Contactsand show who your app may be sharing data withby listing all the domains your app contacts,as well as the domains that websites accessedwithin your app contact.

App Privacy Report will be in Privacy Settingsand can be enabled by people to better understandthe apps they have installed.If people want to clear usage history,they can just turn it back off again.It's also important to note that App Privacy Reportwill not record ephemeral WebKit sessions by web browsers,such as Private Browsing Mode in Safari.

In iOS 15, Record App Activity provides export functionalityfor you to better understand your apps' behaviors.So, you'll want to grab the iOS 15 betaand turn on Record App Activity to get a head starton what people will see for your appin the App Privacy Report feature.Then, when you select Save App Activity,iOS will produce a JSON file.You should review the content of this JSON fileto confirm your app behaves as expected.

So, let's take a look.The JSON will have a list of stream dictionaries,one for each time a binary accessed user data and sensors,like location or camera.Here's an example of a single access.First, search for all instances of the bundle IDsof all your app's binaries.From there, the timestamps can help youtie those accesses to your software behavior.

To see all the domains you've contacted,look below the section marker in JSON:there's a final dictionary.This uses bundle IDs for keys, so there's one dictionaryfor each of your app's executables.From there, you can see all domain contacts,when they were initiated, and if they were app or user-initiated.

Now, let me show you the difference betweena connection by an app and a connection by a website.Connections made by SafariViewControllerand ASWebAuthenticationSessionsare automatically tagged as connections by websites.You can also manually tag connectionsas being caused by a websiteif a connection is made on behalf of third-party contentand isn't core to app functionality.

At standard layers, we've added an attributionenum to manually tag a connection.You'll need to specify "user."If you don't specify,connections will be marked as app traffic.This enum exists in NSMutableURLRequests,where you'll want to supply the MainDocumentURL,in NWConnection in the Network framework,and sockets.You can also tag connectionsvia convenience methods in other Apple frameworks,such as LinkPresentation and AVFoundation.WKWebView has added new methods to pass an NSURLRequest,so you can tag your connections appropriately.For more info, see "Explore WKWebView additions."App Privacy Report existsto provide transparency on app behaviors.And Record App Activity is a great tool to help youunderstand what people will see when App Privacy Reportbecomes available in an upcoming software update.Your app should access only data the user would expectand at the times they would expect.This is another opportunityto really build trust with your users,as they can understand more of what your application does.Also, Record App Activity is a good wayto better understand the behavior of the SDKsyou've put in your appsand confirm their practices align with yours.Integrate Record App Activity into your QA passes,and confirm that only the data you expect to accessis present in the App Activity JSON.

And for our final section of transparency and control,I'd like to walk through a few existing areaswhere we frequently see questions from developers.

In late 2020,Privacy Nutrition Labels went live.Labels are designed to bring transparencyin a glanceable format.Knowing what your app will do with their data makes iteasier for people to trust you and engage with your app.We know how hard building good privacy isand that the best work can be invisible.Your label is a place you can show off the hard work you doto protect people.

Labels need to be inclusive of all your practices,all features, and all OS versions per platform.Labels must line up with your App Tracking Transparency usage,which brings me to the next topic.App Tracking Transparency was announced at WWDC 2020and was required beginning in spring 2021 with iOS 14.5.Now, people can chose whether they want to betracked across apps and websites.This lets people more easily trust new apps,and existing ones, too.To request permission, you'll need to providea purpose string explaining why you want to track.You can further explain by puttingadditional information ahead of that prompt.If you choose to take this approach,there are a few details to keep in mind.For example, you shouldn't pre-prompt with a yes or no.For more information,refer to our Human Interface Guidelines.Now, some things to keep in mind.Tracking is about linking user data across apps and websitesfor advertising purposes or sharing with data brokers.For the detailed definition,see the User Privacy and Data Use page.App Tracking Transparency is aboutmore than the IDFA, or Identifier For Advertising.The IDFA is one way to track, but App Tracking Transparencyrequires you to ask permission for any tracking.As part of your app's functionality,you might collect names, email addresses,or other identifiers.Linking data using this informationis also considered tracking.Fingerprinting, or the collectionof multiple bits of informationto generate a stable device identity,is disallowed by the developer program license agreement,even if people give you permission to track.

If tracking is denied, all app functionalitymust still be available.Make sure that your App Tracking Transparency usageis reflected in your Nutrition Label.

Many of you embed third-party SDKsto avoid reimplementing functionality or to takeadvantage of helpful third-party services.You need to be aware of what those SDKs are doing.You're responsible for the behavior of your whole app.If an SDK collects data, you need toput that behavior on your Privacy Label.If an SDK is going to track,you need to get people's permissionbefore calling those methods.Many SDKs have documentationrelated to the Privacy Nutrition Label.You can also reach out to them to ask.We know that advertising is a key part of how ourdevelopers thrive, so we've been hard at workbuilding privacy-preserving ad-attribution technologies.If you run ads in your app,pay for ads to grow your customer base,or work directly in the ad ecosystem,here are some of the improvements.

We added conversion values and the source appswhen possible, hardened fraud resilience,provided credit for alternate advertising flows,launched privacy-preserving web attribution,provided accounting for lost conversions,further hardened our privacy protections,and now, with iOS 15, we've addeda specific pingback to you so you can measuread campaign performance without help from the ad network.For more information on all these changes, check out"Meetprivacy-preserving ad attribution."And that wraps up our tourthrough the transparency and control pillarand all the actions you'll need to take with your apps.

The final privacy pillar is security.Security is a vital part of some of the most well-knownfeatures on our platform, such as ensuring only the personthat you are iMessaging can read your messages.As an example of how security enables privacy,the iMessaging privacy assuranceis upheld by end-to-end encryption.If you use CloudKit for your app,we've got some new security measures in store for you.You have always been able to have CKAssetsautomatically encrypted at rest with CloudKit.

In iOS 15, we provide functionalityso you're able to have other data typessimilarly protected with strong encryptionby just calling a function.This means that where you were previously handling encryptionof user data yourselves, now we will provide the encryptionand key management for all data types stored in iCloud.We're now supporting strings, numbers,dates, CLLocation and Arrays.

And it's really easy!You just set the key value pair on the recordusing the encryptedValues API,and CKModifyRecordsOperation to save.And to retrieve the encrypted value,just call CKFetchRecordsOperationwith the same encryptedValues property.

And now, I'll hand it off to Elliotto talk about Private Relay, and how the privacy pillarshelped shape its design decisions.Thanks, Garrett!We use the internet throughout our lives to express ourselves,to connect us to work and school, order food,and to help us learn new things at developer conferences.Wi-Fi in a hotel, cellular on the go,and even the internet in our homes--wherever you go, and whatever network you use,privacy on the internet has never been more important.Let's walk through my Sunday morningafter recently moving to Cupertino.After drinking a pot of coffee, I sit down on my broken couchand decide it's time to get a new one.I like the couches at Apple Park,so I open my Mac and browse to Furniture Site in Safarito find some similar styles.As soon as I connect,Furniture Site has my IP address.Which can be used to determine which city I live in,so Cupertino is also added to my activity profile.Behind the scenes, Furniture Site,like many other websites,gathers information about me to share with data brokers.

Furniture Site contributes the data about my couch browsingand my IP address is used to combine all of the otherbits of data collected about me from many other places.When combined, the bits and pieces forma comprehensive profile about what I do on the web.

Adding it all together, the profile that is builtrepresents a very personal and up-to-date snapshot aboutwho I am and what's going on in my life right now.My profile even includes personal details,like my email address, and even my home addressthat I shared to have a table delivered.I never provided some of this informationintentionally or wanted it to be shared.This kind of browsing history can't be clearedor reset and isn't even stored on my own devices.Not only can this data be used to serve adson other sites that I visit, it can be usedto influence my behavior without me knowing.

Later on Sunday, I started researchinglawn mowers on Lawn Mower Site.Using my IP address and other profile information,I was served an ad about the couch that I looked at.Two days later, I received a couch catalogin the mail from Furniture Site.Internet tracking doesn't always stay on the internet.With a detailed profile,tracking can transition to physical space.Tracking reduces trust and can lead peopleto limit what they do on your website.Networks and equipment makers are able to collectthis type of information, too,even discover behavior patternsfrom people who use your website or app.

Technologies like TLS and encrypted DNShelp protect behavior patterns and your users' datafrom being exposed to network providers.You should adopt these technologies.To learn more about how to use built-in ways to protectinternet privacy in apps, check the "Enable Encrypted DNS"and "Boost performance and security with modern networking"videos from WWDC 2020.In iOS 15 and macOS Monterey, we are introducingiCloud Private Relay, a new internet privacy service.Included in iCloud+, Private Relay makes sureevery internet connection you make is encrypted,and your IP address no longer identifies youor gives away your location to websites in Safari.And the best part, with Private Relay's unique design,no one, including Apple,can see both who you are and which websites you visit.

Let's briefly explore how Private Relay workswhen I shop for my new home.First, when making a connection to Furniture Site,two different Proxy operators in the Private Relay Networkare randomly picked so that no single operatorhas control or can see the whole picture.The proxy that accepts my connection fromthe internet is called the Ingress Proxy.The Ingress Proxy prevents other serversfrom seeing my IP addressand encrypts my internet trafficto prevent my network providerfrom knowing what I'm up to.The relay back to the internet is providedby the Egress Proxy, which prevents the Ingress Proxyfrom seeing what website I'm contacting.

Private Relay manages network access in a waythat doesn't require identity or account information,using RSA Blinded Signatures.A cryptographic blinding operation,performed by my device, lets me redeem itfor network access, without giving awayany information about my account or who's making the connection.

Using the public key from the Token server,a Private Relay Proxy can quickly verifynetwork access permission.

Before making a connection,the Private Relay Access Token Server provides a bundleof different tokens to my device.

This gives me access to any proxy operator I choose,whenever I need it.

To enforce the separation of information betweenthe proxies I picked, the connection is builtusing multiple layers of encryption.The proxies remove layer-by-layerwhen the connection passes through.Only my device can decrypt every layer,which is required to know that I am accessing the Furniture Site.

When making the connection,the Egress Proxy randomly selects an IP address to use.This helps to prevent linking my couch searchto my lawn mower search, or my recent table delivery.Over time, Private Relay connectionsare automatically created and reusedto provide IP address tracking protectionand good performance.The way Private Relay hides my IP addresshas one more privacy benefit.Since my home IP address can be geo-coded to my rough location,the Ingress Proxy can share that location with me.This lets me inform the Egress Proxywhich group of IP addresses to choose between.This is a great example of great features and great privacy.Websites can provide local content in Safari,while my precise location stays hidden.

Remember, the Ingress Proxy is the only onethat can see my IP address,The Ingress Proxy converts my IP addressto the same IP-based areathat lawnmower site would have seen,then returns an approximated version back.In this example, the Ingress Proxy sends back"Bay Area, California," which is forwarded to the Egress Proxyto help it pick from a group of IP addressesthat are assigned to that general area.With a regional IP address, sites that I contactcan still find nearby stores.

Let's visualize how this works.When I connect, both sites see connectionscoming from an IP address that maps to my general area.The dots on the map represent possiblePrivate Relay IP address locationsthat are shared by everyone in the region.

When the "Use Country and Time Zone" optionis selected in iCloud Internet Privacy settings,no hint is provided to the Egress Proxy.

So, it picks a random IP address from the groupthat represents the much larger regionthat belongs to the Ingress Proxy.As a result, websites will see connectionsbeing made from a broad regional area.The same set of IP addresses are used by everyone in the region.

With the more generalized location setting,the Lawn Mower Site can now see a randomized location,which, for me, can be places like Los Angelesinstead of Cupertino.

Privacy on the internet gets even betterwhen Private Relay and Hide My Email are used togetherto prevent websites from using your IP and email addressto track your activity across the web.We've gone over how iCloud Private Relay demonstrateskey concepts from our privacy pillars.The data minimization concept is illustrated byusing unlinkable tokens for network access.Only devices are able to process and decryptall of the encryption layers in a Private Relay connection.IP address protections enhance controlover tracking on the internet.Layered encryption and strong security enforces controlover who can access internet browsing content.Our privacy pillars have helped us every step of the waywhen designing iCloud Private Relay.Back to Lauren.Thanks, Elliot.Great features and great privacy becomes easierwhen we all work together.We hope that learning about the new improvements in iOS 15and how Apple builds privacy into our products,like Private Relay, has inspired you to consideropportunities for innovation when building your app.

To better protect people's data, encrypt new assets in CloudKit.For seamless location-based features,adopt the Share Current Location button.Lastly, check your Record App Activity logto prepare for the App Privacy Reportand ensure it aligns with your nutrition label.Apple builds tools with privacy in mindso that you can build great appsfor anyone on the platform.Having an ecosystem where people are excitedto explore new apps and try new featureswhile feeling in control of how their data is being usedrelies on all of us doing our best work.iOS 15 and macOS Monterey provide more control and insightthan ever before, and we're so excited to see what you build.[upbeat music]

23:59 -Encrypt/decrypt data with CKModifyRecordsOperation

## Code Samples

```swift
// Device 1: Encrypt data before calling CKModifyRecordsOperation.


myRecord.encryptedValues[
"encryptedStringField"
] 
=
 
"Sensitive value"




// Device 2: Decrypt data after calling CKFetchRecordsOperation.



let
 decryptedString 
=
 myRecord.encryptedValues[
"encryptedStringField"
] 
as?
 
String
```

