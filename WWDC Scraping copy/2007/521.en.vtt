WEBVTT

00:00:18.710 --> 00:00:23.100
>> Josh: We're gonna talk about access control
lists today, managing and deploying these things.

00:00:23.100 --> 00:00:26.670
And we're gonna talk specifically about file
system access controls and we're gonna talk

00:00:26.670 --> 00:00:30.790
about service access controls basically
ACLs ands SACLs as we like to call them.

00:00:30.789 --> 00:00:33.750
We're not gonna get into dACLs, which
would be the directory access ones.

00:00:33.750 --> 00:00:40.750
So we're not gonna get into any other kind of access control
on Mac OS X strictly looking at the deploying and managing

00:00:40.750 --> 00:00:44.170
of the other two that are the ones that
you commonly see in an IT environment

00:00:44.170 --> 00:00:46.980
since this is more of an administration sort of track.

00:00:46.979 --> 00:00:53.179
That said, my name is Josh Wiesnbecher (Sp?) I'm one of
the enterprise CE's at Apple computer that takes care

00:00:53.179 --> 00:00:57.799
of I take care of deployment and
management of client technologies.

00:00:57.799 --> 00:01:06.149
And even though this is an IT sort of track before I get
into my little bit I wanna introduce John Fagan who's one

00:01:06.150 --> 00:01:11.510
of our local file system engineers to talk to you a
little bit about how all this stuff actually works.

00:01:11.510 --> 00:01:17.469
( Applause )

00:01:17.469 --> 00:01:20.640
>> John: Alright, as said, I'm John
Fagan I work in the file systems group.

00:01:20.640 --> 00:01:25.500
And we're talking mainly about the
implementation of re sales just

00:01:25.500 --> 00:01:27.689
to give you an idea of what they are and how they work.

00:01:27.689 --> 00:01:32.769
And I'll also be talking about the command
line interface because that's where I live.

00:01:32.769 --> 00:01:36.319
Josh will be talking about the graphics later.

00:01:36.319 --> 00:01:46.599
As everyone should already be familiar with the CH pod
command, we have it have had Apple in CH pod since Tiger.

00:01:46.599 --> 00:01:50.859
The (inaudible) describes them in very good detail
I recommend reading it if you haven't already.

00:01:50.859 --> 00:01:58.189
The basic syntax is you say plus A that indicates you're
gonna be adding an ACL or an ace to a file ace enter

00:01:58.189 --> 00:02:01.739
to access control entry and access
control has a list of those.

00:02:01.739 --> 00:02:04.569
You can use minus A to remove a specific one.

00:02:04.569 --> 00:02:10.239
And dash capital N will remove all the ACLs from the
file if you need to clear it out for some reason.

00:02:11.280 --> 00:02:18.090
The LS command has been extended and this was in
Tiger to show a plus on the out put of LS dash L

00:02:18.090 --> 00:02:24.009
and that's the permission bit to
indicate that there is an ACL on the file.

00:02:24.009 --> 00:02:28.949
The reason it is right next, right at the end of
the (inaudible) is that any script that happens

00:02:28.949 --> 00:02:32.399
to parsit (Sp?) based on spaces will continue to work.

00:02:32.400 --> 00:02:39.780
And I verify that all my scripts
continue to work, which is useful.

00:02:39.780 --> 00:02:49.000
The (inaudible) dash E is a list out the ACLs for the file
in the example on the screen describes it pretty well.

00:02:49.000 --> 00:02:56.479
There are number when you use the CH model, you can
specify an order and again, this is in the man page.

00:02:56.479 --> 00:03:02.000
Josh will get into the semantics of ACLs later
describing why you'd want to care about the order.

00:03:02.000 --> 00:03:06.020
If, the new and leopard, if you
want, if you specify the at sign

00:03:06.020 --> 00:03:11.710
to that LS dash L it will list out
extended attributes that a file has.

00:03:11.710 --> 00:03:19.090
Again, Y is similar with the plus sign at, at the end of
the mode bit it will indicate that there are EA's present.

00:03:19.090 --> 00:03:29.640
The one caveat there is, if a file has both ACLs
and the EA's only the at sign will be listed.

00:03:29.639 --> 00:03:33.849
Now, I said I would talk about
the implementation here it is.

00:03:33.849 --> 00:03:38.710
On most of the file systems ACLs are implemented as EA's.

00:03:38.710 --> 00:03:47.270
As we've indicated in the past EA's have a
reverse DNS name or we recommend you use this.

00:03:47.270 --> 00:03:56.210
So, EA's on for example, HFS plus UF as etcetera
are in the com dot apple dot system dot security EA,

00:03:56.210 --> 00:03:59.550
witch does not show up to any other attributes.

00:03:59.550 --> 00:04:05.140
So generally, this doesn't matter, unless you happen to
be set kind of set in EA with that name and find out.

00:04:05.139 --> 00:04:06.549
It doesn't work.

00:04:06.550 --> 00:04:12.340
Now since it's all supplemented as an EEA on those file
systems it's also subject to the normal limitations

00:04:12.340 --> 00:04:16.990
that an EA may have on that file
system, which I'll get to in a bit.

00:04:16.990 --> 00:04:23.629
File systems that have native EA
support are HFS plus and UDF.

00:04:23.629 --> 00:04:30.050
And as we've mentioned as available
is that FS also has native EA support.

00:04:30.050 --> 00:04:39.910
File systems that do not have native EA's,
which include UFS and MS dot also NFS

00:04:39.910 --> 00:04:44.120
for the network file system implement
EA's using an Apple double file.

00:04:44.120 --> 00:04:51.180
The kernel will emulate this by creating a dot
under bar file with the same name as file fu.

00:04:51.180 --> 00:04:54.439
The kernel will create and manipulate dot under bar fu.

00:04:54.439 --> 00:04:56.469
Now when I say this as an Apple double file.

00:04:56.470 --> 00:04:58.060
It's not exactly an Apple double file.

00:04:58.060 --> 00:05:00.209
It's a very limited version of it.

00:05:00.209 --> 00:05:09.669
It only supports the finder info section and the
resource force section and the EA's are in this gap

00:05:09.670 --> 00:05:14.830
between the finder and fo and resource fork.

00:05:14.829 --> 00:05:18.339
The (inaudible) are getting used more and more

00:05:18.339 --> 00:05:21.560
You know as 10 and as we started saying with Tiger.

00:05:21.560 --> 00:05:25.129
We recommend you use those for
storing small amounts of metadata.

00:05:25.129 --> 00:05:33.620
The OS X uses several of them, again using the reverse DNS
information com dot apple dot finder info com dot apple dot

00:05:33.620 --> 00:05:38.730
resource fork are the, well finder and
info and resource fork fairly obviously

00:05:38.730 --> 00:05:48.080
ACLs and corn king, which I'm not sure we've
mentioned yet, but will start showing up on your files.

00:05:48.079 --> 00:05:55.849
Since they're implemented as EA's and ACLs as well
as generic EA's have some limitations on HFS plus.

00:05:55.850 --> 00:06:06.160
There is about a 3000 byte jus0t under four K limit
for the size of an EA except for the resource fork.

00:06:06.160 --> 00:06:11.150
When it's emulated for example, on USF or MS
dos there's about a 64 k byte limdits total.

00:06:11.149 --> 00:06:15.560
And EDTA can be up to that size.

00:06:15.560 --> 00:06:18.470
There is no hard limit on the number of EA's.

00:06:18.470 --> 00:06:23.190
So if you're going to write a program
or script to stifle through them.

00:06:23.189 --> 00:06:26.449
Then you need to be prepared that there may be lots.

00:06:26.449 --> 00:06:34.250
Some of my test programs generate 10,000 EA's on a file.

00:06:34.250 --> 00:06:40.240
Now for the IT track most important is
to be concerned about maintaining EA's.

00:06:40.240 --> 00:06:45.460
We have, since Tiger, we have had program, the
command line programs, tried to deal with them.

00:06:45.459 --> 00:06:50.370
There have been bugs, but generally, they do work
and they've been working better with each version.

00:06:50.370 --> 00:06:55.519
Rsink and SEP actually do not copy EA's by default.

00:06:55.519 --> 00:07:00.079
You have to use the dash capital E option to get them.

00:07:00.079 --> 00:07:01.620
CP will copy them by default.

00:07:01.620 --> 00:07:06.620
You have to tell it not to, but you need
the CP dash P option to copy the ACL

00:07:06.620 --> 00:07:10.209
because that's the only way CP will copy permissions.

00:07:10.209 --> 00:07:12.669
Tar will copy everything by default.

00:07:12.670 --> 00:07:20.020
And sort the files in the EA metadata
as a dot under bar file in the archive.

00:07:20.019 --> 00:07:24.430
If you extract it on another file
system or another operating system,

00:07:24.430 --> 00:07:31.240
and then retar it up it will just work
because the file has the right name.

00:07:31.240 --> 00:07:37.980
One caveat is that when you modify an EA on the system.

00:07:37.980 --> 00:07:40.360
The modification time for the file does not change.

00:07:40.360 --> 00:07:44.740
The only exception for this is on
HSF plus with the resource fork.

00:07:44.740 --> 00:07:48.629
And that is due to the actual implementation
of HSF plus where the resource fork

00:07:48.629 --> 00:07:52.899
and data fork are considered parts
of the same aspects of the file.

00:07:52.899 --> 00:07:55.739
No other EA causes a modification time.

00:07:55.740 --> 00:07:59.939
If we're going to be looking at copying
files over based on their modification time.

00:07:59.939 --> 00:08:03.459
You have to be aware of this.

00:08:03.459 --> 00:08:09.509
Now this is just for any programmers in the room,
or anyone who wants to write their own code.

00:08:09.509 --> 00:08:16.629
Tar and all the other utilities, copy and
manipulate EA's using the copy fly routine.

00:08:16.629 --> 00:08:22.939
This is a routine that was added to Tiger, but as a
private interface we've made it public for leopard.

00:08:22.939 --> 00:08:24.189
We recommend you use it.

00:08:24.189 --> 00:08:34.600
It can copy all the metadata we support, which includes
the POSIX permissions, the EA's, ACLs, quarantine bit,

00:08:34.600 --> 00:08:37.519
and anything else we happen to add later.

00:08:37.519 --> 00:08:39.240
It also can copy the normal data.

00:08:39.240 --> 00:08:41.860
I've got two usages on this screen.

00:08:41.860 --> 00:08:44.509
The first one will copy just the metadata.

00:08:44.509 --> 00:08:49.659
The second one is the simplest
CP program we have on the system.

00:08:49.659 --> 00:08:52.870
One caveat, it only works on single files.

00:08:52.870 --> 00:08:55.110
It won't copy an entire hierarchy.

00:08:55.110 --> 00:08:57.960
But I like it I recommend people use it.

00:08:57.960 --> 00:09:00.040
And that's it for me.

00:09:00.039 --> 00:09:01.539
Let's go back to Josh.

00:09:01.539 --> 00:09:02.699
( Applause )

00:09:02.700 --> 00:09:07.290
>> Josh: Thanks Shawn.

00:09:09.269 --> 00:09:10.730
All right thank you Shawn.

00:09:10.730 --> 00:09:12.879
So now that everyone's got a little
bit of better understanding.

00:09:12.879 --> 00:09:20.159
I think underneath of what's going on hopefully we'll
avoid the whole arsenic OS X server and bloodbath thing

00:09:20.159 --> 00:09:23.149
in Q and A later because that's fixed now.

00:09:23.149 --> 00:09:27.889
So work in a talk a little bit about
file system asil administration.

00:09:27.889 --> 00:09:33.230
Just a quick show of hands, how many people in
here are more administrative than developer?

00:09:34.590 --> 00:09:36.780
I should have expected that in the IT track actually.

00:09:36.779 --> 00:09:37.539
I imagine.

00:09:37.539 --> 00:09:41.740
So we are going to talk a little bit about ACL's
why we have them, what we're using them for.

00:09:41.740 --> 00:09:46.330
In the very first thing to know about is the
whole point in using these file system ACL's is

00:09:46.330 --> 00:09:49.110
to give you more control over your file system.

00:09:49.110 --> 00:09:54.529
We always before at this (inaudible) file
permissions, you know the owner of the group, everyone.

00:09:54.529 --> 00:09:57.000
And then you had just your three bits on that you could set.

00:09:57.000 --> 00:09:59.649
And it was extremely easy to get stuck.

00:09:59.649 --> 00:10:04.509
Because you couldn't do anything more than
owner group, everyone else on the system.

00:10:04.509 --> 00:10:08.419
So you if you had to say give two different
varying levels to two different groups.

00:10:08.419 --> 00:10:12.099
If you had the owner you wanted to have one
thing and everyone else got something else.

00:10:12.100 --> 00:10:14.240
And then you had one group you wanted to read access

00:10:14.240 --> 00:10:18.250
in one group you wanted write only access
like a drop box, you couldn't do it.

00:10:18.250 --> 00:10:19.669
So you're kind of get stuck.

00:10:19.669 --> 00:10:24.370
We had a bunch of these special so that we could
throw on their stickies and other things like that.

00:10:24.370 --> 00:10:26.060
And you could kinda try and make things work.

00:10:26.059 --> 00:10:29.019
But it really didn't do exactly what you wanted.

00:10:29.019 --> 00:10:32.039
And it became difficult to make it work that way.

00:10:32.039 --> 00:10:39.679
So ACL's give us a lot more flexibility, and a lot more
control and more importantly, a lot more granular control.

00:10:39.679 --> 00:10:43.099
So how do these things actually work when
we start looking at them and figuring

00:10:43.100 --> 00:10:45.690
out how we're going to evaluate our file system?

00:10:45.690 --> 00:10:49.790
Well, the basic items of this include a gued (Sp?).

00:10:49.789 --> 00:10:54.519
This is something new on OS X and 10
three and four, and it's coming on up.

00:10:54.519 --> 00:10:56.829
And we have gueds for just all kinds of stuff now.

00:10:56.830 --> 00:11:03.340
And all it is, and sometimes you'll see it called the
UUID to, this allows you to uniquely identify something

00:11:03.340 --> 00:11:07.940
in the operating system, whether
it's a user, whether it's a volume.

00:11:07.940 --> 00:11:12.660
You can use this in F stab to put
mouse points and things like that in.

00:11:12.659 --> 00:11:16.449
But their unique across space and
time or so claims the man page.

00:11:16.450 --> 00:11:21.000
And they're made by taking the Mac address and
just like milliseconds since the Epoc (Sp?)

00:11:21.000 --> 00:11:23.159
in some sort of other calculation thrown in there.

00:11:23.159 --> 00:11:27.069
And so you get these big alphanumeric
numbers that are unique.

00:11:27.070 --> 00:11:30.710
And these are really important because
if we just use traditional UID,

00:11:30.710 --> 00:11:34.200
say what's everyone's first UID on their system?

00:11:34.200 --> 00:11:41.660
It's 501. So if I had 501 and someone else at 501 and
someone else at 501 and I tried to do ACLs with that.

00:11:41.659 --> 00:11:47.179
They'll get the same resolution because the system doesn't
really care about your name he cares about your number.

00:11:47.179 --> 00:11:52.250
So the gued allows us to have is absolutely
guaranteed function across space and time.

00:11:52.250 --> 00:11:52.870
Don't change them.

00:11:52.870 --> 00:11:56.720
I've seen people try to duplicate them on
different systems to get similar results.

00:11:56.720 --> 00:11:58.310
That's all bad.

00:11:58.309 --> 00:11:59.739
Don't do that.

00:12:02.840 --> 00:12:09.750
So an ACL it self is actually a list of
things called aces, access control entries.

00:12:09.750 --> 00:12:13.789
And an ace itself is a list of four specific items.

00:12:13.789 --> 00:12:20.139
So each ace includes the gued of the user or
the group that this particular ace applies to.

00:12:20.139 --> 00:12:23.610
That allows you to uniquely tie it to a specific thing.

00:12:23.610 --> 00:12:28.259
The permission of type, whether this
is an allow or whether this is a deny,

00:12:28.259 --> 00:12:30.360
and we'll talk a little bit about the differences in those.

00:12:30.360 --> 00:12:36.070
There are some really significant changes to the
way the system behaves when it sees allow or deny.

00:12:36.070 --> 00:12:39.310
And this comes into the ordering
that Shawn was talking about.

00:12:39.309 --> 00:12:43.279
The actual permissions setting, we
have 13 different possible permissions.

00:12:43.279 --> 00:12:45.929
We can set all to individual allow or deny.

00:12:45.929 --> 00:12:52.870
So you can make up an incredibly complicated
ACL to control access to single folders.

00:12:52.870 --> 00:12:54.889
And then we also have the inherited field.

00:12:54.889 --> 00:13:00.529
And what the inherited field does is it specifies
whether this ace was inherited from the public folder

00:13:00.529 --> 00:13:07.049
from the parent folder or whether it
was explicitly defined on that folder.

00:13:07.049 --> 00:13:10.219
And there are, like I said, 13 possible permissions.

00:13:10.220 --> 00:13:13.340
We are way beyond read write execute at this point.

00:13:13.340 --> 00:13:18.350
So these are organized into three different
categories to help you kind of keep an idea down

00:13:18.350 --> 00:13:20.110
and understand what it is you're working on.

00:13:20.110 --> 00:13:25.389
And its administrative privileges,
read privileges, and write privileges.

00:13:25.389 --> 00:13:31.730
Under administration, privileges, and I should note that
a lot of our ACL's mirror the Windows ACL and management.

00:13:31.730 --> 00:13:36.620
And this is good for you as administrators,
because it makes us compatible with the UCL world,

00:13:36.620 --> 00:13:42.490
and it also makes it so that our ACL's are not
strange scary Apple ACL's to all the Microsoft guys.

00:13:42.490 --> 00:13:45.590
It gains us a lot of acceptance in the IC server room.

00:13:45.590 --> 00:13:50.600
So these are ones that if you ever admin a
Windows file server, which I have had the glory

00:13:50.600 --> 00:13:54.710
of doom before you're really familiar
with these because it's difficult,

00:13:54.710 --> 00:13:58.590
especially on 2000 to just tak e control
of things and change things around.

00:13:58.590 --> 00:14:03.990
So these two administration privileges are change
permissions which allows the user to change the permissions

00:14:03.990 --> 00:14:10.080
on there or take ownership meaning
you could CH own it basically to you.

00:14:10.080 --> 00:14:15.550
So you can block these two out for regular users, and
then you're pretty well certain that they're not going

00:14:15.549 --> 00:14:17.679
to be able to take any control over anything.

00:14:17.679 --> 00:14:23.359
They're not going to be able to just arbitrarily
change the permissions on your file system.

00:14:23.360 --> 00:14:25.340
We've got read privileges.

00:14:25.340 --> 00:14:29.970
And we've got read attributes, which is things like the time

00:14:29.970 --> 00:14:34.100
and the modification date and creation
date things like that.

00:14:34.100 --> 00:14:38.950
We've got read extended attributes and reading
these EA's allows us to see like our new,

00:14:38.950 --> 00:14:41.200
like the folder EA's, and the finder EA's.

00:14:41.200 --> 00:14:43.710
It also allows us to read the ACL's.

00:14:43.710 --> 00:14:49.230
We also have list folder contents, which
would be like if you did in LS on directory.

00:14:49.230 --> 00:14:52.750
You can read out the contents without
actually going into the directory.

00:14:52.750 --> 00:14:56.389
This also allows you to read the data in a file.

00:14:56.389 --> 00:14:57.809
We have traverse folder.

00:14:57.809 --> 00:15:02.569
This would be like if you type a CD
directory and you actually went inside that.

00:15:02.570 --> 00:15:04.700
And this is what you need to create a drop box.

00:15:04.700 --> 00:15:07.040
Even if you don't give any other read permissions.

00:15:07.039 --> 00:15:11.199
You have to be able to traverse that
file bound the, the directory boundary.

00:15:11.200 --> 00:15:14.410
And this also is equivalent to the execute on a file.

00:15:14.409 --> 00:15:19.919
And then we also have read permissions in this
allows you to read the permissions on a file.

00:15:19.919 --> 00:15:26.599
Even in the server when we go in here and you turn off
all this stuff, and you don't want the user to happen.

00:15:26.600 --> 00:15:29.050
Even if you go in and give them a deny on it.

00:15:29.049 --> 00:15:33.349
It is going to give them a read attributes
and extended attributes and permissions.

00:15:33.350 --> 00:15:39.259
Because how is the finder otherwise going to read the
ACLs to know that he can't let you touch the file?

00:15:39.259 --> 00:15:45.330
You have to be able to see the extended attributes
to be able to know what to do with that file.

00:15:45.330 --> 00:15:47.500
We have some write privileges as well.

00:15:47.500 --> 00:15:49.159
And these are very similar.

00:15:49.159 --> 00:15:51.480
They're pretty much just opposite of the other ones.

00:15:51.480 --> 00:15:56.889
We can write our attributes, which are things like
change the creation date change the modification date.

00:15:56.889 --> 00:16:01.870
We can change the extended attributes,
which would allow someone to edit the ACL.

00:16:01.870 --> 00:16:05.879
You can have, you can create files, which is write data.

00:16:05.879 --> 00:16:08.419
This would be adding files to a fold her.

00:16:08.419 --> 00:16:14.000
You can create a folder which is
also a pending data to a file.

00:16:14.000 --> 00:16:16.929
And we can delete and delete subfolders and files.

00:16:16.929 --> 00:16:22.319
And the key thing here with delete,
delete means this actual item.

00:16:22.320 --> 00:16:30.370
Alright, so deleting this actual item or deleting the
subfolders and files contained within this directory.

00:16:30.370 --> 00:16:37.230
If you want users to be able to rename files and
folders inside a directory they actually have to be able

00:16:37.230 --> 00:16:40.350
to remove it and rename it and drop the file back down.

00:16:40.350 --> 00:16:45.029
So they have to be able to have the delete
subfolders and files to rename files and folders.

00:16:45.029 --> 00:16:51.990
So now we know a little bit about
what the aces are what the ACLs are,

00:16:51.990 --> 00:16:55.269
what our permission possibilities
are and there's a lot of them.

00:16:55.269 --> 00:17:00.850
So one of the things that people get confused on
is how these are actually applied by the system.

00:17:00.850 --> 00:17:08.910
And ACL, as it would sound access control
list is just a list of access control entries.

00:17:08.910 --> 00:17:12.290
And so what we can look that there
is the order of precedence

00:17:12.289 --> 00:17:17.109
that determines how Mac OS X is going
to decide how to act upon those.

00:17:17.109 --> 00:17:21.240
So the thing to remember is one
ACL's are checked first starts,

00:17:21.240 --> 00:17:25.690
if there's any ACL's signed to that it starts there first.

00:17:25.690 --> 00:17:31.090
It starts at the top of the list, and
it just goes one by one down the list.

00:17:31.089 --> 00:17:35.740
The ACL in the POSIX permissions are going to be combined.

00:17:35.740 --> 00:17:39.250
If it doesn't find matches in the
ACL's for what it's looking for.

00:17:39.250 --> 00:17:42.529
It's got a look at the POSIX, and it's
going to composite those two together

00:17:42.529 --> 00:17:45.470
to create what the individual users should be able to see.

00:17:45.470 --> 00:17:49.289
And the POSIX permissions are only
going to be used if no ace matches.

00:17:49.289 --> 00:17:52.779
And that deny ace overrides everything.

00:17:52.779 --> 00:17:59.849
If I tell someone to deny Shawn write to this folder
because the E doesn't need to stick in his head in here.

00:17:59.849 --> 00:18:03.649
What's going to happen is, that's
automatically, in workgroup manager,

00:18:03.650 --> 00:18:08.880
or looking at it with LS is going
to jump to the top of the list.

00:18:08.880 --> 00:18:13.970
And that's a very important security point,
because you don't want to run into conflicts,

00:18:13.970 --> 00:18:23.230
where if I had to deny on Jule and I had an allow
on the CD group team, which Jule's a member of,

00:18:23.230 --> 00:18:28.890
the problem would be if I have that allow
above the deny his explicit deny wouldn't take

00:18:28.890 --> 00:18:33.310
because this thing stops when it finds its match.

00:18:33.309 --> 00:18:37.629
And if it finds an allow before
it finds a deny it lets people in.

00:18:37.630 --> 00:18:42.320
So in order to combat that and make it so you don't
have to worry about it that deny's always jump

00:18:42.319 --> 00:18:44.470
to the top of the list and you can't move them

00:18:44.470 --> 00:18:45.769
You can not bring them down.

00:18:45.769 --> 00:18:48.670
And any deny overrides any allow.

00:18:48.670 --> 00:18:55.220
So you've gone to the situation there where you have
to remember it's kind of like the atomic bomb of ACL's.

00:18:55.220 --> 00:18:58.079
If you put a deny down there that's it.

00:18:58.079 --> 00:19:00.789
Those users that match that aren't going to get in there.

00:19:00.789 --> 00:19:04.779
An evaluation for each requested
permissions stops when that match is found.

00:19:04.779 --> 00:19:08.139
And there's 13 different ones it's going to be looking for.

00:19:08.140 --> 00:19:12.820
So you can have this nested in and we'll look at
some of these in our demo, where we have one group

00:19:12.819 --> 00:19:20.059
that has both a deny and an allow and an enclosing group
one that includes that one all of them layering together

00:19:20.059 --> 00:19:23.049
to build out what the affected
permissions are for that user.

00:19:23.049 --> 00:19:26.720
It can get really complicated really fast.

00:19:26.720 --> 00:19:32.039
So usage and propagation of this, he usages
model that Apple has is fairly simple.

00:19:32.039 --> 00:19:34.170
We apply ACL to folders.

00:19:34.170 --> 00:19:39.130
We don't apply ACL to files (inaudible)
or to tools and application of aces

00:19:39.130 --> 00:19:42.030
to files is only done through inheritance.

00:19:42.029 --> 00:19:46.210
And there are four types of inheritance
you need to consider.

00:19:46.210 --> 00:19:51.519
So we have just applied to this
folder, and when you do this one.

00:19:51.519 --> 00:19:54.779
It doesn't affect anything inside the folder.

00:19:54.779 --> 00:19:59.399
These are things that only apply to that particular item.

00:19:59.400 --> 00:20:01.800
We've apply to child folders.

00:20:01.799 --> 00:20:08.409
So this one used in this method, you notice,
doesn't apply to the parent folder at all.

00:20:08.410 --> 00:20:13.380
It only applies to the child, first level
child folders inside that directory tree.

00:20:13.380 --> 00:20:15.260
Same goes for child files.

00:20:15.259 --> 00:20:20.440
And then if you want to recurs back down all the way
through, you have an apply to all the descendents.

00:20:20.440 --> 00:20:22.580
Notice if you just use apply to all descendents.

00:20:22.579 --> 00:20:25.009
It doesn't apply to the parent folder here.

00:20:25.009 --> 00:20:28.430
So you're going to have to mix and match
these to come up with the ones you want.

00:20:28.430 --> 00:20:34.500
By default when you define an ace it's going to put
all of them down so that it automatically applies

00:20:34.500 --> 00:20:37.390
to the parent folder, and everything in it.

00:20:37.390 --> 00:20:40.560
Now when I say, it automatically
applies to everything in it.

00:20:40.559 --> 00:20:46.710
That's the place where were different from the Windows
systems and that we do not do automatic ACL propagation

00:20:46.710 --> 00:20:50.170
when you click the okay button or the save button.

00:20:50.170 --> 00:20:52.800
We have to propagate these things down.

00:20:52.799 --> 00:20:59.349
And propagation of ace, ACL's only happens
in Mac OS X at two very specific times.

00:20:59.349 --> 00:21:06.159
One of them is a follow directory creation time, the kernel
will actually apply that ACL to that new file or new folder.

00:21:06.160 --> 00:21:12.730
Or you could use an administrative tool that propagation
tool in server admin on Leopard or (inaudible) manager

00:21:12.730 --> 00:21:20.829
on Tiger or CH mod you could use also to apply recursively
just like you always do, although Shawn will probably,

00:21:20.829 --> 00:21:27.039
not like I say, doing ACL's from the command
line to do complex ones gets very cumbersome.

00:21:27.039 --> 00:21:28.579
They're very long.

00:21:28.579 --> 00:21:30.509
And they'll show you some of these and what they look like.

00:21:30.509 --> 00:21:36.180
But if one of these two events
does not happen no ACL's propagate.

00:21:36.180 --> 00:21:42.440
Time and time again I've seen a SysAdmin that
goes in selects that parent folder in their tree,

00:21:42.440 --> 00:21:50.380
turns in all their inheritance bits, clicks save, and
then calls their alliance line because nothing happened.

00:21:50.380 --> 00:21:53.920
Well, nothing happened because
nothing triggered the propagation.

00:21:53.920 --> 00:21:59.370
So you do have to be aware of that.

00:21:59.369 --> 00:22:03.369
So like I said, setting the inherent in
its will not automatically propagate ACL's.

00:22:03.369 --> 00:22:08.909
Again, if you have ever been blessed with being a Windows
server adminal arch file server you probably know the pain

00:22:08.910 --> 00:22:15.820
of changing one ace in an ACL, clicking okay, then having
Windows Explorer sit there and just kind of hang on you

00:22:15.819 --> 00:22:19.859
for 25 minutes, while it recourses
through some giant directory going

00:22:19.859 --> 00:22:21.939
down through the tree and applying that change.

00:22:21.940 --> 00:22:23.980
I really like the way we do it more.

00:22:23.980 --> 00:22:28.940
And I do really also like the propagation tool because
of the control it gives you over what you propagate.

00:22:28.940 --> 00:22:33.039
And we'll take a look at that in our demo as well.

00:22:33.039 --> 00:22:35.230
So this is a Leopard sort of session.

00:22:35.230 --> 00:22:37.000
So we're going to talk about Leopard tools.

00:22:37.000 --> 00:22:41.960
On all these same sort of ideas here
apply to workgroup manager on Tiger.

00:22:41.960 --> 00:22:47.200
If any of you have taken your little Leopard disc out so
far, and popped it in a machine with the fly ware drive

00:22:47.200 --> 00:22:50.840
and the Ethernet cable and something else
to plug in to get the nick to come active.

00:22:50.839 --> 00:22:54.839
And you booted up OS X server, and
you found that file sharing is now

00:22:54.839 --> 00:22:58.319
in server admin is no longer in workgroup management.

00:22:58.319 --> 00:23:01.929
So this is the easiest tool to use on
Mac OS server to be able to do this.

00:23:01.930 --> 00:23:05.840
It allows for easy creation of ACL's.

00:23:05.839 --> 00:23:11.649
It allows for custom ace creation, which are
very nice just little clicky clicky boxes.

00:23:11.650 --> 00:23:13.500
We can propagate these tools down.

00:23:13.500 --> 00:23:15.339
And we'll look at this a bit more in our demo.

00:23:15.339 --> 00:23:17.159
But notice our propagation tool.

00:23:17.160 --> 00:23:18.920
I have all kinds of flexibility.

00:23:18.920 --> 00:23:22.500
I could just push out the group owner of these files.

00:23:22.500 --> 00:23:27.660
I could just push out the everyone's permissions,
the POSIX owner, and the ACL's if I wanted.

00:23:27.660 --> 00:23:29.740
Generally, I end up just using this for ACL's.

00:23:29.740 --> 00:23:34.039
This is also how you can remove ACL's
very quickly from your tree as well.

00:23:34.039 --> 00:23:38.220
But it propagates down very selectively what you need to go.

00:23:39.289 --> 00:23:42.889
We have the effect of permission
inspector, which now looks different.

00:23:42.890 --> 00:23:45.980
It's got the HUD display, because this is a media ap.

00:23:45.980 --> 00:23:52.690
And so we can use this to evaluate
what we're going through, and we can,

00:23:52.690 --> 00:23:57.850
we can use this to effectively take a
look at that complex composting of that.

00:23:57.849 --> 00:24:02.969
And we will show you a little bit of this
in our demo with a few little caveats.

00:24:02.970 --> 00:24:13.130
So I'm going to switch over to my demo machine
now, which looks like the screen has dimmed on.

00:24:13.130 --> 00:24:14.350
There we are.

00:24:14.349 --> 00:24:18.709
And we're going to take a look here, and
we're going to do a very quick little demo.

00:24:18.710 --> 00:24:24.150
A word of caution here, we do seem to
have a couple of challenges currently

00:24:24.150 --> 00:24:26.350
with the effective permissions manager in this build.

00:24:26.349 --> 00:24:30.099
So the effective permissions manager may
not be showing us exactly what is right.

00:24:30.099 --> 00:24:32.039
But it is actually functioning.

00:24:32.039 --> 00:24:35.670
And it will be fixed well before you
guys try to put this in production

00:24:35.670 --> 00:24:37.930
and well before we ship the first production builds at this.

00:24:37.930 --> 00:24:41.880
So I wouldn't worry about it too terribly much.

00:24:41.880 --> 00:24:46.130
When you're using file system, ACL's generally
were going to go ahead and were going to use it

00:24:46.130 --> 00:24:48.730
in a file sharing sort of sense here on server.

00:24:48.730 --> 00:24:53.120
And a lot of times, you know, you've got users you want to
keep out of things and users you want to let into things

00:24:53.119 --> 00:24:56.199
and users you want to restrict how much access they have.

00:24:56.200 --> 00:25:01.170
So we're going to take a look at this demo
and we're just going to very easily go

00:25:01.170 --> 00:25:03.230
through and create a small file structure.

00:25:03.230 --> 00:25:05.759
We're going to limit some users and allow others in.

00:25:05.759 --> 00:25:11.819
So we have this pretend design firm here, which is, you
know creative market's a big part Apple's market place.

00:25:11.819 --> 00:25:13.389
And we have a couple different groups.

00:25:13.390 --> 00:25:16.400
We've got designers, freelancers and managers.

00:25:16.400 --> 00:25:20.720
Alright? Now in workgroup manager here,
we can also take a look at these groups.

00:25:20.720 --> 00:25:24.410
If I were to look at the user, you can
see the inherited groups come down,

00:25:24.410 --> 00:25:29.330
because I actually have another group called
global for applying these global changes.

00:25:29.329 --> 00:25:35.389
Now when you're looking at doing administration on
your servers you might be tempted to use everyone here.

00:25:35.390 --> 00:25:41.100
The problem with using everyone for defining file
system writes is that everyone means everyone else.

00:25:41.099 --> 00:25:45.009
It's everyone you didn't specifically
defined in a previous access control.

00:25:45.009 --> 00:25:50.549
So it includes Cyrus iMap, and includes the
Web server user, it includes all that stuff.

00:25:50.549 --> 00:25:57.180
And if we're defining file system privileges for file
sharing to a specific group of people we probably don't want

00:25:57.180 --> 00:26:00.490
to have to worry about having all these
other users that we normally don't think

00:26:00.490 --> 00:26:03.650
about inside the system having access to our file systems.

00:26:03.650 --> 00:26:09.600
So I tend to make another group called Goebel
or file sharing or whatever and then I just nest

00:26:09.599 --> 00:26:12.859
in my other group of users that I want to use.

00:26:12.859 --> 00:26:19.069
So the managers are going to need full access to everything
the full control set which, is one of our defaults.

00:26:19.069 --> 00:26:21.179
It means they can do what ever they want to anything.

00:26:21.180 --> 00:26:23.940
They automatically get and allow on every single thing.

00:26:23.940 --> 00:26:24.960
We've got designers.

00:26:24.960 --> 00:26:30.079
And these designers are going to need access
to everything read wise, but not right wise.

00:26:30.079 --> 00:26:34.000
We have a manager's folder that we
want them to have no access to it all.

00:26:34.000 --> 00:26:36.710
And we want them to be able to
move things around between folders.

00:26:36.710 --> 00:26:38.990
And then we have these lowly freelancers.

00:26:38.990 --> 00:26:43.670
These are probably college kids may be
high school dropouts that you had to hire

00:26:43.670 --> 00:26:46.960
and work your way at night building your new ad campaign.

00:26:46.960 --> 00:26:52.340
So we only want them to have read write access to
the freelancers area and then we want a drop box

00:26:52.339 --> 00:26:56.079
that they're supposed to put their finished work in
that they can't get it back out, because you know,

00:26:56.079 --> 00:26:59.939
they were on my space or something like that and they
dropped their own file in and you want to be able

00:26:59.940 --> 00:27:02.500
to catch them at that so you can get rid of them.

00:27:02.500 --> 00:27:07.369
So if you're using Tiger, one of the,
this is where your sharing will be.

00:27:07.369 --> 00:27:11.669
Now in Tiger, there is, you have
to make sure the ACL's are enabled.

00:27:11.670 --> 00:27:13.130
In Leopard it's a default state.

00:27:13.130 --> 00:27:15.210
And later builds of Tiger it's a default state

00:27:15.210 --> 00:27:19.860
But in Tiger and workbook manager there
actually is a checkbox in the sharing pane.

00:27:19.859 --> 00:27:22.559
To enable access control lists on this volume.

00:27:22.559 --> 00:27:27.200
And it actually gives you a funny little warning,
it says warning, this gives you lots of control,

00:27:27.200 --> 00:27:28.809
you know, which is usually why I turn it on.

00:27:28.809 --> 00:27:31.889
But like I said I don't want the power going to my head.

00:27:31.890 --> 00:27:36.950
But you can check that with, in
that tool you can also enable them

00:27:38.470 --> 00:27:43.750
with the file system ACL control
application at the command line.

00:27:43.750 --> 00:27:48.490
And you can use this to enable or disable
ACL's on a particular volume as well.

00:27:48.490 --> 00:27:52.089
But in Leopard it's all on by default so we
don't have to worry about turning it on anywhere.

00:27:52.089 --> 00:27:54.730
And we can go right ahead to building things.

00:27:54.730 --> 00:27:56.460
So I'm gonna switch over to server admin.

00:27:56.460 --> 00:28:01.940
And look at the nice sign in server
admin if no one's seen that yet.

00:28:01.940 --> 00:28:05.970
And our file sharing tab is just right here
in the middle and we can see our directories.

00:28:05.970 --> 00:28:09.259
I've got my main drive and I've got my backup drive.

00:28:09.259 --> 00:28:13.390
So we can go ahead and switch this
over to volumes and we're gonna browse.

00:28:13.390 --> 00:28:15.630
And I'm gonna make a new folder on server.

00:28:15.630 --> 00:28:18.340
And I'm gonna call it AFP design.

00:28:21.809 --> 00:28:23.919
Okay there's AFP design.

00:28:23.920 --> 00:28:25.850
And then I want to share this item.

00:28:25.849 --> 00:28:33.789
So I will share this item and then I can switch over to
my share points and eventually it will show up there.

00:28:33.789 --> 00:28:45.629
Save changes, there it is okay just to the second.

00:28:45.630 --> 00:28:50.540
And then on the permissions tab we have
got what we want our permissions to be.

00:28:50.539 --> 00:28:53.539
So we're going to go ahead and we're going to, the
first thing we're going to do is we're going to,

00:28:53.539 --> 00:28:55.710
lets get rid of most of this POSIX stuff.

00:28:55.710 --> 00:28:57.720
This is an exercise in ACL's.

00:28:57.720 --> 00:29:03.259
So I want this to be done by the
local admin user on the box.

00:29:03.259 --> 00:29:11.559
And I don't want any writes for groups or and I don't want
any writes for the others, which again should be everyone.

00:29:11.559 --> 00:29:13.789
We'll take a look here at permissions now.

00:29:13.789 --> 00:29:18.379
So now we can see the writes on this are very
restricted right now from a POSIX standpoint.

00:29:18.380 --> 00:29:21.620
So we're gonna start to build this out.

00:29:21.619 --> 00:29:26.889
So we want to make a folder inside here
which I can use the new folder button for.

00:29:26.890 --> 00:29:31.740
And the first folder we're gonna make is
called, we're gonna make one called managers.

00:29:31.740 --> 00:29:38.420
Okay, and you kinda have to click
on and off here, there it is.

00:29:38.420 --> 00:29:40.720
We're gonna make one called jobs.

00:29:40.720 --> 00:29:53.190
And we're gonna make one called freelance
as soon as that one shows up, now freelance.

00:29:53.190 --> 00:30:03.519
Okay, and let's figure out where to put those.

00:30:03.519 --> 00:30:05.490
I put them in the wrong place.

00:30:05.490 --> 00:30:08.690
So I'll do it with this actually,
this probably works better.

00:30:08.690 --> 00:30:13.769
Jobs, there we go, and freelance.

00:30:13.769 --> 00:30:19.750
Okay, so we'll jump back to our share points now.

00:30:19.750 --> 00:30:25.549
Now when I start defining my ACL's and I start
thinking about how I'm gonna plan these things out,

00:30:25.549 --> 00:30:30.329
I find it's probably best to do the broad strokes first.

00:30:30.329 --> 00:30:35.449
In this case I am gonna make one more
folder called drop box in here just

00:30:35.450 --> 00:30:40.380
so we can see a little bit deeper
hierarchy and how things go together.

00:30:40.380 --> 00:30:44.040
And this is really decided it wants to ignore me today.

00:30:44.039 --> 00:30:49.569
and of course I've messed things up
with those rights but we'll get there.

00:30:49.569 --> 00:30:50.779
There we go, alright.

00:30:50.779 --> 00:30:53.940
So I want thing about the broad strokes and how things work.

00:30:53.940 --> 00:31:00.000
So in this case I know that the
managers need full control to everything.

00:31:00.000 --> 00:31:02.000
So that's an easy one to define.

00:31:02.000 --> 00:31:06.089
I can just come in and drop them in and then
I can have manager full control everything

00:31:06.089 --> 00:31:08.099
and I can propagate that to everything.

00:31:08.099 --> 00:31:10.209
So I'll just pull up my groups here real fast.

00:31:10.210 --> 00:31:13.720
And I'll grab my managers group and I'll drop that in there.

00:31:13.720 --> 00:31:16.410
And then here you can see our defaults.

00:31:16.410 --> 00:31:20.240
Our defaults are we do all four methods
of inheritance right off the top.

00:31:20.240 --> 00:31:23.380
Our default is also an allow and our default is a read only.

00:31:23.380 --> 00:31:25.270
It's a nice safe default.

00:31:25.269 --> 00:31:29.480
It doesn't give anyone access to go in
and mess anything up, which is, you know,

00:31:29.480 --> 00:31:33.700
one of the points of being an administrator is
you don't want them messing with your stuff.

00:31:33.700 --> 00:31:37.420
so, in this case though I want it to be a full
control because these are the people that, you know,

00:31:37.420 --> 00:31:40.880
write the checks and they need to be able
to have control to everything in this case.

00:31:40.880 --> 00:31:42.670
So I'm gonna switch to a full control.

00:31:42.670 --> 00:31:47.050
All that full control means is it
gives every single write possible.

00:31:47.049 --> 00:31:50.379
It gives the, it goes through the
ace and it defines every single one.

00:31:50.380 --> 00:31:55.860
And if we were to look at that actual that ace
in depth here we could see that all that does

00:31:55.859 --> 00:31:58.729
and it comes through and it just checks every box.

00:31:58.730 --> 00:32:03.490
And we'll look at creating some
custom aces here in just a moment.

00:32:03.490 --> 00:32:07.460
So I click okay on that I click save.

00:32:07.460 --> 00:32:12.509
Now if I go back in, wait for it to stop pin wheeling.

00:32:12.509 --> 00:32:17.170
( Silence )

00:32:17.170 --> 00:32:20.529
And this is acting even more strangely than it was before.

00:32:20.529 --> 00:32:21.670
There we go, okay.

00:32:21.670 --> 00:32:23.500
So now you can see that's on there.

00:32:23.500 --> 00:32:28.690
But if I click on one of these
other items, I don't have any ACL's.

00:32:28.690 --> 00:32:35.930
I remember that's because it doesn't propagate automatically
just because I told it you're gonna be able to inherit down.

00:32:35.930 --> 00:32:38.480
You have to actually go through that process manually.

00:32:38.480 --> 00:32:40.000
So that's pretty easy to do.

00:32:40.000 --> 00:32:42.230
we'll select AFP design here.

00:32:42.230 --> 00:32:44.910
and I'll pull up the propagations permissions tool.

00:32:44.910 --> 00:32:46.810
And in here I do have all these different options.

00:32:46.809 --> 00:32:48.139
Can everyone see that alright?

00:32:48.140 --> 00:32:53.550
Good. I can propagate any of the POSIX things
and I can do these on an individual basis.

00:32:53.549 --> 00:32:56.190
I don't have to just say POSIX or ACL's.

00:32:56.190 --> 00:33:02.049
I can actually pick the owner name and the everyone
permission and then the access control list.

00:33:02.049 --> 00:33:05.470
In this case we're going to go ahead
and propagate everything down so

00:33:05.470 --> 00:33:09.350
that everything is owned up and
looks like this enclosing folder.

00:33:09.349 --> 00:33:15.480
Click okay, it grinds away for a minute there, okay.

00:33:15.480 --> 00:33:19.849
And if we look at it we should start
seeing that they did in fact inherit down

00:33:19.849 --> 00:33:21.269
So now we cans tart drilling down.

00:33:21.269 --> 00:33:22.819
And these are inherited.

00:33:22.819 --> 00:33:28.220
And you can tell they're inherited because they're
gray and they aren't available for editing.

00:33:28.220 --> 00:33:33.769
If I double click on one notice it's
there but I can't do anything to it.

00:33:33.769 --> 00:33:36.019
It's not an explicit ACL.

00:33:36.019 --> 00:33:40.329
In Tiger there's actually a little
inherited yes no box as well that you'll see.

00:33:40.329 --> 00:33:43.159
But here this is one with a nicer simpler interface.

00:33:43.160 --> 00:33:47.650
They're easy to tell apart so the actual yes
no inherit thing was a little bit redundant

00:33:47.650 --> 00:33:51.360
because if you can't make changes to
it and it's grayed out it's inherited.

00:33:51.359 --> 00:33:54.829
Now I can perform options actions
on all these inherited ACL's.

00:33:54.829 --> 00:33:59.129
I could come in and I could remove my inherited entries

00:33:59.130 --> 00:34:02.050
which then remove the inherited
entries from that file or folder.

00:34:02.049 --> 00:34:04.899
And I could also make these explicit
and then I could further edit them

00:34:04.900 --> 00:34:07.630
from that point and then they'll propagate down again.

00:34:07.630 --> 00:34:15.869
as long as I don't go back to the root and do a forced
propagation again or somehow magically recreate that file

00:34:15.869 --> 00:34:22.869
in some way that it just kind of is reborn, then it's not
gonna pick up that original inherited again because one

00:34:22.869 --> 00:34:25.289
of the two key operations is not happening.

00:34:25.289 --> 00:34:30.139
It's just gonna stay in an explicit state.

00:34:30.139 --> 00:34:31.940
So, we're not gonna change anything on that right now.

00:34:31.940 --> 00:34:35.769
But what we're gonna do is, I'm gonna pull out, and here's
the part of the demo that might get a little bit hairy.

00:34:35.769 --> 00:34:39.630
I'm gonna pull out the affected permissions inspector.

00:34:39.630 --> 00:34:45.410
Now when you are working on ACL's
leave this guy up on the screen.

00:34:45.409 --> 00:34:47.639
Okay? Just leave it there, put it in the corner.

00:34:47.639 --> 00:34:50.379
You all have twin 30 inch displays for a reason.

00:34:50.380 --> 00:34:57.170
And so you can use that and you can put this over on
one and, you know, everything's on the other screens.

00:34:57.170 --> 00:35:03.309
So, in this case you can see what directory
I'm looking at, what user I'm evaluating.

00:35:03.309 --> 00:35:06.699
And this will look so much better than the
one on Windows I'll tell you that for sure.

00:35:06.699 --> 00:35:11.239
But I can take in a user notice it's user not group.

00:35:11.239 --> 00:35:15.079
And in fact, if I try to drop a group in there I can't.

00:35:15.079 --> 00:35:21.639
That is the way it works by default because you really
can't evaluate the permissions for a group in that way.

00:35:21.639 --> 00:35:29.339
So I'm going to drop in myself being a manager and
looks like drop box, and of course it doesn't do.

00:35:29.340 --> 00:35:30.650
So we'll go back here.

00:35:30.650 --> 00:35:33.360
This is the part that's acting a little bit strange.

00:35:33.360 --> 00:35:35.480
It's okay, we'll work through it.

00:35:35.480 --> 00:35:39.570
So this one normally then would light up and
it will show me everything down the line.

00:35:39.570 --> 00:35:45.050
It gives checks for the things I have, if there's
a group that I don't have complete control

00:35:45.050 --> 00:35:47.730
over you get the little minus tick mark there.

00:35:47.730 --> 00:35:51.510
If there's an area that I do have complete
control over you'll see a checkbox there.

00:35:51.510 --> 00:35:55.640
And I can actually show you some of these in a couple
different places let me put local admin in there.

00:35:55.639 --> 00:35:56.460
There we go.

00:35:56.460 --> 00:36:00.220
Local admin is a local admin on the box
and he is the POSIX read and write owner.

00:36:00.219 --> 00:36:07.239
So notice he's not in the manager's group, but it composites
those writs out so that he has all these writes here.

00:36:07.239 --> 00:36:09.939
And the tool is working very nicely
for showing those results.

00:36:09.940 --> 00:36:12.389
It's just getting confused on the multiple ACL's.

00:36:12.389 --> 00:36:16.019
If I looked around the rest of the
file system here, I can easily see,

00:36:16.019 --> 00:36:18.900
and it keeps the user I'm looking at what their writes are.

00:36:18.900 --> 00:36:20.240
There's a full control.

00:36:20.239 --> 00:36:23.309
If I were to drop another use them
on the system in there though.

00:36:23.309 --> 00:36:25.650
You can see, the default writes that you have.

00:36:25.650 --> 00:36:30.960
So this would be if I click on it to 755 permissions.

00:36:30.960 --> 00:36:36.460
And notice that we have in this case, a custom
everyone deny this is injured by default.

00:36:36.460 --> 00:36:37.960
I did not create this.

00:36:37.960 --> 00:36:42.849
We are moving on at Apple to using
ACL's more and more as we can.

00:36:42.849 --> 00:36:45.190
And if we were to look at what this was denying here.

00:36:45.190 --> 00:36:49.349
We can see, it denies delete, and it denies the inheritance.

00:36:49.349 --> 00:36:52.710
So by denying the delete.

00:36:52.710 --> 00:36:57.130
It means that everyone can not delete that.

00:36:58.250 --> 00:37:03.000
If I were to look at another user in their
you can see that Jule just has those options.

00:37:03.000 --> 00:37:07.739
And if I were to look at the drop
box can see it's a drop box.

00:37:07.739 --> 00:37:09.609
Not drop boxes, traditionally when you may be.

00:37:09.610 --> 00:37:16.400
You could just do read write in everyone and you just
would do read only read write and execute for the owner

00:37:16.400 --> 00:37:18.960
and you would just do write and
execute for the other people.

00:37:18.960 --> 00:37:22.079
But here we actually have a little
more complication going on.

00:37:22.079 --> 00:37:26.639
We have read attributes and we have
traverse folder and read permissions.

00:37:26.639 --> 00:37:29.989
And then under right we have everything except delete.

00:37:29.989 --> 00:37:35.879
So deleting the subfolders and files, which is
something they can't do because they can't actually go

00:37:35.880 --> 00:37:41.980
into the folder, although they can traverse the
folder, which is the part that confuses most people.

00:37:41.980 --> 00:37:46.599
And so they can actually change the contents of
that directory, because really what is a directory.

00:37:46.599 --> 00:37:48.440
It's kind of, it's a record of things in the area.

00:37:48.440 --> 00:37:52.720
It isn't actually a bucket that
stuff is stacked up in its actually,

00:37:52.719 --> 00:37:56.549
when you change the contents of
that folder, you're changing that.

00:37:56.550 --> 00:38:02.970
So, in this case we need to traverse so you can actually
put something in there, if you don't have the traverse,

00:38:02.969 --> 00:38:11.039
if you just came through with an ACL and told that I
want to allow write one day be able to delete the file,

00:38:11.039 --> 00:38:17.090
which also depends on the enclosing folder writes,
and the other one is that they would be able.

00:38:17.090 --> 00:38:20.680
They would not be able to actually put anything
in it, because they cannot traverse the boundary

00:38:20.679 --> 00:38:24.149
of that directory to be able to drop anything in there.

00:38:26.409 --> 00:38:31.219
And I'm going to continue to just look around here
a bit in the system so that we can see this stuff.

00:38:31.219 --> 00:38:33.189
And we can evaluate different users.

00:38:33.190 --> 00:38:39.740
Notice in the share they can't delete, local admin,
Jule, they cannot have access, it just has read access.

00:38:39.739 --> 00:38:43.029
But the actual local admin has the regular amount of access.

00:38:43.030 --> 00:38:44.630
Notice on OS X server.

00:38:44.630 --> 00:38:49.690
We don't give them the ability to delete the home
folder, because that would be a fun phone call.

00:38:49.690 --> 00:38:53.210
I just threw it in the trash, but it's on the server.

00:38:53.210 --> 00:38:55.269
So you have a backup right.

00:38:55.269 --> 00:39:00.739
So, in this case will go through here and take a
look at, because these it is evaluating properly.

00:39:00.739 --> 00:39:04.919
We're going to get brave though and kind
of try to soldier back through here.

00:39:04.920 --> 00:39:10.340
So taking a look in here with local admin,
if we look at Justice entry level point here,

00:39:10.340 --> 00:39:15.519
which it should work okay on this, and I put in a manager.

00:39:15.519 --> 00:39:17.960
And of course it's not working properly on that.

00:39:17.960 --> 00:39:24.829
But what you would see normally is, it would be all full
and in this case any other user that wasn't local admin

00:39:24.829 --> 00:39:28.849
or inside this managers group would have
no access to the share point whatsoever.

00:39:28.849 --> 00:39:32.909
When they connect with AFP, we do our
nice share point enumeration with AFP.

00:39:32.909 --> 00:39:36.019
So that people can actually see share
points that they can't connect to.

00:39:36.019 --> 00:39:39.710
With SNB without tuning in a bit, you
know, you get all the share points anyway.

00:39:39.710 --> 00:39:42.000
And then you get a nasty message when you try to use it.

00:39:42.000 --> 00:39:46.619
But in this case we would need to allow more
people to have read access to everything.

00:39:46.619 --> 00:39:49.049
Otherwise, they don't even get to the share point.

00:39:49.050 --> 00:39:54.470
If I were to come through here and in
freelance on the freelancer folder I were

00:39:54.469 --> 00:40:00.529
to give them my freelance group write access to this because
this is an area they need to be able to get into and use.

00:40:00.530 --> 00:40:08.500
So I'm gonna give them read and write it applies to only
this folder because I do not want and it only applies,

00:40:08.500 --> 00:40:12.329
actually it does apply to all the descendants, excuse me.

00:40:12.329 --> 00:40:16.590
So we'll click that button and
then we'll propagate that down.

00:40:16.590 --> 00:40:18.070
Or actually we don't even have to.

00:40:18.070 --> 00:40:21.600
so if we propagated it down then
we'd have to remove it from here.

00:40:21.599 --> 00:40:25.409
but in this case because propagation's
not automatic it doesn't go.

00:40:25.409 --> 00:40:30.000
So I didn't have to go back and clean
up the ACL I didn't want on there.

00:40:30.000 --> 00:40:32.739
So, in this case now, the freelance
folder has two different ones.

00:40:32.739 --> 00:40:36.500
It's got managers full control and
it's got freelancers read and write.

00:40:36.500 --> 00:40:43.420
The EPI on Tiger and when this one gets working all the
way will show for any member of the freelancer's group

00:40:43.420 --> 00:40:47.650
that they have no access to this folder,
which seems completely counter intuitive

00:40:47.650 --> 00:40:50.340
to what the aces actually say on the screen.

00:40:50.340 --> 00:40:54.800
And the reason it will tell you that is because
they don't have access to get to that folder.

00:40:54.800 --> 00:41:00.330
And if you can't actually traverse the tree far
enough to get there then you don't have any access.

00:41:00.329 --> 00:41:02.829
So, in this case what we need to do is add our global group

00:41:02.829 --> 00:41:07.519
and give our global group a read
only to the route of the file share.

00:41:07.519 --> 00:41:08.829
So, that's a pretty easy thing to do.

00:41:08.829 --> 00:41:15.489
and this is a reason I like to create these groups
that are just generic groups for file sharing.

00:41:15.489 --> 00:41:20.819
This group would only contain users I wanted
to actually connect in a file sharing way.

00:41:20.820 --> 00:41:27.100
So I'll click save on that and then I will propagate it
down because that's another one of those broad strokes

00:41:27.099 --> 00:41:30.250
that you may not notice the first time
when you're trying to set this up.

00:41:30.250 --> 00:41:34.750
And in this case we just wanna propagate the ACL's.

00:41:34.750 --> 00:41:36.010
And it's gonna propagate that real fast.

00:41:36.010 --> 00:41:42.220
And then when we take a look now we can see
we've got that global and that managers in there.

00:41:42.219 --> 00:41:48.109
Now I'm not gonna go through all the creation of the drop
box when I already showed you guys the drop box writes.

00:41:48.110 --> 00:41:53.370
The important ones to remember when we
look at the drop boxes if I click back

00:41:53.369 --> 00:41:56.920
through and look at local admin's drop box here.

00:41:58.150 --> 00:41:59.240
these are the important ones to remember.

00:41:59.239 --> 00:42:02.149
You gotta be able to read the attributes,
read the permissions,

00:42:02.150 --> 00:42:04.340
traverse the folder, and just don't let them delete it.

00:42:04.340 --> 00:42:06.990
And that creates a drop box with an ACL.

00:42:06.989 --> 00:42:11.579
It's a different way to do it than with the POSIX
command, POSIX permissions but it will allow you to create

00:42:11.579 --> 00:42:14.299
that drop box so that it's not a big issue.

00:42:14.300 --> 00:42:20.190
So before I put everyone to sleep with this enormously long
demo, I'm gonna go ahead and show you one last thing here.

00:42:20.190 --> 00:42:23.309
And that is the ultimate power of the deny.

00:42:23.309 --> 00:42:27.039
So, we only want managers to be able to get in here.

00:42:27.039 --> 00:42:34.210
and in this case let's pretend, for whatever reason,
I don't know why, I don't wanna remove my global read.

00:42:34.210 --> 00:42:40.210
So right now I've got a situation where I could
have people be able to go in here and get in,

00:42:40.210 --> 00:42:47.840
and actually now that I think about it what's
wrong about, no that one does work, so.

00:42:47.840 --> 00:42:50.039
I'm gonna take a look at my managers folder.

00:42:50.039 --> 00:42:51.670
And I don't wanna remove that global read.

00:42:51.670 --> 00:42:54.849
Manager's full control, great that's what they need.

00:42:54.849 --> 00:43:01.949
So, what I need to do though is take designers
and freelancers and this will be a situation

00:43:01.949 --> 00:43:08.899
where I could use the everyone also to go ahead and clean
up everything else on the system as well to deny this out.

00:43:08.900 --> 00:43:09.960
And I'm gonna make these denys.

00:43:09.960 --> 00:43:15.159
And I'm gonna make them full controls.

00:43:15.159 --> 00:43:22.849
And now when I save that, and I go
back to my folder, there at the top.

00:43:22.849 --> 00:43:30.099
So even if I really messed up and I said oh yeah them adding
my controls freelancer allow oh I gotta get out of here.

00:43:30.099 --> 00:43:33.139
I gotta get home my favorite show's on.

00:43:33.139 --> 00:43:36.539
I don't want to be able to give that allow and mess it up.

00:43:36.539 --> 00:43:40.779
So even if I fat fingered it and
I gave the freelancers full access

00:43:40.780 --> 00:43:48.160
to the accounting data this isn't gonna make me get run out
on some sort of sox petard because they're not gonna be able

00:43:48.159 --> 00:43:53.299
to come get me because we've reordered that
ace automatically to put that deny at the top.

00:43:53.300 --> 00:43:57.010
So, I could go and add as many
allows as I'd like for people.

00:43:57.010 --> 00:43:59.230
But, that deny is gonna stop them in their tracks.

00:43:59.230 --> 00:44:03.130
It's not gonna let them in and it's gonna override them.

00:44:03.130 --> 00:44:06.510
Okay, so we're gonna switch back to the slides now.

00:44:06.510 --> 00:44:13.710
( Silence )

00:44:13.710 --> 00:44:15.720
All that essentially works the same on Tiger.

00:44:15.719 --> 00:44:17.419
You just do it in work group manager.

00:44:17.420 --> 00:44:24.950
I wanted to show it in server admin because
that's a major change of where those controls are.

00:44:24.949 --> 00:44:28.419
The next little bit we're gonna talk
about is service access controls.

00:44:28.420 --> 00:44:31.820
This is something that's slowly been
creeping into the OS a little bit.

00:44:31.820 --> 00:44:35.300
Anyone in here run a 10 3 VPN server?

00:44:35.300 --> 00:44:36.280
Yeah a couple hands.

00:44:36.280 --> 00:44:41.290
That had a SACL in it, remember, you could
restrict VPN access to a specific group of users.

00:44:41.289 --> 00:44:43.480
Well this allows us to do this for everything.

00:44:43.480 --> 00:44:44.869
And we get a bunch of different fun ones.

00:44:44.869 --> 00:44:47.799
And in Leopard now we get them on the client's side too.

00:44:47.800 --> 00:44:50.850
So we can get a lot more granular about
who can do things without having to go

00:44:50.849 --> 00:44:53.869
and edit SSH comp files and all that stuff.

00:44:53.869 --> 00:45:00.880
so, what a service access controlled list does is
essentially it's finery control of who can do what.

00:45:00.880 --> 00:45:05.990
Who can access what services on
that box, whether it's a client,

00:45:05.989 --> 00:45:09.799
whether it is a server machine
you can start controlling this.

00:45:09.800 --> 00:45:16.690
For example you could restrict FTP access, wonderful
clear FTP, and you could restrict that down to just very

00:45:16.690 --> 00:45:23.420
under privileged users that are not critical that have
extremely tight access on the system and things like that.

00:45:23.420 --> 00:45:28.119
So that that way, you don't have some
admin user, while some guys outside

00:45:28.119 --> 00:45:31.989
with a wire crack, and he's taken a look at your system.

00:45:31.989 --> 00:45:36.399
And all of a sudden he sees an admin log in
with FTP in the clear, that's a bad thing.

00:45:36.400 --> 00:45:38.940
So this will be able to deny users from doing that.

00:45:38.940 --> 00:45:41.269
SACL's also have a really cool trick.

00:45:41.269 --> 00:45:43.909
And districts actually in the documentation now too.

00:45:43.909 --> 00:45:48.429
And it's been documented on afp548
dot com and a couple other websites.

00:45:48.429 --> 00:45:55.329
This is a cool way you can use an OS X server a mail server
to provide mail access from non open directory accounts.

00:45:55.329 --> 00:45:58.150
And we'll talk about that in just a minute.

00:45:58.150 --> 00:46:03.930
But on Mac OS X, the non-server version, the
SACL's again there are fine grained control,

00:46:03.929 --> 00:46:07.419
and you can restrict access to specific groups or users.

00:46:07.420 --> 00:46:09.780
And we do this in system preferences.

00:46:09.780 --> 00:46:14.820
It used to be you did this in (inaudible) manager and
other places kind of got real hacky about it on your Tiger.

00:46:14.820 --> 00:46:15.960
But it all worked.

00:46:15.960 --> 00:46:22.280
But in this case, we're going to use the
system preferences to set up our SACL's.

00:46:22.280 --> 00:46:23.550
And it's pretty easy.

00:46:23.550 --> 00:46:25.450
Most of them are found in the sharing panel.

00:46:25.449 --> 00:46:26.489
And in this case, you can see.

00:46:26.489 --> 00:46:28.709
I restrict it down to only these users.

00:46:28.710 --> 00:46:33.679
The plus and minus buttons here are really cool, and they'll
look out in directory services and other places like that.

00:46:33.679 --> 00:46:35.949
So you can kind of get in there
and get really granule with this.

00:46:35.949 --> 00:46:38.569
You can do this on just about everything.

00:46:38.570 --> 00:46:42.170
So I can control is allowed to as SSH into my box.

00:46:42.170 --> 00:46:48.639
I can control who can send a remote Apple
events in my box, which prevents so many pranks.

00:46:48.639 --> 00:46:51.819
It's almost hardly worth turning on if it's not your system.

00:46:51.820 --> 00:47:00.180
On Mac OS X server, we have more levels of these now and
in this case now, any server on the box can be restricted.

00:47:00.179 --> 00:47:05.019
We can restrict this big long list of
stuff, and we also now have the ability

00:47:05.019 --> 00:47:07.900
to re create restricted service administrators

00:47:07.900 --> 00:47:10.900
You can say this admin can only look at these services.

00:47:10.900 --> 00:47:14.530
You can say this admin can only monitor the services.

00:47:14.530 --> 00:47:19.470
So it allows you to start handing out things to people
that you normally really wouldn't be handing them out to.

00:47:19.469 --> 00:47:20.209
( Applause )

00:47:20.210 --> 00:47:31.130
how many people on Tiger or earlier, took server admin made
some silly little admin user and then ripped all the modules

00:47:31.130 --> 00:47:34.590
out of server admin so you could give
someone control to restart service?

00:47:34.590 --> 00:47:36.880
Yeah yeah see don't do that anymore.

00:47:36.880 --> 00:47:41.809
You can just give them the server admin and let them get
you down, but they can only have access to what you say

00:47:41.809 --> 00:47:44.880
so on server, server admin is where we do our SACL's.

00:47:44.880 --> 00:47:46.119
This is very similar to Tiger.

00:47:46.119 --> 00:47:48.339
It has changed a little bit.

00:47:48.340 --> 00:47:56.930
So the access tab allows us for easy SACL creation so
that we can go through and be able to take care of that.

00:47:57.940 --> 00:48:02.000
We have our administrative SACL's and were
going to take a look at these as well.

00:48:02.000 --> 00:48:02.940
In this case, you can see.

00:48:02.940 --> 00:48:06.340
I'm giving the managers the ability
to monitor the AFP group.

00:48:06.340 --> 00:48:09.360
Why? Because their managers, they are not administrators.

00:48:09.360 --> 00:48:13.910
Alright, they might sign my paycheck,
but they're not touch in my box.

00:48:13.909 --> 00:48:18.509
So, we also have this ability to go in
and ad these SACL's for the mail server.

00:48:18.510 --> 00:48:21.510
And I will talk about this one in
just a couple more seconds here.

00:48:21.510 --> 00:48:25.050
OS X in open directory, we have this
thing called the mail attribute.

00:48:25.050 --> 00:48:30.430
And the mail attribute is a sign when you go into work
group manager, and you click enable mail for this user

00:48:30.429 --> 00:48:33.759
on Xserver that makes your mail attribute.

00:48:33.760 --> 00:48:38.050
And if it doesn't have that then it has no,
the mail server doesn't know what to do.

00:48:38.050 --> 00:48:45.360
So in this case, you can take a group from
AD, drop it in here as a SACL, and enable it.

00:48:45.360 --> 00:48:48.559
And this will enable a more traditional
UNIX mail accounts for these users.

00:48:48.559 --> 00:48:54.710
This is actually in the Tiger documentation now that you
can do this and in various other Mac OS X server books

00:48:54.710 --> 00:48:59.409
that you can pick up as well as afp548 dot com.

00:48:59.409 --> 00:49:02.269
So we've got a demo we're gonna
take a look at here really quick.

00:49:02.269 --> 00:49:05.639
So I'm going to switch back to my demo machine.

00:49:05.639 --> 00:49:12.759
We probably have, I put more into this demo, because I knew
that the other demo was going to get cut a little bit short.

00:49:12.760 --> 00:49:21.070
So the first thing I'm going to look
at here, is my system preferences.

00:49:21.070 --> 00:49:23.250
And this is on a client machine.

00:49:23.250 --> 00:49:26.000
And these are things I didn't have before.

00:49:26.000 --> 00:49:27.619
I did not have SACL's before.

00:49:27.619 --> 00:49:32.289
And you can see I have even much more control over
AC else now as well here with the file sharing

00:49:32.289 --> 00:49:40.590
with the new file sharing systems that we have with
Mac OS X. We also have better display of ACL's in here,

00:49:40.590 --> 00:49:46.130
although it's still you really can't do
it as much as you'd like to do in them.

00:49:46.130 --> 00:49:55.710
If I were to actually click on a folder I own there
we go to like documents let's see, you can see again,

00:49:55.710 --> 00:49:57.389
I really can't do much in here right now.

00:49:57.389 --> 00:50:00.759
This is pretty much what we had in Tiger as well.

00:50:00.760 --> 00:50:04.750
So in this case, I can go through
and I can restrict different access.

00:50:04.750 --> 00:50:07.500
So in this instance, I won a restrict from the login.

00:50:07.500 --> 00:50:09.960
And by default, I've got it set.

00:50:09.960 --> 00:50:13.929
It set for all users in this case, I set it up for just me.

00:50:13.929 --> 00:50:17.609
But I want to do something a little more creative here.

00:50:17.610 --> 00:50:22.320
So instead of only these users and if I click the
plus you can see, I kind of get this system built out.

00:50:22.320 --> 00:50:25.050
I can create a new person in here,
and other things like that.

00:50:25.050 --> 00:50:28.700
Wouldn't it be great if we could do groups on the client?

00:50:28.699 --> 00:50:33.789
Which you can though, so I'm going to come
in here and I'm going to create a new group,

00:50:33.789 --> 00:50:41.110
and I'm going to collect SS age access, SSH users.

00:50:41.110 --> 00:50:43.039
I can spell that easier.

00:50:45.039 --> 00:50:48.059
Creates a group, I'm going to put these two accounts in it.

00:50:48.059 --> 00:50:49.409
And there we go.

00:50:49.409 --> 00:50:53.940
So now I've got this SSH users
group and I can see who's in there.

00:50:53.940 --> 00:50:59.369
I'm going to go back now go back to
my sharing pane, and in this case,

00:50:59.369 --> 00:51:05.359
remote login is going to be restricted,
ooh it didn't find it.

00:51:05.360 --> 00:51:07.650
Well in this case, we'll say to administrators.

00:51:07.650 --> 00:51:12.519
How about that, so this restricts this just to
local administrators, so that we can go ahead

00:51:12.519 --> 00:51:16.250
and start ratcheting down on the services a little bit.

00:51:16.250 --> 00:51:18.570
And you can see, this is pretty pervasive stuff.

00:51:18.570 --> 00:51:22.559
It's in all our different services,
remote management this always was here.

00:51:22.559 --> 00:51:25.360
It just looks a little bit different now in ARD.

00:51:25.360 --> 00:51:28.820
And we have we just split out some
of the writes some a little bit.

00:51:28.820 --> 00:51:34.570
Xgrid, remote Apple events, like I said great for
pranks, but you know it's something you might want to try

00:51:34.570 --> 00:51:39.650
to restrict some on your network, because
it could be seen as a security pool.

00:51:39.650 --> 00:51:45.740
And so we got pretty easy ways now to do SACL's and ACLs
on flying is not something we've ever really had before.

00:51:45.739 --> 00:51:52.639
You could do it before, and there were some shareware
utilities on Tiger to allow you to get in there and do that.

00:51:52.639 --> 00:51:55.839
But the real meat of this again still is on the server.

00:51:55.840 --> 00:51:58.289
So if I look at server admin here.

00:51:58.289 --> 00:52:03.210
And I go up to settings, and I go to services access.

00:52:03.210 --> 00:52:08.280
This is where I can start to really
restrict down what I'm looking at.

00:52:08.280 --> 00:52:13.530
And in this case, I've got this FTP only group
which has one user on it called FTP user.

00:52:13.530 --> 00:52:17.560
You can use this, I've seen people do this
to hand out a generic FTP user account.

00:52:17.559 --> 00:52:20.940
I know it sounds like generic accounts, that's terrible,

00:52:20.940 --> 00:52:24.829
but if there's only one possible
account you can access with FTP.

00:52:24.829 --> 00:52:28.799
If you ever have an FTP breach,
how much cleanup do you have?

00:52:28.800 --> 00:52:29.810
Not a lot.

00:52:29.809 --> 00:52:34.750
So you know, hey, that's that user, I better change
the password and all of a sudden you're done.

00:52:34.750 --> 00:52:41.780
So it makes your life a lot easier in this case were
going to go ahead and were going to restrict FTP.

00:52:41.780 --> 00:52:46.560
And we have a couple more checkboxes, and
I'm going to say FTP only can get access

00:52:46.559 --> 00:52:50.230
to that before I do that I am going to connect to it once.

00:52:52.179 --> 00:52:56.659
And I'm going to connect with just
a regular user name and password.

00:52:56.659 --> 00:53:02.019
Josh, and it'll connect here in just a second.

00:53:02.019 --> 00:53:05.869
So it's going through it's evaluating that.

00:53:05.869 --> 00:53:06.900
And there we go.

00:53:06.900 --> 00:53:09.440
I connected up with FTP.

00:53:09.440 --> 00:53:13.289
And I'm going to make one quick change here.

00:53:13.289 --> 00:53:13.829
There we go.

00:53:13.829 --> 00:53:16.690
For the sake of the demo that's much easier.

00:53:16.690 --> 00:53:19.150
So I'm going to eat check that out.

00:53:19.150 --> 00:53:21.660
So but I don't want Josh having access to that.

00:53:21.659 --> 00:53:24.049
Josh in this case is a manager user.

00:53:24.050 --> 00:53:29.350
Local admin at this point could FTP in,
and that's not a username and a password.

00:53:29.349 --> 00:53:30.710
You want getting compromised.

00:53:30.710 --> 00:53:38.039
So I'm going to take a look and I'm going to restrict
FTP access down to only allow members of the FTP group.

00:53:38.039 --> 00:53:41.130
And in here, I only have one user.

00:53:41.130 --> 00:53:48.700
So now, if Josh tries to connect, and I'm going to go
through again and it's going to spin for second Josh Apple.

00:53:48.699 --> 00:53:54.289
It's not going to let me connect to the FTP.

00:53:54.289 --> 00:54:01.279
But FTP user can get in, so I'm
restricting down this service,

00:54:01.280 --> 00:54:04.810
and I'm controlling who's allowed to have access to this.

00:54:04.809 --> 00:54:07.909
And this is really good for insecure services.

00:54:09.570 --> 00:54:15.780
So the next thing that I want to show you in here is
the male attribute, which, again sounds really simple.

00:54:15.780 --> 00:54:17.850
You know it here we go there we go.

00:54:17.849 --> 00:54:24.000
Alright, now I've got a Mac OS, in a nutshell I've
now enabled mail use if I turn on the mail server

00:54:24.000 --> 00:54:29.230
and configure it properly for that
group of users from active directory.

00:54:29.230 --> 00:54:32.599
You can use this to build a really
fast outgoing FTP service or something

00:54:32.599 --> 00:54:37.309
like that, because I know you all love exchange.

00:54:37.309 --> 00:54:42.269
So that's a very quick way to go
ahead and connect and restrict this.

00:54:42.269 --> 00:54:46.590
So another thing we can do here that's
really cool is the login window.

00:54:46.590 --> 00:54:49.940
And this came up in some discussions that Jule
and I had with a couple of people this week.

00:54:49.940 --> 00:54:54.670
How do you control access to the
consul of a workstation or server?

00:54:54.670 --> 00:54:58.510
Now, if you're using our policy
out of the directory our MCX stuff.

00:54:58.510 --> 00:55:03.100
You can go in and you can do this with computer lists
and restrict you can login and things like that.

00:55:03.099 --> 00:55:04.860
But what about the server?

00:55:04.860 --> 00:55:08.809
You know, I know all your servers have
no keyboards there behind locked grates

00:55:08.809 --> 00:55:13.579
on the racks behind you know the three different
biometric locks to get into the manager out.

00:55:13.579 --> 00:55:20.059
But we all don't have that I had one place where ran
servers, where they actually wouldn't let me have a door

00:55:20.059 --> 00:55:24.659
for the server closet, because
there was no air vents and it.

00:55:24.659 --> 00:55:28.319
There were several problems with that
sentence, all of which I won't go into.

00:55:28.320 --> 00:55:32.660
If you went to the effective system admin session
yesterday, you probably know, what most of them are.

00:55:32.659 --> 00:55:39.170
But in this case, I can actually control login window, and
in the case of this, this will control access to the consul

00:55:39.170 --> 00:55:42.450
of the server, which is very important to get.

00:55:42.449 --> 00:55:47.710
Apple when we started in 10 4 separating
by default are directory administrator

00:55:47.710 --> 00:55:49.599
in our local administrator on the box.

00:55:49.599 --> 00:55:55.619
That is a great thing, because you don't, it may mean you
have one extra button to click and one extra password to tie

00:55:55.619 --> 00:55:58.059
or put in your key chain, but it restricts

00:55:58.059 --> 00:56:01.769
and keeps the local administration separate
from the directory Main administration.

00:56:01.769 --> 00:56:06.409
And in this case, I don't want a domain
admin to come in and login on this machine.

00:56:06.409 --> 00:56:14.519
So I've actually created a group called
Consol Admins, which only contains,

00:56:14.519 --> 00:56:17.630
if I go look at Consol Admins here, it's a local group.

00:56:17.630 --> 00:56:18.769
It's not in the directory.

00:56:18.769 --> 00:56:20.900
It is local to this machine.

00:56:20.900 --> 00:56:29.579
And it only contains the local administrator on this box
because I want to control who can log in through the window.

00:56:29.579 --> 00:56:33.480
So in this case, I'm going to restrict
login window to just Consol Admins.

00:56:33.480 --> 00:56:40.139
I'm going to click save, and I'm
going to go take a look at that.

00:56:40.139 --> 00:56:43.509
Ooh finder pen wheeling, come on finder.

00:56:43.510 --> 00:56:48.350
( Silence )

00:56:48.349 --> 00:56:50.150
Oh come on.

00:56:50.150 --> 00:56:52.670
Oh there it is, alright.

00:56:52.670 --> 00:56:53.960
It was that FTP on melt.

00:56:53.960 --> 00:57:00.130
So I'm going to go in and take a look here
using nifty new feature in a leper right.

00:57:00.130 --> 00:57:03.490
And I can try to log in as their admin.

00:57:06.929 --> 00:57:16.500
No not allowed in local admin I can log in and in
fact, that's the only user I'll be able to log in as

00:57:16.500 --> 00:57:20.409
because I've restricted down console
access to that one particular thing.

00:57:20.409 --> 00:57:23.679
It's kind of confusing name, I found login window,

00:57:23.679 --> 00:57:27.889
because it seems like an odd service
to access the login window service.

00:57:27.889 --> 00:57:32.989
But in this case, it makes perfect sense because
it keeps you from using the login window.

00:57:32.989 --> 00:57:38.659
Another little nice bit of UI I like there to share
folder bar that shows up at the top of any shared folder.

00:57:38.659 --> 00:57:41.500
So before you drop the accounting data in there,

00:57:41.500 --> 00:57:45.440
you can know that it's a shared folder,
and it's probably time to check it out.

00:57:45.440 --> 00:57:48.679
So let me log out of that row fast.

00:57:50.050 --> 00:57:56.370
Yes. The reason that connection failed his
I'm not allowing guest access into my server.

00:57:56.369 --> 00:58:02.309
Another little bit here that we like is notice that
I've only got the active services in server admin

00:58:02.309 --> 00:58:06.420
and without talking about it too much
outside the scope of this session.

00:58:06.420 --> 00:58:11.050
It means I can basically select in server admin
which ones I show and which ones I don't show.

00:58:11.050 --> 00:58:17.310
And in this case, I'd love to be able to give out
permissions for a group of users to monitor a service.

00:58:17.309 --> 00:58:20.900
So they can actually look to see if
it's running before they call me,

00:58:20.900 --> 00:58:25.250
because it may be something else that's
wrong, it could be any number of things.

00:58:25.250 --> 00:58:29.519
So we actually have the second tab
under access called administrators.

00:58:29.519 --> 00:58:36.920
And I can say for the AFP service,
I'm going to give my local admins,

00:58:36.920 --> 00:58:42.369
remember file sharing is a local administrative privilege
because it's actually changing things on the box.

00:58:42.369 --> 00:58:48.539
They can administer a server and
then I'm going to say that designers,

00:58:48.539 --> 00:58:52.789
because they're the ones that always call kid monitor.

00:58:52.789 --> 00:58:54.519
You can tell I've got a pre press back there.

00:58:54.519 --> 00:58:56.329
The designers always call.

00:58:56.329 --> 00:59:03.590
And now I can hand out server admin, and I can give server
admin after I've restricted my other services as well

00:59:03.590 --> 00:59:07.510
to the appropriate groups and make
sure all my SACL's are set up.

00:59:07.510 --> 00:59:11.310
I can hand out server admin now to
members of the administrator group.

00:59:11.309 --> 00:59:15.269
And they can login and they can take
a look at AFP, and they can see.

00:59:15.269 --> 00:59:16.349
Oh yeah AFP is running.

00:59:16.349 --> 00:59:19.279
It says it's up I can see there's
current connections, and everything else.

00:59:19.280 --> 00:59:21.010
I better not call Josh and wake him up.

00:59:21.010 --> 00:59:22.960
I'll let him sleep.

00:59:22.960 --> 00:59:24.329
I'll call his minion.

00:59:24.329 --> 00:59:29.219
So Jule gets a phone call, and then we go on from there.

00:59:29.219 --> 00:59:33.299
In this case the local admin group could
then log in and administer the server.

00:59:33.300 --> 00:59:35.590
And remember again that file sharing is a local.

00:59:35.590 --> 00:59:41.930
It's in the context of the local administrator group
because it is something that is a local operation

00:59:41.929 --> 00:59:44.949
to the file system and where you share out there.

00:59:44.949 --> 00:59:47.509
Okay? I'm going to switch back to slides now

00:59:47.510 --> 00:59:54.710
( Silence )

00:59:54.710 --> 00:59:58.539
So, real quick here, to sum up what we just
looked at today before we get into our Q

00:59:58.539 --> 01:00:02.829
and A discussion, is that ACLs allow for control.

01:00:02.829 --> 01:00:07.389
Like the funny little dialog box in
workgroup manager in Tiger would tell you.

01:00:07.389 --> 01:00:10.400
Look out this may be more than you're asking for.

01:00:10.400 --> 01:00:14.610
So don't go crazy with ACL's on your file system.

01:00:14.610 --> 01:00:18.849
If you don't need to go crazy with
ACL's on your file system.

01:00:18.849 --> 01:00:24.489
We seen people get into trouble because, you know,
all those sure POSIX would have worked just fine.

01:00:24.489 --> 01:00:28.779
They could have done everything they wanted
to with the they wanted to use ACL's for it.

01:00:28.780 --> 01:00:31.120
And in the case of very simple structures.

01:00:31.119 --> 01:00:35.059
It may be more complication than you
actually need to get your job done.

01:00:35.059 --> 01:00:37.119
And who once more work?

01:00:37.119 --> 01:00:43.029
No hands, so you can use the traditional
UNIX tools to work with your ACL's.

01:00:43.030 --> 01:00:45.950
And currently all this works, right.

01:00:45.949 --> 01:00:49.389
Rsync with the E flag, the Big E, it works.

01:00:49.389 --> 01:00:58.210
Copy, TAR, CPIO all that stuff, if it uses our copy file
it's going to work, and it continues to work in Leopard.

01:00:58.210 --> 01:01:03.360
So you can use that to work with these
tools like I said deploy with moderation.

01:01:03.360 --> 01:01:05.269
If you don't need to complicate your life

01:01:05.269 --> 01:01:09.710
as a systems administrator don't complicate
your life as a systems administrator.

01:01:09.710 --> 01:01:11.380
No one needs more work.

01:01:11.380 --> 01:01:16.450
Use the effective permission specter when you're
doing your file system ACL's leave it open.

01:01:16.449 --> 01:01:22.319
The whole time and drop a member of the group that you're
thinking about adding at that point in time in there.

01:01:22.320 --> 01:01:23.650
It tells you what group it is.

01:01:23.650 --> 01:01:29.829
It tells you what folder it's looking at it will save
your mind from just rotting and rolling out of your ear,

01:01:29.829 --> 01:01:34.659
because you don't want to sit there
and gas that well I gave them traverse.

01:01:34.659 --> 01:01:38.349
And I gave them read attributes,
but not extended attributes.

01:01:38.349 --> 01:01:40.460
And oh why isn't this working?

01:01:40.460 --> 01:01:44.079
You can just look at the EPI and
you can see why it's not working.

01:01:44.079 --> 01:01:46.670
And you can go oh, he needs that
checkbox, and you can go back to the allow

01:01:46.670 --> 01:01:49.240
or the denying and add or remove a checkbox.

01:01:49.239 --> 01:01:53.669
At Mac OS X are workstation version now, now is easy SACL's.

01:01:53.670 --> 01:01:55.170
They're just in system preferences.

01:01:55.170 --> 01:02:01.659
It allows us a lot more control over it so we can go through
and very quickly go in and control who can access what.

01:02:01.659 --> 01:02:05.609
And the ways different people can
come into that machine from remotely.

01:02:05.610 --> 01:02:11.390
And that's a very important part of any network security
plan is controlling who can get into what and how