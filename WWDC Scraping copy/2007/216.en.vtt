WEBVTT

00:00:20.289 --> 00:00:22.910
>> Hello. Good morning.

00:00:22.910 --> 00:00:26.899
(Applause).

00:00:26.899 --> 00:00:28.160
Welcome to Time Machine In-Depth.

00:00:28.160 --> 00:00:32.149
I am Deric Horn. I'm the Application
Technologies Evangelist,

00:00:32.149 --> 00:00:36.469
and before joining evangelism I used be a
member on the file system engineering team.

00:00:36.469 --> 00:00:42.299
And being here today really reminds me of
a time when we were developing HFS+.

00:00:42.299 --> 00:00:49.089
At that time we had gotten HFS+ up to the point where
we were able to finally copy a file onto an HFS+ volume,

00:00:49.090 --> 00:00:51.740
and this was really a huge accomplishment for us.

00:00:51.740 --> 00:00:56.450
But, about that time as well, WWDC was right around
the corner, and I don't know if you guys know this,

00:00:56.450 --> 00:01:01.160
but some sort of a California law that every presentation
at the conference has to have at least one demo,

00:01:01.159 --> 00:01:04.149
and I think in my mind I was picturing
what our demo would look like.

00:01:04.150 --> 00:01:08.600
Sitting there in the Finder and
copying a file onto a volume.

00:01:08.599 --> 00:01:10.299
Not much of a demo.

00:01:10.299 --> 00:01:12.329
So that's really one of the reasons
why I really love Time Machine.

00:01:12.329 --> 00:01:16.439
It really emphasizes the use of the
file system, and it's really, I think,

00:01:16.439 --> 00:01:23.099
going to be probably the number one user feature
that's going to drive adoption of Leopard to our users,

00:01:23.099 --> 00:01:26.049
and cause people to upgrade from Tiger to Leopard.

00:01:26.049 --> 00:01:29.799
After all, the most important thing
about our machines is our data.

00:01:31.450 --> 00:01:35.640
So, how many of you out there have
actually tried Time Machine yet?

00:01:35.640 --> 00:01:36.250
Wow. Okay.

00:01:36.250 --> 00:01:37.680
Good. About half of you.

00:01:37.680 --> 00:01:42.370
I don't know if your experience was exactly like
mine, but the first time I plugged in that volume,

00:01:42.370 --> 00:01:47.120
and I did that backup, it was almost
like a-- this-- this new feeling I had.

00:01:47.120 --> 00:01:49.060
This different relationship I had with my computer.

00:01:49.060 --> 00:01:52.600
It was almost like I just unloaded
this backpack full rocks on the ground.

00:01:52.599 --> 00:01:54.859
I mean, it was like, now I have this safety net.

00:01:54.859 --> 00:01:58.159
I felt really free to go around and
try thing I had never tried before,

00:01:58.159 --> 00:02:00.689
going on into Photoshop, trying new filters, plug-ins.

00:02:00.689 --> 00:02:04.459
I didn't care if undo was supported or
not, because I felt like I always had undo.

00:02:04.459 --> 00:02:07.409
I could always go back to the version that file I just had.

00:02:07.409 --> 00:02:11.590
Right away I found myself on like Version Tracker,
downloading new shareware, trying new things.

00:02:11.590 --> 00:02:16.430
So it was really this kind of this-- this enlightened
feeling I just had with my machine after that,

00:02:16.430 --> 00:02:19.830
because I always felt safe right
next to me, all my files right there.

00:02:19.830 --> 00:02:22.950
I could always go back to that stable state I was just in.

00:02:22.949 --> 00:02:26.899
By now a lot of you have probably
heard about Xcode Snapshots.

00:02:26.900 --> 00:02:33.020
So, Xcode snapshots are the ability to when you're working
a project in Xcode, you take a snapshot, try something new,

00:02:33.020 --> 00:02:36.580
if you screw up, you can always go
back that to that safe snapshot.

00:02:36.580 --> 00:02:42.730
Well, Time Machine implements this idea of snapshots,
across the board for all your applications.

00:02:42.729 --> 00:02:46.310
So whether you are in Photoshop or any other
application, if you screw something up,

00:02:46.310 --> 00:02:50.090
you just go right back to that safe
place where you were, that safe snapshot.

00:02:53.770 --> 00:02:58.189
So what were some of the goals we
had when we designed Time Machine?

00:02:58.189 --> 00:03:02.069
Well, obviously the goal was to protect our data.

00:03:02.069 --> 00:03:03.509
To provide the safety net.

00:03:03.509 --> 00:03:06.609
But we wanted to do something that was
really that provided the seamless integration

00:03:06.610 --> 00:03:08.970
of a backup solution onto your system.

00:03:08.969 --> 00:03:14.069
Something that went beyond what normal backup solutions do
and really make it intuitive for all users to understand how

00:03:14.069 --> 00:03:16.620
to use and to be able to retrieve their data.

00:03:16.620 --> 00:03:20.620
We wanted to be able to backup our data and keep
it in-- in a file format that everyone understands.

00:03:20.620 --> 00:03:23.569
We're not going to use encryption,
we're not going to use compression.

00:03:23.569 --> 00:03:28.459
This way in the future you don't have to worry about,
you know, do I have a method to unencrypt this file?

00:03:28.460 --> 00:03:30.840
Do I have this method to unstuff this file?

00:03:30.840 --> 00:03:34.060
Is that company around that still
developed this encryption technology?

00:03:34.060 --> 00:03:36.360
Do your files just sit on regular HFS+ volume?

00:03:36.360 --> 00:03:42.580
It's as easy as copying-- copying them back over, so it
makes it very easy, very intuitive to use and to understand.

00:03:42.580 --> 00:03:47.480
Now that being said, Time Machine 1.0
isn't going to be everything for everybody.

00:03:47.479 --> 00:03:50.219
It's not designed to be an enterprise-level solution.

00:03:50.219 --> 00:03:56.270
We don't have these goals in mind of I have my university
of
4000 machines, I need some encrypted offsite storage,

00:03:56.270 --> 00:03:58.180
and Time Machine's going to provide
all the functionality you need.

00:03:58.180 --> 00:04:01.370
No. Time Machine was designed for our typical usage in mind.

00:04:01.370 --> 00:04:05.980
Small businesses, users, home usage, and so forth.

00:04:05.979 --> 00:04:09.799
And probably one of the neatest things about Time Machine,
and I'm going to say this about a lot of the technologies

00:04:09.800 --> 00:04:21.850
in Leopard, is that it's really well integrated across
all of Mac OS X. So, the typical place where we're going

00:04:21.850 --> 00:04:24.610
to be using Time Machine is directly within the Finder.

00:04:24.610 --> 00:04:28.129
Go ahead and find that directory that contains
those files that you're going to--that you want

00:04:28.129 --> 00:04:30.329
to find these older versions of these files.

00:04:30.329 --> 00:04:35.659
Once you find this directory, this folder, this window,
you enter the, you click on the Time Machine icon

00:04:35.660 --> 00:04:38.380
and you enter this Time Machine presentation mode.

00:04:38.379 --> 00:04:41.740
Now, I think from there that's where
this intuitive user interface comes in.

00:04:41.740 --> 00:04:45.009
I think it's very intuitive to
understand that depth represents time.

00:04:45.009 --> 00:04:47.259
The further back you go, the older in time you go.

00:04:47.259 --> 00:04:50.589
All the way back to when the Big Bang was.

00:04:50.589 --> 00:04:56.250
We also have integration of Time Machine into a
number of our applications in Mac OS X. So again,

00:04:56.250 --> 00:05:00.360
I may have added a number of contacts into
my Address Book before this conference.

00:05:00.360 --> 00:05:04.069
And then maybe-- and after the
conference I delete those contacts.

00:05:04.069 --> 00:05:08.899
A month later I want to go back and find that person that I
wanted to have contact with, not in my Address Book anymore.

00:05:08.899 --> 00:05:13.810
I go ahead and open up Address Book, from the Address
Book application itself, I click the Time Machine icon,

00:05:13.810 --> 00:05:18.660
and I'm presented with that same
familiar Time Machine user interface.

00:05:18.660 --> 00:05:22.250
And I can go ahead and go back in
time and reconcile those records.

00:05:22.250 --> 00:05:26.509
Now the interesting thing about this is
that Address Book, behind the scenes,

00:05:26.509 --> 00:05:30.550
actually has to have two versions of
its database open at the same time.

00:05:30.550 --> 00:05:32.220
So, it's not working on a file-by-file basis.

00:05:32.220 --> 00:05:36.680
And it's going to go ahead and reconcile
those individual records and move them across.

00:05:36.680 --> 00:05:41.740
Similarly we have integration with
iPhoto, as well as the Installer.

00:05:41.740 --> 00:05:46.360
So, we've all been told, make a backup
before you install new software.

00:05:46.360 --> 00:05:47.330
Nobody does it.

00:05:47.329 --> 00:05:48.569
I've never done it.

00:05:48.569 --> 00:05:50.670
But right now we make it very easy to do.

00:05:50.670 --> 00:05:53.730
It's as simple as clicking a checkbox
before you install your new software.

00:05:53.730 --> 00:05:56.290
If things get screwed up you can
always go back to that safe place

00:05:56.290 --> 00:05:59.290
where you were right before you installed that software.

00:05:59.290 --> 00:06:02.040
In addition, we have integration with the Migration
Assistant.

00:06:02.040 --> 00:06:07.410
So, you may have all of you data on the MacBook
Pro, slips out of your lap, drive gets broken.

00:06:07.410 --> 00:06:12.220
Now, unfortunately you have to go out and buy a new MacBook
Pro, but the good thing is with the Migration Assistant,

00:06:12.220 --> 00:06:18.140
you can now move all of your data from one of those Time
Machine snapshots back onto your current new volume.

00:06:21.689 --> 00:06:24.250
So, now that I've described a little bit about technology,

00:06:24.250 --> 00:06:28.019
you're probably wondering why did it
take us so long to write Time Machine?

00:06:28.019 --> 00:06:32.109
Well, it turns out Time Machine really
leverages a number of technologies

00:06:32.110 --> 00:06:35.310
which are really just now coming to life in Leopard.

00:06:36.350 --> 00:06:40.700
So, a typical backup scenario--
a typical backup scenario,

00:06:40.699 --> 00:06:45.829
involves scanning your entire source
volume and your entire destination volume.

00:06:45.829 --> 00:06:49.589
So really what I mean by that is we
might have a million files on our volume.

00:06:49.589 --> 00:06:53.619
The backup solution now has to go ahead and
scan every single file in our source volume,

00:06:53.620 --> 00:06:59.410
every single file in your destination volume, compare
things like modification dates, attributes, file sizes,

00:06:59.410 --> 00:07:01.500
when it finds a difference copy those across.

00:07:01.500 --> 00:07:05.110
Now that takes a long time to scan 2 million files.

00:07:05.110 --> 00:07:08.530
So now in Leopard we have a new file
system technology called FSEvents.

00:07:08.529 --> 00:07:11.729
This provides file system event notification.

00:07:11.730 --> 00:07:15.750
So for instance, when we want-- when we launch
Time Machine now, Time Machine can then say,

00:07:15.750 --> 00:07:17.860
"Tell me all the files that have changed in the last day."

00:07:17.860 --> 00:07:22.860
FSEvents will then send us a list of
directories containing only those changed files.

00:07:22.860 --> 00:07:27.340
So that accounts for the blazing speed we see in
Time Machine when we do those incremental backups.

00:07:27.339 --> 00:07:31.109
We also leverage another-- a number of
other technologies in the file system.

00:07:31.110 --> 00:07:32.009
Things like EAs--

00:07:32.009 --> 00:07:33.480
Extended Attributes.

00:07:33.480 --> 00:07:36.720
That-- this allows us to tag some
extra metadata onto the files.

00:07:36.720 --> 00:07:40.840
This metadata then can be searched by Spotlight,
maybe the metadata contains information

00:07:40.839 --> 00:07:46.500
such as whether the Time Machine backup is in
progress, the last time of the backup and so forth.

00:07:46.500 --> 00:07:49.680
Eric Weiss will go into details
about this a little bit later.

00:07:53.110 --> 00:07:58.920
We actually had to change the volume format
of HFS+ to accommodate Time Machine.

00:07:58.920 --> 00:08:03.670
So when you think about it, on your
system, out of those million files,

00:08:03.670 --> 00:08:06.780
there's really only a few files
that actually change over time.

00:08:06.779 --> 00:08:11.369
So, for instance, everything in that
/System directory, it rarely changes.

00:08:11.370 --> 00:08:15.920
So to get better performance out of Time Machine,
we introduced a new concept, and this is the concept

00:08:15.920 --> 00:08:19.730
of being able to create hard links
to directories themselves.

00:08:19.730 --> 00:08:23.900
Again, Eric will talk more about this in a
little bit, but the idea being here if nothing--

00:08:23.899 --> 00:08:27.029
if nothing changes in my /System volume, don't go ahead

00:08:27.029 --> 00:08:31.219
and create all these folders or-- or
links to files that already exist

00:08:31.220 --> 00:08:36.560
for better speed. Let's just say that /System
is exactly the same, create directory hard link,

00:08:36.559 --> 00:08:41.129
or what we call an archive directory
link, to this original /System.

00:08:44.000 --> 00:08:45.639
Come on. Quick Look.

00:08:45.639 --> 00:08:47.470
So by now you guys have all heard of Quick Look, I'm sure.

00:08:47.470 --> 00:08:51.370
Quic kLook is another one of those technologies that
is pervasive throughout all of Mac OS X. It's used

00:08:51.370 --> 00:08:56.230
in Spotlight, it's used in the Finder, it's used in your
open save panels to provide those little previews,

00:08:56.230 --> 00:09:01.060
and probably what I think is the most important place
where Quick Look is used, is directly in Time Machine.

00:09:01.059 --> 00:09:06.139
So currently the workflow using a backup solution
would involve something like I'm a graphic artist.

00:09:06.139 --> 00:09:09.600
I drew a picture and I remember that
picture had maybe a small red balloon on it.

00:09:09.600 --> 00:09:14.159
Okay, go over on my backup, retrieve
this file, put it on my volume,

00:09:14.159 --> 00:09:17.179
double click it, launch Photoshop, no, not the right file.

00:09:17.179 --> 00:09:19.659
Go back to find the other backup, and repeat this process.

00:09:19.659 --> 00:09:22.120
It's not a great user experience.

00:09:22.120 --> 00:09:26.669
So now with Quick Look, directly from this Time Machine
presentation mode, you can go ahead and finds these files,

00:09:26.669 --> 00:09:32.029
hit the space bar, presents a Quick Look preview, not the one
I'm looking for, go back one more version, hit the space bar.

00:09:32.029 --> 00:09:35.500
Really increases productivity and that user workflow.

00:09:35.500 --> 00:09:38.279
And lastly, Core Animation.

00:09:38.279 --> 00:09:40.669
So I don't believe that Core Animation is just eye candy.

00:09:40.669 --> 00:09:47.129
I think that Core Animation is really responsible for
providing this rich, kind of intuitive user interface.

00:09:47.129 --> 00:09:50.409
This is the first time that we're seeing
a backup solution that doesn't use things

00:09:50.409 --> 00:09:53.389
such as tables and lists to portray the data.

00:09:53.389 --> 00:09:56.549
It's portraying the data in a whole new
way and that's through Core Animation

00:09:56.549 --> 00:10:01.459
being able to animate and show you your snapshots over time.

00:10:01.460 --> 00:10:04.820
So now let's talk about Time Machine 2.0.

00:10:04.820 --> 00:10:08.040
The ability to get your documents before you write them.

00:10:08.039 --> 00:10:12.509
So what do we need for Time Machine 2.0?

00:10:14.320 --> 00:10:14.660
(Laughter) Okay.

00:10:14.659 --> 00:10:15.439
Wrong presentation.

00:10:15.440 --> 00:10:16.650
I must have made a mistake here.

00:10:16.649 --> 00:10:19.600
Let's go ahead and look at Time Machine
and see if we can get the right version.

00:10:19.600 --> 00:10:26.529
So I'm just going to give you a quick
little tour of how Time Machine works.

00:10:26.529 --> 00:10:34.079
The most common scenario, we'll find a directory here and we
want to go ahead and find the older version of this file.

00:10:34.080 --> 00:10:38.430
So in this one I am going to go ahead and look
at a representation of my presentation.

00:10:38.429 --> 00:10:44.049
Simply click on the Time Machine icon, and
we are presented with this user interface.

00:10:44.049 --> 00:10:47.889
The first thing you'll notice is on the right-hand
side, a number of these tick marks are white,

00:10:47.889 --> 00:10:50.379
and as we go back in time you will notice the grey ones.

00:10:50.379 --> 00:10:55.799
The white ones represent the snapshots that we have made
and the grey ones are where we don't have that data.

00:10:55.799 --> 00:10:59.479
So as you can tell my first backup was
probably made on May 30th, for instance.

00:10:59.480 --> 00:11:04.050
And there's a number of different ways we can
navigate within this Time Machine presentation mode.

00:11:04.049 --> 00:11:06.990
For one, you can notice it's very similar to the Finder.

00:11:06.990 --> 00:11:10.560
If we-- if I decide this isn't the right folder
I can go ahead and click around from here.

00:11:10.559 --> 00:11:14.479
You will notice that all the other
windows now change their titles.

00:11:14.480 --> 00:11:17.620
So, I can go ahead and navigate back to where I was.

00:11:17.620 --> 00:11:21.960
By using these arrows over here, it will
automatically zoom us back to that version to--

00:11:21.960 --> 00:11:26.200
to the version of that directory which
has something different in it.

00:11:26.200 --> 00:11:29.560
So as I click back, nothing has changed
for a number of days here and now all

00:11:29.559 --> 00:11:32.839
of the sudden we will see, okay, we
have 2 files in this directory.

00:11:32.840 --> 00:11:36.889
We can also go ahead and click on
individual directories over here.

00:11:36.889 --> 00:11:39.899
But I'm going to go ahead and try and
find that file that I'm looking for.

00:11:39.899 --> 00:11:41.649
I don't know, was this it?

00:11:41.649 --> 00:11:45.250
We can check just by hitting the
space bar, and again we'll be presented

00:11:45.250 --> 00:11:47.769
with this Quick Look preview of what was in the document.

00:11:47.769 --> 00:11:48.389
It's that easy.

00:11:48.389 --> 00:11:49.860
Directly from Time Machine.

00:11:49.860 --> 00:11:53.990
I know that's still the-- that's still the wrong
presentation, we'll hit the space bar again.

00:11:53.990 --> 00:11:55.299
Go back in time a little further.

00:11:55.299 --> 00:11:59.609
Let's keep on going back.

00:11:59.610 --> 00:12:02.560
Okay. I think this is the right one, let's
go ahead and check it out in Quick Look.

00:12:02.559 --> 00:12:04.729
This is the right presentation.

00:12:04.730 --> 00:12:09.080
So to restore it, we'll just go ahead and click the
restore button, and as you can see through animation,

00:12:09.080 --> 00:12:12.620
it will just bring us right back into today's time.

00:12:12.620 --> 00:12:14.929
And ask us if we want to replace this original file.

00:12:14.929 --> 00:12:19.589
So it doesn't just replace that original file, we can
keep both of them, replace it, or keep the original one.

00:12:19.590 --> 00:12:24.440
In this case I'm going to go ahead and
replace, I'll go ahead and keep both of them.

00:12:24.440 --> 00:12:26.680
So we have the original one and the new one.

00:12:26.679 --> 00:12:28.509
That's a little bit to see how Time Machine works.

00:12:28.509 --> 00:12:34.129
(Applause).

00:12:34.129 --> 00:12:38.200
At this time I'd like to welcome Robert Ulrich on stage to
talk a little bit more about the details of Time Machine.

00:12:38.200 --> 00:12:40.259
(Applause)

00:12:40.259 --> 00:12:41.049
>> Thank you.

00:12:41.049 --> 00:12:46.039
(Applause).

00:12:46.039 --> 00:12:49.769
So, hello.

00:12:49.769 --> 00:12:50.559
I am Robert Ulrich.

00:12:50.559 --> 00:12:51.459
I am an engineer.

00:12:51.460 --> 00:12:53.410
I work on Time Machine.

00:12:54.580 --> 00:12:57.430
And, here's what we're going to talk about here.

00:12:57.429 --> 00:13:01.919
What's new with Time Machine, how
it works, and tips for your application.

00:13:01.919 --> 00:13:04.409
I'm going to cover more of the high-end
sort of user experience,

00:13:04.409 --> 00:13:10.230
and Eric will talk about some of the low-level details.

00:13:10.230 --> 00:13:11.830
So, what's new this year in Time Machine?

00:13:11.830 --> 00:13:13.170
Well, we've added a lot of stuff.

00:13:13.169 --> 00:13:20.110
We have simplified the options, we've added automatic setup,
we have added backup to the servers and AirPort disks.

00:13:20.110 --> 00:13:20.889
A lot of stuff.

00:13:20.889 --> 00:13:26.799
So we'll cover some of that now.

00:13:26.799 --> 00:13:33.649
So, we've simplified the options this year in Time Machine,
so now everything is much simpler and much easier to set up.

00:13:33.649 --> 00:13:36.620
You'll see this in your seat, it's
really, really easy to deal with.

00:13:36.620 --> 00:13:41.100
And here's some of the stuff that we've done.

00:13:42.220 --> 00:13:45.019
First of all, we've eliminated the on/off switch.

00:13:45.019 --> 00:13:46.319
There is no more on/off switch.

00:13:46.320 --> 00:13:52.430
Time Machine is always running, there is-- it's just a
question of whether you want to do it manually or automatic.

00:13:52.429 --> 00:13:55.809
So, if you turn on the automatic switch, we just back it up.

00:13:55.809 --> 00:13:59.069
You no longer need to set the backup
time, it just happens for you.

00:13:59.070 --> 00:14:03.110
And that's all you need to do.

00:14:03.110 --> 00:14:09.810
So, when you do automatic backups, what happens now
is your machine is automatically backed up every hour.

00:14:09.809 --> 00:14:13.469
That's why you no longer need to set
any time, it just happens every hour.

00:14:13.470 --> 00:14:20.180
The hourly backups are kept on a rolling basis for 24
hours, so after the file has passed 24 hours we'll--

00:14:20.179 --> 00:14:23.669
we'll remove the oldest one and we'll make a new one.

00:14:23.669 --> 00:14:29.569
And-- but the first one that happens every day
after midnight will become your daily backup.

00:14:29.570 --> 00:14:36.720
So, one of those every day gets saved as a daily backup,
and then we have a rolling list for the last 24 hours.

00:14:36.720 --> 00:14:43.730
We've also added support for backing up your disk when--
when it's-- when a FireWire or USB disk has been attached.

00:14:43.730 --> 00:14:47.300
And we haven't backed up for
a while, which is really useful.

00:14:48.519 --> 00:14:53.230
So, if you turn off automatic backups for some reason,
you can still do manual backups and you just go

00:14:53.230 --> 00:14:57.240
to the control panel and press
Back Up Now and we'll back it up.

00:14:57.240 --> 00:15:00.299
In this case if you turn off automatic
there's no hourly backups done,

00:15:00.299 --> 00:15:03.859
they are just done on a demand
basis when you press the button.

00:15:08.389 --> 00:15:10.649
One of the features that we have had a lot of requests for

00:15:10.649 --> 00:15:14.389
and we've added this year is Stop
and Resume, which is very useful.

00:15:14.389 --> 00:15:20.159
So, if your machine is in the middle of doing a backup
and you need to go, you can now stop your backup.

00:15:20.159 --> 00:15:26.029
You can-- and then we'll remember where we were and we'll
pick it up later, so if you come back later and just start,

00:15:26.029 --> 00:15:28.679
you can just go back and press Start Back Up again,

00:15:28.679 --> 00:15:31.719
and you'll continue from where you
are going-- from where you left off.

00:15:31.720 --> 00:15:36.690
And this is especially useful if your machine is in the
middle of doing a backup and you need to shut it down

00:15:36.690 --> 00:15:40.640
or take it on the road, then we'll
just stop what we're doing and we'll--

00:15:40.639 --> 00:15:43.929
we'll pick it up later when we do a backup again.

00:15:46.860 --> 00:15:53.519
So, whenever we backup your system, we always backup
everything you need to do a single-click reinstall of an--

00:15:53.519 --> 00:15:58.340
and get an entirely bootable system with all of your
user accounts and all your system files and everything.

00:15:58.340 --> 00:16:06.680
When we do this, we keep the system data for everything and
that turns out to be on the order of a couple of gigabytes,

00:16:06.679 --> 00:16:10.629
but because it doesn't ever change,
it stays roughly constant.

00:16:10.629 --> 00:16:15.769
So even though, you know, even if you save
your-- your system files are not huge, you know,

00:16:15.769 --> 00:16:21.840
you've got like a 500 gigabyte hard disk and you're talking
about a few gigabytes, so it's not a not a big penalty

00:16:21.840 --> 00:16:27.379
to keep your system and have always a full
rebootable system which we think is really important.

00:16:30.879 --> 00:16:35.490
So, but if you decide that you really don't want
to keep your system file, this is primarily useful

00:16:35.490 --> 00:16:43.370
if you always do a full install off of a DVD and you
prefer to do that versus restoring your full system.

00:16:43.370 --> 00:16:46.330
You can choose to turn-- skip system files now.

00:16:46.330 --> 00:16:51.200
And in this case, you'll-- you'll save
that few gigabytes from your system,

00:16:51.200 --> 00:16:56.940
but it means that you won't have a full rebootable--
a fully bootable restore from one button.

00:16:56.940 --> 00:17:02.200
Now, fortunately, the-- the important thing here is we're
still-- we still work right with the Migration Assistant

00:17:02.200 --> 00:17:06.240
and the Installer, so that we haven't
saved your system files,

00:17:06.240 --> 00:17:11.430
but we're able to restore all your user
files on top of a fresh DVD install.

00:17:11.430 --> 00:17:17.039
So in this case you're still-- you're still able to
get back to a full system with all your user accounts

00:17:17.039 --> 00:17:18.750
and all the permissions are set up and everything.

00:17:18.750 --> 00:17:20.710
So this is really important.

00:17:20.710 --> 00:17:27.059
If you do turn on this-- this-- this option, by the way,
it will speed up your initial backup because we won't have

00:17:27.059 --> 00:17:33.159
to grab any of those system files on your initial backup,
but it really doesn't effect any incremental backups.

00:17:33.160 --> 00:17:37.920
So, because the system files don't change for
the most part, unless you do a system update,

00:17:37.920 --> 00:17:42.460
most of the time this makes no difference in performance
so you're not penalized for keeping your system files

00:17:42.460 --> 00:17:46.819
around which is really, really a good thing.

00:17:46.819 --> 00:17:49.740
So, even if you decide to keep everything, there--

00:17:49.740 --> 00:17:53.819
I just wanted to point out there are some
directories which we automatically skip.

00:17:53.819 --> 00:17:55.519
And these are a few of them here.

00:17:55.519 --> 00:18:01.910
Primarily there are things that are cached like
~/Library/Caches, /Library/Caches Spotlight,

00:18:01.910 --> 00:18:05.259
metadata, things like that, that can be rebuilt later.

00:18:05.259 --> 00:18:07.990
Temporary directories, of course,
because they have got files that are

00:18:07.990 --> 00:18:10.940
that have just been written for temporary reasons.

00:18:10.940 --> 00:18:16.640
Device mounts because individual devices
are backed up as individual devices.

00:18:16.640 --> 00:18:19.370
And network-- network mounts, because we don't want--

00:18:19.369 --> 00:18:24.209
we don't want your backup to be traversing your
local network and backing up other peoples' machines.

00:18:24.210 --> 00:18:28.559
And-- and FileVault images, and I'll
get into that-- in that in a little bit later,

00:18:28.559 --> 00:18:30.799
because there-- they're handled separately.

00:18:32.430 --> 00:18:35.410
So, now we have an even simpler configuration than before.

00:18:35.410 --> 00:18:40.040
You simply go and choose a disk, and you are done.

00:18:40.039 --> 00:18:41.809
There is no step two.

00:18:43.500 --> 00:18:45.119
(Laughter) So, this is even easier than last year.

00:18:45.119 --> 00:18:49.959
You don't have to set times to backup, you
don't have to do anything, you just choose disk.

00:18:49.960 --> 00:18:56.110
And we have even gone a little bit step
further, as Steve mentioned in his keynote,

00:18:56.109 --> 00:19:00.529
we've now added single-click backup setup.

00:19:00.529 --> 00:19:04.619
So, what I've got here is a FireWire hard disk.

00:19:04.619 --> 00:19:10.609
And I'm going to take a machine here, this machine
has never been set up for-- for Time Machine.

00:19:10.609 --> 00:19:14.799
And I'm just going to plug this disk onto here.

00:19:14.799 --> 00:19:22.480
Like so. And the disk appears on the Desktop.

00:19:22.480 --> 00:19:29.690
We notice this.

00:19:31.410 --> 00:19:36.220
And...okay.

00:19:36.220 --> 00:19:46.250
Well...Maybe-- maybe somebody did
plug a disk on here before.

00:19:46.250 --> 00:19:48.619
Let's try this-- another one.

00:19:52.710 --> 00:20:03.610
I didn't. Okay.

00:20:03.609 --> 00:20:15.039
Well...I guess I didn't pray to the right demo god today.

00:20:16.670 --> 00:20:19.840
So, what would have happened-- (Laughter) --

00:20:21.279 --> 00:20:30.309
had somebody not already set up Time Machine on those
machines...is you would have seen this dialog.

00:20:30.309 --> 00:20:32.899
Do you want to enable Time Machine?

00:20:32.900 --> 00:20:41.330
So by default, now, you just simply plug a time-- you simply
plug a FireWire disk or a USB disk onto your computer,

00:20:41.329 --> 00:20:44.730
and you'll be asked, would you like to enable Time Machine?

00:20:44.730 --> 00:20:47.160
And you say, yes, and you are done.

00:20:47.160 --> 00:20:48.410
That's it.

00:20:48.410 --> 00:20:51.740
There is no longer any step one
even, and we detect new disk,

00:20:51.740 --> 00:20:59.069
we configure things for you and you're just set up to go.

00:21:03.210 --> 00:21:07.840
So, part of how we do this is we changed
the default configuration of Time Machine.

00:21:07.839 --> 00:21:14.720
Now automatic is turned on for you, automatically, so as
soon as we have a-- as soon as we get a disk set, we--

00:21:14.720 --> 00:21:17.519
we're running, so automatic is turned on.

00:21:17.519 --> 00:21:21.250
All your system files are backed
up, your boot volume is backed up,

00:21:21.250 --> 00:21:24.490
and all your volumes containing user accounts are backed up.

00:21:24.490 --> 00:21:28.809
So, if you have to-- if you happen to have user
accounts which don't reside on your boot disk,

00:21:28.809 --> 00:21:32.899
we'll grab those volumes as well so
that we get all your user accounts.

00:21:34.420 --> 00:21:39.690
So, we've added Spotlight integration now,
which you should have seen in Steve's keynote.

00:21:39.690 --> 00:21:44.250
So that if you don't happen to find this on your
disk, if you don't happen to find a file on your disk,

00:21:44.250 --> 00:21:48.490
you can start searching your backups
and see if it happens to exist on your backup.

00:21:48.490 --> 00:21:55.349
And if in-- in Spotlight knows about a particular
file, maybe referenced in multiple backups,

00:21:55.349 --> 00:22:00.669
Spotlight knows about this, so if you won't
return multiple hits, beyond the ones that--

00:22:00.670 --> 00:22:05.830
if a file only exists once but it's in many backups,
you'll only see once which is kind of useful.

00:22:05.829 --> 00:22:11.869
And one thing I wanted to mention, this is not included
in the WWDC build, this is fresh, bleeding-edge code here.

00:22:11.869 --> 00:22:20.829
So, as you go on and use your backups these
days, now, especially with automatic backups,

00:22:20.829 --> 00:22:23.799
what's going to happen is over time
you're going to get more and more backups.

00:22:23.799 --> 00:22:26.529
It's going to fill up your disk, so we have added an option

00:22:26.529 --> 00:22:31.210
to optionally remove automatically old
backups for you to recover their space.

00:22:31.210 --> 00:22:33.420
(Applause).

00:22:33.420 --> 00:22:34.980
Thank you, I guess.

00:22:36.119 --> 00:22:38.969
(Laughter) So let's talk about how-- how all that works.

00:22:38.970 --> 00:22:45.269
So, to begin with, whenever you delete
a backup, you don't delete everything

00:22:45.269 --> 00:22:49.019
that appears-- that you apparently have in your backup.

00:22:49.019 --> 00:22:56.369
So, as I make a backup here, as we can see, we've got a
Backup number 1 and it has 3 files in it, A, B and C. So,

00:22:56.369 --> 00:23:01.289
if I go work on my computer for
awhile and then I do another backup,

00:23:01.289 --> 00:23:10.009
in this case what's happened is I make another backup, and
in this case I've removed file A, so it's not in Backup 2,

00:23:10.009 --> 00:23:17.299
I've left file B the same, so it's still there, I've
modified C, so now I have a new version of C in Backup 2,

00:23:17.299 --> 00:23:24.000
and I've added a file D. So here's a case where I've got
two backups. There is 5 files existing on disk, so if--

00:23:24.000 --> 00:23:28.029
but, and-- and Backup 1 appears to have 3 files.

00:23:28.029 --> 00:23:36.879
But if I-- if I remove Backup 1, now,
those go away and I lose files A and C,

00:23:36.880 --> 00:23:40.720
but B is still around, even though it was in Backup 1.

00:23:40.720 --> 00:23:46.279
So because of this, removing a particular backup
doesn't remove everything that you see in that backup,

00:23:46.279 --> 00:23:50.430
it removes only data that is unique to that backup.

00:23:50.430 --> 00:23:58.019
So, if we look at it that way, rather than seeing one huge
backup, and then, you know, other backups that are also huge,

00:23:58.019 --> 00:24:04.109
rather we have a set of-- of individual backups where
each one contains a certain amount of unique data.

00:24:04.109 --> 00:24:10.219
So if I remove any one, I'll only remove some
amount of data and the amount of data depends

00:24:10.220 --> 00:24:15.380
on how much stuff changed in that
particular backup when I made it.

00:24:15.380 --> 00:24:18.780
And so, if we look at that over time, we
end up with something that looks like this,

00:24:18.779 --> 00:24:24.420
where over time I've got a bunch of backups and each
one of them contains a certain amount of unique data

00:24:24.420 --> 00:24:28.039
to that backup that would go away if I removed it.

00:24:28.039 --> 00:24:34.180
So the first thing is, that we do, is we
always keep the backups that you specify.

00:24:34.180 --> 00:24:41.950
So if you say keep, you know, couple weeks, then
we-- we lock those down and we never touch them.

00:24:43.099 --> 00:24:51.799
Then, we go and we remove using a non-linear
distribution, we remove files-- we remove backups that--

00:24:51.799 --> 00:24:58.490
with a tendency to remove older
backups more-- sooner than newer ones.

00:24:58.490 --> 00:25:03.839
And you-- we'll see as-- as this goes on we'll
drop out more files, we'll drop out more files,

00:25:03.839 --> 00:25:08.699
and we end up with something looking kind of like this.

00:25:08.700 --> 00:25:15.220
Where we have the ones that are guaranteed up
front, and then we have a bunch of files left

00:25:15.220 --> 00:25:18.269
that cover the entire time span, so we haven't removed--

00:25:18.269 --> 00:25:26.480
we haven't done anything like just lop off the last
end snapshots, but we've actually kept them over time

00:25:26.480 --> 00:25:31.089
and they're just more-- there's more of them
upfront because you tend to be making those--

00:25:31.089 --> 00:25:36.639
those tend to be the files that you are actively working
on where you might need to go back to one from a day ago,

00:25:36.640 --> 00:25:43.800
versus one from 6 months ago, you're probably only going
to need to go back as an, you know, archive measure.

00:25:45.710 --> 00:25:48.779
So, another feature we have added in encrypted backups.

00:25:48.779 --> 00:25:54.039
This is really useful because nowadays we've all
got those little disks and they're everywhere,

00:25:54.039 --> 00:25:58.680
and we can either misplace them, somebody could
break into the house and steal it, or, you know,

00:25:58.680 --> 00:26:02.279
your roommate could just decide he wants to look at
all your files and he can't get on your machine,

00:26:02.279 --> 00:26:07.889
but he can the get the hard disk because you are not
home and plug it onto his machine and try to read it.

00:26:07.890 --> 00:26:13.620
So, in this case, we backup onto an encrypted HFS+
disk image.

00:26:13.619 --> 00:26:19.919
This is protected by a single machine-wide password
that if you don't know, you can't mount the disk.

00:26:19.920 --> 00:26:28.450
But we have a-- we write a key into the assistant key
chain so that when it-- when it's attached to your machine,

00:26:28.450 --> 00:26:38.819
we can read it, we can do backups to it, we can
restore from it without any user intervention.

00:26:41.730 --> 00:26:49.130
So, for-- for those of you who know what FileVault,
this is our-- this is account encryption facility,

00:26:49.130 --> 00:26:53.860
where you can have your entire account encrypted
and not readable by anyone else on the machine.

00:26:53.859 --> 00:26:57.919
So you have been using FileVault, we now
support backing up FileVault accounts.

00:26:57.920 --> 00:27:01.029
FileVault accounts are backed up
only when the user is logged in,

00:27:01.029 --> 00:27:05.680
because normally it's just an encrypted
disk that we can't read.

00:27:05.680 --> 00:27:10.590
But when you are logged in it'll,
it'll occur, and each backup is--

00:27:10.589 --> 00:27:15.689
each account is backed up on its own encrypted
disk image which is encrypted individually,

00:27:15.690 --> 00:27:22.170
but we also put just as with regular FileVault accounts,
we put a mass-- the system master password on top of it,

00:27:22.170 --> 00:27:30.390
so that the admin is able to restore all the-- the
entire system including all FileVault accounts.

00:27:34.170 --> 00:27:38.570
So, this year we've added support for backing up to servers.

00:27:38.569 --> 00:27:44.849
And we back up to servers by backing up to an HFS+
disk image on the server for each machine.

00:27:44.849 --> 00:27:49.369
So each machine has its own individual backup image.

00:27:49.369 --> 00:27:56.359
And each-- each machine-- so you can have multiple
machines back up on a single server, and as--

00:27:56.359 --> 00:28:01.619
as Deric mentioned earlier our focus is not on the
enterprise but on the individual computer and LAN workgroups,

00:28:01.619 --> 00:28:05.799
so you have, hopefully, a few of these but not thousands.

00:28:09.619 --> 00:28:15.669
So, for working with MacBooks, of course, the-- the--
being able to backup to the server is really great

00:28:15.670 --> 00:28:21.150
because now when you come home you can turn on your
machine and you can just backup to the server

00:28:21.150 --> 00:28:24.610
or the AirPort Extreme that you've got in your house.

00:28:24.609 --> 00:28:32.959
You can also-- also as I mentioned earlier, we have
added support for automatic backup on disk connection.

00:28:32.960 --> 00:28:39.500
So that if you connect a FireWire or USB disk and you
haven't backed up for a while because you've been out

00:28:39.500 --> 00:28:42.650
on the road, we'll notice that and we will say
it's been a while, so we'll go ahead

00:28:42.650 --> 00:28:45.920
and start a backup even if it's not on the hour.

00:28:47.660 --> 00:28:55.990
So, finally I wanted to put a plug in for how you can
work with Time Machine, and the answer is Quick Look.

00:28:55.990 --> 00:28:58.170
Quick Look is very important to Time Machine.

00:28:58.170 --> 00:29:01.620
It is key to-- to how Time Machine operates.

00:29:01.619 --> 00:29:07.739
When their-- when your users go into their old backups
and they want to find that file that they have lost,

00:29:07.740 --> 00:29:12.029
the way that they can find-- figure out which
files-- they might have 5 files named the same thing

00:29:12.029 --> 00:29:17.529
that are different ages, the one-- how are they going
to find the one that they want is using Quick Look.

00:29:17.529 --> 00:29:23.950
So if you have an-- if you have a file format which
isn't a standard file format, place add a plug-in for--

00:29:23.950 --> 00:29:29.950
for Quick Look so that users can
see their files in Time Machine.

00:29:29.950 --> 00:29:34.180
And as a bonus, it works right-- it works
with Finder, it works with Spotlight,

00:29:34.180 --> 00:29:37.570
it works with iChat Theater, so
it's, you know, this is important.

00:29:37.569 --> 00:29:39.250
Write a plug-in!

00:29:41.269 --> 00:29:49.180
And, just so that you will, we have sessions
tomorrow, there's a session at 3:30 in Mission 2,0

00:29:49.180 --> 00:29:52.170
that will-- that's Getting Started with QuickLook.

00:29:52.170 --> 00:29:57.650
So that will be-- that will go over everything you need
to do to write one, and then if you on Friday there's a--

00:29:57.650 --> 00:30:04.280
there's a Lab in-- at noon on how to-- that
will actually help your write your first one.

00:30:07.309 --> 00:30:19.990
So now I'd like to do a quick demo of this,
and assuming it works better than the last one.

00:30:19.990 --> 00:30:33.630
So, I have-- I was looking for some cars earlier, because
I was thinking about, you know, it's time to get a new car.

00:30:33.630 --> 00:30:40.160
And I was talking to the loan guy, it was ACME was the
name of the company, and here's some of the stuff I did,

00:30:40.160 --> 00:30:46.120
and now I can go back in Time Machine, because I know
that I had some quotes on several different cars,

00:30:46.119 --> 00:30:50.129
and I don't remember which one,
but I can go back and I can find,

00:30:50.130 --> 00:30:54.730
I've got a bunch over time, and
I, oh, was this the one I wanted?

00:30:54.730 --> 00:31:02.599
I'm not sure, I can look at it, and I can easily
just go and look at it with Quick Look, say,

00:31:02.599 --> 00:31:06.439
the Porsche Carrera, that might be a little pricey.

00:31:06.440 --> 00:31:09.480
I had some ones before I was looking at.

00:31:09.480 --> 00:31:11.650
Let's see.

00:31:11.650 --> 00:31:16.269
This one? Oh, yeah, that's the one
I was looking at, the Infiniti G5.

00:31:16.269 --> 00:31:21.509
It's a little bit less than the 911,
and I think I can swing that price.

00:31:21.509 --> 00:31:27.470
Now the important thing to notice here is this
is a machine that does not have Excel installed.

00:31:27.470 --> 00:31:34.670
So I'm still able to look at this as Steve showed in
his keynote and I can look at all the information.

00:31:34.670 --> 00:31:39.519
This is something that was sent to me by somebody
else, and I'm still able to look at it and view it,

00:31:39.519 --> 00:31:43.629
and this is the kind of thing that you
can get by adding Quick Look to your--

00:31:43.630 --> 00:31:47.000
to your-- adding a plug-in to Quick Look from you.

00:31:47.000 --> 00:31:57.380
So...And so now I would like to go ahead and
bring up Eric Weiss who is going to talk about some

00:31:57.380 --> 00:32:03.720
of the low-level implementation details
of Time Machine and how it all works.

00:32:03.720 --> 00:32:10.839
(Applause)

00:32:10.839 --> 00:32:15.029
>> Thank you.

00:32:19.269 --> 00:32:21.400
Hello there.

00:32:21.400 --> 00:32:27.160
My name is Eric Weiss. I'm a software
engineer. I work on Time Machine's backend,

00:32:27.160 --> 00:32:32.980
specifically on a process called backupd whose
job it is to wake up, make a backup for you,

00:32:32.980 --> 00:32:36.710
and go away, hopefully, without getting in your way.

00:32:36.710 --> 00:32:38.039
Here we go.

00:32:38.039 --> 00:32:43.460
So I'm going to give you a little bit more detail on how it
is that-- that Time Machine actually works when it's going

00:32:43.460 --> 00:32:47.600
about making backups, and hopefully,
give your an idea of how you guys

00:32:47.599 --> 00:32:50.709
as application developers can-- can take advantage of it.

00:32:50.710 --> 00:32:52.809
So, there are 4 things I'm going to talk about.

00:32:52.809 --> 00:32:57.929
First is we're going to take quick look at what it
is that a backup actually looks like on your disk.

00:32:57.930 --> 00:33:02.480
So, obviously the preferred way for
you to, as a user go and recover and--

00:33:02.480 --> 00:33:06.269
and view your backups is through the-- the Time Machine UI.

00:33:06.269 --> 00:33:12.859
But, if you, say, want to take your backup disk and
plug it into a Tiger machine and look at your backups,

00:33:12.859 --> 00:33:19.069
you actually are actually capable of browsing your backups
entirely through the Finder as though it were a live disk

00:33:19.069 --> 00:33:22.419
that you were looking at, so I'll show you
exactly how it is that that actually looks.

00:33:22.420 --> 00:33:26.640
Also if you're-- if you're going to interface
with Time Machine backup library programmatically,

00:33:26.640 --> 00:33:29.240
you'll want to know what the layout looks like.

00:33:29.240 --> 00:33:35.220
Second I'm going to discuss some features that we take
really, really heavy advantage of in Time Machine.

00:33:35.220 --> 00:33:41.240
So, not-- not things that backupd itself implements,
but public features available to all of you guys

00:33:41.240 --> 00:33:44.620
that let us get backups done and
get them done very, very quickly.

00:33:44.619 --> 00:33:47.199
If you don't know about them, maybe
you'll want to learn about them

00:33:47.200 --> 00:33:50.610
and take advantage of them in your own applications.

00:33:50.609 --> 00:33:55.019
Third, with those features in mind, we're going
to run through very quickly how it is that--

00:33:55.019 --> 00:33:57.940
that backupd goes and makes a backup for you.

00:33:57.940 --> 00:34:02.850
And finally we'll talk about what you guys as
App Developers, as Tool Developers can do to work

00:34:02.849 --> 00:34:07.230
with Time Machine and help each other out.

00:34:07.230 --> 00:34:10.539
So, first, let's take a look at the
structure of a backup on your disk.

00:34:10.539 --> 00:34:13.840
At the top level you have your-- your disk.

00:34:13.840 --> 00:34:19.870
As Robert mentioned, we need to be backing up to an HFS+
volume, because there are lots and lots of features

00:34:19.869 --> 00:34:27.539
that have been-- some added to HFS+ in Leopard, some in
Tiger, and we rely on them very heavily within Time Machine,

00:34:27.539 --> 00:34:30.889
and so we make you back up to an HFS+ volume.

00:34:30.889 --> 00:34:36.379
The top-- top level of the volume you'll see a
folder called Backups with the extension backup DB.

00:34:36.380 --> 00:34:43.400
This is the only place Time Machine writes anything, so if
you're looking for Time Machine content, that's where it goes.

00:34:43.400 --> 00:34:49.110
Underneath there you'll see a folder, associated with every
computer that you're backing up onto that backup disk.

00:34:49.110 --> 00:34:53.260
In this case, I'd just be backing up my
own Mac Pro, but say I were in a small--

00:34:53.260 --> 00:34:58.070
small home, I might have 2 or 3 other machines
all being backed up to that same disk,

00:34:58.070 --> 00:35:03.110
and here's where you would see the content
for each of those individual machines.

00:35:03.110 --> 00:35:07.230
Underneath that you'll see the actual
library of backups for that machine.

00:35:07.230 --> 00:35:11.880
So, each of these 3 folders underneath
Eric's Mac Pro is a backup.

00:35:11.880 --> 00:35:15.559
The name of each of the folders corresponds
to the time that backup was completed.

00:35:15.559 --> 00:35:22.400
So, for instance, the middle one, the highlighted
one would be a backup completed on June 12th at noon.

00:35:22.400 --> 00:35:26.030
And finally if you look inside one
of those backups, you'll see the--

00:35:26.030 --> 00:35:29.390
the disks that you're backing up
on that-- on that date and time.

00:35:29.389 --> 00:35:33.019
So, once you get down to this level,
you can browse those disks

00:35:33.019 --> 00:35:39.170
as though you were browsing them as
a mounted live volume in the Finder.

00:35:39.170 --> 00:35:40.460
Here we go.

00:35:40.460 --> 00:35:44.579
There are a couple of special cases, one of which
is FileVault accounts that you are backing up.

00:35:44.579 --> 00:35:48.460
As Robert mentioned we added support for
backing up FileVault accounts since the--

00:35:48.460 --> 00:35:54.789
since last WWDC, and if you look for FileVault backup
content, it will all be in a folder called FileVault Accounts

00:35:54.789 --> 00:35:58.579
at the top level of your-- your backups
database, or your machine database.

00:35:58.579 --> 00:36:02.670
And inside of there you'll see an encrypted disk
image of each user you are backing up.

00:36:02.670 --> 00:36:06.650
As I think Robert mentioned, we can only backup
FileVault accounts when the user is logged

00:36:06.650 --> 00:36:10.200
in because that's the only time
that the the disk image is mounted.

00:36:10.199 --> 00:36:15.730
But, if you go and look at that disk image you'll see a
backups.backupdb directory at the top level and then each

00:36:15.730 --> 00:36:18.369
of the backup snapshots for that-- that user.

00:36:18.369 --> 00:36:23.829
Keep in mind there won't be a one-to-one correspondence,
necessarily, of system backups to FileVault account backups

00:36:23.829 --> 00:36:28.039
because of that requirement that the users be logged in.

00:36:28.039 --> 00:36:31.719
And finally if you are backing
up to a network location, we--

00:36:31.719 --> 00:36:37.949
we require HFS+ to backup, as I've said a couple
times already, but we want people to be able to backup

00:36:37.949 --> 00:36:43.269
over the network. So the way we do this, is to create
disk images at the top level of the network volume

00:36:43.269 --> 00:36:46.449
which are themselves formatted
HFS+ which we can write

00:36:46.449 --> 00:36:51.809
into as though they were local volumes,
as though we have-- as though a sandbox.

00:36:51.809 --> 00:36:57.769
So, we support AFP, for instance, if you have a fancy new
AirPort Extreme and you can plug in a disk, or SMB, or NFS,

00:36:57.769 --> 00:37:04.780
and in that case, yeah, it's pretty simple, top level of the
volume you'll see a disk image, encrypted or not according

00:37:04.780 --> 00:37:12.430
to your preference, and if you mount that disk image
it will look exactly like the previous two cases.

00:37:12.429 --> 00:37:12.750
All right.

00:37:12.750 --> 00:37:17.849
So now I'm going to talk about some of the publicly
accessible core technologies that backupd uses in order

00:37:17.849 --> 00:37:20.089
to get backups done and get them done quickly.

00:37:20.090 --> 00:37:24.250
There are 4 things that I want to talk about, sorry, 5.

00:37:24.250 --> 00:37:26.050
The first is Extended Attributes.

00:37:26.050 --> 00:37:29.990
Extended Attributes are not new to Leopard,
they were added in Tiger to HFS+,

00:37:29.989 --> 00:37:36.369
and they allow you to apply attributes to-- to,
sorry, key/value pairs to file system objects.

00:37:36.369 --> 00:37:40.839
Files and directories, which essentially
let's you treat them, least from my perspective

00:37:40.840 --> 00:37:42.930
as though they were programmatic objects.

00:37:42.929 --> 00:37:48.019
We use the file system extremely heavily in Time
Machine, and so, we need to store lots of data

00:37:48.019 --> 00:37:52.380
on files, and this is-- this is the way we do it.

00:37:52.380 --> 00:37:56.079
Next, Access Control Lists, ACLs, again, added in Tiger.

00:37:56.079 --> 00:37:59.360
But if you don't know about them,
you might-- might be curious.

00:37:59.360 --> 00:38:03.120
This is how we protect your backups
against accidental tampering.

00:38:04.929 --> 00:38:09.190
Next the FSCopyObject API, the final
feature I'll talk about added in Tiger.

00:38:09.190 --> 00:38:13.559
It's been enhanced a whole bunch in
Leopard and this is a fantastic Copy API.

00:38:13.559 --> 00:38:18.150
If you need to copy things, whether or not you're
doing
it from a backup, I highly recommend FSCopyObject.

00:38:18.150 --> 00:38:23.320
It's super fast, it's robust, and it's used by
all sorts of applications on the system.

00:38:23.320 --> 00:38:27.530
Time Machine uses it to copy everything,
Migration uses it to copy out of backups,

00:38:27.530 --> 00:38:30.769
and Finder uses it to copy everything
whenever
it makes a copy.

00:38:30.769 --> 00:38:36.289
New to Leopard is a feature called Archive
Directory Links, added to HFS+,

00:38:36.289 --> 00:38:39.559
which essentially gives us the
ability to hard link a folder.

00:38:39.559 --> 00:38:45.889
Which is how we represent an unchanged
hierarchy of files and directories very, very quickly.

00:38:45.889 --> 00:38:47.539
And the FSEvents API.

00:38:47.539 --> 00:38:51.889
So there's a session on the FSEvents API and-- and for
a whole lot of detail I recommended you go to that.

00:38:51.889 --> 00:38:56.429
It's in Pacific Heights at 3:30, I think
it's called Introduction to FSEvents.

00:38:56.429 --> 00:39:00.829
FSEvents is a notification mechanism
for file system events.

00:39:00.829 --> 00:39:06.909
Whenever it is that you change a file on disk, you
can not only be notified live of that change happening,

00:39:06.909 --> 00:39:10.819
but in Time Machine's case, we
wake up at some point and we want

00:39:10.820 --> 00:39:13.680
to say what's happened on these
two disks over the last week.

00:39:13.679 --> 00:39:17.259
Which is the last time we ran a backup, and we'll
get a list of all the directories that we care

00:39:17.260 --> 00:39:20.640
about without needing to scan them all individually.

00:39:20.639 --> 00:39:24.829
Looking a little bit closer at each of
these features, first, Extended Attributes.

00:39:24.829 --> 00:39:29.380
As I mentioned they're just key/value pairs
that you store on-- on file system objects.

00:39:29.380 --> 00:39:34.369
And the things that we really like about
them is that 1) since they are file system--

00:39:34.369 --> 00:39:39.589
since it's a file system feature, obviously they're
stored persistently across reboot, they let us--

00:39:39.590 --> 00:39:45.190
let us query whatever information we need
to about-- about backups that we have.

00:39:45.190 --> 00:39:51.320
For instance, here's some stuff, some things we used them
for. One is to when we go to make a backup we want to figure

00:39:51.320 --> 00:39:53.550
out what the last backup was very quickly.

00:39:53.550 --> 00:39:58.980
We do this by remembering an attribute on each of the
backups saying what date if was completed, so we look up,

00:39:58.980 --> 00:40:01.500
we find that the folders that has the last completed date,

00:40:01.500 --> 00:40:04.320
the one that's most recent, and
that's our most recent backup.

00:40:04.320 --> 00:40:09.320
And finally if you look at the directories
associated with each volume you're backing

00:40:09.320 --> 00:40:11.430
up you'll see a bunch of Extended Attributes on them.

00:40:11.429 --> 00:40:16.019
Oh, I should mention that these are certainly not
things I would recommend relying on existing here.

00:40:16.019 --> 00:40:19.050
I'm just giving you a couple of
examples of what we use them for.

00:40:19.050 --> 00:40:25.269
But, right, if you look at the directory containing
a backup of a volume, you'll see a volume UUID,

00:40:25.269 --> 00:40:30.429
so every HFS volume has a UUID associated with
it, which ends up being super useful for our case,

00:40:30.429 --> 00:40:36.829
because when we have a backup of your volume, it might have
a certain name, but if you rename your volume we don't want

00:40:36.829 --> 00:40:39.579
that to force us to make a whole
new backup of that volume again.

00:40:39.579 --> 00:40:47.170
So, rather than relying on the name of your
volume, we-- we rely on the UUID not changing.

00:40:47.170 --> 00:40:49.200
Archive Directory Links.

00:40:49.199 --> 00:40:51.559
These guys are new to Leopard as I mentioned,

00:40:51.559 --> 00:40:55.429
and if you know what a hard link is,
these guys are hard links to folders.

00:40:55.429 --> 00:41:00.009
So, what they do for us is they let us
super quickly represent a directory of

00:41:00.010 --> 00:41:03.420
files and folders that could be N levels deep,

00:41:03.420 --> 00:41:05.490
in a single operation.

00:41:05.489 --> 00:41:09.229
The thing that's very nice about them is that
they are browsable since they're implemented

00:41:09.230 --> 00:41:13.990
in the file system they're browsable
seamlessly through Finder and through Terminal.

00:41:13.989 --> 00:41:17.459
If you go and look at them they look
exactly like normal directories.

00:41:17.460 --> 00:41:20.320
And they degrade to aliases on Tiger systems.

00:41:20.320 --> 00:41:23.530
So you can take your backup volume,
plug it into a Tiger system

00:41:23.530 --> 00:41:26.380
and still navigate it and view your backup content on it.

00:41:26.380 --> 00:41:33.539
If you don't know what a hard link is I
will just very quickly explain what it is.

00:41:33.539 --> 00:41:39.269
So, normally you have a file which gives you
a reference to some blocks

00:41:39.269 --> 00:41:42.099
on your disk and its link count is originally 1.

00:41:42.099 --> 00:41:46.889
So if you create a hard link to that file, you end up
with another reference to those actual blocks on disk,

00:41:46.889 --> 00:41:52.420
this would be as opposed to a simlink or an alias
which would essentially be a-- a pointer to--

00:41:52.420 --> 00:41:57.380
sorry, a simlink would essentially be a small file
that just includes the path to the original file.

00:41:57.380 --> 00:42:03.329
Instead you actually have another reference to those blocks
on disk which lets you do the neat trick of deleting one

00:42:03.329 --> 00:42:08.420
of them and still being able to access that
content on disk through the other hard link.

00:42:08.420 --> 00:42:12.340
And finally, when you get rid of the last
hard link, there goes the actual blocks

00:42:12.340 --> 00:42:14.260
on disk and they're freed to be reclaimed.

00:42:14.260 --> 00:42:21.350
So this is the basic principle that we rely on in order to
compress our backup content and keep it-- keep it small.

00:42:21.349 --> 00:42:27.960
In the case of an Archive Directory Link, common backup
scheme that involves hard links would have one that--

00:42:27.960 --> 00:42:32.980
let's say you are backing up this one directory and nothing
changed inside it, a lot of backup schemes will do something

00:42:32.980 --> 00:42:38.369
where they'll hard link each of the files underneath
that directory which requires you

00:42:38.369 --> 00:42:41.859
to make end hard links for end
files underneath that top level.

00:42:41.860 --> 00:42:47.450
What we do in Time Machine is replace those
three links just to make it painfully obvious,

00:42:47.449 --> 00:42:51.739
with a single hard link to the
top level of that-- that volume.

00:42:54.539 --> 00:42:57.489
Access Control Lists.

00:42:57.489 --> 00:43:04.409
These guys added to-- to Tiger, again, but not sure how
many people actually use them and they're super useful.

00:43:04.409 --> 00:43:07.670
The reason that we use them in Time
Machine is for essentially two reasons.

00:43:07.670 --> 00:43:13.079
First of all they can be applied on top of and in
coordination with POSIX permissions and other ACLs.

00:43:13.079 --> 00:43:17.380
So when you copy something into the backup
store, we want to be able to protect it.

00:43:17.380 --> 00:43:22.119
We don't want someone to accidentally browse through
their backups, not realize they're inside their backups,

00:43:22.119 --> 00:43:25.319
and open something up, modify it, delete it, and whatnot.

00:43:25.320 --> 00:43:27.809
So we want to-- we want to protect
the content of the backups.

00:43:27.809 --> 00:43:34.759
So we-- we apply these ACLs to them, that-- that
tell people you can't-- what do we have on there,

00:43:34.760 --> 00:43:38.310
don't add anything inside here, don't delete
it, don't modify it, etc., etc.

00:43:38.309 --> 00:43:41.150
And the nice thing is since we're not doing that through--

00:43:41.150 --> 00:43:46.369
through a POSIX permissions, when you go and restore
that content later we don't have to worry about it being

00:43:46.369 --> 00:43:49.500
out of sync with what you had originally
put in your backup content.

00:43:49.500 --> 00:43:55.070
All we have to do is, and we do this through the
FSCopyObject API is strip off the ACLs that were put on

00:43:55.070 --> 00:43:57.860
there as they were copied into the backup store.

00:43:57.860 --> 00:44:01.079
There we go.

00:44:01.079 --> 00:44:05.969
And finally the FSEvents API. Again, I
highly recommended going to the session on it.

00:44:05.969 --> 00:44:12.439
The FSEvents API, managed by fseventsd, is the guy that
tracks the list of events, the event history that's happened

00:44:12.440 --> 00:44:14.940
on all the drives that you are backing up.

00:44:14.940 --> 00:44:18.019
So you can get-- you can get events
live, you can get events historical,

00:44:18.019 --> 00:44:23.230
and this is how Time Machine very quickly
figures out what it is that we need to backup.

00:44:23.230 --> 00:44:28.840
Now I wanted to mention one-- one thing about
this that I think illuminates the-- the--

00:44:28.840 --> 00:44:34.019
the greatness of this feature is that there are
situations where you might not have an FSEvent record.

00:44:34.019 --> 00:44:39.349
For instance, let's say I take my backup disk,
remove it from Leopard, plug it into a Tiger machine.

00:44:39.349 --> 00:44:42.150
So, we don't have the FSEvents even running on Tiger,

00:44:42.150 --> 00:44:45.360
and so there would be-- what happens
when I go and make changes there?

00:44:45.360 --> 00:44:49.930
Well, nobody knows about those changes, and
when I go and plug it back into the Leopard

00:44:49.929 --> 00:44:52.039
and make another backup, I wouldn't want to
have just a bunch of stuff that I had done

00:44:52.039 --> 00:44:53.079
that the Time Machine knows nothing about.

00:44:53.079 --> 00:45:01.179
So, the FSEvents framework is able to tell me that
that drive was modified elsewhere, and sorry,

00:45:01.179 --> 00:45:03.449
it can't tell me what those changes were.

00:45:03.449 --> 00:45:07.619
Which requires backup, or sorry, which requires
Time Machine to have this separate fallback path

00:45:07.619 --> 00:45:10.289
that actually does the manual scanning of your--

00:45:10.289 --> 00:45:14.949
your previous backup with the entire
contents of all your disks being backed up.

00:45:14.949 --> 00:45:20.199
And so, if you want to see how much faster you get to be
when you look at the historical event record, and you--

00:45:20.199 --> 00:45:26.000
you take advantage of it, give that a try and then press--
press backup, then you'll see that it takes quite a long time

00:45:26.000 --> 00:45:30.170
on the order of 5 to 10 minutes to scan a very large disk.

00:45:32.369 --> 00:45:36.539
Which speaks volumes to the-- the
effectiveness of FSEvents.

00:45:36.539 --> 00:45:41.690
Now, we'll put those features together and briefly
discuss how it is we go about making a backup.

00:45:41.690 --> 00:45:43.730
First backup is-- is pretty simple.

00:45:43.730 --> 00:45:46.210
There's not too much trickery you can do with that.

00:45:46.210 --> 00:45:51.039
We basically take all your disks and we are going
to copy everything from disk A to backup A,

00:45:51.039 --> 00:45:56.769
obviously filtering out the directories Robert mentioned
which have your temporary stuff, your cached stuff.

00:45:56.769 --> 00:46:03.269
And all the copying happens through the FSCopyObject
API which takes care of slapping the ACLs on all

00:46:03.269 --> 00:46:06.869
of your backup content so that we
don't let people modify it later.

00:46:06.869 --> 00:46:11.980
The more interesting case is an incremental backup
where the first thing we do is we wake up,

00:46:11.980 --> 00:46:15.380
we find the most recent backup that we
have, and we query the FSEvents daemon.

00:46:15.380 --> 00:46:20.099
We say what's changed in my backup structure.

00:46:20.099 --> 00:46:23.139
Let's say I have 4 items that I'm backing up, 4 folders.

00:46:23.139 --> 00:46:28.190
The FSEvents API might say folders B and D changed.

00:46:28.190 --> 00:46:32.950
We then know that those are the only two places that we
have to look for any other changes, so we'll scan inside B,

00:46:32.949 --> 00:46:39.119
we'll scan inside D, we will copy whatever
it is that we have to into the new backup.

00:46:39.119 --> 00:46:46.519
Finally we make 2-- 2, sorry, I perform 2 other operations
to say hard link A, hard link C. These could be directories,

00:46:46.519 --> 00:46:54.280
these could be enormous directories like /System,
and that's it and we're done making a backup.

00:46:54.280 --> 00:46:56.480
Except, there are a couple other things we do.

00:46:56.480 --> 00:47:00.550
One is that we want to guarantee that the point
that we finish a backup, you have a-- a-- a--

00:47:00.550 --> 00:47:08.250
a coherent piece of information that says this is exactly
what my disk looked like at this given point in time.

00:47:08.250 --> 00:47:10.550
So once we're finished a backup we do this extra pass

00:47:10.550 --> 00:47:15.210
where we say, we ask the FSEvents API,
did anything change during the course

00:47:15.210 --> 00:47:16.940
of this backup that we actually care about?

00:47:16.940 --> 00:47:23.150
And if so, we'll do another pass making another backup of
that smaller set of content, and the nice thing is this will

00:47:23.150 --> 00:47:28.490
eventually catch up quite quickly, because as we complete
backups, there is less stuff that's changed and so we have

00:47:28.489 --> 00:47:31.449
less things-- or fewer things we have to look
at and we finish even quicker.

00:47:31.449 --> 00:47:38.250
And finally, the last thing we do is-- is put a
bunch of attributes on the backup that we have,

00:47:38.250 --> 00:47:42.909
erase all the ones that we made in the
middle, and make that your new backup.

00:47:42.909 --> 00:47:46.319
So, I am going to make a quick demo for you.

00:47:46.320 --> 00:47:52.100
This is largely because Deric, in
his desire to show off HFS+ back

00:47:52.099 --> 00:47:55.960
in the day, always really wanted the demo copying a file.

00:47:55.960 --> 00:48:00.130
So now I am going to, in fact, demo copying a file.

00:48:00.130 --> 00:48:02.550
Okay. So, here's the machine I've been looking at earlier.

00:48:02.550 --> 00:48:06.930
Let's just do something to generate
some kind of file system activity.

00:48:06.929 --> 00:48:14.960
I'll duplicate this-- the presentation, I believe this
is the presentation from 2008 that your saw earlier.

00:48:14.960 --> 00:48:18.130
We open up the Time Machine preference.

00:48:18.130 --> 00:48:21.250
(Laughter) Not that copy, the next one.

00:48:21.250 --> 00:48:23.340
Oh no. What's happening?

00:48:25.679 --> 00:48:27.009
Huh.

00:48:27.010 --> 00:48:27.630
(Applause).

00:48:27.630 --> 00:48:30.690
Let's see if I can give this one more shot.

00:48:30.690 --> 00:48:35.280
Go away. Work this time, okay?

00:48:37.860 --> 00:48:39.849
Oh, man. Okay.

00:48:39.849 --> 00:48:44.920
I guess copying a file will, in fact,
have to wait for yet another year.

00:48:44.920 --> 00:48:48.789
(Laughter) Trust me, it's very cool though.

00:48:48.789 --> 00:48:55.019
But anyway, what you would have seen had I been able
to actually make a backup is that despite the fact

00:48:55.019 --> 00:49:01.099
that we're backing up an entire system and there are, what
is it? It looked like, as of a couple days I took a look

00:49:01.099 --> 00:49:07.719
and there was something like 92,000
files and 400,000, sorry--

00:49:07.719 --> 00:49:11.419
400,000 files, 92,000 directories in a typical install.

00:49:11.420 --> 00:49:16.920
Oh, could I have the slides back?

00:49:16.920 --> 00:49:20.269
Oh. Well, I hear that it's not spinning anymore.

00:49:20.269 --> 00:49:22.579
So, could I have the demo back one more time?

00:49:22.579 --> 00:49:24.809
Sorry. Yes.

00:49:24.809 --> 00:49:25.190
All right.

00:49:25.190 --> 00:49:26.670
Okay. If it spins again,

00:49:26.670 --> 00:49:28.480
it's your fault, Robert.

00:49:28.480 --> 00:49:29.710
All right.

00:49:29.710 --> 00:49:31.619
(Applause) There we go.

00:49:31.619 --> 00:49:37.269
So, again, my-- this disk has about
92,000 directories, about 400,000 files,

00:49:37.269 --> 00:49:40.170
the only thing I actually changed was that on my desktop.

00:49:40.170 --> 00:49:46.880
And hopefully through the magic of FSEvents, we see that we
have already figured out what it is that we need to backup.

00:49:46.880 --> 00:49:52.480
Now it is that we're copying those files as
they were, the ones that were changed.

00:49:52.480 --> 00:49:56.639
So it's probably taking a little bit longer because
there's a bunch of stuff that actually changes

00:49:56.639 --> 00:49:59.920
in the background just in the course
of keeping your machine up and running.

00:49:59.920 --> 00:50:01.760
And so it has to come back and get all of that.

00:50:01.760 --> 00:50:03.700
So we've just made a backup.

00:50:03.699 --> 00:50:05.960
(Applause)

00:50:05.960 --> 00:50:07.590
Thank you very much.

00:50:09.119 --> 00:50:14.849
And, third thing I'd like to talk about, sorry, the
final thing I'd like to talk about is how it is that you

00:50:14.849 --> 00:50:18.989
as app developers and tool developers
can work with Time Machine.

00:50:18.989 --> 00:50:20.659
So lots of ways you can do it.

00:50:20.659 --> 00:50:26.429
One: If you have any interest in copying things
out of the backup store, you can totally do this.

00:50:26.429 --> 00:50:29.799
This is just fine, but you have
to use the FSCopyObject API.

00:50:29.800 --> 00:50:34.060
That's actually a good thing because the
FSCopyObject API is really, really good.

00:50:34.059 --> 00:50:38.190
And it's really well tested, and it's been
improved a whole bunch in Leopard simply

00:50:38.190 --> 00:50:43.150
because Time Machine copies an enormous amount of stuff
and we've been working very closely with them to-- to--

00:50:43.150 --> 00:50:45.910
to make it as good as it possibly can be.

00:50:45.909 --> 00:50:49.480
It's extremely fast, it's robust, it knows
about all the stuff that I've talked about.

00:50:49.480 --> 00:50:53.320
It knows about the Archive Directory Links,
it won't have a problem copying them.

00:50:53.320 --> 00:50:58.570
It knows about the ACLs because it put them on in the first
place and it can strip them off on the way out, and

00:50:58.570 --> 00:51:02.400
it's used by all sorts of applications throughout
the system.

00:51:04.150 --> 00:51:09.690
Secondly, you're an app developer and
you have-- you use the file system.

00:51:09.690 --> 00:51:13.280
Let's say you have documents that you
create or you write a bunch of files.

00:51:13.280 --> 00:51:14.490
Here's are bunch of things that you can do.

00:51:14.489 --> 00:51:16.299
There are 3 that I'd like to talk about.

00:51:16.300 --> 00:51:22.900
One is if you write a lot of files or you write big files,
exclude the ones that you don't need to have backed up.

00:51:22.900 --> 00:51:29.329
Second, try not to have directories that have huge
numbers of files in a flat directory structure.

00:51:29.329 --> 00:51:31.069
That just makes backup a little bit slow.

00:51:31.070 --> 00:51:33.610
It's not tragic if you do it, but it will slow things down.

00:51:33.610 --> 00:51:40.230
And finally, if you have really-- really big
files that change constantly, try and avoid those,

00:51:40.230 --> 00:51:45.639
because that will eat people's disk place very quickly,
and the most important as Robert mentioned and--

00:51:45.639 --> 00:51:51.389
and Deric mentioned also, please support
Quick Look if you have  document types.

00:51:51.389 --> 00:51:56.670
So, if you're excluding stuff there are things that you
should exclude, obviously temporarily files, cache files,

00:51:56.670 --> 00:52:01.500
index files, anything you can rebuild. The easiest
way to get this stuff excluded is just to put it

00:52:01.500 --> 00:52:03.739
in a standard directories for these sort of things.

00:52:03.739 --> 00:52:08.259
If you do that, Time Machine has logic built in where it
will not go ahead and backup anything that you're putting

00:52:08.260 --> 00:52:11.820
in your /tmp directories, your cache
directories so that's probably the easiest way.

00:52:11.820 --> 00:52:16.260
But if that doesn't make sense in your
particular case, we have some API for you.

00:52:16.260 --> 00:52:18.480
There are 2 versions of this API.

00:52:18.480 --> 00:52:27.260
CSBackupSetItemExcluded. And what you do is you call this
on a path, and you say, depending on the value your giving

00:52:27.260 --> 00:52:32.870
to an excludeBy Path, either Time Machine will remember
that specific path and never backup whatever happens

00:52:32.869 --> 00:52:40.000
to live there at that time, or if this is an item that you
don't want to backup that might move across the file system,

00:52:40.000 --> 00:52:45.940
set-- pass false to that, and we'll set an extended attribute
on this specific item that you don't want to backup

00:52:45.940 --> 00:52:52.090
and we'll track that wherever it goes and
make sure that it never gets backed up.

00:52:52.090 --> 00:52:58.090
Finally, sorry, thirdly, if you-- if you're using the
file system, heavily, again, try not to create really,

00:52:58.090 --> 00:53:00.150
really big files that need to change all the time.

00:53:00.150 --> 00:53:04.769
The problem that we have with them is that we're
making backups every hour, and when we do that

00:53:04.769 --> 00:53:08.719
and you have a several gigabyte file, unless people
have enormous hard drives we are going to fill those

00:53:08.719 --> 00:53:10.269
up pretty quickly.

00:53:10.269 --> 00:53:17.449
The easiest way to avoid that or-- or the-- the, economical
example of something to avoid is an enormous file most

00:53:17.449 --> 00:53:23.369
of which is static but you have some-- some indexable
content that you are constantly updating on that file.

00:53:23.369 --> 00:53:28.019
And finally, yeah, if you have a-- if you have a single
folder that has a huge number of files inside it,

00:53:28.019 --> 00:53:31.780
this is going to slow backup down, because,
as I mentioned a couple of times, we're,

00:53:31.780 --> 00:53:34.830
we're creating these Archive Directory
Links and this is one of our real--

00:53:34.829 --> 00:53:41.110
really major performance advantages is being able to-- to
skip these really big directories as quickly as possible.

00:53:41.110 --> 00:53:46.809
But if you have a very flat structure and a single thing
changes in it, so you have a 10,000 file folder and one file

00:53:46.809 --> 00:53:51.769
in it changes, we can't create a directory link to that
and we need to scan the entire contents of that folder;

00:53:51.769 --> 00:53:59.320
we need to scan the entire contents of your previous
version of that folder, and make 9,999 hard links to--

00:53:59.320 --> 00:54:01.210
just so we can copy over a new version of one file.

00:54:01.210 --> 00:54:04.050
So, again, just slows us down a little bit, it's not
tragic, but if you can avoid it, that would be fantastic.

00:54:04.050 --> 00:54:12.320
And, finally, again, support Quick Look.

00:54:12.320 --> 00:54:16.260
If you have your own document style
this is the best way to look fantastic

00:54:16.260 --> 00:54:21.340
in Time Machine, and they are pretty easy to write.

00:54:21.340 --> 00:54:22.530
So, that's all that I have for you.

00:54:22.530 --> 00:54:25.510
And, thank you very much, we're
going to move on to Q&A now.

00:54:25.510 --> 00:54:29.500
(Applause)