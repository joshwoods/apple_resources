WEBVTT

00:00:11.150 --> 00:00:12.740
Good morning, everybody.

00:00:12.750 --> 00:00:15.240
It's good to see you all here
early in the morning on the

00:00:15.240 --> 00:00:16.340
first full day of the conference.

00:00:16.340 --> 00:00:21.010
We've got a lot of cool new
stuff to show you in Tiger.

00:00:22.600 --> 00:00:25.030
So the outline of what we're
going to talk about today,

00:00:25.040 --> 00:00:28.780
I'll give a quick recap of the
Bonjour technology for the few

00:00:28.790 --> 00:00:31.550
people in the audience who may not
be completely familiar with it.

00:00:31.810 --> 00:00:41.120
I'm going to cover what's new,
and then we're going to do some hands-on

00:00:41.120 --> 00:00:41.120
demonstration examples to show you with
real code how easy it is to use this.

00:00:41.500 --> 00:00:45.380
And then my colleague Kiran Sarkar is
going to talk about the new wide area

00:00:45.380 --> 00:00:49.880
Bonjour capabilities that are in Tiger,
and he will show you some

00:00:50.220 --> 00:00:53.740
examples of how you can set up
your own wide area Bonjour server

00:00:53.740 --> 00:00:55.520
using a standard DNS server.

00:00:57.810 --> 00:00:59.500
So the recap.

00:00:59.520 --> 00:01:03.760
This is what was an hour-long talk
at the first WWDC presentation

00:01:03.760 --> 00:01:06.270
on zero configuration networking,
and now it's one slide,

00:01:06.280 --> 00:01:08.890
but I do want to cover it to make
sure we're all on the same page.

00:01:10.900 --> 00:02:35.400
[Transcript missing]

00:02:35.890 --> 00:02:39.410
That happens pretty
much today using DHCP.

00:02:39.540 --> 00:02:43.430
If you show up at a conference like
this or you're in a hotel room,

00:02:43.450 --> 00:02:45.700
using DHCP,
you can just plug into the Ethernet

00:02:45.700 --> 00:02:49.120
or join the wireless network and
you get an address automatically.

00:02:49.120 --> 00:02:52.940
So that aspect of IP is
reasonably well handled.

00:02:52.950 --> 00:02:56.020
The aspect that isn't handled
is when you're not on a big

00:02:56.020 --> 00:02:58.120
network run by an administrator.

00:02:58.120 --> 00:03:01.520
It's just your computer and
your printer and a cable.

00:03:01.520 --> 00:03:03.180
And there is no DHCP server.

00:03:03.180 --> 00:03:04.660
There is no DNS server.

00:03:04.660 --> 00:03:08.120
And before Bonjour,
IP would just fall on its face and

00:03:08.120 --> 00:03:11.760
not have any idea what to do because
there was no server there to tell it.

00:03:11.760 --> 00:03:13.540
And that's what Bonjour fixed.

00:03:15.920 --> 00:03:18.850
The technology that made
that work are three things.

00:03:18.850 --> 00:03:22.470
IPv4 link local addressing gives
you an address when there's no

00:03:22.470 --> 00:03:24.200
DHCP server to hand one out.

00:03:24.200 --> 00:03:27.950
Multicast DNS gives you name
lookup when there's no DNS server

00:03:28.110 --> 00:03:29.870
to look up names for you.

00:03:29.870 --> 00:03:34.290
And the third thing is a new step
forward from good old-fashioned IP,

00:03:34.380 --> 00:03:38.220
and that's browsing the network
with DNS service discovery

00:03:38.280 --> 00:03:40.470
to discover what's out there.

00:03:40.820 --> 00:03:46.250
DNS service discovery works equally well
on multicast DNS in the local case and,

00:03:46.250 --> 00:03:51.030
as you'll see now, using standard unicast
DNS in the wide area case.

00:03:52.610 --> 00:03:55.000
Since we launched this
technology three years ago,

00:03:55.000 --> 00:03:57.780
it's become very widely available.

00:03:57.780 --> 00:04:00.340
It's been in several MacÂ OS releases.

00:04:00.340 --> 00:04:01.460
It's been in Windows.

00:04:01.460 --> 00:04:03.070
It's in Linux.

00:04:03.070 --> 00:04:06.460
It's in many,
many software products from Apple.

00:04:06.460 --> 00:04:09.010
Pretty much anything on the
Mac that does networking uses

00:04:09.010 --> 00:04:12.110
Bonjour because the engineers at
Apple clearly see the benefits.

00:04:12.170 --> 00:04:13.380
Safari uses it.

00:04:13.380 --> 00:04:14.500
iChat uses it.

00:04:14.500 --> 00:04:17.620
iTunes uses it,
both for peer-to-peer iTunes

00:04:17.620 --> 00:04:22.160
music networking and also for
discovering the Airport Express.

00:04:22.500 --> 00:04:24.310
Those of you who've got
an Airport Express will

00:04:24.470 --> 00:04:26.880
know you just plug it in,
and it just appears in that pop-up menu

00:04:26.880 --> 00:04:28.480
at the bottom of the iTunes window.

00:04:28.480 --> 00:04:30.690
No typing in addresses
or any of that nonsense.

00:04:30.690 --> 00:04:32.240
If there's one there, it shows up.

00:04:32.240 --> 00:04:35.690
All of that made possible by Bonjour.

00:04:36.040 --> 00:04:39.720
Network printers have very
widely adopted Bonjour,

00:04:39.720 --> 00:04:41.920
and that's why they just show
up in the print dialogue.

00:04:41.960 --> 00:04:44.650
TiVo is using it.

00:04:44.730 --> 00:04:46.690
Many,
many hardware products are using it.

00:04:49.390 --> 00:04:52.360
So what's new since the last time we met?

00:04:52.390 --> 00:04:55.720
Well,
for those of you who haven't heard yet,

00:04:55.720 --> 00:04:57.700
Rendezvous is now Bonjour.

00:04:57.700 --> 00:05:02.640
We have a new name, but the same logo,
and from now on, you won't be hearing the

00:05:02.860 --> 00:05:04.840
word Rendezvous anymore.

00:05:06.930 --> 00:05:08.590
What else is new since
the last time we met?

00:05:08.650 --> 00:05:12.750
All of the specification documents
have been updated to reflect what

00:05:12.860 --> 00:05:15.310
the software now does in Tiger.

00:05:15.320 --> 00:05:18.740
We made a lot of improvements
in Tiger compared with Panther,

00:05:18.740 --> 00:05:21.570
and a lot of the third-party
device makers were asking

00:05:21.740 --> 00:05:23.270
for the details of that.

00:05:23.270 --> 00:05:26.660
And as soon as we got Tiger shipped,
we focused on getting all

00:05:26.660 --> 00:05:28.320
those documents updated.

00:05:28.800 --> 00:05:32.360
Link Local Addressing After many
years of work at the IETF,

00:05:32.510 --> 00:05:34.760
just last month was published.

00:05:34.760 --> 00:05:36.980
It's now an official IETF standard RFC.

00:05:36.980 --> 00:05:41.600
The other drafts are all available
at the dns-sd.org website.

00:05:41.650 --> 00:05:44.900
That's linked off the
Apple Bonjour website,

00:05:44.900 --> 00:05:47.490
so you can find that very easily.

00:05:50.720 --> 00:05:51.600
What else is new?

00:05:51.600 --> 00:05:54.240
Well, big news.

00:05:54.770 --> 00:05:58.040
We've released Bonjour for Windows.

00:05:58.040 --> 00:06:01.210
Many of our hardware makers
making devices like cameras

00:06:01.280 --> 00:06:04.890
and printers said to us,
"We love this Bonjour on the Mac.

00:06:04.890 --> 00:06:07.390
We love link local addressing,
and it's just absolutely fabulous.

00:06:07.390 --> 00:06:09.870
You plug things in and they just work.

00:06:10.020 --> 00:06:15.240
But what about Windows?" We still have
to have the manual this thick explaining

00:06:15.310 --> 00:06:17.790
how to set it up for Windows users.

00:06:17.990 --> 00:06:22.040
We made Bonjour for Windows available,
and as of today,

00:06:22.040 --> 00:06:26.000
you can now license Bonjour for
Windows to include with your product.

00:06:26.090 --> 00:06:30.270
So instead of having a manual that
thick and huge tech support costs

00:06:30.270 --> 00:06:34.290
answering the phone trying to
explain to people how to set it up,

00:06:34.290 --> 00:06:37.110
you just put the installer
on the CD in the box,

00:06:37.170 --> 00:06:39.330
and Windows users get...

00:06:39.760 --> 00:06:41.740
Not exactly the same
ease of use as Mac users,

00:06:41.740 --> 00:06:45.740
but they get the ability to
discover Bonjour devices on the

00:06:45.750 --> 00:06:47.200
network in Internet Explorer.

00:06:47.200 --> 00:06:50.520
They get the ability to set
up printers without hassle.

00:06:50.520 --> 00:06:54.650
They get the ability to run other
software that you may develop running

00:06:54.650 --> 00:06:57.030
on Windows using the same APIs as OS X.

00:06:57.590 --> 00:06:59.990
Setting up printers is
an interesting story.

00:07:00.000 --> 00:07:04.230
There's a website called iFelix,
not affiliated with Apple or Microsoft.

00:07:04.230 --> 00:07:06.300
I just happened to find it one day.

00:07:06.300 --> 00:07:10.050
And they have a bunch of how-to
instruction files telling people how

00:07:10.140 --> 00:07:12.680
to set up computers and solve problems.

00:07:12.680 --> 00:07:15.680
And they had a page on how to
do network printing on Windows.

00:07:15.680 --> 00:07:17.050
And I printed it out.

00:07:17.050 --> 00:07:22.050
And the paper came to more than six feet,
taller than I am, and it stuck up on the

00:07:22.050 --> 00:07:23.820
wall outside my office.

00:07:23.820 --> 00:07:27.060
And recently they added a
link at the top of that page.

00:07:27.580 --> 00:07:57.140
That said, don't do this.

00:07:57.140 --> 00:07:57.140
Just install Bonjour for Windows.

00:07:57.140 --> 00:07:57.140
And the new instructions with
Bonjour for Windows are four screenshots.

00:07:57.140 --> 00:07:57.140
And actually the first screenshot
is the introduction and the final

00:07:57.140 --> 00:07:57.140
screenshot is the congratulations,
you've finished.

00:07:57.140 --> 00:07:57.140
So it's only really two screenshots.

00:07:57.140 --> 00:07:57.140
And I wanted to make it less than that.

00:07:57.140 --> 00:07:57.140
I actually wanted us to have
in the first screen just a

00:07:57.140 --> 00:07:57.140
button saying I'm feeling lucky.

00:07:57.140 --> 00:07:57.140
And you click it and the window
disappears and you're done.

00:07:57.140 --> 00:07:57.140
So that's available for Windows,
which meets one of the big needs

00:07:57.140 --> 00:07:57.140
that hardware developers are having.

00:07:57.140 --> 00:07:58.990
were asking us.

00:07:59.530 --> 00:08:01.720
It's available for licensing today.

00:08:01.830 --> 00:08:05.840
Contact bonjourdev@apple.com
and we'll sort out the details

00:08:05.890 --> 00:08:07.600
of getting that on your CD.

00:08:07.630 --> 00:08:11.720
It's available for public
download to anybody who wants

00:08:11.990 --> 00:08:14.500
it today at apple.com/bonjour.

00:08:14.510 --> 00:08:15.800
I picked up a magazine.

00:08:15.800 --> 00:08:18.870
I just came back from London,
and I picked up this

00:08:18.870 --> 00:08:20.510
magazine in the airport.

00:08:20.630 --> 00:08:22.830
What Hi-Fi?

00:08:22.830 --> 00:08:26.440
Like a lot of Hi-Fi magazines,
they're still extolling the virtues

00:08:26.570 --> 00:08:28.440
of LPs and turntables and vinyl.

00:08:28.440 --> 00:08:32.890
But they had a review of
network music players.

00:08:32.900 --> 00:08:37.670
Their top-rated music player, well,
actually the only one that didn't stink,

00:08:37.670 --> 00:08:43.750
basically, was the Roku SoundBridge,
which I'm sure people who have been here

00:08:43.860 --> 00:08:46.050
before saw me show in previous years.

00:08:47.000 --> 00:08:48.450
Very nice little elegant product.

00:08:48.450 --> 00:08:53.260
Implements link local addressing and
multicast DNS and DNS server discovery,

00:08:53.260 --> 00:08:56.350
all of the Bonjour conformance
test checklist items,

00:08:56.380 --> 00:08:58.600
and you just plug it in and it works.

00:08:58.600 --> 00:09:02.060
The other interesting thing was in
their annual roundup of products,

00:09:02.120 --> 00:09:03.700
they created a new category.

00:09:03.700 --> 00:09:06.990
First time this year,
Technology Product of the Year,

00:09:06.990 --> 00:09:10.890
and that award went to the
Airport Express for playing music.

00:09:10.940 --> 00:09:16.630
And this is really,
really gratifying to the Bonjour team.

00:09:16.640 --> 00:09:21.820
Because those products both singled out
in this magazine as being the Hi-Flyers,

00:09:21.820 --> 00:09:23.660
made possible by Bonjour.

00:09:23.740 --> 00:09:26.730
Now, of course,
as a technology behind the scenes,

00:09:26.730 --> 00:09:29.510
you won't see that
mentioned in the magazine.

00:09:29.590 --> 00:09:31.790
They don't know why it works,
they just know that it works.

00:09:31.840 --> 00:09:37.380
And partly that's because while we were
in the transition of picking a new name,

00:09:37.380 --> 00:09:42.160
companies were not putting
Rendezvous or Bonjour on their boxes.

00:09:42.280 --> 00:09:45.580
Well, as of today, you can license the
logo and the trademark.

00:09:45.580 --> 00:09:46.780
But you can't license the
logo and the trademark.

00:09:46.780 --> 00:09:49.650
As well as licensing Bonjour for Windows.

00:09:49.690 --> 00:09:53.740
And I encourage all of you to do that
and start putting that logo on the boxes.

00:09:54.000 --> 00:09:56.980
Because somebody described
Bonjour as the best kept secret

00:09:57.010 --> 00:09:58.690
in the networking industry.

00:09:58.740 --> 00:10:01.820
I heard somebody at this
conference asking the question,

00:10:01.820 --> 00:10:05.000
"When are printer makers
going to start adopting it?"

00:10:05.420 --> 00:10:08.660
Pretty much every printer,
every network printer you can

00:10:08.700 --> 00:10:12.040
buy today from every network
printer maker does Bonjour,

00:10:12.040 --> 00:10:15.000
but they don't say on the
box because we're in the

00:10:15.110 --> 00:10:17.140
process of changing the name.

00:10:20.090 --> 00:10:24.760
I'm not saying that these products
in these magazines were necessarily

00:10:25.060 --> 00:10:26.760
the best because they use Bonjour.

00:10:26.850 --> 00:10:30.550
It's not some magic fairy dust
that you sprinkle on a bad product

00:10:30.550 --> 00:10:32.550
and it magically becomes good.

00:10:32.580 --> 00:10:36.500
But there is a definite correlation
that the kind of developers who

00:10:36.500 --> 00:10:40.090
care about doing Bonjour are the
kind of developers who get all

00:10:40.160 --> 00:10:42.260
the other details right as well.

00:10:42.260 --> 00:10:44.120
And it's not a slight difference.

00:10:44.120 --> 00:10:45.790
It's night and day.

00:10:46.110 --> 00:10:50.260
Jim Laudebach wrote a Ziff Davis article
about network music players.

00:10:50.350 --> 00:10:51.650
He reviewed four of them.

00:10:51.660 --> 00:10:55.580
Three of them he gave up after two
hours and couldn't get them to work.

00:10:55.610 --> 00:10:56.740
The fourth was the Roku.

00:10:56.830 --> 00:10:57.700
He plugged it in.

00:10:57.700 --> 00:10:59.230
It worked in 30 seconds.

00:10:59.240 --> 00:11:04.360
And you want to put the Bonjour logo on
your packaging to let people know which

00:11:04.360 --> 00:11:07.100
of those groups your product falls in.

00:11:16.050 --> 00:11:22.930
Last year, we previewed the Java API,
and I'm pleased to tell you that that

00:11:23.070 --> 00:11:25.580
API was polished up and finished.

00:11:25.640 --> 00:11:26.540
It's in Tiger.

00:11:26.540 --> 00:11:28.180
It's in Bonjour for Windows.

00:11:28.180 --> 00:11:31.240
It also went into the
10.3.9 software update,

00:11:31.240 --> 00:11:34.880
so for those of you making Java apps,
you don't need to require Tiger.

00:11:36.500 --> 00:11:42.300
So that's there from 10.3.9 and
later for the Java programmers.

00:11:42.410 --> 00:11:46.180
And the other big new feature,
which Kieran's going to tell you about,

00:11:46.190 --> 00:11:48.750
is wide area Bonjour.

00:11:49.400 --> 00:13:55.400
[Transcript missing]

00:13:56.470 --> 00:13:58.200
So now it's time for the demo.

00:13:58.230 --> 00:14:06.740
We will switch to demo one, please.

00:14:06.750 --> 00:14:08.300
OK.

00:14:11.210 --> 00:14:17.490
So what I want to show you
right now is how easy it is to

00:14:18.040 --> 00:14:21.010
Add Bonjour to hardware products,
how easy it is to use in

00:14:21.010 --> 00:14:23.860
software applications in a
variety of different languages.

00:14:31.500 --> 00:14:39.400
[Transcript missing]

00:14:42.460 --> 00:14:45.600
This is a network camera made
by a company called Axis.

00:14:45.600 --> 00:14:52.250
And those of you who were at the
developer conference when we first

00:14:52.250 --> 00:14:56.750
announced Rendezvous as it was
then in MacÂ OSÂ 10.2 will remember

00:14:56.750 --> 00:14:59.400
I showed some Axis cameras on stage.

00:14:59.420 --> 00:15:02.200
And we had a demo where
the Mac software was real,

00:15:02.200 --> 00:15:04.850
but all the hardware was being simulated.

00:15:04.890 --> 00:15:09.620
And the point of the demo was to
show how the world could be if these

00:15:09.620 --> 00:15:12.380
devices adopted Bonjour or Rendezvous.

00:15:21.970 --> 00:15:25.420
Access is one of the companies
that's been shipping Bonjour-enabled

00:15:25.420 --> 00:15:27.980
products for about a year,
but most people don't know

00:15:28.040 --> 00:15:30.620
that unless you happen to
notice it show up in Safari.

00:15:30.620 --> 00:15:32.930
Starting now,
they'll be making a fuss about

00:15:33.320 --> 00:15:36.520
that in their marketing and
putting the logo on the box.

00:15:37.200 --> 00:15:41.730
The other thing I love about
this Access camera is this

00:15:41.780 --> 00:15:46.980
does power over Ethernet,
and that really addresses one of the

00:15:47.440 --> 00:15:51.010
last criticisms of IP-based networking.

00:15:51.100 --> 00:15:53.590
The advantage of USB and FireWire
is you don't need a power brick

00:15:53.590 --> 00:15:55.240
because you get power on the cable.

00:15:55.240 --> 00:16:00.060
And power over Ethernet was invented a
few years ago by companies like Cisco to

00:16:00.060 --> 00:16:04.530
power their IP phones on the desktop
and to power wireless base stations

00:16:04.530 --> 00:16:07.060
that you put into the ceiling space.

00:16:08.540 --> 00:16:11.690
and it was too expensive.

00:16:12.110 --> 00:16:16.220
If you want to put wireless base stations
down the corridor in your company,

00:16:16.520 --> 00:16:19.470
and you have to hire an electrician
to crawl through the ceiling space and

00:16:19.520 --> 00:16:22.140
put the power outlets to power them,
he's going to charge you

00:16:22.140 --> 00:16:23.580
about $100 an outlet.

00:16:23.580 --> 00:16:27.470
So Cisco said, OK,
we'll charge you about $100

00:16:27.500 --> 00:16:29.620
a port on the Ethernet hub.

00:16:29.630 --> 00:16:32.200
So a 24-port Ethernet switch
would cost you $2,500.

00:16:32.300 --> 00:16:37.380
And that kind of put it out of reach as a
practical technology for home consumers.

00:16:38.340 --> 00:16:42.040
I'm very excited that Netgear has
started shipping a $100 hub that

00:16:42.110 --> 00:16:43.270
provides power over Ethernet.

00:16:43.300 --> 00:16:46.970
And we plug this in.

00:16:48.430 --> 00:16:51.600
This runs Linux,
so it's powered over the cable.

00:16:51.600 --> 00:16:56.960
Some of you may remember some of the
products I've shown in previous years.

00:16:56.960 --> 00:16:59.940
This is the SCH Intercom print server.

00:16:59.940 --> 00:17:04.740
I think this was the first
Bonjour-capable print server.

00:17:04.740 --> 00:17:07.520
You plug it in the parallel port
and you connect the Ethernet.

00:17:07.540 --> 00:17:11.640
You'll see the power brick is about
as big as the print server itself.

00:17:11.690 --> 00:17:12.930
Stuart Cheshire

00:17:13.360 --> 00:17:14.740
This is the Site Player Telnet.

00:17:14.960 --> 00:17:17.440
It connects to the serial port
so you can telnet over the

00:17:17.440 --> 00:17:19.290
Ethernet to a serial device.

00:17:19.500 --> 00:17:22.000
Power brick bigger than the device.

00:17:22.100 --> 00:17:25.030
This is a beautiful little IO gear thing.

00:17:25.360 --> 00:17:26.640
This is a print server.

00:17:26.690 --> 00:17:28.800
USB in this side, Ethernet out this side.

00:17:28.800 --> 00:17:30.150
Power brick.

00:17:30.260 --> 00:17:32.930
These things are all crying
out for power over Ethernet.

00:17:32.930 --> 00:17:36.690
So for the hardware makers in the room,
definitely I urge you to consider

00:17:36.690 --> 00:17:39.880
looking at power over Ethernet
now the price is coming down.

00:17:39.880 --> 00:17:42.270
It can save all of this spaghetti wiring.

00:17:44.430 --> 00:17:51.400
So you'll see the Axis
camera showing up in Safari.

00:17:52.240 --> 00:17:55.380
I can double click it and it connects.

00:17:55.510 --> 00:17:59.300
So we discovered it, but

00:18:02.590 --> 00:18:06.660
Viewing video in a web
page is kind of cumbersome.

00:18:06.680 --> 00:18:11.440
Modern video streaming is done using RTP,
and QuickTime can play RTP streams.

00:18:11.440 --> 00:18:16.680
So I thought it wouldn't be much better
if we could actually just discover the

00:18:16.680 --> 00:18:21.650
RTP streaming service this camera offers,
rather than just a generic web page.

00:18:21.660 --> 00:18:28.000
So let's go to setup.

00:18:30.540 --> 00:18:33.510
Now, this runs Linux,
so you can just get the Darwin code

00:18:33.540 --> 00:18:35.040
and compile the responder.

00:18:35.420 --> 00:18:40.110
Fortunately, I didn't have to because
Access has already done that.

00:18:40.130 --> 00:18:45.730
What I did with this camera was I went
into the little scripting editor that

00:18:45.980 --> 00:18:49.150
they've got built in to the camera

00:18:49.790 --> 00:18:55.760
and in the configuration directory,
this is their services file that

00:18:55.760 --> 00:18:57.220
describes the services on the camera.

00:18:57.220 --> 00:19:01.400
It was already advertising HTTP,
and it was advertising Access Video.

00:19:01.400 --> 00:19:08.090
I added this section here to add RTSP,
reboot the camera,

00:19:08.430 --> 00:19:13.120
and now when we look in QuickTime Player,

00:19:13.240 --> 00:19:17.700
This is in QuickTime Player 7
on Panther and on Tiger.

00:19:17.700 --> 00:19:21.780
In the Open URL panel,
you pull down this menu and it

00:19:21.780 --> 00:19:25.510
will discover Bonjour advertised
RTP streams on the network.

00:19:25.600 --> 00:19:31.850
You select it and we have Bonjour.

00:19:37.710 --> 00:19:39.100
We have networked video.

00:19:39.100 --> 00:19:44.690
So that was a quick prototype.

00:19:44.700 --> 00:19:46.440
That was about half an hour's work.

00:19:49.770 --> 00:19:55.650
What I want to show you now is how
we added that to QuickTime Player.

00:19:58.560 --> 00:20:02.940
One of the tools here,
if you've not seen Bonjour Browser,

00:20:02.940 --> 00:20:04.520
it's a great tool for developers.

00:20:04.520 --> 00:20:08.420
It will just browse the network
and tell you what's there.

00:20:08.420 --> 00:20:09.510
Now, this can be hard on the network.

00:20:09.630 --> 00:20:11.130
You don't want to leave
it running all the time.

00:20:12.800 --> 00:20:29.000
[Transcript missing]

00:20:46.400 --> 00:20:51.520
The dns-sd command is really
an internal testing tool,

00:20:51.520 --> 00:20:56.820
but we ship it with Tiger because
it is such a useful testing tool,

00:20:56.820 --> 00:21:00.110
both in the development process
and in troubleshooting networks.

00:21:00.200 --> 00:21:11.260
So I will do a-b,
browse for HTTP TCP service, and...

00:21:13.790 --> 00:21:16.790
We can see that the camera
is advertising HTTP.

00:21:16.870 --> 00:21:18.520
So this was the first thing we did.

00:21:18.640 --> 00:21:21.860
When I wanted to confirm that I'd
made the camera advertise RTSP,

00:21:21.860 --> 00:21:26.320
before I embarked on a big programming
project on QuickTime Player,

00:21:26.320 --> 00:21:28.620
the first thing to do is
browse on the command line.

00:21:28.620 --> 00:21:34.090
And there we've successfully confirmed
that the camera is advertising.

00:21:35.100 --> 00:21:40.600
So the second step was I went to
the QuickTime team and I asked for

00:21:40.600 --> 00:21:47.500
a copy of the sources for QuickTime,
which I have on an encrypted disk

00:21:47.580 --> 00:21:49.160
image in case I lose my laptop.

00:21:53.800 --> 00:21:57.730
QuickTime Player is
just an Xcode project.

00:22:15.470 --> 00:22:19.620
And if I build and run that,
you'll see QuickTime Player as

00:22:19.620 --> 00:22:21.510
it was when I got it.

00:22:21.600 --> 00:22:26.300
It has the open URL menu up here.

00:22:29.060 --> 00:22:34.160
It has the menu of recent items,
but that's all.

00:22:34.330 --> 00:22:40.460
So we thought this is a good place
for us to add Bonjour browsing on.

00:22:40.560 --> 00:22:45.060
So let's go back to the source code here.

00:22:46.690 --> 00:22:49.920
We only had to change two files,
and this was literally

00:22:49.920 --> 00:22:51.240
an afternoon's work.

00:22:51.240 --> 00:22:57.150
So first we will change the header file.

00:23:37.090 --> 00:23:42.630
So the first thing I changed was we
added two NSNetServiceBrowser objects.

00:23:42.900 --> 00:23:47.360
So we could browse for RTSP and QTTP.

00:23:47.360 --> 00:23:52.050
And the Bonjour service
type QTTP semantically means

00:23:52.050 --> 00:23:55.700
QuickTime movie file served over HTTP.

00:23:55.800 --> 00:23:59.440
The reason it's not HTTP is
because it doesn't make sense

00:23:59.510 --> 00:24:02.220
for QuickTime player to discover
every web page on the network.

00:24:02.220 --> 00:24:04.630
It specifically wants
to discover movie files.

00:24:04.740 --> 00:24:08.120
The transport protocol
happens to be HTTP,

00:24:08.150 --> 00:24:10.570
but that's an implementation detail.

00:24:12.280 --> 00:24:17.740
So we added the two extra objects,
and we added a new method to set

00:24:18.140 --> 00:24:22.940
the URL text field to simulate as
if the user had typed something in,

00:24:22.950 --> 00:24:24.540
the software will now automate it.

00:24:24.580 --> 00:24:26.890
So that was all we had to
change in the header file.

00:24:26.900 --> 00:24:36.730
Let me... I'm going to
actually apply those changes.

00:24:36.740 --> 00:24:38.880
So let's...

00:24:53.480 --> 00:24:55.800
So I've changed that file.

00:24:55.800 --> 00:25:00.310
Now, the only other file we had to
change was the OpenURL panel.

00:25:18.920 --> 00:25:22.450
We added one header file for
the struct SOC adder type.

00:25:22.500 --> 00:25:31.660
This is the implementation
of the routine that

00:25:33.200 --> 00:25:44.290
takes in a host name and a port and a
text record expressed as an NSDictionary.

00:25:44.420 --> 00:25:50.100
And from that, it extracts the path key,
and it forms a URL,

00:25:50.100 --> 00:25:54.300
either a form RTSP colon
slash slash or HTTP.

00:25:56.100 --> 00:25:59.980
If there's a username there,
then it will put username, colon,

00:25:59.980 --> 00:26:04.190
password, at, and then password.

00:26:07.460 --> 00:26:09.840
If the port number is the default,
we don't put it in just

00:26:09.850 --> 00:26:11.030
for cosmetic reasons.

00:26:11.030 --> 00:26:15.070
If the port number is different,
then we have colon port number, slash,

00:26:15.070 --> 00:26:16.110
and then the path.

00:26:16.130 --> 00:26:19.610
So that builds a URL,
and then we call set string value to

00:26:19.710 --> 00:26:22.180
put that string into the text field.

00:26:31.340 --> 00:26:36.980
Looking a bit further on,
I'll actually jump down here.

00:26:36.980 --> 00:26:42.920
When the window is opened,
we make an NSNetService browser,

00:26:42.920 --> 00:26:45.730
and we browse for QTTP,
and we make another

00:26:45.840 --> 00:26:47.610
one browsing for RTSP.

00:26:47.650 --> 00:26:51.510
And there you'll see the close
routine that stops the operation

00:26:51.510 --> 00:26:53.340
when the window is closed.

00:26:53.340 --> 00:26:55.430
So let's apply some of
these changes to the file.

00:26:56.040 --> 00:27:01.100
We will put the header file in,
we'll put the initialization in,

00:27:01.100 --> 00:27:04.330
and we'll put the disposing at the end.

00:27:08.570 --> 00:27:13.120
We now have-- so now that
we've started the browse,

00:27:13.150 --> 00:27:16.370
in your code,
you would need to implement--

00:27:18.180 --> 00:27:22.650
A Cocoa method called DidFindService,
which is called when a new

00:27:22.650 --> 00:27:25.050
service is found on the network.

00:27:25.050 --> 00:27:29.460
And in this code here,
you'll see we are making a menu item.

00:27:31.270 --> 00:27:34.890
We are checking if we need to add a
separator item if this is the first

00:27:34.990 --> 00:27:38.940
thing we're adding to the menu,
and we are adding the item and

00:27:39.060 --> 00:27:43.490
enabling the button if this is
the first thing we're adding.

00:27:43.500 --> 00:27:46.970
We have a corresponding remove
method if a service goes away,

00:27:46.970 --> 00:27:51.710
because this is one of the things that's
very important about Bonjour browsing.

00:27:53.360 --> 00:27:54.720
services are live.

00:27:54.720 --> 00:27:56.400
You don't have a refresh button.

00:27:56.400 --> 00:27:58.530
When services come along,
they get added to the list.

00:27:58.670 --> 00:28:01.140
When they go away,
they disappear from the list,

00:28:01.220 --> 00:28:02.560
and it's always live.

00:28:02.590 --> 00:28:05.300
So the did remove service
tells you it's gone away.

00:28:06.760 --> 00:28:08.520
We reverse what we did before.

00:28:08.520 --> 00:28:13.060
We remove it, and if there are no
more things in the menu,

00:28:13.060 --> 00:28:14.350
then we disable the button.

00:28:14.350 --> 00:28:18.900
So let's apply that to our file.

00:28:22.580 --> 00:28:26.250
When the user picks one of
the things from the menu,

00:28:26.250 --> 00:28:31.370
we do a resolve with timeout
to go from that named service

00:28:31.380 --> 00:28:34.940
to look up its host name,
port number, and the other details.

00:28:34.940 --> 00:28:39.970
So we'll apply that.

00:28:41.420 --> 00:28:47.030
And then the last change is what
we started looking at before.

00:28:49.510 --> 00:28:56.190
Which is when the resolution completes,
the did resolve address is called.

00:28:56.230 --> 00:29:01.350
We extract the text record dictionary,
the address, the port.

00:29:01.440 --> 00:29:06.650
Depending on whether it's a V6 or IPv4,
we get the port number

00:29:06.650 --> 00:29:08.020
out of the SOC adder.

00:29:08.020 --> 00:29:11.080
And then we call this
setTextFilledWithType method

00:29:11.200 --> 00:29:12.820
that I showed you earlier.

00:29:17.600 --> 00:29:24.440
This is the real source
code for QuickTime Player.

00:29:24.440 --> 00:29:27.100
And you just saw me make the changes.

00:29:27.100 --> 00:29:31.840
So we will now go back to Xcode.

00:29:31.840 --> 00:29:37.820
We'll build and run that.

00:30:00.700 --> 00:30:01.800
Okay, that's linking.

00:30:01.860 --> 00:30:02.900
It's running.

00:30:02.900 --> 00:30:10.820
And now we see in the menu,
it's discovered the camera.

00:30:10.820 --> 00:30:16.040
So it was literally that easy for us to
add Bonjour browsing to QuickTime Player.

00:30:16.040 --> 00:30:18.570
We took those diffs back
to the QuickTime team,

00:30:18.570 --> 00:30:22.560
and they said, that's pretty cool,
and now it's in the product.

00:30:22.560 --> 00:30:30.710
We then showed that to the Access people,
and they said, that's pretty cool,

00:30:30.710 --> 00:30:30.710
and now it's in the product.

00:30:32.110 --> 00:30:36.610
This is their new model of the camera,
which is shipping sometime this month.

00:30:36.640 --> 00:30:38.280
It's not out yet, but very soon.

00:30:38.280 --> 00:30:42.620
And this now ships with
Bonjour advertising.

00:30:42.620 --> 00:30:52.020
So this now... I have
to wait for it to boot.

00:30:52.020 --> 00:30:55.740
This is booting up.

00:31:02.520 --> 00:31:03.790
and they will be shipping this.

00:31:03.790 --> 00:31:07.670
There we go, Access 207.

00:31:12.280 --> 00:31:15.720
So now, and this has really,
really nice low-light performance.

00:31:15.720 --> 00:31:19.190
For a consumer-level camera,
this is amazingly good in a dim light.

00:31:19.250 --> 00:31:23.980
I can see you more clearly on the screen
here than I can standing here myself.

00:31:26.300 --> 00:31:29.210
So now we have a shipping
product from Apple which

00:31:29.360 --> 00:31:31.440
browses using Bonjour for RTSP.

00:31:31.440 --> 00:31:35.090
We have a shipping product from
Access that browses with Bonjour.

00:31:35.170 --> 00:31:40.990
There's a company nearby called Wizchip
that makes reference design boards and

00:31:41.170 --> 00:31:48.400
they have all these little modules that
you can add on to this for prototyping.

00:31:50.860 --> 00:31:51.900
That little camera module.

00:31:51.900 --> 00:31:54.880
And they saw this and
thought that was exciting.

00:31:54.880 --> 00:31:58.060
And in one afternoon,
they got the sources from Darwin,

00:31:58.100 --> 00:32:00.890
they typed to make it, compiled,
they added the services.txt file,

00:32:01.030 --> 00:32:02.660
they checked it into their CVS server.

00:32:02.660 --> 00:32:05.820
So now all of the products that
license the WishChip design

00:32:05.960 --> 00:32:07.880
are advertising with Bonjour.

00:32:07.880 --> 00:32:12.390
And because they're a group
of people who use Linux,

00:32:12.390 --> 00:32:15.560
they were very excited about that.

00:32:15.630 --> 00:32:20.780
And they're adding Bonjour to VLC,
Video Landcast.

00:32:20.810 --> 00:32:24.950
So now we've got multiple
clients browsing.

00:32:24.950 --> 00:32:30.340
We've got multiple hardware
products advertising services.

00:32:30.340 --> 00:32:31.860
And that's critical mass.

00:32:32.080 --> 00:32:36.200
At this point, every camera vendor,
if they want to show up in QuickTime and

00:32:36.300 --> 00:32:39.820
VLC will advertise with Bonjour,
anybody making software that

00:32:39.900 --> 00:32:43.040
can view cameras will want
to browse for Bonjour because

00:32:43.040 --> 00:32:45.040
that's how you find cameras.

00:32:45.040 --> 00:32:50.310
And that is how you go from nothing
to a de facto industry standard in

00:32:50.630 --> 00:32:50.780
the sense that you can't find cameras.

00:32:50.810 --> 00:32:54.170
So you have to have a space of a couple
of months instead of a few years.

00:32:54.220 --> 00:32:59.020
So with that, I'd like to ask Kieran
to come up on stage.

00:33:00.440 --> 00:33:03.640
and tell you about Wadari Bonjour.

00:33:03.670 --> 00:33:05.120
Can we go back to the podium machine,
please?

00:33:13.810 --> 00:33:15.600
Thank you, Stuart.

00:33:15.600 --> 00:33:20.380
My name is Kiran Sikar, and for Tiger,
I was working on extending Bonjour's

00:33:20.380 --> 00:33:23.580
functionality beyond the local network.

00:33:25.880 --> 00:33:29.260
This morning I'd like to take a few
minutes and give an overview of exactly

00:33:29.260 --> 00:33:33.310
what wide area Bonjour is and how
it's going to impact your products

00:33:33.480 --> 00:33:35.680
and the way we work with our machines.

00:33:35.750 --> 00:33:38.670
Then I want to dive in and take a look
at some of the technology that goes

00:33:38.710 --> 00:33:43.640
into bringing out this new functionality
and the steps we need to take to make

00:33:43.640 --> 00:33:46.190
the most out of this new technology.

00:33:46.400 --> 00:33:49.210
Then we're going to wrap up
by doing some live demos,

00:33:49.320 --> 00:33:52.420
seeing how you can set this
up on your own networks.

00:33:54.530 --> 00:33:59.280
White area Bonjour brings us two
new pieces of key functionality.

00:33:59.280 --> 00:34:02.140
The first one's a dynamic DNS host name.

00:34:02.140 --> 00:34:07.600
Now, this is analogous to the .local name
that we have in local area Bonjour.

00:34:07.610 --> 00:34:11.400
But unlike a .local name,
this name is globally unique.

00:34:11.400 --> 00:34:15.220
That means that when I name
my machine or device,

00:34:15.220 --> 00:34:19.140
that name refers to my
machine and only my machine,

00:34:19.140 --> 00:34:21.990
no matter where you are on the internet.

00:34:22.010 --> 00:34:24.720
Now,
in addition to this name being unique,

00:34:24.860 --> 00:34:26.700
it's also persistent.

00:34:26.710 --> 00:34:30.800
That means that as I move about, say,
from my office to my

00:34:30.870 --> 00:34:33.820
home to an internet cafe,
or as my IP address

00:34:33.940 --> 00:34:37.650
changes for any reason,
my name stays the same and stays up

00:34:37.760 --> 00:34:42.560
to date so that people can be able
to reach me no matter where I am.

00:34:42.950 --> 00:34:46.250
Now, of course,
Bonjour is about more than just naming.

00:34:46.250 --> 00:34:51.290
It's also about being able to
discover services on the internet.

00:34:51.420 --> 00:34:54.500
With Wide Area Bonjour,
we can advertise our services

00:34:54.610 --> 00:34:58.350
so that people outside of our
local network can discover us,

00:34:58.350 --> 00:35:02.510
and we in turn can discover these
services outside of the LAN.

00:35:03.080 --> 00:35:05.490
But just as important as
what's new with wide area

00:35:05.490 --> 00:35:08.870
Bonjour is what stayed the same.

00:35:09.030 --> 00:35:11.600
First of all,
the protocol semantics are the same.

00:35:11.600 --> 00:35:16.540
We use the same DNS resource records to
convey information about our services.

00:35:16.570 --> 00:35:21.380
But more importantly for all of you,
the APIs are unchanged.

00:35:21.390 --> 00:35:25.270
These APIs were written from
day one to scale from the local

00:35:25.650 --> 00:35:28.590
network to the wide area networks.

00:35:28.610 --> 00:35:31.490
And we figured you guys probably
have enough of a transition

00:35:31.500 --> 00:35:32.980
to think about right now.

00:35:33.080 --> 00:35:36.650
So you likely won't have to change
a single line of code to use wide

00:35:36.650 --> 00:35:39.140
area Bonjour in your applications.

00:35:40.280 --> 00:35:42.200
Now,
it's great that the protocol is the same.

00:35:42.200 --> 00:35:44.400
It's great that the APIs are the same.

00:35:44.470 --> 00:35:48.900
But these are really secondary
to the user experience.

00:35:49.400 --> 00:35:53.690
By taking the Bonjour user experience
from the local network that's made

00:35:53.790 --> 00:35:56.990
the technology in all of your products
that leverage it so successful

00:35:57.000 --> 00:36:01.700
and easy to use and extending it,
we complete the Bonjour experience,

00:36:01.850 --> 00:36:06.520
which is bringing zero
configuration networking everywhere.

00:36:06.640 --> 00:36:10.030
From the local networks where it started,

00:36:10.330 --> 00:36:13.380
is the founder of Bonjour,
a mobile app that is designed

00:36:13.380 --> 00:36:14.800
to manage networks with multiple
subnets and even across the internet.

00:36:14.960 --> 00:36:17.670
And in doing this,
we bring reachability to everyone.

00:36:17.700 --> 00:36:21.360
Traditionally, to be reachable,
you either had to be on a managed

00:36:21.360 --> 00:36:25.870
network or have a static IP address
and know how to set that up.

00:36:26.450 --> 00:36:30.050
With wide area Bonjour,
you don't need those things.

00:36:30.060 --> 00:36:34.480
And by removing that restriction,
we bring reachability within the

00:36:34.490 --> 00:36:37.980
grasp of a much wider audience.

00:36:38.240 --> 00:36:41.030
Now, even if you have been
reachable in the past,

00:36:41.200 --> 00:36:45.450
chances are once you went mobile,
your reachability went out the door.

00:36:45.650 --> 00:36:48.920
With Wide Area Bonjour,
we have mobility and

00:36:48.920 --> 00:36:52.990
reachability with ease of use,
bringing about new possibilities

00:36:53.170 --> 00:36:55.390
for mobile collaboration.

00:36:56.280 --> 00:37:00.640
If you already use Bonjour in your
application on the local network,

00:37:00.700 --> 00:37:04.450
wide area Bonjour makes your
applications even more powerful while

00:37:04.560 --> 00:37:07.270
still maintaining their ease of use.

00:37:07.840 --> 00:37:10.300
On the other hand,
if you manage a network,

00:37:10.330 --> 00:37:14.840
you might have found yourself wishing
that you had the Bonjour ease of use,

00:37:14.850 --> 00:37:17.690
but not being confined
to a single subnet.

00:37:17.890 --> 00:37:20.190
With Wide Area Bonjour,
you get just that.

00:37:20.320 --> 00:37:24.890
You end up with a network that's both
easy for you to administer and flexible

00:37:24.890 --> 00:37:28.810
and easy for your users to interact with.

00:37:29.390 --> 00:37:33.300
Now, if you have a hardware product,
like the one that Stuart's just showed,

00:37:33.560 --> 00:37:36.910
and you already use
Bonjour on the local network,

00:37:36.910 --> 00:37:40.140
you know how Bonjour makes
your products easier to use,

00:37:40.310 --> 00:37:44.580
giving you more satisfied customers,
and even lowering your support cost.

00:37:44.620 --> 00:37:51.440
But wide area Bonjour can take that
competitive advantage even further,

00:37:51.440 --> 00:37:54.190
and might even bring about new types of
devices that were previously impossible.

00:37:54.520 --> 00:37:56.680
Now,
before this becomes a marketing talk,

00:37:56.860 --> 00:37:59.970
I want to take a look at some
of the technology that goes

00:37:59.970 --> 00:38:02.230
behind this new functionality.

00:38:03.030 --> 00:38:07.670
With local Bonjour,
we use multicast DNS to query for and

00:38:07.670 --> 00:38:09.550
advertise services on the local network.

00:38:09.610 --> 00:38:14.030
With wide-area Bonjour,
we use those same resource records,

00:38:14.030 --> 00:38:16.680
but instead of multicasting
them on the local network,

00:38:16.700 --> 00:38:20.700
we communicate directly with a
central server using unicast DNS.

00:38:20.700 --> 00:38:24.440
To discover services,
we simply issue a query to

00:38:24.440 --> 00:38:26.700
the server and get a response.

00:38:26.750 --> 00:38:30.940
And to register our services,
we use a kind of DNS known

00:38:30.940 --> 00:38:32.700
as dynamic DNS update.

00:38:33.030 --> 00:38:35.700
This is a standard part of DNS that,
when enabled,

00:38:35.700 --> 00:38:40.860
allows a client to actually publish
its resource records into the server so

00:38:40.950 --> 00:38:43.650
that they can be discovered by others.

00:38:43.860 --> 00:38:47.400
Now, these two things,
unicast queries and dynamic update,

00:38:47.400 --> 00:38:50.040
provide the basis for wide area Bonjour.

00:38:50.100 --> 00:38:54.330
But we went ahead and actually
extended the DNS protocol using

00:38:54.330 --> 00:38:59.790
DNS's native extension mechanism to
further enhance the user experience.

00:39:00.900 --> 00:39:03.060
Take dynamic updates.

00:39:03.180 --> 00:39:07.140
With a traditional dynamic update,
we update the server and that

00:39:07.160 --> 00:39:10.800
record stays in the server
until we actively delete it.

00:39:11.080 --> 00:39:14.760
Now that's fine for some applications,
but consider a laptop.

00:39:14.800 --> 00:39:19.640
I plug in my laptop, register my name,
register my services,

00:39:19.770 --> 00:39:21.800
and then unplug the Ethernet
cable and walk away.

00:39:21.800 --> 00:39:25.030
Well, those records are going to stay
on the server indefinitely,

00:39:25.030 --> 00:39:27.730
giving people who discover
them stale information.

00:39:28.580 --> 00:39:32.170
So we extended dynamic updates
to contain a lease life,

00:39:32.630 --> 00:39:36.420
allowing the server to garbage collect
these orphaned records and keeping

00:39:36.490 --> 00:39:38.280
people's browse lists up to date.

00:39:40.030 --> 00:39:44.700
Likewise, on the discovery side,
traditional DNS queries

00:39:45.000 --> 00:39:46.400
are one-shot queries.

00:39:46.520 --> 00:39:49.920
We ask a question and get an
answer that represents what's on

00:39:49.920 --> 00:39:52.440
the server at that point in time.

00:39:52.640 --> 00:39:56.580
But with Bonjour,
we want to do live browses to learn

00:39:56.580 --> 00:40:00.390
as new services become available
and to find out when services that

00:40:00.400 --> 00:40:03.690
we've previously discovered go away.

00:40:04.600 --> 00:40:08.330
We don't want to have a refresh button,
and we want something that's more

00:40:08.470 --> 00:40:11.590
scalable and more responsive than
just polling the server every

00:40:11.720 --> 00:40:13.980
few minutes or every few hours.

00:40:14.190 --> 00:40:18.650
So we created a new kind of
query called a long-lived query,

00:40:18.650 --> 00:40:21.260
where we ask the server
for the set of answers,

00:40:21.340 --> 00:40:24.600
and also to tell the server to
continue to let us know with

00:40:24.600 --> 00:40:29.610
notifications as new services become
available or as services that we've

00:40:29.670 --> 00:40:32.170
previously been told about disappear.

00:40:32.410 --> 00:40:36.900
It's a little-known fact that that
notification mechanism is actually what

00:40:36.900 --> 00:40:44.010
drives .Mac syncing when you get live
notifications as your sync data changes.

00:40:44.800 --> 00:40:46.580
Now, unfortunately,
I don't have time to go into

00:40:46.590 --> 00:40:49.660
the details of how those
protocols are implemented today,

00:40:49.660 --> 00:40:52.650
but if you're curious,
they're all open specifications,

00:40:52.650 --> 00:40:56.090
and they're documented on
the developer web page.

00:40:57.490 --> 00:41:01.230
Now, a few things need to happen on the
client for a client to fully take

00:41:01.240 --> 00:41:04.110
advantage of all those technologies.

00:41:06.440 --> 00:41:09.960
First, we've got the discovery side.

00:41:09.960 --> 00:41:15.610
Now, discovery is a truly zero
configuration experience.

00:41:15.790 --> 00:41:19.170
As Stuart pointed out,
if you open up Safari on your laptop

00:41:19.310 --> 00:41:23.070
and click the Rendezvous icon,
pardon me, the Bonjour icon,

00:41:23.130 --> 00:41:29.360
old habits are hard to break,
you will see wide area websites that

00:41:29.470 --> 00:41:31.960
are advertised in the apple.com domain.

00:41:31.960 --> 00:41:35.910
That's because we've set the
network up here at Moscone to tell

00:41:36.380 --> 00:41:40.860
clients to browse in apple.com,
and any services in apple.com's

00:41:40.920 --> 00:41:44.860
domain will be picked up
automatically by your clients.

00:41:46.800 --> 00:41:49.940
Now, we can also configure other domains.

00:41:50.080 --> 00:41:51.940
For example,
if you wanted to continue browsing

00:41:51.940 --> 00:41:55.790
in apple.com after you leave the
conference from your hotel room,

00:41:55.800 --> 00:41:57.380
per se,

00:41:59.350 --> 00:42:03.510
We do get a truly zero configuration
mobile experience as you move between,

00:42:03.640 --> 00:42:06.400
say,
an airport that advertises local pages,

00:42:06.460 --> 00:42:10.400
perhaps describing some of the
services or restaurants it offers,

00:42:10.400 --> 00:42:18.690
or a hotel that describes services
containing some of the concessions

00:42:18.690 --> 00:42:18.690
and services that it offers.

00:42:20.520 --> 00:42:23.180
The advertisement side is
a little bit different.

00:42:23.280 --> 00:42:25.640
Because we're using a
globally unique host name,

00:42:25.730 --> 00:42:26.780
we can't just make one up.

00:42:27.030 --> 00:42:29.750
You know,
if I try to name my laptop Google.com,

00:42:29.890 --> 00:42:32.230
that's clearly not going to work.

00:42:32.480 --> 00:42:36.380
So we need a unique host name
that's given to us by the person

00:42:36.380 --> 00:42:39.180
who's running our Bonjour server.

00:42:40.360 --> 00:42:44.100
Additionally, for registration domains,
we have one domain where

00:42:44.100 --> 00:42:45.520
we want to register.

00:42:45.620 --> 00:42:50.100
We don't want to just register wherever
the network tells us as we move about,

00:42:50.170 --> 00:42:54.800
because the whole point is that you
register in one well-known place,

00:42:54.870 --> 00:42:58.570
and as you move about between networks,
other people still

00:42:58.590 --> 00:43:00.200
know where to find you.

00:43:01.230 --> 00:43:04.600
And lastly,
if you're using Wide Area Bonjour behind

00:43:04.600 --> 00:43:08.160
a firewall on a small network
with a trusted group of people,

00:43:08.390 --> 00:43:12.200
you might be happy having a
completely open name server where

00:43:12.200 --> 00:43:14.760
anyone can publish records into it.

00:43:14.890 --> 00:43:19.430
But if you're on a bigger network or
you're using this on the open internet,

00:43:19.550 --> 00:43:22.850
you clearly need some kind of
security system so that not anyone

00:43:22.850 --> 00:43:24.900
can publish into your server.

00:43:25.070 --> 00:43:28.100
So we use DNSSEC for this.

00:43:28.360 --> 00:43:32.720
And if DNSSEC is being used
on your wide area server,

00:43:32.720 --> 00:43:36.610
you'll need to add that
to the client as well.

00:43:37.890 --> 00:43:40.820
Now, keep in mind that once
these things are set up,

00:43:40.940 --> 00:43:44.190
we do have a truly zero
configuration experience.

00:43:44.270 --> 00:43:47.540
Names and services are
registered automatically,

00:43:47.740 --> 00:43:49.730
automatically deregistered.

00:43:49.840 --> 00:43:53.900
They stay up to date as
your location changes,

00:43:53.900 --> 00:43:56.550
and the browsers stay live.

00:43:57.450 --> 00:44:00.990
Now, if you've been exploring in Tiger,
you might be wondering,

00:44:01.070 --> 00:44:04.110
where's the UI to set
this up on the client?

00:44:04.310 --> 00:44:07.400
Well, the truth is we're still
working on getting the UI up

00:44:07.400 --> 00:44:10.020
to Apple's specifications.

00:44:10.250 --> 00:44:15.710
That being said, on the path to bringing
Wide Area Bonjour to all of our users,

00:44:15.710 --> 00:44:17.940
we're actually in a great place.

00:44:17.990 --> 00:44:21.010
Most importantly,
all of the mechanisms for

00:44:21.010 --> 00:44:26.230
Wide Area Bonjour are in
Tiger and exposed in Tiger's APIs.

00:44:26.470 --> 00:44:30.410
In addition,
we've got the Wide Area Discovery,

00:44:30.410 --> 00:44:32.800
which happens without
any configuration at all,

00:44:32.850 --> 00:44:35.670
as you can see today on your laptops.

00:44:36.880 --> 00:44:41.350
We've also got a fully
featured UI test tool.

00:44:41.390 --> 00:44:45.360
Now, this is a test tool,
and it favors flexibility

00:44:45.360 --> 00:44:46.330
over simplicity.

00:44:46.440 --> 00:44:49.770
And it might not be pretty,
but it gets the job done.

00:44:49.960 --> 00:44:52.320
And I'm going to walk you
through how to set it up today.

00:44:52.520 --> 00:44:57.340
And what I'd love to have happen is
for all of you guys to download it,

00:44:57.640 --> 00:45:01.070
take it back to your networks,
set up a Bonjour server,

00:45:01.320 --> 00:45:07.870
get your colleagues using this UI tool,
and getting used to the wide

00:45:07.870 --> 00:45:11.130
area Bonjour experience and
really understanding the value

00:45:11.140 --> 00:45:13.080
that it adds to your products.

00:45:13.140 --> 00:45:16.300
That way, when we do integrate
a UI into the system,

00:45:16.300 --> 00:45:18.840
you guys are ready to
hit the ground running.

00:45:19.560 --> 00:45:23.470
Now, if you really can't wait that long,
you can actually embed pieces of the

00:45:23.470 --> 00:45:25.990
UI directly into the application.

00:45:26.190 --> 00:45:30.360
One of our Apple applications
that does distributed video

00:45:30.360 --> 00:45:32.530
rendering did just this.

00:45:32.720 --> 00:45:34.860
Now, admittedly,
this is a short-term solution,

00:45:34.860 --> 00:45:38.760
because we don't want separate
controls in every single application.

00:45:38.840 --> 00:45:42.260
But if you do have special needs,
I urge you to go ahead and contact us,

00:45:42.340 --> 00:45:44.600
and we can work with you to do
that in a way that's going to

00:45:44.600 --> 00:45:47.400
be as maintainable as possible.

00:45:51.600 --> 00:45:57.060
On the server side,
the configuration is actually quite easy.

00:45:57.250 --> 00:46:02.380
We've got a web page up on dnssd.org.

00:46:02.600 --> 00:46:05.980
is the founder of Bonjour,
a web service that gives step-by-step

00:46:05.980 --> 00:46:09.400
instructions on how you can set up a
name server from scratch and configure

00:46:09.400 --> 00:46:12.000
it to be a wide area Bonjour server.

00:46:12.010 --> 00:46:15.940
Now, if you've ever looked at
DNS configuration files,

00:46:15.980 --> 00:46:17.200
they're kind of yucky.

00:46:17.440 --> 00:46:22.330
But this website is set up so that
you can really just copy it and paste

00:46:22.560 --> 00:46:26.500
it and change just a few pieces,
as I'm going to show,

00:46:26.630 --> 00:46:30.270
and you'll be ready to
hit the ground running.

00:46:31.050 --> 00:46:34.350
The two main pieces we need
to set up are a zone file,

00:46:34.350 --> 00:46:38.370
which describes the namespace where
we'll be registering and indicates

00:46:38.370 --> 00:46:43.310
its capabilities as a Bonjour domain,
and a configuration file that

00:46:43.450 --> 00:46:49.620
tells the name server to accept
dynamic updates and possibly

00:46:49.730 --> 00:46:50.800
configure some security credentials.

00:46:51.170 --> 00:46:53.900
Now,
not all name servers right now support

00:46:54.000 --> 00:46:59.080
our DNS extensions for the long-lived
queries and the update leases.

00:46:59.100 --> 00:47:03.100
So with Tiger,
we ship a daemon that implements

00:47:03.100 --> 00:47:07.100
those two extensions and runs
alongside your standard name server.

00:47:07.100 --> 00:47:09.980
And of course,
this is available on Darwin to use

00:47:09.980 --> 00:47:12.090
with other name servers as well.

00:47:14.060 --> 00:47:17.580
So now that we've got the server
set up and the client configured,

00:47:17.900 --> 00:47:21.870
what do applications need to
do to use wide area Bonjour?

00:47:22.760 --> 00:47:25.660
For most of you, nothing.

00:47:26.150 --> 00:47:30.340
From day one,
we suggested that when you use our APIs,

00:47:30.370 --> 00:47:33.240
when you have to specify a
domain parameter for either

00:47:33.240 --> 00:47:37.240
registration or browsing,
you don't specify a particular domain

00:47:37.240 --> 00:47:40.920
and instead pass the empty string,
allowing the system to choose

00:47:40.920 --> 00:47:42.720
domains on your behalf.

00:47:42.720 --> 00:47:45.710
Now, up until now,
that's just been the local domain.

00:47:45.850 --> 00:47:50.430
But with wide area Bonjour,
the system can register and browse

00:47:50.590 --> 00:47:55.300
in the local network as well as
whatever wide area domains are

00:47:55.450 --> 00:47:58.470
appropriate for that environment.

00:47:59.440 --> 00:48:03.840
Now, the one area of this that could
use a little polish is that

00:48:03.920 --> 00:48:08.430
you're discovering services from
potentially a variety of domains,

00:48:08.460 --> 00:48:10.660
and they're being
displayed in one flat list.

00:48:10.700 --> 00:48:13.250
And that gets the job done,
and it's a great way for

00:48:13.270 --> 00:48:16.590
unmodified applications to
benefit from this technology.

00:48:16.600 --> 00:48:21.940
But you might run into cases where,
for example, you see one service on the

00:48:21.940 --> 00:48:25.740
local network and another
service on a wide area domain,

00:48:26.000 --> 00:48:27.990
and they have the same name,
and they show up next to

00:48:28.070 --> 00:48:30.010
each other in the list,
and the user doesn't know

00:48:30.010 --> 00:48:33.020
which is which until the user
actually selects the service.

00:48:35.220 --> 00:48:38.450
If you want to refine this experience,
you can do what we call

00:48:38.450 --> 00:48:40.100
multi-domain browsing.

00:48:40.260 --> 00:48:43.480
And the Finder does this today in Tiger.

00:48:44.290 --> 00:48:47.380
To do this, you need to use our
domain enumeration APIs,

00:48:47.380 --> 00:48:50.720
which have been part of
the API from day one.

00:48:50.830 --> 00:48:53.140
These return a list of domains,
which you can then

00:48:53.140 --> 00:48:55.200
display in a hierarchy.

00:48:55.410 --> 00:48:58.300
You then only need to browse
when the user actually

00:48:58.300 --> 00:49:01.920
selects an individual domain,
and then you then show the

00:49:01.980 --> 00:49:04.070
results just for that domain.

00:49:07.410 --> 00:49:09.440
Now that we've covered
the basics of clients,

00:49:09.540 --> 00:49:12.780
servers, and how the applications
interact with them,

00:49:12.860 --> 00:49:16.730
I want to turn over to some
demos and look at setting up a

00:49:16.730 --> 00:49:20.710
server with some static services,
as well as configuring

00:49:20.710 --> 00:49:22.450
secure dynamic update.

00:49:22.590 --> 00:49:26.790
And as well, I'd like to look at how we
can use our preference pane,

00:49:26.790 --> 00:49:29.560
which is the test tool
to configure the client,

00:49:29.670 --> 00:49:31.760
to interact with that server.

00:49:31.890 --> 00:49:34.350
So if we could switch
over to the demo machine,

00:49:34.350 --> 00:49:35.010
please.

00:49:52.930 --> 00:49:59.360
So this is the web page which
describes how to set up a server.

00:49:59.710 --> 00:50:02.600
It's not too long,
and most of it is actually description.

00:50:02.640 --> 00:50:06.000
And unfortunately,
we're running a bit short on time,

00:50:06.000 --> 00:50:08.120
so I don't have time to go
through it step by step.

00:50:08.120 --> 00:50:16.560
But I will go ahead and set it up anyway,
and what I'd like you to take away

00:50:16.560 --> 00:50:20.200
from this is how easy it is and how
it's mostly a matter of copying and

00:50:20.200 --> 00:50:20.200
pasting and changing just a few things.

00:50:23.530 --> 00:50:29.080
Here we've got our configuration file.

00:50:29.080 --> 00:50:34.370
Now this configuration file is just
copied and pasted from the setup page.

00:50:34.370 --> 00:50:38.330
Let me make this a little bigger for you.

00:50:53.150 --> 00:50:55.620
So let's just go ahead and look
at the changes I had to make

00:50:56.450 --> 00:50:58.730
to use this with my server.

00:51:03.880 --> 00:51:06.400
This is the copy that the
name server will actually

00:51:06.400 --> 00:51:10.100
read its configuration from.

00:51:10.240 --> 00:51:16.340
And this is the sample.

00:51:16.460 --> 00:51:20.500
The first change we had to
make here is the forwarders.

00:51:43.700 --> 00:51:45.700
That's better.

00:51:45.700 --> 00:51:54.200
So when a machine's running
as a wide area Bonjour server,

00:51:54.240 --> 00:51:59.200
it answers queries for
records within its name space.

00:51:59.200 --> 00:52:05.200
Right now I'm setting up a server
for the domain Bonjour.kiren.com.

00:52:05.200 --> 00:52:07.700
Now, if this server gets a
query for something else,

00:52:07.720 --> 00:52:11.810
say www.amazon.com,
it needs to know the address of

00:52:11.820 --> 00:52:14.700
another server to send that off to.

00:52:14.810 --> 00:52:20.490
So I go ahead and add my
normal DNS server here.

00:52:23.380 --> 00:52:26.600
And the web page even shows you
how you can find the address of

00:52:26.600 --> 00:52:29.250
your server on your OS X system.

00:52:32.540 --> 00:52:35.300
After that,
it's really a matter of searching

00:52:35.300 --> 00:52:41.520
and replacing Bonjour.example.com
with Bonjour.kiren.com.

00:52:43.430 --> 00:52:50.130
The last thing we do is this is the
shared secret for secure dynamic updates.

00:52:50.400 --> 00:52:54.630
Clients need to have this secret and
use it to sign their updates in order

00:52:54.990 --> 00:52:57.810
for my secure server to accept them.

00:52:58.960 --> 00:53:02.610
The web page shows how,
with a single Unix command,

00:53:02.730 --> 00:53:06.590
we can generate a random secret,
and we then just go ahead and

00:53:06.740 --> 00:53:09.290
copy and paste that in here.

00:53:14.290 --> 00:53:20.440
Now, that takes care of the
configuration file.

00:53:20.460 --> 00:53:22.900
Now let's look at the zone file.

00:53:23.720 --> 00:53:26.390
The zone file describes the zone.

00:53:26.530 --> 00:53:30.420
It gives information like the
time to live and also has the

00:53:30.430 --> 00:53:33.260
resource records within that zone.

00:53:33.930 --> 00:53:37.450
Now, if you're curious about
DNS and how this all works,

00:53:37.450 --> 00:53:40.950
I encourage you to either read
online or buy one of the DNS books,

00:53:40.960 --> 00:53:44.250
such as the Cricut book,
which are very good and very detailed.

00:53:44.450 --> 00:53:46.280
But if you just want to
get this up and working,

00:53:46.630 --> 00:53:49.260
again,
what you need to do is just copy and

00:53:49.700 --> 00:53:57.090
paste the boilerplate from the web page
and change a few pieces where indicated.

00:53:59.640 --> 00:54:01.940
So here's my finished zone file.

00:54:01.940 --> 00:54:07.980
And here's the example
that was copied and pasted.

00:54:24.550 --> 00:54:28.640
And here we only have two differences.

00:54:28.880 --> 00:54:34.510
First, we need the address of the machine
itself that's running as the name server.

00:54:34.750 --> 00:54:39.930
Here we have WAB for
wideareabonjour.example.com.

00:54:40.010 --> 00:54:45.250
And I changed that over to
myserver.bonjour.curing.com.

00:54:45.730 --> 00:54:48.420
This is typically the name that's
already been assigned to your

00:54:48.420 --> 00:54:53.390
machine that's acting as the server.

00:54:53.510 --> 00:54:56.920
And again,
we make that change in one more place.

00:55:03.230 --> 00:55:05.960
And that pretty much takes care of it.

00:55:05.970 --> 00:55:12.300
The one thing that I would like to
add are some static service records.

00:55:12.300 --> 00:55:16.740
Now, these are not for dynamic
Bonjour registrations,

00:55:16.850 --> 00:55:20.330
such as cameras or services
advertised by a laptop.

00:55:20.700 --> 00:55:24.050
But these are things like the web
pages that you're discovering in

00:55:24.520 --> 00:55:29.180
Safari that are in a fixed place
that we want our clients to discover.

00:55:29.720 --> 00:55:34.540
So I have a few examples here
that I'm just going to copy

00:55:34.570 --> 00:55:37.020
and paste into the zone file.

00:55:43.970 --> 00:55:47.080
Here, we're advertising a printer.

00:55:47.080 --> 00:55:48.900
Again,
don't worry too much about the details,

00:55:48.920 --> 00:55:51.700
because this is documented
on the web page.

00:55:51.780 --> 00:55:56.310
But the service type is printer.tcp,
and it's pointing to

00:55:56.310 --> 00:56:00.080
our WWDC public printer.

00:56:01.180 --> 00:56:05.240
Now, notice here that the name of
the printer that we're pointing

00:56:05.300 --> 00:56:11.780
to isn't even in my domain,
bonjour.kieran.com.

00:56:12.130 --> 00:56:14.260
Nonetheless,
I'm still able to advertise it

00:56:14.350 --> 00:56:18.340
so that people on my network or
who are browsing in my domain can

00:56:18.440 --> 00:56:21.470
discover it and connect to it.

00:56:22.420 --> 00:56:27.060
We have a second one here
for our speaker printer.

00:56:27.060 --> 00:56:29.720
And we've got an example web page.

00:56:30.240 --> 00:56:34.360
This is the same type of record
as we have on the Apple.com

00:56:34.360 --> 00:56:39.050
server that allows you guys to
discover these Bonjour services.

00:56:43.220 --> 00:56:45.740
in case you haven't seen,
they're right here.

00:56:45.740 --> 00:56:49.800
And if you open up your
Bonjour bookmark bar in Safari,

00:56:49.800 --> 00:56:51.710
you'll see them yourself.

00:56:54.220 --> 00:56:58.100
So now we have our files all set.

00:56:58.160 --> 00:57:00.370
I'll make sure I've saved it.

00:57:06.100 --> 00:57:12.430
What's left is to run
the name server and...

00:57:13.640 --> 00:57:18.840
Our daemon that implements
the DNS extensions.

00:57:20.450 --> 00:57:23.200
The name server doesn't
even take any arguments.

00:57:23.220 --> 00:57:26.090
Just run it, and we're good.

00:57:27.320 --> 00:57:29.730
The daemon takes a couple arguments.

00:57:29.750 --> 00:57:32.670
The first one is the name of the zone.

00:57:32.770 --> 00:57:35.910
And then because we're
using authentication,

00:57:35.910 --> 00:57:40.040
we use -k,
indicating that we need a secure key,

00:57:40.070 --> 00:57:42.290
followed by the name of the key,
which here is the same

00:57:42.300 --> 00:57:46.120
as the name of the zone,
and the shared secret.

00:57:46.170 --> 00:57:48.120
Launch those.

00:57:51.500 --> 00:57:53.800
Just to make sure we
didn't have any typos,

00:57:53.830 --> 00:57:55.500
we'll check the system log.

00:57:55.500 --> 00:58:01.640
And the errors that you saw
there are actually benign,

00:58:01.640 --> 00:58:05.640
and those are listed on
the web page as well.

00:58:05.640 --> 00:58:10.690
Now... let's see if
this stuff is working.

00:58:14.150 --> 00:58:16.160
Here we've got the
Bonjour preference pane.

00:58:16.180 --> 00:58:22.120
We see three tabs-- Host Name,
Registration, and Browsing.

00:58:23.060 --> 00:58:26.460
The host name is our unique host
name that identifies our machine,

00:58:26.500 --> 00:58:29.780
that points to an address that
can change as we move about.

00:58:30.630 --> 00:58:33.180
And since I myself am the
administrator of this zone,

00:58:33.180 --> 00:58:35.220
I can pick my host name
and know it's unique.

00:58:35.380 --> 00:58:40.410
So I'll name this machine Demo.Demo.

00:58:41.090 --> 00:58:47.680
Bonjour.kiren.kiren.com as
well as the shared secret,

00:58:51.590 --> 00:58:55.870
I can just copy and paste
from my configuration file,

00:58:55.870 --> 00:58:57.510
if I can find it.

00:59:14.280 --> 00:59:15.360
We click Apply.

00:59:15.520 --> 00:59:17.040
See that the light turns green?

00:59:17.160 --> 00:59:20.600
That means that our name
was successfully registered.

00:59:20.660 --> 00:59:25.270
This name can now be used for anything
that you'd use a host name for.

00:59:25.800 --> 00:59:30.740
You can ping it,
you can use it in finders,

00:59:31.010 --> 00:59:32.990
connect to server.

00:59:34.630 --> 00:59:39.840
And that right there gives us
a lot in terms of reachability.

00:59:39.900 --> 00:59:42.150
But as I mentioned,
Bonjour is about more than just naming.

00:59:42.320 --> 00:59:47.290
We want to be able to register
and discover services as well.

00:59:48.960 --> 00:59:55.710
So in the registration tab,
I click the checkbox and enter my zone.

01:00:03.400 --> 01:00:11.840
And again, enter my DNSSEC authentication
and click Apply.

01:00:15.080 --> 01:00:18.190
Now, let's see if this is working.

01:00:18.400 --> 01:00:20.820
Here we're just doing
our standard browse.

01:00:21.030 --> 01:00:23.600
The Safari,
like many of your applications,

01:00:23.600 --> 01:00:28.310
does these empty string browses where
the system picks domains for it.

01:00:28.810 --> 01:00:33.010
Now, let's see if I can advertise
a web page with wide area

01:00:33.010 --> 01:00:35.200
Bonjour and have it be discovered.

01:00:35.200 --> 01:00:42.350
Click Personal Web Sharing.

01:00:42.550 --> 01:00:46.170
It takes a few seconds
for Apache to fire up.

01:00:53.350 --> 01:00:55.620
And there we have it.

01:00:56.010 --> 01:00:57.260
I double click on it.

01:00:57.260 --> 01:01:00.590
Oh, it decided to use my dot local.

01:01:06.100 --> 01:01:09.810
Because we're using the same machine
as both the client and server,

01:01:09.810 --> 01:01:13.400
we ended up using my .local name.

01:01:13.410 --> 01:01:19.410
But just to show you that I'm
not using smoke and mirrors,

01:01:32.930 --> 01:01:39.530
Well, let's try to print this page.

01:01:39.530 --> 01:01:44.220
Here you can see we've discovered the
printer with the wide area registration.

01:01:47.390 --> 01:01:54.800
And now, all of these services that
use Bonjour will register

01:01:54.800 --> 01:01:57.790
and browse in wide area.

01:01:59.940 --> 01:02:04.170
So we're actually running short on time,
and I don't want to take

01:02:04.280 --> 01:02:05.750
up all of our Q&A time.

01:02:05.750 --> 01:02:09.810
So let's go back to the
slides just to wrap up here.

01:02:17.670 --> 01:02:21.150
So for some more information,
go to the Developer page.

01:02:21.270 --> 01:02:23.240
We've got documentation.

01:02:23.240 --> 01:02:24.620
We've got specs.

01:02:24.640 --> 01:02:30.480
We've got links to the dns-sd.org page,
where you can find information to

01:02:30.560 --> 01:02:34.040
set up the clients and the server,
as I just showed.

01:02:34.820 --> 01:02:39.240
And we've got a few other sessions
that are directly related to Bonjour.

01:02:39.280 --> 01:02:41.820
Later this afternoon,
we've got a lab where you can work

01:02:41.920 --> 01:02:46.850
with the Bonjour team on integrating
Bonjour into your products.

01:02:47.540 --> 01:02:51.800
We've got the Cocoa session,
which covers a variety

01:02:51.800 --> 01:02:54.850
of networking topics,
including Bonjour.

01:02:55.210 --> 01:02:58.860
And along with the beer
bash at Apple Campus,

01:02:58.860 --> 01:03:01.600
we've got the
Apple Developer Connection Plugfest,

01:03:01.640 --> 01:03:04.340
which is a great opportunity for
you to bring your products in,

01:03:04.340 --> 01:03:06.900
show them to us as well
as the other developers,

01:03:06.900 --> 01:03:10.900
and to work with the
Bonjour team on those products.

01:03:12.880 --> 01:03:15.960
And for more information,
you can contact Craig Keithley,

01:03:15.960 --> 01:03:22.010
who's our I/O evangelist and
also does evangelism for Bonjour.

01:03:23.080 --> 01:03:26.650
He's also moderating our Q&A,
so if I could have Craig come up as

01:03:26.680 --> 01:03:28.140
well as the rest of the Bonjour team.