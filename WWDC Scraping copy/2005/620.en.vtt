WEBVTT

00:00:00.060 --> 00:00:02.740
I manage one of the developer
technical support teams

00:00:02.740 --> 00:00:03.980
here in Developer Relations.

00:00:04.010 --> 00:00:08.000
We are responsible for the
show that you are attending.

00:00:08.000 --> 00:00:13.430
I've got great pleasure today in bringing
up two people to the stage to talk about

00:00:13.430 --> 00:00:16.000
moving from Panther to Tiger Server.

00:00:16.000 --> 00:00:19.000
How many of you right now
are running Panther Server?

00:00:19.000 --> 00:00:21.000
Excellent!

00:00:21.000 --> 00:00:22.000
That's what I wanted to see.

00:00:22.000 --> 00:00:25.570
So after this session,
you'll see the things you need to know

00:00:25.570 --> 00:00:28.000
in order to migrate smoothly up to Tiger.

00:00:28.000 --> 00:00:30.940
A couple of gotchas that
you might not be aware of.

00:00:30.940 --> 00:00:34.970
We do have some fantastic resources also,
so we'll be pointing

00:00:34.970 --> 00:00:35.980
you to some of those.

00:00:36.000 --> 00:00:38.850
So I'd like to bring on
to the stage right now,

00:00:38.860 --> 00:00:40.000
Schoun Regan.

00:00:40.000 --> 00:00:42.510
He runs the itinstructure.com site.

00:00:42.510 --> 00:00:46.000
He actually does a lot of
training and consulting for Apple.

00:00:46.000 --> 00:00:50.350
And Josh Wisenbakker,
who runs afp548.com,

00:00:50.350 --> 00:00:54.700
which I'm sure many of you have
used if you are a Macintosh

00:00:54.700 --> 00:00:57.020
Systems Administrator.

00:00:58.810 --> 00:00:59.800
Thank you.

00:01:00.210 --> 00:01:02.760
Thank you, Jason.

00:01:02.760 --> 00:01:04.560
So, I didn't get to see it.

00:01:04.560 --> 00:01:06.080
How many people have
Tiger Server installed

00:01:06.080 --> 00:01:08.040
already and you're running it?

00:01:08.040 --> 00:01:10.120
Why are you here?

00:01:10.770 --> 00:01:16.040
I'm being facetious because the session
is about upgrading and some of the issues

00:01:16.350 --> 00:01:18.200
that you're going to find in upgrading.

00:01:18.340 --> 00:01:23.010
We've planned this session out
carefully and sort of narrowed it down

00:01:23.010 --> 00:01:27.140
to some of the areas that are most
important when people are upgrading.

00:01:27.140 --> 00:01:29.890
So let's go ahead and get started.

00:01:30.980 --> 00:01:33.710
So preparing for an upgrade,
what do you need to do?

00:01:33.930 --> 00:01:36.500
Well, focus on,
and what we want to do is focus

00:01:36.500 --> 00:01:38.230
on critical aspects of this.

00:01:38.230 --> 00:01:40.720
We want to focus on
service configuration,

00:01:40.720 --> 00:01:45.050
on the password server and the KDC,
and we want to focus on users and groups.

00:01:45.050 --> 00:01:48.210
Also, how many people have
read the migration guide?

00:01:48.210 --> 00:01:50.340
It's free, it's out there, right?

00:01:50.340 --> 00:01:50.800
Okay.

00:01:50.870 --> 00:01:54.870
So if you didn't know about it,
there's a link at the end of the session.

00:01:54.870 --> 00:01:57.820
It's on Apple's server
site under documentation.

00:01:57.820 --> 00:02:00.880
You have a PDF guide,
you can download it.

00:02:00.900 --> 00:02:03.590
download that and it talks about
some of the stuff that we're going

00:02:03.600 --> 00:02:05.260
to talk about in this session.

00:02:06.070 --> 00:02:08.380
So, what are we going to learn?

00:02:08.380 --> 00:02:09.900
We're going to talk about
planning the upgrade,

00:02:09.900 --> 00:02:11.850
we're going to talk a
little bit about backup,

00:02:12.020 --> 00:02:13.440
some rules of engagement.

00:02:13.440 --> 00:02:17.100
We have to have some rules here
before we upgrade to Tiger Server,

00:02:17.100 --> 00:02:18.900
so we want to talk about
some of these rules.

00:02:18.900 --> 00:02:21.170
We're going to talk
about service updates,

00:02:21.170 --> 00:02:23.980
and we're going to spend a bulk
of the time towards the end

00:02:24.040 --> 00:02:27.500
talking about the LDAP database
password server and the KDC.

00:02:27.500 --> 00:02:29.570
That's really what we want to hit here.

00:02:31.320 --> 00:02:33.980
So upgrade methods.

00:02:33.990 --> 00:02:34.790
What can we do?

00:02:34.830 --> 00:02:37.060
How can we upgrade?

00:02:37.140 --> 00:02:39.740
Well, you can do a clean install.

00:02:40.140 --> 00:02:46.690
30 users, don't really have a lot,
back up the users, data, blow it away,

00:02:46.770 --> 00:02:49.600
install Tiger Server, and you're done.

00:02:49.750 --> 00:02:52.240
You re-enter the users,
re-enter the passwords.

00:02:52.380 --> 00:02:55.550
Kind of straightforward,
you may have done that before.

00:02:56.220 --> 00:02:58.100
Upgrade in place.

00:02:58.250 --> 00:03:01.440
On upgrade in place,
you have a Panther Server.

00:03:01.440 --> 00:03:02.140
It's already running.

00:03:02.140 --> 00:03:05.300
How many people have done
an upgrade in place already?

00:03:05.300 --> 00:03:06.000
Okay.

00:03:06.000 --> 00:03:08.600
So those of you that have
done an upgrade in place,

00:03:08.600 --> 00:03:11.230
how many have had problems
after the upgrade?

00:03:11.230 --> 00:03:12.640
Okay.

00:03:12.640 --> 00:03:17.090
How many have had problems with
the LDAP KDC or password server?

00:03:17.110 --> 00:03:17.720
Okay.

00:03:17.720 --> 00:03:19.300
Just a few, right?

00:03:19.300 --> 00:03:22.330
So some of the issues that
we have that we can face,

00:03:22.330 --> 00:03:25.040
we're going to talk about
as we go further on,

00:03:25.040 --> 00:03:27.540
and hopefully we can learn from this.

00:03:27.590 --> 00:03:30.520
And so when you plan your upgrade,
you don't have to worry about this.

00:03:30.600 --> 00:03:35.520
We also want to keep an eye
towards remote upgrading.

00:03:35.520 --> 00:03:35.520
Okay.

00:03:36.850 --> 00:03:41.010
Next up is the record and
configuration migration.

00:03:41.160 --> 00:03:43.710
This is where we migrate
our user records,

00:03:43.950 --> 00:03:47.780
we migrate our computer records,
we migrate our KDC information,

00:03:47.800 --> 00:03:52.410
and our password server
database information.

00:03:52.410 --> 00:03:52.410
Back them up.

00:03:52.990 --> 00:03:57.840
Wipe it, reinstall it,
and pull the information back in.

00:03:57.890 --> 00:04:01.700
When you do this,
or to assist you in doing some of this,

00:04:01.860 --> 00:04:03.390
there are migration tools.

00:04:03.420 --> 00:04:05.370
They are binaries, and they're included.

00:04:05.380 --> 00:04:07.870
You can see the URL right there.

00:04:08.710 --> 00:04:12.960
So, think about your deployment.

00:04:12.980 --> 00:04:15.600
Which one of these makes
the most sense to you?

00:04:15.600 --> 00:04:17.820
You need to decide.

00:04:17.940 --> 00:04:21.710
And what tools are necessary to
accomplish each one of these?

00:04:22.860 --> 00:04:26.140
So, backup procedure.

00:04:26.190 --> 00:04:28.040
Few slides, can't do without it.

00:04:28.250 --> 00:04:31.750
Always have a backup
in place ready to go.

00:04:32.450 --> 00:04:36.440
What I want to demonstrate in the
next couple of slides is just a quick

00:04:36.470 --> 00:04:39.100
and dirty XServe backup solution.

00:04:39.270 --> 00:04:42.760
This is called pleasing your ISP.

00:04:42.760 --> 00:04:47.300
Because if you have an XServe
at an ISP or remote location,

00:04:47.410 --> 00:04:51.040
do you really want to be going there
while you're trying to do the backup?

00:04:51.040 --> 00:04:52.840
Can you do it remotely?

00:04:52.920 --> 00:04:53.980
Are there things that you can do?

00:04:54.300 --> 00:04:55.720
So you can try this at home.

00:04:55.800 --> 00:04:58.580
What we've done is said, well,
let's go ahead and take

00:04:58.590 --> 00:05:01.060
a standard G5 XServe,
mirror the two drives,

00:05:01.090 --> 00:05:04.020
user data is on an XServe rate,
and we have a third drive,

00:05:04.080 --> 00:05:06.840
and we're going to use
that for something else.

00:05:08.800 --> 00:05:11.990
You have Mac OS X Server installed
on the Mirrod drives.

00:05:12.220 --> 00:05:15.800
Take the third drive and
install Mac OS X Client.

00:05:15.890 --> 00:05:17.200
You may need an additional license.

00:05:17.200 --> 00:05:19.430
Don't install Server, install Client.

00:05:19.540 --> 00:05:21.430
Use the same administrator
name and password.

00:05:21.500 --> 00:05:26.870
Turn on SSH, ARD, and then copy over.

00:05:27.870 --> 00:05:32.150
The configuration file,
the preferences.plist from

00:05:32.150 --> 00:05:34.390
your server to the client.

00:05:35.360 --> 00:05:40.060
When you do that,
and you boot from the third disk,

00:05:40.110 --> 00:05:41.800
if you're remote, what happens?

00:05:41.970 --> 00:05:44.460
Do you have to change
your passwords in R or D?

00:05:44.510 --> 00:05:45.650
No.

00:05:45.740 --> 00:05:48.340
Does it have the exact
same IP configuration?

00:05:48.390 --> 00:05:48.790
Yes.

00:05:49.270 --> 00:05:50.480
Is SSH turned on?

00:05:50.720 --> 00:05:51.750
Yes.

00:05:51.850 --> 00:05:55.480
If you're using SSH keys,
you may need to migrate the keys over.

00:05:55.560 --> 00:06:00.030
Once you've done this,
you can use HDI util, whatever you want,

00:06:00.030 --> 00:06:03.450
create a disk image,
make it read-writable.

00:06:04.100 --> 00:06:08.690
Use any tool that you want
to take your server image and

00:06:08.820 --> 00:06:11.160
clone it to the disk image.

00:06:11.830 --> 00:06:16.270
Create a small script that maybe once
a week mounts the disk image and does

00:06:16.270 --> 00:06:19.530
a synchronization between your server
mirrored drives and the disk image

00:06:19.550 --> 00:06:22.190
and then unmounts the disk image.

00:06:22.900 --> 00:06:26.810
You can also have small shell scripts
that sit there and say if Watchdog

00:06:26.810 --> 00:06:31.860
or something else reboots the machine
within three times within five minutes,

00:06:32.060 --> 00:06:34.780
change the startup disk
to the client disk.

00:06:34.900 --> 00:06:38.100
Obviously something's going on,
you may not be able to get into it,

00:06:38.230 --> 00:06:40.920
so you put a dead man
switch so it'll change over,

00:06:41.130 --> 00:06:43.200
boots from the client disk,
and then you can actually

00:06:43.210 --> 00:06:45.710
restore in place,
recover data, do what you need to do.

00:06:45.720 --> 00:06:51.610
So you ship the Tiger CD out to your ISP,
you have them put it in the drive bay,

00:06:51.610 --> 00:06:53.710
and you leave it go.

00:06:54.830 --> 00:06:56.300
I want to turn it over to Josh.

00:06:56.330 --> 00:06:59.760
We want to talk about what to
look for or a quick and dirty

00:06:59.820 --> 00:07:01.800
demo of just what we talked about.

00:07:01.810 --> 00:07:02.400
Josh?

00:07:02.400 --> 00:07:03.740
Okay.

00:07:03.740 --> 00:07:06.020
Demo number one, please.

00:07:06.060 --> 00:07:08.930
And I will say that I'm not
the only person at AFP548.

00:07:09.070 --> 00:07:13.160
Joel Renick is the instigator of
our little endeavor there as well.

00:07:13.240 --> 00:07:17.560
And we have a lot of talented writers,
and thank you for your support on that.

00:07:17.650 --> 00:07:21.400
So taking a look here very
quickly at some of these files

00:07:21.400 --> 00:07:24.360
that Schoun was talking about,
you can see we've got our drives here.

00:07:24.360 --> 00:07:27.920
If you look at the orange ones,
this is our imaginary XServe down here.

00:07:27.920 --> 00:07:30.920
We've got our pre-in-place OS drive
that we haven't updated yet.

00:07:30.940 --> 00:07:37.120
We've got our backups drive over here,
and we've got our client OS drive.

00:07:37.150 --> 00:07:39.990
So the client drive we have
10.4 client installed on.

00:07:40.240 --> 00:07:43.760
And now we want to move these files that
Schoun was talking about over there,

00:07:43.810 --> 00:07:47.920
and we just want to make sure that it
is set up the same way this XServe is.

00:07:47.920 --> 00:07:51.220
So if it reboots off his
script and then comes up,

00:07:51.220 --> 00:07:53.920
it is ready to go off of that machine.

00:07:53.920 --> 00:07:55.590
So what we're going to
check is just host config.

00:07:55.700 --> 00:07:57.880
This is just standard
old Etsy host config.

00:07:57.920 --> 00:08:01.360
ARD is in here,
and this is how you can turn ARD agent

00:08:01.620 --> 00:08:03.640
on and off outside of using Kickstart.

00:08:03.740 --> 00:08:06.310
This is what ensures it gets
it going up at the beginning.

00:08:06.330 --> 00:08:09.420
So just verify ARD agent equals yes.

00:08:09.420 --> 00:08:09.920
Okay.

00:08:09.920 --> 00:08:10.980
ARD will start up.

00:08:11.020 --> 00:08:14.950
Now, something that's not in there
is SHH isn't in there anymore

00:08:15.250 --> 00:08:18.910
because LookupD is now the
owner of our SSH processes.

00:08:19.030 --> 00:08:22.090
So we do need to check our SSH.

00:08:23.060 --> 00:08:25.700
P List and that's in
System Library Launch Daemons,

00:08:25.720 --> 00:08:27.420
SSH P List.

00:08:27.420 --> 00:08:30.900
And the easy way to tell if it's
enabled or not is if it's enabled,

00:08:30.940 --> 00:08:33.080
it doesn't say it's disabled.

00:08:33.080 --> 00:08:37.260
On a machine that's disabled at the top,
you'll have a disabled is true key.

00:08:37.260 --> 00:08:41.420
When you enable SSH in the system
preferences of the sharing panel,

00:08:41.420 --> 00:08:43.770
what it does is it just
takes out that key.

00:08:44.110 --> 00:08:49.040
A lot of the Launch Daemons and a
lot of LaunchD functions in this way.

00:08:49.040 --> 00:08:51.840
It doesn't usually set disabled to false.

00:08:51.840 --> 00:08:57.050
It usually just removes the key through
the system preferences that Apple has.

00:08:57.060 --> 00:08:59.540
So now that we've verified
that SSH is going to start up,

00:08:59.550 --> 00:09:04.340
and you can see it's on volumes
client system so we know where it is,

00:09:04.340 --> 00:09:06.190
we need to copy over our SSH

00:09:06.550 --> 00:09:08.960
preferences file,
and this is the file that controls

00:09:08.960 --> 00:09:11.460
our Ethernet and our IP interfacing.

00:09:11.460 --> 00:09:14.770
So we're just going to copy
it from the OS X server to

00:09:14.770 --> 00:09:16.990
the same place in the client.

00:09:20.960 --> 00:09:23.200
Okay, so it's copied over,
but we need to make

00:09:23.200 --> 00:09:24.560
sure of a couple things.

00:09:24.560 --> 00:09:28.540
When we're running our OS X server here,
we are running our own DNS server,

00:09:28.540 --> 00:09:32.320
and it's looking at ourselves for DNS.

00:09:32.340 --> 00:09:34.710
And we boot off of the client,
it's not going to do that.

00:09:34.770 --> 00:09:38.020
So you need to make sure you
come in and edit that plist file.

00:09:38.080 --> 00:09:39.580
And yes, I know, Pico.

00:09:41.950 --> 00:09:43.900
If you want to come
in and edit this file,

00:09:43.900 --> 00:09:47.630
and it's pretty easy to do,
you're just going to remove the

00:09:47.630 --> 00:09:52.390
search domain and the DNS server.

00:09:53.830 --> 00:09:56.360
And then we just save out our changes.

00:09:56.740 --> 00:09:59.990
And then we're all ready to go
there with our config files.

00:10:00.260 --> 00:10:04.380
The next thing we need to do is boot up
off the client and make an image of this,

00:10:04.460 --> 00:10:06.480
which we're not going to do
all the booting and imaging

00:10:06.480 --> 00:10:07.600
because it would take so long.

00:10:07.840 --> 00:10:11.800
You can use HDI Util if
you like to use HDI Util,

00:10:11.800 --> 00:10:12.960
which is very nice.

00:10:13.180 --> 00:10:16.020
And you can also just use Disk Utility.

00:10:16.070 --> 00:10:21.350
When you make this image,
you just file a new image from folder,

00:10:21.380 --> 00:10:22.880
which moved.

00:10:24.910 --> 00:10:30.980
and I would probably actually
use HDI Util to do this so I can

00:10:30.980 --> 00:10:33.960
make it directly to a sparse,
and then that way it always

00:10:33.960 --> 00:10:37.080
can grow to expand to fit the
size of what we need to do.

00:10:37.080 --> 00:10:40.540
And I never have to go in
later and resize the image,

00:10:40.590 --> 00:10:42.520
which is just kind of a pain.

00:10:43.320 --> 00:10:50.450
In doing this,
it allows you to literally have

00:10:50.610 --> 00:10:53.140
remote control over that XServe.

00:10:53.140 --> 00:10:58.030
You literally don't need to
go to that machine unless

00:10:58.060 --> 00:11:00.200
you have a hardware failure.

00:11:00.440 --> 00:11:03.200
You've set it up,
there are a couple other scripts,

00:11:03.200 --> 00:11:07.080
and we actually are going
to post some of the scripts.

00:11:07.330 --> 00:11:11.100
They'll be on AFP 548
in the coming weeks.

00:11:11.470 --> 00:11:12.700
So where are we?

00:11:12.720 --> 00:11:14.310
We decided on an installation method.

00:11:14.370 --> 00:11:17.360
Do we just want to do a nuke and install
and just type in everything again?

00:11:17.360 --> 00:11:18.880
That's fine.

00:11:19.200 --> 00:11:21.300
Do we want to do a migration in place?

00:11:21.300 --> 00:11:22.910
What do we want to do?

00:11:23.290 --> 00:11:24.810
Did we back up our current server?

00:11:25.050 --> 00:11:26.900
Yep, we backed it up.

00:11:26.940 --> 00:11:32.020
Before we go any further,
there are some rules.

00:11:42.840 --> 00:11:46.000
I've seen the lists.

00:11:46.000 --> 00:11:51.380
It's explained over and over and over,
but somehow some people

00:11:51.380 --> 00:11:53.800
slip through the cracks.

00:11:55.160 --> 00:11:59.230
Never update a production server.

00:11:59.350 --> 00:12:00.450
So, we'll get serious.

00:12:00.590 --> 00:12:01.840
Back up, number one.

00:12:02.110 --> 00:12:05.910
Number two,
get all your service configuration

00:12:05.920 --> 00:12:07.700
files that you've touched.

00:12:07.900 --> 00:12:11.300
If you've tweaked the AFP property list,
the plist file,

00:12:11.300 --> 00:12:14.140
go grab it out of library preferences.

00:12:14.260 --> 00:12:21.240
If you've tweaked the SSHD config list,
go get it in Etsy.

00:12:21.310 --> 00:12:23.260
If you've tweaked the
SMB configuration file,

00:12:23.350 --> 00:12:24.800
go grab it.

00:12:24.800 --> 00:12:27.380
Go grab the configuration
file for the daemons and the

00:12:27.380 --> 00:12:29.070
services that you're running.

00:12:29.180 --> 00:12:31.220
Back them up.

00:12:31.560 --> 00:12:35.480
In fact, if you want to be good about it,
just tar it private.

00:12:35.480 --> 00:12:39.500
Take private, tar it up, zip it off,
you've got most of what you need,

00:12:39.500 --> 00:12:40.990
and you can go back and get it later.

00:12:41.060 --> 00:12:42.860
I would also grab,
and it's not up here on the slide,

00:12:42.860 --> 00:12:47.690
I would also grab library preferences
for the AFP list and a few others.

00:12:48.130 --> 00:12:51.540
Use File Merge,
Apple's great developer tool, or Diff.

00:12:51.540 --> 00:12:54.710
After you've done an upgrade and
certain things aren't working,

00:12:55.050 --> 00:12:55.600
why?

00:12:55.910 --> 00:12:57.800
Why aren't they working?

00:12:58.020 --> 00:13:00.600
Use File Merge to compare the files.

00:13:00.710 --> 00:13:03.690
Oh, here's my SMB config file beforehand,
here's my SMB config

00:13:03.690 --> 00:13:05.020
file after the upgrade.

00:13:05.290 --> 00:13:06.700
What happened?

00:13:06.920 --> 00:13:08.000
Okay?

00:13:08.200 --> 00:13:15.710
So, some homegrown config files may
have been fixed by the upgrade.

00:13:16.190 --> 00:13:21.020
By that we mean sometimes if
you put some lines in there,

00:13:21.030 --> 00:13:27.140
DNS, and you do the upgrade,
those lines may have been altered

00:13:27.140 --> 00:13:29.140
a little bit or taken out.

00:13:29.230 --> 00:13:32.520
So file merge is a great way to
say here's the way it was before,

00:13:32.520 --> 00:13:34.220
here's the way it's going to be now.

00:13:34.280 --> 00:13:36.460
Let's go ahead and take a
look at this and see what

00:13:36.510 --> 00:13:38.050
lines we need to put back in.

00:13:38.570 --> 00:13:42.470
And as a prelude to that,
poor DNS hygiene will be

00:13:42.470 --> 00:13:45.140
dealt with harshly in Tiger.

00:13:45.550 --> 00:13:47.390
Gotta have DNS ready.

00:13:48.020 --> 00:13:49.230
More roles.

00:13:49.570 --> 00:13:51.380
System admin tools.

00:13:51.510 --> 00:13:52.900
Put them on the client.

00:13:52.970 --> 00:13:54.040
Do it right ahead of time.

00:13:54.590 --> 00:13:56.660
And understand the role of LaunchD.

00:13:56.780 --> 00:13:59.920
LaunchD changes things
significantly for certain services.

00:13:59.920 --> 00:14:02.720
So you need to understand what
LaunchD is going to do and how

00:14:02.720 --> 00:14:05.930
it's going to affect some of the
configuration files and some of the

00:14:05.930 --> 00:14:08.340
custom configurations that you've done.

00:14:08.340 --> 00:14:10.950
And you're going to need to go in there.

00:14:10.950 --> 00:14:15.540
Hey, I've got an SSH plist now,
just like Josh showed you earlier.

00:14:15.630 --> 00:14:18.340
Before it was in the SSHD config file.

00:14:18.480 --> 00:14:19.120
Oh my gosh.

00:14:19.140 --> 00:14:20.410
Not a problem.

00:14:20.580 --> 00:14:23.080
The Launch Services plists
are named accordingly,

00:14:23.080 --> 00:14:24.180
according to service.

00:14:24.180 --> 00:14:26.580
Go in there,
take a look at what you've got,

00:14:26.580 --> 00:14:29.980
take a look at Apple's
upgrade documentation,

00:14:29.980 --> 00:14:34.610
and make sure your services
are migrated properly.

00:14:35.680 --> 00:14:38.300
Configuration files in Panther,
some of them are binary.

00:14:38.300 --> 00:14:41.320
You can still use
Property List Editor to edit these files.

00:14:41.350 --> 00:14:46.840
However, if you feel more comfortable,
you might want to use PLUtil.

00:14:46.840 --> 00:14:49.620
You can use the line we have right here.

00:14:49.630 --> 00:14:52.240
How many of you have already used PLUtil?

00:14:52.240 --> 00:14:55.520
Okay, so it's not a bad tool to use.

00:14:55.590 --> 00:14:59.260
You can still use Property List Editor if
you choose to do so.

00:14:59.260 --> 00:15:01.470
However,
I would recommend that you use PLUtil,

00:15:01.590 --> 00:15:05.480
migrate the file to another location,
open it up in Property List Editor,

00:15:05.480 --> 00:15:05.480
and then you can use
PLUtil to edit these files.

00:15:05.500 --> 00:15:06.820
So,
if you want to use Property List Editor,

00:15:06.820 --> 00:15:09.650
do a diff, use file merge,
do whatever you want, make your changes,

00:15:09.740 --> 00:15:10.520
send it back.

00:15:12.470 --> 00:15:15.590
So the installation itself.

00:15:15.780 --> 00:15:19.400
Clean installs follow a set path.

00:15:19.530 --> 00:15:25.810
An in-place upgrade follows a much
shorter path than a clean install.

00:15:25.950 --> 00:15:27.900
Clean install,
we just walked through the screens.

00:15:27.910 --> 00:15:30.890
An in-place upgrade allows you
to do certain things and other

00:15:30.960 --> 00:15:31.890
things it takes for granted.

00:15:31.890 --> 00:15:33.390
We want to talk about some of those.

00:15:33.400 --> 00:15:36.190
An in-place upgrade,
it requires the walkthrough

00:15:36.190 --> 00:15:37.410
of just a few screens.

00:15:37.510 --> 00:15:40.390
Obviously you do need to
have a new serial number.

00:15:40.400 --> 00:15:44.320
Keyboard layout, serial number,
administrator name.

00:15:44.500 --> 00:15:48.320
Probably not a good idea to change
the administrator name at this point.

00:15:48.400 --> 00:15:51.810
The computer names you can change
inside the preferences.plist.

00:15:51.980 --> 00:15:54.400
Networking information you
can change if you so desire.

00:15:54.400 --> 00:16:00.360
Directory usage,
we'll look at that in just a minute.

00:16:00.620 --> 00:16:04.680
Any of the services that you
want to turn on or turn off.

00:16:05.310 --> 00:16:08.530
When you upgrade and find the time,
right?

00:16:08.650 --> 00:16:10.700
And then you get a restart.

00:16:10.860 --> 00:16:18.240
So if you're doing this,
save a copy of the plist file.

00:16:18.350 --> 00:16:20.910
If you already have an
existing LDAP server,

00:16:21.110 --> 00:16:24.300
it's best to save that copy
back to an existing LDAP server.

00:16:24.330 --> 00:16:27.230
And we're going to talk about that
just a little bit in the demo here,

00:16:27.240 --> 00:16:31.640
because what we're talking about is,
if you already have a Mac OS X server,

00:16:31.700 --> 00:16:33.990
especially an LDAP server in place,

00:16:34.220 --> 00:16:37.220
When you go to install another server,
as long as you're bound to

00:16:37.250 --> 00:16:40.070
that initial LDAP server,
you can save all your configuration

00:16:40.090 --> 00:16:41.200
files on the LDAP server.

00:16:41.200 --> 00:16:45.290
You don't need to save them on a USB disk
or a FireWire drive or an iPod shuffle.

00:16:45.290 --> 00:16:46.910
You can do that,
but you can also save them

00:16:47.020 --> 00:16:50.450
back to the LDAP server,
which, in the case of many, many servers,

00:16:50.490 --> 00:16:52.330
is actually a pretty good idea.

00:16:52.470 --> 00:16:55.860
Okay, so I'm going to turn it
over to Josh for a demo,

00:16:55.900 --> 00:16:57.400
and we're going on machine number two.

00:16:57.400 --> 00:17:00.400
And we're still on one.

00:17:00.420 --> 00:17:03.400
So go back to number one, please.

00:17:04.250 --> 00:17:09.100
So we now have booted up off
of our Tiger Server CD or DVD,

00:17:09.100 --> 00:17:11.860
which Apple mercifully thought
to send both of them to you

00:17:11.910 --> 00:17:14.470
in your maintenance kits,
in case you didn't have

00:17:14.470 --> 00:17:15.840
an XR with a DVD drive.

00:17:15.920 --> 00:17:18.580
So congratulations to
Apple on doing that.

00:17:18.580 --> 00:17:20.310
I think that was a very good decision.

00:17:20.370 --> 00:17:22.290
So we've booted up,
and we've come up to our

00:17:22.370 --> 00:17:23.600
server installer screen now.

00:17:23.900 --> 00:17:26.980
And we're just going to kind
of step through the boxes here.

00:17:27.250 --> 00:17:28.760
And it's pretty basic.

00:17:28.760 --> 00:17:30.590
It's pretty much the same
as you've seen before.

00:17:30.900 --> 00:17:34.100
10.4 has some nice
utilities menu here now.

00:17:34.100 --> 00:17:36.880
They've added a lot more
utilities that you can run

00:17:37.160 --> 00:17:38.460
right off of the installer CD.

00:17:38.600 --> 00:17:41.600
Before, remember, we had nothing,
and then we had startup disk,

00:17:41.600 --> 00:17:43.600
and if you were on a server,
you had terminal,

00:17:43.600 --> 00:17:46.080
and now there's all kinds of
stuff you can get to from here.

00:17:46.160 --> 00:17:49.600
These are important utilities generally
to aid you in doing an upgrade.

00:17:49.600 --> 00:17:54.100
So, but we're just going to go through
the boxes and get it going.

00:17:54.100 --> 00:17:56.600
Of course, we will read the entire
license agreement.

00:17:58.290 --> 00:18:02.400
accept it, because yes,
I read the whole thing.

00:18:02.440 --> 00:18:03.880
We will go where we're
going to install it.

00:18:03.980 --> 00:18:07.030
Under options,
we've got upgrade and erase and install.

00:18:07.040 --> 00:18:09.960
There is no archive
install on OS X server,

00:18:09.960 --> 00:18:12.900
and it's mainly because there's
preference files everywhere,

00:18:12.900 --> 00:18:14.200
and you would never catch all of them.

00:18:14.200 --> 00:18:16.640
So we don't have that option here.

00:18:16.720 --> 00:18:19.110
So it's either upgrade
or erase and install.

00:18:19.170 --> 00:18:21.430
In this case, we're doing an upgrade.

00:18:23.010 --> 00:18:25.660
And then at that point we could
customize if we needed to.

00:18:25.790 --> 00:18:29.000
Notice that we can't deselect
languages if they're already installed,

00:18:29.000 --> 00:18:31.400
because they're installed
and it's just gonna go right

00:18:31.400 --> 00:18:33.000
ahead and upgrade this stuff.

00:18:33.120 --> 00:18:37.200
We can go through and trim down some of
that 1.2 gigabytes of printer drivers,

00:18:37.250 --> 00:18:40.300
if we don't need all 1.2
gigabytes of printer drivers.

00:18:40.400 --> 00:18:43.200
And X11, which you can then install.

00:18:43.280 --> 00:18:45.400
I like to have X on my machines.

00:18:45.490 --> 00:18:48.400
So, at this point we do need to
switch over to number two,

00:18:48.450 --> 00:18:52.530
because just like Julia Childs,
it's ready to come out of the oven.

00:18:53.600 --> 00:18:56.940
So I should say,
we have the service that we

00:18:56.940 --> 00:19:00.780
have up here have 15,000 users.

00:19:00.830 --> 00:19:03.900
They all have open directory passwords.

00:19:03.970 --> 00:19:07.890
About 3,000 of them have home folders.

00:19:08.100 --> 00:19:12.960
Doing an in-place upgrade like
this will take about 25 minutes.

00:19:12.960 --> 00:19:16.000
Now that's to install the software.

00:19:16.090 --> 00:19:19.280
What Josh has done,
we have installed the software

00:19:19.280 --> 00:19:21.760
on demo machine number two,
the machine is rebooted,

00:19:21.760 --> 00:19:23.840
and we're now up to the welcome screen.

00:19:23.840 --> 00:19:26.460
So I wanted to give you a little
bit of idea of how many users

00:19:26.460 --> 00:19:27.870
we have on these machines.

00:19:27.950 --> 00:19:30.990
Josh Wisenbak: Yeah,
these machines we do have a fair

00:19:31.220 --> 00:19:32.960
amount of stuff to migrate on.

00:19:32.960 --> 00:19:35.880
So it's rebooted,
it's installed and copied all the files.

00:19:35.880 --> 00:19:38.450
And OS X server, of course,
stops at the secondary screen

00:19:38.600 --> 00:19:41.720
after it's done copying files
so that we can go and set it up.

00:19:41.880 --> 00:19:43.880
Excuse me.

00:19:44.000 --> 00:19:46.720
Choose our language, and then immediately
check our serial number,

00:19:46.750 --> 00:19:49.600
which now we have the option of site
licensing on the servers as well,

00:19:49.600 --> 00:19:51.880
which is very nice to have,
especially if you start doing things

00:19:51.880 --> 00:19:53.880
like putting config records in LDAP.

00:19:53.880 --> 00:19:56.880
So if I can type this
whole number in here.

00:19:56.880 --> 00:19:57.880
Okay.

00:19:58.350 --> 00:19:59.590
I'll talk while he's typing.

00:19:59.600 --> 00:20:00.640
Don't worry about writing it down.

00:20:00.640 --> 00:20:01.720
It's from the developer site.

00:20:01.800 --> 00:20:03.100
You're developers.

00:20:03.260 --> 00:20:06.260
It will expire.

00:20:06.390 --> 00:20:19.800
You can go get it yourself if you like.

00:20:30.540 --> 00:20:34.230
And then we can click through here
and go through all of our stuff.

00:20:34.260 --> 00:20:36.560
Go ahead and put the password back in.

00:20:36.560 --> 00:20:37.660
You can go ahead and
explain that if you want.

00:20:37.660 --> 00:20:38.110
Right.

00:20:38.300 --> 00:20:42.000
And it's probably a good idea
not to change the password simply

00:20:42.000 --> 00:20:45.260
because the KDC principle for the
user has probably already been

00:20:45.410 --> 00:20:47.430
created if you've created a master.

00:20:47.650 --> 00:20:50.280
And the password server
is already set up.

00:20:50.330 --> 00:20:52.960
So it's probably not a good idea to
change the password at this point.

00:20:53.020 --> 00:20:56.180
And I would leave all your network
settings and such like this alone

00:20:56.190 --> 00:20:58.000
because we're updating in place.

00:20:58.000 --> 00:21:01.880
So we want to maintain the same
configuration we had before.

00:21:02.000 --> 00:21:06.210
We're not going to change anything.

00:21:09.600 --> 00:21:10.600
Turn off Firewire.

00:21:10.670 --> 00:21:12.600
Yeah, that's what I'm going to go do.

00:21:12.600 --> 00:21:15.100
Here we go.

00:21:16.770 --> 00:21:19.540
Set DirectUSI to no change and look,
it's grayed out.

00:21:19.540 --> 00:21:23.040
There's not even an option.

00:21:23.050 --> 00:21:26.100
Apple File Services is
the only thing enabled.

00:21:26.130 --> 00:21:29.480
I typically, on a new install,
would not check these boxes

00:21:29.480 --> 00:21:32.420
because it starts up unsecured
services on your machine,

00:21:32.420 --> 00:21:35.770
and I don't like doing that.

00:21:35.770 --> 00:21:35.770
Our time zone.

00:21:36.600 --> 00:21:38.240
Network time.

00:21:38.340 --> 00:21:40.000
Date and time.

00:21:40.090 --> 00:21:43.090
Now, go ahead and hit Save As.

00:21:44.610 --> 00:21:48.130
If we were connected to another
LDAP server and we were bound to that

00:21:48.130 --> 00:21:50.600
LDAP server under a directory node,
we would actually see

00:21:50.600 --> 00:21:51.900
that LDAP server offered.

00:21:52.000 --> 00:21:54.870
We could save the configuration
record in the config records

00:21:54.870 --> 00:21:57.390
of that parent LDAP server,
so we wouldn't have to

00:21:57.420 --> 00:21:58.630
retrieve it at a later date.

00:21:58.660 --> 00:22:03.190
If this machine is rebooted and a clean,
fresh, unconfigured install

00:22:03.310 --> 00:22:07.370
goes to this machine,
it will automatically find that record,

00:22:07.380 --> 00:22:09.900
reconfigure itself, and reboot.

00:22:10.460 --> 00:22:12.660
Apple put this in,
and this is sort of a sleeping giant.

00:22:12.660 --> 00:22:17.670
It's an incredibly efficient way if you
have several machines and you need to

00:22:17.750 --> 00:22:22.160
reboot them quickly with clean versions
of the OS to be able to do that.

00:22:22.240 --> 00:22:23.340
So it's very, very useful.

00:22:23.340 --> 00:22:25.860
We're just going to go ahead and
save it as a configuration file.

00:22:25.860 --> 00:22:29.930
It'll show up with the
MAC address as the file.

00:22:30.050 --> 00:22:31.640
So go ahead and click configuration file.

00:22:31.890 --> 00:22:34.670
We're not going to put it encrypted,
and if we do that,

00:22:34.670 --> 00:22:41.000
we can save it anywhere we'd like to.

00:22:41.000 --> 00:22:44.000
And it's just a standard plist file?

00:22:44.080 --> 00:22:45.480
Yep.

00:22:48.000 --> 00:22:52.260
When we're done, we just click Apply,
and it starts going along.

00:22:54.200 --> 00:22:58.240
So, one of the things when you do
an in-place upgrade that you'll

00:22:58.240 --> 00:23:01.900
see that's a little scary,
and I don't know if we'll get to it here,

00:23:01.980 --> 00:23:04.460
is your LDAP records.

00:23:04.840 --> 00:23:09.150
And anytime you see the word
LDAP on the screen and you're not

00:23:09.180 --> 00:23:12.820
really in control of your server,
you might get a little queasy, right?

00:23:12.930 --> 00:23:14.750
So not really to worry.

00:23:15.030 --> 00:23:17.700
It's actually taking and
upgrading your server.

00:23:17.700 --> 00:23:19.140
Everything's being taken care of.

00:23:19.140 --> 00:23:21.730
So let's go ahead and
while this is working,

00:23:21.730 --> 00:23:24.020
we're going to go back to the slides.

00:23:27.560 --> 00:23:30.190
And we want to talk about
some of the service updates.

00:23:30.210 --> 00:23:34.840
Are there any major service updates
in this upgrade that are going

00:23:34.960 --> 00:23:36.470
to affect some of my services?

00:23:36.500 --> 00:23:43.170
So, directory services, security,
file sharing, web and mail,

00:23:43.170 --> 00:23:46.420
and we need to talk about these.

00:23:46.590 --> 00:23:47.500
So directory services.

00:23:47.500 --> 00:23:51.380
So if I do an upgrade in place,
what changes are going

00:23:51.380 --> 00:23:53.500
to be shown in NetInfo?

00:23:53.690 --> 00:23:55.500
What changes to LDAP?

00:23:55.500 --> 00:23:58.500
And what about binding?

00:23:58.630 --> 00:24:00.500
What takes place?

00:24:00.520 --> 00:24:03.500
NetInfo is still around in both
Tiger Client and Tiger Server.

00:24:03.500 --> 00:24:07.300
NFS mounts, you still go ahead and
throw them in there.

00:24:07.600 --> 00:24:11.560
There are just some mild local user
changes if you're used to rooting

00:24:11.560 --> 00:24:13.500
around in NetInfo or using DSCL.

00:24:13.500 --> 00:24:18.620
And you want to go in and
check your config records,

00:24:18.780 --> 00:24:20.500
because the DHCP information is in there.

00:24:20.500 --> 00:24:22.500
We're going to talk about
that a little bit later.

00:24:22.500 --> 00:24:26.500
And also some basic lookup de-information
has been thrown into NetInfo.

00:24:26.500 --> 00:24:28.710
LDAP.

00:24:28.710 --> 00:24:32.500
As of 10.3.9,
we have some additional schema.

00:24:32.500 --> 00:24:33.950
Of course,
that's going to be there when we

00:24:33.950 --> 00:24:35.470
upgrade to the server as well.

00:24:35.500 --> 00:24:37.360
And binding.

00:24:37.360 --> 00:24:39.500
If the server is bound to
another directory service,

00:24:39.500 --> 00:24:42.500
it's probably a good idea to
unbind to that directory service

00:24:42.500 --> 00:24:45.470
before you do the upgrade.

00:24:45.700 --> 00:24:47.300
Okay?

00:24:48.380 --> 00:24:48.880
All right.

00:24:49.100 --> 00:24:50.140
Josh?

00:24:50.190 --> 00:24:50.820
Okay.

00:24:51.190 --> 00:24:54.500
So now if we can switch over
to machine number three.

00:24:57.090 --> 00:24:59.100
So now we've finished
our upgrade in place.

00:24:59.320 --> 00:25:02.400
Everything went perfectly smooth,
and we've now got a machine

00:25:02.400 --> 00:25:04.100
booted up into Tiger Server.

00:25:04.190 --> 00:25:06.530
So there are a couple things
that I can just take a look

00:25:06.570 --> 00:25:09.420
around here and show you,
and one is that we still do use local

00:25:09.420 --> 00:25:11.270
net info database for some things.

00:25:11.410 --> 00:25:15.180
And in here we can take a look
mainly at DHCP configuration records,

00:25:15.200 --> 00:25:19.000
if we had any subnets defined,
make sure those came over properly.

00:25:19.050 --> 00:25:23.200
Take a look at the lookupd records,
make sure that these are

00:25:23.200 --> 00:25:25.280
still what they should be.

00:25:25.500 --> 00:25:28.510
A new feature that everyone
just really is happy about,

00:25:28.510 --> 00:25:33.830
me included, is the new info tab for user
information in our LDAP databases.

00:25:33.840 --> 00:25:36.460
You'll see 99 in there on all your users.

00:25:36.460 --> 00:25:39.500
That's just that default placeholder
that we used to put in there.

00:25:39.500 --> 00:25:43.300
Anyone ever point address book at
their open directory server before,

00:25:43.300 --> 00:25:45.500
hoping they'd get all this
information about users,

00:25:45.500 --> 00:25:47.830
and everyone had the last name of 99?

00:25:47.830 --> 00:25:50.500
Well, there it is,
and now you can go take it out and

00:25:50.500 --> 00:25:52.500
put in the correct user information.

00:25:52.500 --> 00:25:55.080
So you can go through there
and configure all your users

00:25:55.080 --> 00:25:58.610
and fill in this information,
and then address book on Macs will

00:25:58.690 --> 00:26:01.590
just automatically pick that info out.

00:26:03.560 --> 00:26:07.550
The other thing we'd have to do is
if we were bound to Active Directory,

00:26:07.550 --> 00:26:11.120
other directory services,
you probably want to unbind from those

00:26:11.180 --> 00:26:13.180
services before you perform an upgrade.

00:26:13.360 --> 00:26:17.530
And in that case,
you would want to come into

00:26:17.530 --> 00:26:20.580
Directory Access and make sure...

00:26:23.380 --> 00:26:26.140
Make sure that you come back
and set up any custom directory

00:26:26.140 --> 00:26:28.460
services that you had in there.

00:26:28.540 --> 00:26:32.680
With 10.3, we really didn't want to hook
in a master into an AD domain,

00:26:32.820 --> 00:26:36.000
but with 10.4 now,
Eric is saying that that's good to go.

00:26:36.000 --> 00:26:38.630
We'll take Eric's word for it.

00:26:38.700 --> 00:26:40.200
Yeah.

00:26:40.320 --> 00:26:42.700
So, back to you, Schoun.

00:26:47.380 --> 00:26:51.060
So, don't want you to miss that,
security.

00:26:51.110 --> 00:26:56.890
So, when we upgrade in place, OpenSSL,
what did Apple do here?

00:26:56.900 --> 00:26:58.290
What about the KDC?

00:26:58.300 --> 00:27:01.380
Did they make any significant
GUI changes that we need to talk about?

00:27:01.380 --> 00:27:05.650
Again, we've got Open Directory with
respect to security.

00:27:05.650 --> 00:27:07.520
What about the firewall?

00:27:07.630 --> 00:27:09.020
And what about VPN?

00:27:09.020 --> 00:27:11.970
So, what information do we have here?

00:27:12.460 --> 00:27:17.240
SSL, we can use the certificate manager,
actually.

00:27:17.240 --> 00:27:21.320
In the server admin,
you can also use the self-signed

00:27:21.320 --> 00:27:24.560
certificates and some of the other
certificates inside the keychain.

00:27:24.560 --> 00:27:26.040
You can find those in there.

00:27:26.040 --> 00:27:32.090
You can still import older certificates
if you have them laying around.

00:27:33.720 --> 00:27:35.820
The KDC.

00:27:35.960 --> 00:27:38.470
Kerberos,
the GUI for Kerberos is nice and

00:27:38.520 --> 00:27:45.480
shiny and metal and new and clean,
and there's a nice little option in

00:27:45.480 --> 00:27:54.270
there to allow you to use the GUI to
edit the edu.mit.kerberos file.

00:27:54.560 --> 00:27:57.230
And we're going to do a demo of
it in here in just a little bit,

00:27:57.260 --> 00:27:59.000
but it's really, really useful.

00:27:59.000 --> 00:28:01.430
It's one of those sleeper
things that's kind of hidden.

00:28:01.540 --> 00:28:04.100
So you can use that to
edit your realms in place.

00:28:04.260 --> 00:28:06.080
Very, very useful.

00:28:06.310 --> 00:28:08.780
and that, by the way,
works on both server and client.

00:28:08.780 --> 00:28:11.370
Open Directory, you have secure binding.

00:28:11.440 --> 00:28:14.190
You can turn off certain
authentication methods.

00:28:14.440 --> 00:28:17.040
Previously,
this was only available with Nest,

00:28:17.210 --> 00:28:20.780
using Nest to get the protocols and
set the protocols and turn these off.

00:28:20.790 --> 00:28:24.310
So you have the ability
to do that now as well.

00:28:24.620 --> 00:28:27.300
And the firewall.

00:28:27.300 --> 00:28:29.910
The firewall, still IPFW.

00:28:30.090 --> 00:28:34.500
There are still two files
inside of ETSI IP Filter.

00:28:35.020 --> 00:28:39.980
One of them, ipfw.conf.apple,
that's maintained by the GUI.

00:28:40.110 --> 00:28:44.180
The other one, ipfw.conf,
that can contain additional rules.

00:28:44.210 --> 00:28:46.930
For those of you that like
to hand crank that file,

00:28:46.930 --> 00:28:47.820
that's fine.

00:28:47.820 --> 00:28:51.220
Just make sure the GUI doesn't
inadvertently override or conflict

00:28:51.220 --> 00:28:53.110
with some of the rules that you have.

00:28:53.300 --> 00:28:56.670
Pick one, pick the other,
do them both if you want to.

00:28:56.670 --> 00:29:01.080
Just make sure that your firewall
rules are set and clear in both files,

00:29:01.150 --> 00:29:03.680
and know that both files exist.

00:29:03.800 --> 00:29:06.990
You can still do ipfw from
the command line if you want.

00:29:07.060 --> 00:29:09.760
Reboot's going to wipe that out unless
you put up a startup item in there.

00:29:09.810 --> 00:29:13.870
And if you're upgrading in place
and you have older firewall rules,

00:29:13.870 --> 00:29:16.660
those firewall rules
will now migrate over.

00:29:16.660 --> 00:29:22.090
And you will actually see them listed
as another set of firewall rules.

00:29:22.100 --> 00:29:23.890
rules.

00:29:24.330 --> 00:29:25.420
And finally, VPN.

00:29:25.470 --> 00:29:27.140
It's now Kerberos for your enjoyment.

00:29:27.210 --> 00:29:28.440
That's great.

00:29:28.650 --> 00:29:29.000
Love that.

00:29:29.290 --> 00:29:29.980
Okay.

00:29:30.180 --> 00:29:32.260
And you can now use Raccoon.

00:29:32.260 --> 00:29:32.980
They've enabled it.

00:29:33.100 --> 00:29:34.360
You can use the SSL cert.

00:29:34.470 --> 00:29:38.150
So whether or not you want
to use Kerberos certificate,

00:29:38.150 --> 00:29:39.340
it's up to you.

00:29:39.340 --> 00:29:41.230
VPN has been upgraded as well.

00:29:41.260 --> 00:29:43.930
We just want to show you
some of these services.

00:29:44.780 --> 00:29:44.960
Okay.

00:29:44.980 --> 00:29:47.950
So back on three again,
and we're going to take a look at

00:29:48.010 --> 00:29:50.070
some of the things we just saw there.

00:29:50.070 --> 00:29:53.690
And the first one is the new cert
manager that's in server admin.

00:29:53.690 --> 00:29:57.540
Apple really didn't have a good
way to access this stuff before.

00:29:57.540 --> 00:30:00.520
And when you upgrade to a master,
it's going to go ahead and

00:30:00.640 --> 00:30:02.070
generate a default cert.

00:30:02.070 --> 00:30:05.770
It's not the greatest cert in the world,
but if you're just looking for

00:30:05.770 --> 00:30:08.740
SSL internally on your network,
it does actually work.

00:30:08.870 --> 00:30:13.150
You can use this cert for mail and web
and iChat server and such like that.

00:30:13.180 --> 00:30:14.400
Okay.

00:30:14.400 --> 00:30:14.440
Okay.

00:30:14.460 --> 00:30:14.500
Okay.

00:30:14.500 --> 00:30:14.500
Okay.

00:30:14.500 --> 00:30:14.520
Okay.

00:30:14.520 --> 00:30:14.640
Okay.

00:30:14.640 --> 00:30:14.660
Okay.

00:30:14.660 --> 00:30:14.680
Okay.

00:30:40.940 --> 00:30:44.640
So also new here is Open Directory has
gained a lot of policies

00:30:44.680 --> 00:30:46.780
that we can put on things.

00:30:46.800 --> 00:30:51.230
So we've got a few more policies in
here as far as just general password

00:30:51.260 --> 00:30:55.560
policies go for rotation and complexity.

00:30:55.560 --> 00:30:58.400
Under binding,
we now have a new thing in OS X for

00:30:58.400 --> 00:31:00.320
server that you'll have to think about.

00:31:00.320 --> 00:31:02.760
And this is just like, you know,
has anyone bound a Mac to an

00:31:02.760 --> 00:31:05.820
Active Directory domain or
PC Active Directory domain?

00:31:05.820 --> 00:31:08.660
And it does this, checks with it,
and it binds and creates a

00:31:08.660 --> 00:31:10.480
computer record and all that stuff.

00:31:10.700 --> 00:31:12.960
Well,
all that's about two-way trusted binding.

00:31:12.960 --> 00:31:16.400
The server authenticates the client,
the client authenticates the server,

00:31:16.400 --> 00:31:19.820
everybody is happy, everyone has proved
they are who they are.

00:31:19.820 --> 00:31:21.880
And we can do that now in OS X.

00:31:21.880 --> 00:31:25.750
So by default, it's checked to enable
it but not require it.

00:31:25.900 --> 00:31:27.340
You can require it.

00:31:27.350 --> 00:31:29.620
You also have some other
things you can check.

00:31:29.650 --> 00:31:31.670
You can disable clear text passwords.

00:31:31.770 --> 00:31:34.750
You can sign or encrypt
all your data protocol,

00:31:34.850 --> 00:31:37.380
your LDAT packets using Kerberos or S3.

00:31:37.380 --> 00:31:41.020
You can block man in the middle
packets where it tags each packet

00:31:41.050 --> 00:31:44.080
and then checks to make sure that
when you get it on the other end,

00:31:44.140 --> 00:31:45.540
it's actually who it's from.

00:31:47.500 --> 00:31:52.770
Is everyone excited about having
NTM v2 in OS X Server and OS X now?

00:31:53.780 --> 00:31:57.340
Now we've got a nice little box here
so we can turn things on and off.

00:31:57.380 --> 00:31:59.630
If you don't need APOP and
you don't need WebDAV,

00:31:59.690 --> 00:32:03.120
turn them off because as it says,
it's recoverable.

00:32:03.120 --> 00:32:07.140
So if there's an issue where you need
to have these different protocols,

00:32:07.140 --> 00:32:10.090
you can turn them on,
but it's nice to not have to go hit

00:32:10.280 --> 00:32:14.490
nest just to turn off the hashes that
you don't want to keep on your system.

00:32:15.980 --> 00:32:19.850
If we look at Kerberos now,
this is the same basic

00:32:19.850 --> 00:32:22.460
little panel they always had,
but they've now got this

00:32:22.540 --> 00:32:25.660
nice thing under edit,
and you can actually edit your realms.

00:32:25.700 --> 00:32:29.040
Here you can see our default
OS X realm that was set up.

00:32:29.060 --> 00:32:32.160
We can see the servers that are
in it because we haven't set up

00:32:32.160 --> 00:32:34.050
any services on this machine yet.

00:32:34.080 --> 00:32:36.420
We can see our different DNS domains.

00:32:36.420 --> 00:32:40.750
We can configure additional realms
automatically using the DNS records

00:32:40.810 --> 00:32:43.280
that we get out of our service records.

00:32:44.090 --> 00:32:47.740
There isn't a duplicate button,
so if you wanted to make a new one,

00:32:47.740 --> 00:32:50.380
you just make a new one and then
kind of copy the other settings

00:32:50.380 --> 00:32:53.010
you had to get it set up correctly.

00:32:57.320 --> 00:32:59.200
Let's go back to the slides.

00:32:59.200 --> 00:33:01.200
There we go.

00:33:01.350 --> 00:33:02.420
All right.

00:33:02.750 --> 00:33:05.730
File sharing, somewhat short and
sweet up to this point.

00:33:05.750 --> 00:33:09.350
Link aggregation is there for the update.

00:33:09.350 --> 00:33:11.490
Obviously,
you must have hardware to support that.

00:33:11.540 --> 00:33:16.410
You do have the AFP config or the
com.apple.applefileserver.plist file

00:33:16.410 --> 00:33:18.940
that you've made a backup of before.

00:33:18.940 --> 00:33:23.270
So if you tweak that file a little bit,
and you've made some changes, again,

00:33:23.280 --> 00:33:27.160
you just may want to check the
Kerberos auth key inside that file.

00:33:27.200 --> 00:33:28.680
file.

00:33:29.070 --> 00:33:35.680
Fun new authentication methods: Kerberos,
NTLMv2, which Josh already talked about.

00:33:35.680 --> 00:33:38.400
As previously noted in other sessions,
it can become a primary

00:33:38.400 --> 00:33:42.070
domain controller,
and this version can also become

00:33:42.070 --> 00:33:43.470
a backup domain controller.

00:33:43.830 --> 00:33:46.540
However, as was also stated,
it can only be a backup

00:33:46.590 --> 00:33:49.510
domain controller of itself,
or of another Samba

00:33:49.540 --> 00:33:51.500
primary domain controller.

00:33:51.500 --> 00:33:55.120
SMB SharePoints will still
write to the NetInfo database,

00:33:55.120 --> 00:33:59.370
and this is an important thing that
a lot of people get tripped up on.

00:33:59.500 --> 00:34:01.500
It's not so much in the upgrade,
but it's still there,

00:34:01.500 --> 00:34:04.500
and so you still want to look for that.

00:34:04.500 --> 00:34:07.910
If you hand edit the
SMB configuration file,

00:34:07.990 --> 00:34:12.500
please be aware that inside
the config record of NetInfo,

00:34:12.530 --> 00:34:15.600
it also stores some
SharePoint configuration

00:34:15.600 --> 00:34:19.500
information for both AFP and SMB.

00:34:19.500 --> 00:34:20.500
In certain circumstances,
the NetInfo will be stored

00:34:20.500 --> 00:34:20.500
in the configuration file.

00:34:20.500 --> 00:34:21.040
In other words,
the NetInfo will be stored

00:34:21.040 --> 00:34:21.500
in the configuration file.

00:34:21.500 --> 00:34:25.500
The NetInfo database may
overwrite the SMB config file.

00:34:25.500 --> 00:34:28.030
So it's very,
very important that you take a look

00:34:28.030 --> 00:34:31.760
at both your SMB config file and the
NetInfo database inside the config

00:34:31.760 --> 00:34:35.760
records inside the SharePoints to
make sure that what you're seeing

00:34:35.760 --> 00:34:37.500
is exactly what you need to do.

00:34:37.660 --> 00:34:40.580
There is a command line tool
that allows you to set up the

00:34:40.580 --> 00:34:42.350
SharePoints called Sharing.

00:34:42.500 --> 00:34:44.450
You can still get in there and do that.

00:34:44.500 --> 00:34:47.810
Doing it in the
GUI writes to both places,

00:34:47.810 --> 00:34:50.480
so just double check your work.

00:34:52.780 --> 00:34:55.910
FTP is not handled by ZynetD.

00:34:56.340 --> 00:34:58.080
Some changes there.

00:34:58.590 --> 00:35:02.690
And if you want a Kerberos connection,
the URL is here.

00:35:03.030 --> 00:35:07.410
You can actually go and download the
Kerberos extras from the MIT site.

00:35:07.450 --> 00:35:09.540
Use Fetch.

00:35:09.540 --> 00:35:13.280
New version just came out, I think,
earlier this week or late last week.

00:35:15.400 --> 00:35:16.310
Web and Mail.

00:35:16.310 --> 00:35:19.490
Apache, you get some new modules
after you update.

00:35:19.490 --> 00:35:22.250
Obviously,
there are some updated modules,

00:35:22.250 --> 00:35:24.740
and you get some of the newer modules.

00:35:24.810 --> 00:35:28.040
If you've customized not
so much your websites,

00:35:28.130 --> 00:35:33.910
but the HTTPD configuration file itself,
you should do a diff,

00:35:33.940 --> 00:35:39.000
or you should use file merge to take
a look at the file before and after.

00:35:39.000 --> 00:35:41.460
Right?

00:35:41.690 --> 00:35:44.160
Certificates, reimport the certs.

00:35:44.180 --> 00:35:47.140
If you have any other customized changes,
make sure you take a look at them.

00:35:47.140 --> 00:35:49.790
Of course, we have the web log there.

00:35:50.900 --> 00:35:55.240
And you do have the migration tool
after you've done an in-place upgrade.

00:35:56.210 --> 00:36:00.260
Inside of Server Setup Migration Extras,
you have a migration tool that Apple has

00:36:00.260 --> 00:36:05.640
provided to help you in your migration
from Panther to Tiger with Apache.

00:36:06.660 --> 00:36:08.800
Mail, same thing.

00:36:08.800 --> 00:36:12.640
Make sure you back up your
main.cf and your master.cf files.

00:36:12.640 --> 00:36:15.710
If you've tarred up private,
you've pretty much covered yourself.

00:36:15.800 --> 00:36:19.290
Make sure the mail database
is sort of backed up,

00:36:19.380 --> 00:36:20.800
as with any platform, not just Apple.

00:36:20.800 --> 00:36:30.150
And again, the command line can be found
inside the migration guide.

00:36:30.530 --> 00:36:34.120
to upgrade the database.

00:36:34.230 --> 00:36:38.530
You might have a newer version
of Clam AV or Spam Assassin,

00:36:38.860 --> 00:36:43.110
or you may have some other configuration
or customization of the mail server.

00:36:43.110 --> 00:36:48.240
Now that Apple provides this,
you have to make a decision,

00:36:48.240 --> 00:36:52.800
do I want to continue using the GUI,
or do I want to continue doing it

00:36:52.930 --> 00:36:57.120
from the command line and doing
my own custom configuration?

00:36:57.930 --> 00:37:00.230
Custom configuration is fine,
that's what Unix is here,

00:37:00.250 --> 00:37:01.750
that's what OS X is all about.

00:37:01.750 --> 00:37:05.320
However, again,
sometimes you get in the GUI and it

00:37:05.330 --> 00:37:10.740
may overwrite some of what you've done,
so you need to be a little careful.

00:37:10.740 --> 00:37:15.140
For those of you still running
10.1 and 10.2 mail servers,

00:37:15.290 --> 00:37:19.160
migration steps are included as well,
and I should mention that we now

00:37:19.160 --> 00:37:21.560
have a GUI button for Reconstruct.

00:37:25.640 --> 00:37:28.950
DNS.

00:37:33.430 --> 00:37:36.440
If you've done manual
configuration of your DNS files,

00:37:36.440 --> 00:37:38.930
chances are everything will go great.

00:37:39.150 --> 00:37:43.540
It depends on the lines
that you're using for bind.

00:37:43.750 --> 00:37:48.220
If you've done CLI edits,
you should probably use the

00:37:48.330 --> 00:37:54.300
server admin command line to
start and stop DNS if you need to.

00:37:54.480 --> 00:37:56.620
And if you're using
DNS for the first time,

00:37:56.710 --> 00:37:59.800
you get reverse records that
are automatically created.

00:37:59.930 --> 00:38:03.800
So in your entire setup,
if you forgot that little checkbox,

00:38:03.950 --> 00:38:05.290
it's now done for you.

00:38:05.300 --> 00:38:08.780
So the DNS interface has
been changed a little bit,

00:38:09.280 --> 00:38:15.790
and that's a good thing.

00:38:15.790 --> 00:38:15.790
Right?

00:38:20.320 --> 00:38:23.780
Next up, DHCP.

00:38:23.780 --> 00:38:31.330
No more Googling for what you need to
do to map MAC addresses to IP addresses.

00:38:32.440 --> 00:38:36.140
often shows up, "Hey, how do I..." Blurt,
blurt, blurt.

00:38:36.290 --> 00:38:36.700
Well, you know what?

00:38:36.720 --> 00:38:41.870
Take that, pop it in Safari,
Google for it, I bet you might find it.

00:38:41.870 --> 00:38:41.870
So,

00:38:42.140 --> 00:38:43.760
You don't have to do that anymore.

00:38:43.870 --> 00:38:45.300
Apple put the GUI in.

00:38:45.460 --> 00:38:50.500
Now you have MAC address mapping,
so you can map IP addresses

00:38:50.500 --> 00:38:51.700
to MAC addresses.

00:38:51.860 --> 00:38:54.600
You got to give it up for Apple for this.

00:38:56.570 --> 00:38:59.130
The information is stored in
the local NetInfo database,

00:38:59.140 --> 00:39:01.640
so if you really want to
hand edit these files,

00:39:01.720 --> 00:39:02.900
you could do that.

00:39:03.010 --> 00:39:08.330
And as an aside, you could do this in a
limited fashion with Panther.

00:39:08.510 --> 00:39:09.720
Did anyone know this?

00:39:09.940 --> 00:39:11.500
In the GUI.

00:39:11.690 --> 00:39:16.720
You could turn on the NetBoot filtering.

00:39:16.970 --> 00:39:18.620
And when you turned on
the Netboot filtering,

00:39:18.620 --> 00:39:21.830
you could say only allow Netboot
over these addresses or deny

00:39:21.830 --> 00:39:23.510
Netboot over these addresses.

00:39:23.690 --> 00:39:26.170
It actually wrote the DHCP config record.

00:39:26.240 --> 00:39:28.170
You just didn't turn
on the Netboot service.

00:39:28.280 --> 00:39:31.080
So you could do it in Panther,
but they've made it a

00:39:31.150 --> 00:39:32.020
lot easier in Tiger.

00:39:32.020 --> 00:39:34.620
So that's a really, really good thing.

00:39:35.530 --> 00:39:37.390
And then we have the
Gateway Setup Assistant.

00:39:37.540 --> 00:39:39.970
If you're setting up Mac OS X Server,
you have an XServe,

00:39:40.040 --> 00:39:45.570
you have both Ethernet Jaxx Active,
one live, one internal.

00:39:46.090 --> 00:39:47.870
And you need a quick and dirty setup.

00:39:47.960 --> 00:39:50.180
You've got to get these things running.

00:39:50.330 --> 00:39:54.320
DHCP NAT, VPN, firewall,
you're set to go.

00:39:54.330 --> 00:39:56.630
We have some additional services,
obviously,

00:39:56.630 --> 00:39:58.480
that weren't available in Panther.

00:39:58.480 --> 00:39:59.960
We're not going to speak to those here.

00:39:59.960 --> 00:40:02.450
Those are obviously spoken
to in other sessions,

00:40:02.530 --> 00:40:04.490
but the Xgrid controller and Jabber.

00:40:04.490 --> 00:40:08.050
So we want to talk about some of these,
do a little demo, a little run through.

00:40:09.170 --> 00:40:09.350
Okay.

00:40:09.350 --> 00:40:11.040
Back on three again, please.

00:40:11.040 --> 00:40:14.340
And I will come to Apple's
defense a little bit on the KB,

00:40:14.350 --> 00:40:16.170
which I do every now and then.

00:40:16.170 --> 00:40:20.090
They do have a fairly nice KB article
on how to do MAC address mapping

00:40:20.090 --> 00:40:23.690
with DHCP through NetInfoManager,
although it's now so much

00:40:23.720 --> 00:40:26.950
easier to browse for the
machine and pick it and click,

00:40:26.950 --> 00:40:29.570
I want this machine to be called this.

00:40:29.570 --> 00:40:31.930
So it is a nice improvement.

00:40:31.940 --> 00:40:35.840
So what we're going to look at here very
briefly is the Gateway Setup Assistant.

00:40:35.840 --> 00:40:38.900
And the Gateway Setup Assistant has
probably the least often used.

00:40:38.900 --> 00:40:41.290
It's the most used icon
in the OS X's family,

00:40:41.440 --> 00:40:43.430
and that's the little tuxedo guy here.

00:40:43.450 --> 00:40:46.480
There's a dry cleaner in
Raleigh North Carolina that has

00:40:46.480 --> 00:40:48.970
that on their sign out front,
actually.

00:40:50.540 --> 00:40:55.580
So we can come through here and
we can configure our server.

00:40:55.850 --> 00:40:57.660
Let me log in.

00:41:08.060 --> 00:41:10.300
and it's going to go through and
it takes a look at everything.

00:41:10.310 --> 00:41:12.800
And this is a nice way to quickly set up,
like Schoun said,

00:41:12.800 --> 00:41:15.990
that gateway Mac into there.

00:41:16.950 --> 00:41:20.740
We tell it which one is
connected to the internet.

00:41:20.870 --> 00:41:22.640
We then pick how we're
going to want to share.

00:41:22.640 --> 00:41:24.670
We can share on one or multiples.

00:41:24.860 --> 00:41:26.860
Obviously, you're not going to have
airport in an XServe,

00:41:26.860 --> 00:41:29.460
but this is a PowerBook, so it does.

00:41:29.460 --> 00:41:31.840
G5 desktop machines could have airport.

00:41:31.900 --> 00:41:36.000
FireWire is always there as an option
for doing your networking as well.

00:41:37.760 --> 00:41:38.620
VPN settings.

00:41:38.700 --> 00:41:40.420
You can set up a VPN server.

00:41:40.620 --> 00:41:42.700
We'll give it an easy secret.

00:41:42.820 --> 00:41:43.370
All right.

00:41:43.420 --> 00:41:45.890
I'll hand that out to my users.

00:41:47.310 --> 00:41:50.920
And then we can click Apply and
it will go and set everything up.

00:41:50.920 --> 00:41:53.880
Don't run this if you've
already set up your server,

00:41:54.130 --> 00:41:56.990
because it goes through and rewrites
all your configuration files for

00:41:56.990 --> 00:41:59.000
whatever you've just told it to do.

00:41:59.000 --> 00:42:01.250
So you can look at it,
you can click the More Info

00:42:01.250 --> 00:42:04.100
button and things like that,
but I wouldn't turn it on.

00:42:04.100 --> 00:42:07.550
It also automatically
configures the firewall.

00:42:07.760 --> 00:42:10.540
and just allows all traffic
on the internal network,

00:42:10.560 --> 00:42:13.560
but it blocks most incoming
stuff from the outside.

00:42:13.600 --> 00:42:15.150
So remember,
if you're going to then turn on a

00:42:15.150 --> 00:42:18.060
mail server or something like that,
or need to direct ports

00:42:18.060 --> 00:42:20.130
inside your network,
you'll need to go and set that up

00:42:20.130 --> 00:42:21.740
after you're done with that as well.

00:42:21.760 --> 00:42:24.430
Back to Schoun.

00:42:30.160 --> 00:42:32.260
So where are we?

00:42:32.310 --> 00:42:34.970
Well, regardless of where you
did your upgrade path,

00:42:35.100 --> 00:42:37.770
regardless of what went on,

00:42:37.950 --> 00:42:40.000
We talked about customized
configuration files,

00:42:40.000 --> 00:42:42.500
and we need those customized
configuration files,

00:42:42.500 --> 00:42:44.680
and we had to take care of that.

00:42:45.240 --> 00:42:48.590
We have more corporized services,
so we have more corporized

00:42:48.590 --> 00:42:52.500
principles that we need to deal with
inside the KDC principle database.

00:42:52.650 --> 00:42:56.440
You handled each service and you
tested it and you made sure it worked.

00:42:56.580 --> 00:42:59.360
And you may have gained
some GUI help along the way,

00:42:59.460 --> 00:43:02.700
like the setup assistant,
or you may have done it via the

00:43:02.700 --> 00:43:05.190
command line and hand cranked them out.

00:43:05.850 --> 00:43:09.090
Now, all we have left is user data.

00:43:09.130 --> 00:43:10.980
No problem.

00:43:12.000 --> 00:43:14.750
Let's talk about our
upgrade in place scenarios.

00:43:14.900 --> 00:43:16.740
What do we need to do?

00:43:16.860 --> 00:43:18.700
What scenarios do we have?

00:43:18.810 --> 00:43:21.300
We have Jaguar to Tiger Local.

00:43:22.010 --> 00:43:24.310
We have Panther Local to Tiger Local.

00:43:24.310 --> 00:43:27.010
We have Panther Master to Tiger Master.

00:43:29.150 --> 00:43:32.790
If we have a Jaguar local,
we have a local net info database,

00:43:32.940 --> 00:43:35.970
we may have shadow hash passwords,
we may have crypt passwords.

00:43:36.160 --> 00:43:37.580
We're going on one scenario.

00:43:37.780 --> 00:43:41.380
Upon the upgrade,
you may want to change the password.

00:43:41.380 --> 00:43:41.380
Reset it.

00:43:42.200 --> 00:43:44.080
A Jaguar parent.

00:43:44.270 --> 00:43:48.080
If password server has been used,
it's a good idea to force the

00:43:48.080 --> 00:43:53.490
password change for all the users.

00:43:54.710 --> 00:43:56.900
Panther Local to Tiger Local.

00:43:56.900 --> 00:43:59.620
In Panther Local to Tiger Local,
all users have a

00:43:59.620 --> 00:44:01.160
password server password.

00:44:01.330 --> 00:44:05.020
Password server is there
at the get-go in Panther,

00:44:05.090 --> 00:44:08.500
whether it's a local or a master.

00:44:08.650 --> 00:44:11.580
And you need to remind yourself,
did I use Nest to turn

00:44:11.700 --> 00:44:13.290
off certain protocols?

00:44:13.380 --> 00:44:16.900
Maybe I turned off WebDAV,
maybe I turned off APOP.

00:44:17.050 --> 00:44:18.950
What did I turn off?

00:44:19.250 --> 00:44:22.300
And I probably, after the upgrade,
should go back into the nice

00:44:22.300 --> 00:44:25.450
GUI that we have inside Server Admin
and Open Directory and just

00:44:25.450 --> 00:44:29.270
double check that some of these
protocols are again turned off.

00:44:31.580 --> 00:44:33.460
Panther Local to Tiger Local.

00:44:33.460 --> 00:44:36.500
It is important to understand
after the upgrade if you're

00:44:36.500 --> 00:44:43.230
running a local Tiger Server,
new users that you create will not

00:44:43.310 --> 00:44:46.500
have a password server password.

00:44:46.670 --> 00:44:49.500
They will have a shadow hash password.

00:44:50.120 --> 00:44:50.660
Okay?

00:44:50.660 --> 00:44:55.040
Now, it might be best if you want
everything uniform to change

00:44:55.140 --> 00:44:57.790
everything to the same password type.

00:44:57.790 --> 00:44:59.730
Okay?

00:45:00.850 --> 00:45:04.390
Is this a bad thing?

00:45:08.470 --> 00:45:11.160
Absolutely not.

00:45:11.220 --> 00:45:14.390
Password policies now apply
to the ShadowHash passwords.

00:45:14.630 --> 00:45:18.510
This is an excellent way because
Tiger Server really doesn't need to

00:45:18.540 --> 00:45:19.980
run password server in a local method.

00:45:20.030 --> 00:45:25.020
So now the password server CPU overhead,
you have another additional

00:45:25.020 --> 00:45:28.590
service that you really don't
need running at that point.

00:45:28.730 --> 00:45:31.360
So you have these ShadowHash passwords
and you can certainly use them.

00:45:31.630 --> 00:45:33.960
You can certainly apply
the policies to them.

00:45:34.080 --> 00:45:37.710
So what about a
Panther Master to a Tiger Master?

00:45:38.260 --> 00:45:41.110
During the upgrade in place,
it's really not a good idea

00:45:41.110 --> 00:45:42.650
to change the password.

00:45:43.590 --> 00:45:46.630
Remember, Josh showed you that,
you really can't change

00:45:46.630 --> 00:45:47.580
the directory usage.

00:45:47.580 --> 00:45:53.820
And the migration of the LDAP data takes
place during the initial configuration.

00:45:53.820 --> 00:45:55.670
It's done for you.

00:45:56.340 --> 00:46:00.620
If you have your own
customized schema changes,

00:46:01.110 --> 00:46:02.570
those may be remapped.

00:46:02.570 --> 00:46:06.660
A lot of people went out and did
customized schema changes that mirror

00:46:06.660 --> 00:46:09.010
what Apple did automatically in Tiger.

00:46:09.700 --> 00:46:13.420
So it's a good idea if you already
did some of what they did in Tiger,

00:46:13.470 --> 00:46:17.400
you should probably go back and
take a look after the upgrade.

00:46:17.590 --> 00:46:20.510
If you've done any sort
of root DN changes,

00:46:20.620 --> 00:46:22.490
those may have been changed as well.

00:46:22.500 --> 00:46:27.480
It depends on how customized
you made your configuration.

00:46:28.080 --> 00:46:31.610
And again, when you upgrade,
if you had an edu.mit.kubros file

00:46:31.990 --> 00:46:36.500
that you made manual changes to,
that file may have been overwritten.

00:46:36.500 --> 00:46:41.070
So if you're doing any sort of cross-ramp
authentication or anything else,

00:46:41.070 --> 00:46:43.830
you may want to go back
and check that file.

00:46:44.590 --> 00:46:49.300
You do want to take advantage of all
the new features when you do an upgrade.

00:46:49.400 --> 00:46:53.850
If you have legacy groups,
there is a legacy group GUI upgrade

00:46:53.850 --> 00:46:55.780
path that you can follow.

00:46:55.910 --> 00:46:58.940
Use Workgroup Manager to
perform this process.

00:46:59.050 --> 00:47:04.200
And if you had a Panther Master that
was not a KDC for some reason,

00:47:04.380 --> 00:47:10.480
you can use slap config with a Kerberize
flag to actually hand crank the KDC.

00:47:12.900 --> 00:47:17.590
So an upgrade in place master synopsis.

00:47:17.650 --> 00:47:20.850
The passwords are still in
the password server database.

00:47:20.950 --> 00:47:25.140
The KDC principal database still
retains all the user principles,

00:47:25.140 --> 00:47:27.070
everything else you need.

00:47:27.280 --> 00:47:29.740
Real world, what did you do?

00:47:29.840 --> 00:47:35.200
You did SlapCat or LDAP search
to suck out your configuration

00:47:35.200 --> 00:47:39.400
records into a file,
if you didn't already have a

00:47:39.400 --> 00:47:41.690
full backup somewhere else.

00:47:41.790 --> 00:47:45.430
You do another LDAP search
to extract the records,

00:47:45.430 --> 00:47:48.700
or SlapCat to extract the records after.

00:47:49.080 --> 00:47:52.760
Use File Merge,
use Diff to see if any of your customized

00:47:52.760 --> 00:47:57.040
configuration changes were ever written,
what took place.

00:47:57.360 --> 00:48:01.990
Don't be afraid to extract these records
and take a look at what's in there.

00:48:02.440 --> 00:48:05.730
This is probably the best
way to ensure a smooth,

00:48:05.850 --> 00:48:08.380
in-place upgrade.

00:48:08.590 --> 00:48:10.610
But how do we do that?

00:48:11.660 --> 00:48:14.220
Well, what if I don't want to
do an upgrade in place?

00:48:14.510 --> 00:48:16.940
I don't want to.

00:48:16.990 --> 00:48:21.600
What if I want to do a clean install,
and I want to pull the stuff back in?

00:48:21.780 --> 00:48:21.940
Huh?

00:48:22.050 --> 00:48:24.440
What if I want to do it that way?

00:48:24.560 --> 00:48:26.250
Now what do I do?

00:48:28.260 --> 00:48:32.090
What sort of combinations should we
be aware of when we're doing this?

00:48:32.230 --> 00:48:37.260
Well, Jaguar Server Local,
if you've made edits to

00:48:37.260 --> 00:48:38.660
the NetInfo database.

00:48:38.760 --> 00:48:42.990
Jaguar Server Parent,
you have a parent NetInfo database,

00:48:42.990 --> 00:48:43.640
right?

00:48:43.830 --> 00:48:46.950
You did have the option to
use the password server,

00:48:46.950 --> 00:48:48.420
but there was no KDC.

00:48:49.290 --> 00:48:56.240
So you had to extract the users
out of the NetInfo database.

00:48:56.350 --> 00:48:58.730
You use NI Dump for this.

00:48:59.890 --> 00:49:04.700
Migration with user databases
and password server.

00:49:04.770 --> 00:49:10.480
Password server, you had a local net info
database with password server.

00:49:11.040 --> 00:49:13.760
Zip up the password server, copy it,
do whatever you want.

00:49:13.840 --> 00:49:15.840
You can use,
we actually use the command line here

00:49:16.190 --> 00:49:19.660
in just a little bit with mkpassdb,
that's fine.

00:49:19.810 --> 00:49:24.110
And with a master,
what do you need to migrate?

00:49:24.350 --> 00:49:27.540
The KDC records, you need to migrate the
password server records,

00:49:27.560 --> 00:49:30.300
you need to migrate the LDAP database.

00:49:30.340 --> 00:49:31.280
Okay?

00:49:31.360 --> 00:49:37.670
So, what should we do with regard to the
user records in the user database?

00:49:38.340 --> 00:49:42.000
How do we extract these records?

00:49:42.060 --> 00:49:44.630
How do we pull them back in?

00:49:45.640 --> 00:49:48.260
What about the password server passwords?

00:49:48.470 --> 00:49:50.900
What about the user principles?

00:49:51.000 --> 00:49:53.300
How do we get this done?

00:49:54.520 --> 00:49:57.030
Well, one option is to use Slapcat.

00:49:57.070 --> 00:49:59.000
We have LDF up here.

00:49:59.050 --> 00:50:01.640
Or LDF search, sorry.

00:50:01.710 --> 00:50:05.760
And we do a clean install and then
we re-import the user records.

00:50:06.900 --> 00:50:13.660
If you have groups where you have
changed the default group ID,

00:50:13.660 --> 00:50:16.340
and we've seen this actually
in a couple upgrades,

00:50:16.340 --> 00:50:20.530
the group membership shows up
as unknown in certain cases.

00:50:20.620 --> 00:50:24.190
So if you have cases where the
group ID has been customized,

00:50:24.290 --> 00:50:27.270
you may want to go back in
and do a Schoun recursive and

00:50:27.270 --> 00:50:29.880
re-associate the group memberships.

00:50:29.970 --> 00:50:33.970
Exporting passwords, MKPassDB.

00:50:33.970 --> 00:50:36.360
Suck them out.

00:50:36.360 --> 00:50:36.360
Okay?

00:50:37.040 --> 00:50:42.400
Kerberos database, Kera B5 util.

00:50:42.510 --> 00:50:43.090
Suck 'em out.

00:50:43.160 --> 00:50:45.290
If it's a local, it doesn't have a KDC.

00:50:45.290 --> 00:50:48.700
You don't have to worry about that stuff.

00:50:48.890 --> 00:50:52.950
When you do this, depending on how
customized your schema was,

00:50:53.030 --> 00:50:57.740
you may not get all the new
stuff if you suck stuff out and

00:50:57.740 --> 00:50:59.740
you want to pull it back in.

00:50:59.800 --> 00:51:01.580
What about importing it?

00:51:01.600 --> 00:51:04.750
Now we've got it out,
now we've tarted it up,

00:51:04.750 --> 00:51:06.170
now what do we do?

00:51:07.130 --> 00:51:11.500
Well,
when we set up the new Tiger Server,

00:51:11.500 --> 00:51:14.180
it's a good idea to use the
same administrator name,

00:51:14.360 --> 00:51:16.800
same long name, same short name,
same password.

00:51:16.800 --> 00:51:18.110
It's social engineering.

00:51:18.330 --> 00:51:21.990
That way you don't have
to deal with anything new.

00:51:22.150 --> 00:51:25.810
Use LDAP add to suck
the database back in.

00:51:27.060 --> 00:51:32.110
Password server use MKPassDB with merge.

00:51:33.920 --> 00:51:35.640
And you can use load.

00:51:35.700 --> 00:51:41.040
Load is up here for the care B5 util.

00:51:41.090 --> 00:51:41.090
However,

00:51:41.690 --> 00:51:46.340
You might want to take a look
at that database along with your

00:51:46.440 --> 00:51:50.300
brand new Tiger database because
you really don't want to pull in

00:51:50.450 --> 00:51:54.980
service principles that now exist
inside the Tiger Server database.

00:51:55.110 --> 00:51:57.630
So you want to do a load after
you've taken a look at both

00:51:57.720 --> 00:51:59.800
databases and merged both databases.

00:51:59.860 --> 00:52:01.190
It's actually pretty important.

00:52:01.280 --> 00:52:03.860
So go ahead and reboot.

00:52:03.980 --> 00:52:08.410
So Josh is going to
show you in this demo.

00:52:08.940 --> 00:52:11.060
How to suck the information out.

00:52:11.150 --> 00:52:13.980
Go back to machine number one, please.

00:52:14.000 --> 00:52:16.550
So we're going to suck
out this information,

00:52:16.550 --> 00:52:20.750
and I should point out that you need
to keep this information secure.

00:52:20.950 --> 00:52:22.800
Don't leave it on a machine.

00:52:22.850 --> 00:52:25.690
Don't copy it with FTP.

00:52:25.740 --> 00:52:27.320
Don't email it to yourself.

00:52:27.320 --> 00:52:31.000
Keep this really secure,
because this is all your user records and

00:52:31.030 --> 00:52:32.570
all your database and everything else.

00:52:32.570 --> 00:52:35.430
It's something that you're going to
want to stick out on a thumb drive,

00:52:35.430 --> 00:52:38.930
unplug it from that computer,
carry it to the other computer,

00:52:39.140 --> 00:52:42.000
suck it in on the other machine or
after you've wiped and reinstalled,

00:52:42.000 --> 00:52:45.170
and then either make sure that
you destroy the data or you

00:52:45.170 --> 00:52:47.470
make sure you archive it safely.

00:52:47.620 --> 00:52:51.170
10.4 does this automatic backup feature,
which is so nifty,

00:52:51.170 --> 00:52:54.780
you almost fall down when you see it,
and where it actually archives,

00:52:54.790 --> 00:52:58.610
it generates a history on
encrypted disk images of all of

00:52:58.610 --> 00:53:02.730
this same stuff automatically,
and you can go back to any point

00:53:02.730 --> 00:53:04.580
in time with your OD system.

00:53:04.580 --> 00:53:07.570
So what we're going to look at here
is just the three commands that

00:53:07.580 --> 00:53:11.530
Sean had on his slides and how to
get this information out of there.

00:53:11.580 --> 00:53:14.820
We've got our backup volume mounted,
so we can pretend this is a thumb

00:53:14.820 --> 00:53:16.840
drive and we're going to yank it out.

00:53:16.850 --> 00:53:19.440
And the first one is
just using LDAP search.

00:53:19.440 --> 00:53:20.920
We tell it the host name.

00:53:20.920 --> 00:53:23.810
We tell it our search base,
what class we want to take out,

00:53:23.810 --> 00:53:25.380
and where we want to put it.

00:53:25.400 --> 00:53:29.660
We've got a lot of users on this machine,
so it should take just a second to run,

00:53:29.660 --> 00:53:32.380
and it will generate a
fairly large LDF file,

00:53:32.380 --> 00:53:34.580
although not gigantic.

00:53:34.580 --> 00:53:34.580
So when it's done,
we're going to go ahead and run it.

00:53:34.580 --> 00:53:36.400
And then when it's done,
I'll show you where the file is,

00:53:36.400 --> 00:53:37.800
which looks like an address book file.

00:53:37.800 --> 00:53:40.550
An address book would love to open it,
but if an address book

00:53:40.550 --> 00:53:43.260
opens a file of this size,
it'll just fall down and

00:53:43.260 --> 00:53:45.180
roll underneath the couch.

00:53:45.180 --> 00:53:47.340
So probably wouldn't want to do that.

00:53:47.340 --> 00:53:49.910
So that's finished now,
and if we take a look where we said,

00:53:49.910 --> 00:53:50.660
there it is.

00:53:50.670 --> 00:53:54.570
And let's see, it's 20 megs,
so not too bad.

00:53:57.230 --> 00:54:00.160
The next thing we want to do is we
want to dump out our password server.

00:54:01.120 --> 00:54:03.730
And we do this using
the makepassdb command,

00:54:03.730 --> 00:54:06.100
and this will allow us to dump this out.

00:54:06.100 --> 00:54:09.090
And it takes out all of
our authorization records.

00:54:09.180 --> 00:54:12.100
Now, this one's a little bit different in
that it doesn't go to a single file.

00:54:12.100 --> 00:54:14.100
It actually exports
three different files.

00:54:14.100 --> 00:54:20.100
So we need to tell it a directory
instead of just a file to output to.

00:54:20.100 --> 00:54:23.400
This one does require sudo to run.

00:54:29.930 --> 00:54:30.700
And it's going to run.

00:54:30.700 --> 00:54:34.540
You can just see that it's
just copying out information.

00:54:34.580 --> 00:54:36.470
And in a minute, it'll get finished up.

00:54:36.500 --> 00:54:37.960
There we go.

00:54:38.140 --> 00:54:42.550
And then we can take a look over on
our backups volume and in our folder.

00:54:42.610 --> 00:54:47.180
And there we have our authentication
records have been backed up as well.

00:54:47.510 --> 00:54:50.960
10.2 and 10.3 have really
nice Kerberos support in them,

00:54:50.960 --> 00:54:53.380
so we want to make sure we back
up all these principles as well.

00:54:53.380 --> 00:54:56.000
We don't want to have to go and
try to remake all this by hand.

00:54:56.040 --> 00:55:00.340
So we can use the KDB 5.0 util
to dump this information out.

00:55:00.360 --> 00:55:03.550
Again, this is all very critical,
sensitive information that

00:55:03.550 --> 00:55:05.020
you want to keep backed up.

00:55:05.020 --> 00:55:08.190
Again, it's sudo.

00:55:08.440 --> 00:55:10.780
I'm still with my Windows,
so I don't have to authenticate again.

00:55:10.780 --> 00:55:16.560
And now I can see that I've successfully
dumped out my KDC records as well.

00:55:16.560 --> 00:55:19.200
And this is all my service and user
principles have been backed up.

00:55:19.200 --> 00:55:20.960
Back to you, Schoun.

00:55:25.930 --> 00:55:26.980
So what about replicas?

00:55:27.190 --> 00:55:29.780
Toast them.

00:55:29.920 --> 00:55:31.780
They're replicas.

00:55:33.920 --> 00:55:36.530
Get rid of them,
take them out of the record

00:55:36.530 --> 00:55:41.740
of your Tiger or your upgrade,
and move them over.

00:55:41.740 --> 00:55:43.880
What about home directories?

00:55:45.050 --> 00:55:46.540
Zip 'em up, copy 'em over.

00:55:46.540 --> 00:55:49.030
If you're copying 'em over and
you're not doing an upgrade in place,

00:55:49.080 --> 00:55:51.710
unzip 'em and don't worry about it.

00:55:51.760 --> 00:55:54.960
As long as the UIDs match,
you should be okay.

00:55:55.100 --> 00:55:57.540
It's when you get into
the customized UIDs,

00:55:57.540 --> 00:55:58.700
it might be a little different.

00:55:58.760 --> 00:55:59.330
So where are we?

00:55:59.350 --> 00:56:02.190
NetInfo.

00:56:03.430 --> 00:56:06.740
We know that NetInfo contains
some additional user records.

00:56:06.740 --> 00:56:11.080
If we're going from Jaguar or doing
something else kind of funky like that,

00:56:11.080 --> 00:56:15.370
that's fine, but we can use NI Dump to
actually extract the records.

00:56:15.400 --> 00:56:16.790
What about LDAP?

00:56:16.790 --> 00:56:18.060
What do we need to worry about?

00:56:18.080 --> 00:56:20.350
We need to extract those user records.

00:56:20.350 --> 00:56:23.160
We didn't talk about computer records,
but it's the same thing.

00:56:23.160 --> 00:56:26.050
We just do an LDAP search with a
different OU to pick up what we need.

00:56:26.080 --> 00:56:31.580
The password server database is as
simple as copying it and backing it up.

00:56:31.790 --> 00:56:36.320
The KDC, back it up,
and the home directories move over.

00:56:36.320 --> 00:56:37.700
What are your challenges?

00:56:37.840 --> 00:56:39.820
What are you going to face?

00:56:39.990 --> 00:56:41.750
During the Q&A,
what are we going to hear?

00:56:41.750 --> 00:56:48.800
"My SSH service died,
and I couldn't log in."

00:56:49.170 --> 00:56:54.480
Or SMB was doing something really,
really strange afterwards,

00:56:54.590 --> 00:56:56.450
and I couldn't get to it.

00:56:56.940 --> 00:56:58.130
Things aren't working right.

00:56:58.140 --> 00:56:59.180
Things aren't resolving right.

00:56:59.290 --> 00:57:02.270
DNS might be slightly misconfigured.

00:57:03.160 --> 00:57:06.130
I had to open a book a little
bit and learn about LDAP.

00:57:06.230 --> 00:57:08.340
Don't worry, that's good for you.

00:57:12.600 --> 00:57:17.030
As we wrap up,
upgrading is and has always

00:57:17.130 --> 00:57:24.110
been no matter what platform,
it is not an error-free process.

00:57:24.260 --> 00:57:28.340
Planning and testing are
the best defense you have.

00:57:28.340 --> 00:57:31.430
If you can do so,
the upgrade in place is great.

00:57:31.580 --> 00:57:36.840
Apple has made some great tools to
allow the upgrade in place to occur.

00:57:36.840 --> 00:57:39.480
It works really, really well.

00:57:39.480 --> 00:57:44.880
If you've taken your server and
you've customized those configuration

00:57:44.880 --> 00:57:50.450
files and you've tweaked the schema,
you just need to check along the way,

00:57:50.450 --> 00:57:52.070
did it overwrite?

00:57:52.070 --> 00:57:53.440
Did it change?

00:57:57.050 --> 00:58:00.260
The related sessions that we have,
so you can look at them

00:58:00.260 --> 00:58:03.100
a little bit later,
the Mac OS X server overview,

00:58:03.180 --> 00:58:05.800
the feedback forum,
which was excellent today,

00:58:05.850 --> 00:58:11.070
leveraging the power of ACLs,
managing clients in the enterprise.

00:58:11.390 --> 00:58:16.230
Integrating Mac OS X into a
heterogeneous environment.

00:58:16.230 --> 00:58:20.140
Monitoring your system with
ARD and open source tools.

00:58:20.280 --> 00:58:25.640
Enterprise messaging solutions,
network authentication,

00:58:25.770 --> 00:58:31.580
real-world desktop management practices,
and building automator actions.

00:58:33.130 --> 00:58:36.380
For more information, obviously,
the documentation, the sample code,

00:58:36.440 --> 00:58:40.700
everything else,
developer.apple.com/wwdc2005.

00:58:40.760 --> 00:58:41.770
Here are some URLs.

00:58:41.840 --> 00:58:43.930
I would highly recommend
that you do the first one.

00:58:43.990 --> 00:58:46.790
The migration guide, download it,
read it.

00:58:47.110 --> 00:58:49.220
Tiger Server documentation PDFs.

00:58:49.290 --> 00:58:51.420
Best thing in the world,
suck them all in,

00:58:51.420 --> 00:58:54.300
use one of the free resource
tools to combine them together,

00:58:54.390 --> 00:58:56.770
change ownership back
to preview or spotlight,

00:58:56.890 --> 00:58:58.550
and now you have a nice
searchable database.

00:58:58.660 --> 00:59:00.600
It's about 22 meg,
you can leave it on your drive.

00:59:00.600 --> 00:59:02.660
It's a great way to do it.

00:59:02.930 --> 00:59:07.140
AFP548.com goes without saying.

00:59:07.140 --> 00:59:11.740
Apple has certification classes
in Directory Services and other

00:59:11.740 --> 00:59:12.830
classes that are available.

00:59:12.880 --> 00:59:16.410
The Mac OS X Server listserv
and discussions,

00:59:16.450 --> 00:59:18.670
the discussion groups at Apple.

00:59:19.150 --> 00:59:20.800
Who to contact?

00:59:21.270 --> 00:59:27.950
You can contact these
people for more information.

00:59:27.950 --> 00:59:27.950
And I think Jason?