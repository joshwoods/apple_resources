WEBVTT

00:00:10.690 --> 00:00:14.840
Thank you and welcome everyone to the
Active Directory Integration session.

00:00:14.890 --> 00:00:17.190
This will be the shortest session
because I think everyone is

00:00:17.200 --> 00:00:18.890
going to the airport afterwards.

00:00:18.960 --> 00:00:21.600
So let us get started.

00:00:21.600 --> 00:00:24.190
My name is Ståle Bjordal
and I am with the

00:00:24.330 --> 00:00:27.810
Enterprise Professional Services Group at
Apple.

00:00:29.010 --> 00:00:33.460
On the agenda,
we're going to do a presentation

00:00:33.620 --> 00:00:37.640
in the beginning and followed
by two live demonstrations.

00:00:37.740 --> 00:00:40.850
One that's going to talk about the
server side and one that's going to

00:00:40.850 --> 00:00:42.370
be talking about the client side.

00:00:42.380 --> 00:00:45.690
If we have time,
we'll do some Q&A at the end.

00:00:45.720 --> 00:00:49.690
That's pretty much how we're going
to do it for about an hour or so.

00:00:51.680 --> 00:00:55.930
First I'd like to talk a little bit about
what Active Directory is and how we fit

00:00:55.940 --> 00:00:59.600
into the space that is Active Directory.

00:00:59.650 --> 00:01:03.280
Just like Open Directory,
it is a directory system that's

00:01:03.280 --> 00:01:05.660
based on primarily LDAP and Kerberos.

00:01:05.700 --> 00:01:10.370
Microsoft took it, wrapped their
Microsoft technologies around it,

00:01:10.370 --> 00:01:13.980
and it is proprietary,
but that doesn't mean that

00:01:13.980 --> 00:01:16.570
we can't work with that.

00:01:17.200 --> 00:01:19.880
Primarily Active Directory is
used for Windows computers,

00:01:19.970 --> 00:01:21.000
make no mistake about it.

00:01:21.120 --> 00:01:24.930
Just like we want to use
Open Directory to manage our clients

00:01:24.960 --> 00:01:28.610
and manage our users and groups,
that's what Active Directory does in the

00:01:28.610 --> 00:01:33.460
Windows space for assigning profiles,
publishing applications,

00:01:33.460 --> 00:01:35.620
setting policies for users and groups.

00:01:36.480 --> 00:01:40.680
Their environment is slightly more
complicated and complex than what

00:01:40.900 --> 00:01:44.960
we can do with Open Directory,
just for the sheer size of things.

00:01:44.960 --> 00:01:48.930
Everything, just like OD,
is stored in a centrally

00:01:48.930 --> 00:01:50.900
accessible database.

00:01:50.900 --> 00:01:53.310
It's organized very well.

00:01:53.320 --> 00:01:56.870
We,
as Apple and OS X clients and servers,

00:01:56.870 --> 00:02:03.300
tie into Active Directory so that we
can authenticate our users and authorize

00:02:03.300 --> 00:02:06.120
so we can get access to resources.

00:02:06.480 --> 00:02:09.190
We can also use Active Directory to
manage our clients and groups

00:02:09.200 --> 00:02:11.460
within Active Directory or
the Open Directory service

00:02:11.460 --> 00:02:14.180
and clients that are bound
to the Active Directory domains.

00:02:16.210 --> 00:02:21.140
Microsoft and AD have a little bit
more of a complicated system in

00:02:21.140 --> 00:02:22.900
what we do with Open Directory.

00:02:22.900 --> 00:02:27.620
There are some terms there that's going
to be somewhat of importance for us

00:02:27.620 --> 00:02:33.540
if we want to bind in in a slightly
larger corporate or educational setting.

00:02:33.540 --> 00:02:38.930
Essentially you have a forest,
which is the all-encompassing domain.

00:02:38.930 --> 00:02:41.860
If you have one domain,
you only have one forest.

00:02:41.860 --> 00:02:46.180
Within the forest you have
multiple subdomains and subdomains

00:02:46.180 --> 00:02:51.270
essentially differentiate from
the domain security policies.

00:02:51.710 --> 00:02:59.350
We as Active Directory users and OS X and
clients and servers can decide if we

00:02:59.350 --> 00:03:06.010
want to bind to a specific domain or if
we want to bind and allow all the users

00:03:06.010 --> 00:03:10.340
within the whole forest to authenticate
and use our servers and clients.

00:03:10.340 --> 00:03:13.700
Within domains,
you have a lot of different

00:03:13.700 --> 00:03:15.630
types of containers.

00:03:15.630 --> 00:03:20.000
You have OUs and you have
containers and those organizational

00:03:20.020 --> 00:03:24.630
units store computer records,
printers, users, groups.

00:03:24.730 --> 00:03:29.980
It's primarily important for us to know
where the computer object for the client

00:03:30.010 --> 00:03:34.230
or the server that's going to be bound,
where it's going to be stored.

00:03:34.230 --> 00:03:37.150
By default,
the computer object will go into

00:03:37.150 --> 00:03:40.750
a container called computers
in the root of the domain,

00:03:40.750 --> 00:03:42.740
but as soon as you start expanding
your Active Directory environment,

00:03:42.740 --> 00:03:43.010
you're going to have a lot of
different types of containers.

00:03:43.010 --> 00:03:43.290
You have a lot of different
types of containers.

00:03:43.290 --> 00:03:43.830
You have a lot of different
types of containers.

00:03:43.830 --> 00:03:44.490
You have a lot of different
types of containers.

00:03:44.500 --> 00:03:45.700
You have AD administrators.

00:03:45.700 --> 00:03:50.210
More often than not,
they tend to move computers around.

00:03:50.210 --> 00:03:52.910
If you come in as an
Open Directory administrator

00:03:52.970 --> 00:03:56.020
and want to bind your server,
you may not have access or you may not

00:03:56.020 --> 00:04:02.740
be allowed to put your OS X computer
account in the default container.

00:04:02.740 --> 00:04:06.060
It's definitely something
that you need to work with the

00:04:06.180 --> 00:04:08.960
Active Directory administrator on and
figure out where you should put it

00:04:08.960 --> 00:04:11.490
and if you have permissions to do so.

00:04:12.060 --> 00:04:16.630
Lastly, there's also a concept called
Sites in Active Directory.

00:04:16.630 --> 00:04:22.300
It is probably the most important piece,
at least I think so.

00:04:22.300 --> 00:04:29.260
Sites is a physical organization of
resources based on essentially a subnet.

00:04:29.260 --> 00:04:33.960
What happens is that the AD plugin,
which is the tool that's used

00:04:33.970 --> 00:04:37.980
to bind 99% of the times,
will go out and it will search

00:04:38.180 --> 00:04:42.700
your Active Directory domain
for sites information.

00:04:42.850 --> 00:04:47.730
If it finds a site,
then it's going to attempt to

00:04:47.730 --> 00:04:51.100
use those Active Directory domain
controllers first to bind with.

00:04:51.100 --> 00:04:56.770
Sites should be used if possible.

00:04:56.820 --> 00:04:59.670
If you don't have sites configured
in Active Directory domain or

00:04:59.750 --> 00:05:01.530
if you're not sure what it is,
work with your

00:05:01.610 --> 00:05:05.040
Active Directory administrator
and see if there's a site that

00:05:05.040 --> 00:05:11.400
is configured for your physical
building or your physical location.

00:05:11.520 --> 00:05:14.230
If you don't have sites configured,
what's going to happen is that

00:05:14.230 --> 00:05:17.390
the AD plugin will essentially
start querying DNS and it will

00:05:17.390 --> 00:05:19.490
look for domain controllers.

00:05:19.490 --> 00:05:24.420
It's going to try to find
domain controllers that are

00:05:24.530 --> 00:05:28.750
closest to you in proximity,
again based on the sites information,

00:05:28.750 --> 00:05:32.290
but if you don't have that configured,
there's really no telling

00:05:32.400 --> 00:05:35.490
what domain controllers
you're going to be binding to.

00:05:35.490 --> 00:05:39.220
If you are in Dallas,
you would like to be bound to

00:05:39.220 --> 00:05:42.470
a domain controller in Dallas,
but there are chances that you can

00:05:42.520 --> 00:05:45.610
bind to domain controllers that
is literally all over the country.

00:05:45.810 --> 00:05:49.810
That could bring some problems.

00:05:51.990 --> 00:06:00.140
So what is it that we tend to ask our
customers to check out when you want

00:06:00.210 --> 00:06:01.890
to integrate with Active Directory?

00:06:01.900 --> 00:06:07.740
DNS, Fully Qualified Domain
Name for your domain.

00:06:07.740 --> 00:06:11.970
This is sort of a departure from the
people that are used to using NT,

00:06:11.970 --> 00:06:14.960
where your domain name was
simply your NetBios name,

00:06:14.960 --> 00:06:18.870
and it could be any sort of
name shorter than 15 characters.

00:06:19.600 --> 00:06:23.010
But for Active Directory and
for successful integration,

00:06:23.530 --> 00:06:27.480
Microsoft as well as Apple will
recommend that your domain is

00:06:27.480 --> 00:06:29.230
a fully qualified domain name.

00:06:29.240 --> 00:06:33.780
There will be problems if your
domain cannot be resolved in DNS.

00:06:33.780 --> 00:06:37.570
And when you install Active Directory,
it's also going to be really

00:06:37.570 --> 00:06:41.000
hard to work around not doing
what Microsoft recommends.

00:06:41.020 --> 00:06:43.150
You will essentially be
breaking your DNS and your

00:06:43.150 --> 00:06:45.120
Active Directory before you get started.

00:06:45.140 --> 00:06:48.700
Ensure that sites are configured.

00:06:49.300 --> 00:06:51.660
Again, if you don't know what it is,
talk to your AD administrator.

00:06:51.660 --> 00:06:56.240
Ask him if there's a site configured
for this physical location,

00:06:56.380 --> 00:07:01.830
either this building, this metro network,
this WAN, whatever it may be.

00:07:03.910 --> 00:07:06.830
Ensure that when you bind,
and we're going to be

00:07:06.830 --> 00:07:11.390
demoing all of this,
so in order for you to be able

00:07:11.390 --> 00:07:16.790
to bind into Active Directory,
you need to have access to do so.

00:07:16.800 --> 00:07:21.210
And what we do when a binding session
happens is that you're creating a

00:07:21.250 --> 00:07:23.980
computer account in Active Directory.

00:07:23.980 --> 00:07:28.270
By default, the user that can do that is
any administrator that's a

00:07:28.270 --> 00:07:30.660
domain administrator or higher.

00:07:32.170 --> 00:07:36.270
But if a company has
stringent security policies,

00:07:36.620 --> 00:07:39.840
then a user that's also been
delegated a right to create

00:07:39.840 --> 00:07:42.160
computer objects will suffice.

00:07:42.160 --> 00:07:44.690
So if, like we talked about earlier,
if you have an

00:07:44.690 --> 00:07:48.220
Active Directory environment where
your computer account is supposed

00:07:48.220 --> 00:07:51.870
to go into a specific container
or an organizational unit,

00:07:51.940 --> 00:07:57.890
then all that's really needed to
bind is a user that's allowed to

00:07:57.890 --> 00:08:01.520
create a computer object in the OU.

00:08:02.330 --> 00:08:05.420
for the computer object.

00:08:06.200 --> 00:09:19.100
[Transcript missing]

00:09:21.040 --> 00:09:25.540
So what is the benefits of
integrating with Active Directory?

00:09:25.630 --> 00:09:27.600
Primarily,
it's because you have one username

00:09:27.600 --> 00:09:31.180
and you have one password that will
get you access to all your resources

00:09:31.840 --> 00:09:36.120
on the Active Directory space,
as well as the Open Directory space.

00:09:36.120 --> 00:09:39.740
You don't have to worry about users
trying to use one user account when

00:09:39.740 --> 00:09:43.790
you're logging in here or one user
account when you're logging in there.

00:09:43.790 --> 00:09:45.690
You don't have to worry
about synchronization between

00:09:45.690 --> 00:09:47.160
Active Directory and Open Directory.

00:09:47.160 --> 00:09:50.590
It all magically works using
one username and password.

00:09:53.140 --> 00:09:54.990
You have one Kerberos domain.

00:09:55.000 --> 00:10:00.970
There's no more cross realm trust issues,
although it's possible to do so,

00:10:01.090 --> 00:10:04.790
but why would you when you
can integrate fully with the

00:10:04.790 --> 00:10:07.070
Active Directory Kerberos realm?

00:10:07.890 --> 00:10:12.520
It's easier for Apple as a
company to maintain a presence

00:10:12.600 --> 00:10:15.730
and play in the data center,
in the enterprise field.

00:10:15.760 --> 00:10:20.380
We are fully aware of how
Microsoft Active Directory is

00:10:20.510 --> 00:10:22.320
very heavily used.

00:10:22.370 --> 00:10:26.250
And, you know, you shouldn't be comparing
apples and oranges,

00:10:26.250 --> 00:10:27.200
literally.

00:10:27.200 --> 00:10:32.700
But we know that if we don't play well
with Active Directory and with Microsoft,

00:10:32.700 --> 00:10:34.600
then that's ultimately going
to hurt us in the long run.

00:10:35.220 --> 00:10:39.480
So it benefits Apple as a company to
be able to play with Microsoft and

00:10:39.780 --> 00:10:41.900
Active Directory in their environment.

00:10:41.900 --> 00:10:46.790
And using the AD plugin and binding to
Active Directory does that job very,

00:10:46.790 --> 00:10:47.750
very well.

00:10:51.340 --> 00:10:56.330
The last major benefit is once you're
bound and everything is working fine,

00:10:56.330 --> 00:10:59.820
you have a transparent
access to the resources.

00:10:59.820 --> 00:11:02.720
Because of the ACLs that
we introduced in Tiger,

00:11:02.720 --> 00:11:09.440
you have access to resources that
requires no serious maintenance

00:11:09.440 --> 00:11:13.050
other than having administrators
setting the right permission or

00:11:13.060 --> 00:11:16.990
setting the right access to the
resources that are available to you.

00:11:17.680 --> 00:11:21.470
The SharePoints on the
OS X Server will work with the

00:11:21.470 --> 00:11:23.820
Active Directory users and groups.

00:11:23.820 --> 00:11:27.610
The Active Directory users,
whether they are logging in from an

00:11:27.610 --> 00:11:31.800
OS X client or from a Windows XP client,
will have a single sign-on,

00:11:31.800 --> 00:11:35.420
fully single sign-on
environment to an OS X server,

00:11:35.420 --> 00:11:39.170
to a Windows server, from an OS X client,
from an XP client,

00:11:39.170 --> 00:11:42.540
and it will seamlessly work
together in a single sign-on

00:11:42.540 --> 00:11:44.650
environment because of Kerberos.

00:11:44.660 --> 00:11:47.640
And that's a beautiful thing.

00:11:47.660 --> 00:11:47.800
Thank you.

00:11:50.490 --> 00:11:56.080
So why, in addition to password
and a single user sign-on,

00:11:56.240 --> 00:11:57.730
would people want to integrate?

00:11:57.740 --> 00:12:02.470
Managed client is a very
good reason to do so.

00:12:02.470 --> 00:12:07.070
As you know, with Open Directory,
you have the ability to bind all your

00:12:07.070 --> 00:12:11.140
OS X clients to Open Directory and
then use applications such as

00:12:11.210 --> 00:12:15.570
Worker Manager to assign rights
and privileges to users with regards

00:12:15.570 --> 00:12:20.380
to what printers they can access,
what they can do with C++, etc.

00:12:20.400 --> 00:12:29.190
Managed client is a very
good reason to do so.

00:12:29.190 --> 00:12:41.830
As you know, with Open Directory,
you have the ability to bind all

00:12:41.830 --> 00:12:50.370
your OS X clients to Open Directory,
etc.

00:12:50.440 --> 00:12:55.260
Managed client is a very
good reason to do so.

00:12:55.260 --> 00:13:01.920
As you know, with Open Directory,
you have the ability to bind all

00:13:02.490 --> 00:13:06.940
your OS X clients to Open Directory,
etc.

00:13:07.900 --> 00:13:11.510
So what happens is that you have
a client that is bound to both

00:13:11.610 --> 00:13:15.120
Active Directory and Open Directory.

00:13:15.440 --> 00:13:18.120
He will get the users
from Active Directory,

00:13:18.310 --> 00:13:20.920
get the managed preferences
from Open Directory.

00:13:20.920 --> 00:13:23.100
Active Directory will authenticate.

00:13:23.350 --> 00:13:25.750
It will see that it's a member
of a group in Open Directory.

00:13:25.800 --> 00:13:27.560
It will see that there
are some preferences that

00:13:27.560 --> 00:13:29.560
are applied to that group.

00:13:29.560 --> 00:13:33.390
And bam,
your user environment has been created.

00:13:35.200 --> 00:13:36.960
will skip through some slides here.

00:13:36.960 --> 00:13:39.500
If you don't want to
use the magic triangle,

00:13:39.500 --> 00:13:40.830
what other options are there?

00:13:41.140 --> 00:13:44.680
You can do schema extensions
and extend the schema in your

00:13:44.680 --> 00:13:49.300
Active Directory to accommodate
essentially the Open Directory schema.

00:13:49.700 --> 00:13:54.030
What that would mean would then you could
take Workgroup Manager application and

00:13:54.060 --> 00:13:58.290
then use it against Active Directory and
store settings for the users

00:13:58.290 --> 00:14:01.990
and the groups straight into
Active Directory without using

00:14:02.090 --> 00:14:04.620
Open Directory in the mix whatsoever.

00:14:05.370 --> 00:14:10.680
The Service Pack 2 for Windows 2003
Server is currently scheduled

00:14:10.710 --> 00:14:12.920
to play more in the Unix,
Unix,

00:14:13.090 --> 00:14:18.060
the LDAP world with an implementation
of RFC 2307 that we hope is

00:14:18.150 --> 00:14:22.540
going to make it a little bit
easier for us to play with that.

00:14:22.580 --> 00:14:26.400
There's also a great product
called Centrify that just were

00:14:26.410 --> 00:14:30.010
announced a couple of days
ago or a couple of weeks ago,

00:14:30.440 --> 00:14:35.180
which will use the familiar
MMCs in Active Directory.

00:14:35.200 --> 00:14:39.510
directory to manage Macintosh clients.

00:14:39.900 --> 00:14:48.800
[Transcript missing]

00:14:55.680 --> 00:14:57.360
Thank you, good morning,
for coming here and

00:14:57.390 --> 00:15:00.420
sticking around on Friday.

00:15:00.470 --> 00:15:03.210
Can we get the demo machine up here?

00:15:04.800 --> 00:15:05.700
Great.

00:15:05.700 --> 00:15:10.700
So what we have here is a vanilla
installation of Mac OS 10.4 Server.

00:15:10.700 --> 00:15:12.900
And what we're going to go through
is the process of creating an

00:15:12.900 --> 00:15:16.850
Open Directory domain on the server,
integrating that with

00:15:16.850 --> 00:15:20.690
Active Directory for Kerberos,
and also setting up some file sharing.

00:15:22.300 --> 00:15:24.740
So in the server admin application,
the first thing we're going to do

00:15:24.740 --> 00:15:27.200
is find the Open Directory service.

00:15:27.280 --> 00:15:29.200
Excuse me.

00:15:29.350 --> 00:15:31.470
And under settings,

00:15:33.910 --> 00:15:38.640
We can actually take this to
be a Open Directory master.

00:15:38.680 --> 00:15:41.150
It's going to ask you to
create a DuraAdmin account.

00:15:41.300 --> 00:15:43.550
This is the account that you
can use to administrate your

00:15:43.550 --> 00:15:45.860
LDAP in the Open Directory.

00:15:47.800 --> 00:15:51.600
And we just create a
secure password for that.

00:15:51.690 --> 00:15:52.100
And save.

00:15:52.100 --> 00:15:53.890
And right now in the background,
it's actually going to

00:15:53.890 --> 00:15:54.990
start up a lot of services.

00:15:55.000 --> 00:15:57.440
It's going to start up a Kerberos KDC.

00:15:57.530 --> 00:16:00.830
It's going to create a Kerberos
key tab file for all of your

00:16:00.840 --> 00:16:03.110
services that can be Kerberized.

00:16:03.240 --> 00:16:06.360
It's also going to take that
DIR admin account that we just

00:16:06.360 --> 00:16:10.220
created and make that the first
entry in the LDAP shared domain.

00:16:16.210 --> 00:16:18.470
This runs a lot faster
on our server hardware,

00:16:18.590 --> 00:16:18.960
so.

00:16:18.960 --> 00:16:28.720
Should really stress how many services
it's starting in the background here,

00:16:28.780 --> 00:16:31.720
and how many plist files
and configuration files.

00:16:31.720 --> 00:16:34.880
We're gonna get into that in one second,
so I can show you all those.

00:16:47.200 --> 00:16:48.040
I'm sorry.

00:16:48.040 --> 00:16:53.040
- Show us the slide and then pick a lot.

00:16:53.040 --> 00:16:57.370
- This should be done in just a second,
I mean, hopefully.

00:17:03.580 --> 00:17:05.640
No, no, no.

00:17:05.640 --> 00:17:07.910
We're going to the assumption
DNS is perfect right now.

00:17:07.920 --> 00:17:10.770
Okay,
so we have an Open Directory master.

00:17:10.780 --> 00:17:13.380
Thank you.

00:17:17.430 --> 00:17:20.960
So if we go back to the overview,
we can see that we are running.

00:17:21.020 --> 00:17:22.730
Our Kerberos is running.

00:17:22.820 --> 00:17:23.460
So that's good.

00:17:23.460 --> 00:17:26.140
That means that we should
have DNS up and going.

00:17:26.150 --> 00:17:27.990
And now we're going to go in,
is we're actually going to start

00:17:27.990 --> 00:17:30.960
destroying all those nice things that
we did in the background there to get

00:17:30.960 --> 00:17:35.020
this to work with Active Directory in
a more clean sort of environment.

00:17:35.270 --> 00:17:37.740
So the first thing we're going to
do is we're actually going to remove

00:17:37.790 --> 00:17:41.600
the Kerberos KDC on this machine.

00:17:41.680 --> 00:17:44.790
And what we can do is
use the SSO utility.

00:17:49.200 --> 00:17:51.500
And of course,
we have to put in an administrative

00:17:51.500 --> 00:17:55.040
username and our secure password,
which I'm going to share with everyone.

00:17:55.130 --> 00:17:57.390
So don't tell anyone after we leave here.

00:18:03.620 --> 00:18:06.360
And if we refresh this,
we can see that Kerberos has stopped.

00:18:06.360 --> 00:18:11.430
Sorry.

00:18:11.530 --> 00:18:14.790
It's at the top here.

00:18:15.420 --> 00:18:17.130
Is it kind of readable?

00:18:17.200 --> 00:18:18.760
Sort of?

00:18:22.200 --> 00:18:24.520
So now I'm going to show you some
of the configuration files that were

00:18:24.520 --> 00:18:28.590
built in the background while we
set up the Open Directory master.

00:18:32.580 --> 00:18:36.540
One of which would be the
edu.mit Kerberos file.

00:18:36.560 --> 00:18:40.230
And we can see here that it was
auto-generated from the LDAP on the

00:18:40.300 --> 00:18:42.240
Open Directory on the local node.

00:18:42.240 --> 00:18:45.140
And here is our Kerberos Realm.

00:18:45.520 --> 00:18:47.370
But we don't want to use that Realm.

00:18:47.380 --> 00:18:49.000
We want to use our
Active Directory Realm.

00:18:49.040 --> 00:18:53.260
So we're going to take
this one step further.

00:18:53.280 --> 00:18:55.920
And we're going to simply
get rid of it right now.

00:19:03.700 --> 00:19:06.690
The other file that's of importance
here is the Kerberos keytap file that

00:19:06.690 --> 00:19:10.400
I mentioned earlier that was created
when we created an Open Directory master.

00:19:10.430 --> 00:19:14.960
We can actually read out that
information by using K list minus KT.

00:19:15.420 --> 00:19:17.770
And here you can see all the
service principles on the server

00:19:17.780 --> 00:19:19.440
that have been Kerberized.

00:19:19.440 --> 00:19:22.510
And what you're really looking for
here is the second part of this.

00:19:22.520 --> 00:19:25.310
Well, on the left-hand side,
you can see what the service is.

00:19:25.350 --> 00:19:27.280
On the right-hand side,
you can see the Kerberos realm

00:19:27.280 --> 00:19:28.740
that it's expecting to use.

00:19:28.740 --> 00:19:33.380
Now, in our case, server.copycat.org is
actually our Open Directory.

00:19:33.400 --> 00:19:37.080
We want to use the Active Directory,
which should just be copycat.org.

00:19:37.250 --> 00:19:39.440
So we're actually going to
get rid of this file as well.

00:19:39.660 --> 00:19:42.480
It will auto-generate again when
we bind into Active Directory and

00:19:42.480 --> 00:19:44.580
Kerberize the server again.

00:19:44.830 --> 00:19:51.420
And to do that,
we just do an RM again on the Etsy, KRP5,

00:19:51.430 --> 00:19:53.210
a key tab file.

00:19:54.990 --> 00:19:55.600
And that's gone.

00:19:55.600 --> 00:19:57.710
And just to make sure,
we can actually ask it to read

00:19:57.710 --> 00:19:59.060
out the key tab one more time.

00:19:59.060 --> 00:20:01.680
And it comes back and says
there isn't anything there.

00:20:04.140 --> 00:20:06.290
So the next step that we want to
do is we actually want to bind

00:20:06.300 --> 00:20:08.660
into the Active Directory itself.

00:20:08.670 --> 00:20:12.380
And in the Utilities folder,
you'll find Directory Access.

00:20:12.380 --> 00:20:14.500
In there,
we've got an Active Directory plugin.

00:20:14.500 --> 00:20:16.060
It's a great tool to use.

00:20:16.060 --> 00:20:18.300
You don't have to do
LDAP mappings all over the place.

00:20:18.300 --> 00:20:20.980
You can use the LDAPv3 plugin.

00:20:20.990 --> 00:20:25.530
And when we double click on it,
it's got a very informative GUI.

00:20:27.410 --> 00:20:31.710
We know that our Active Directory domain
is copycat.org and we just

00:20:31.710 --> 00:20:33.300
want to bind in a server.

00:20:33.300 --> 00:20:36.500
At the bottom here we've got
lots of different options.

00:20:36.500 --> 00:20:39.290
You may choose to prefer
a specific server,

00:20:39.360 --> 00:20:41.180
which we can do here.

00:20:43.350 --> 00:20:46.300
and we can allow administration
by the domain admins and

00:20:46.300 --> 00:20:47.680
enterprise admins in Windows.

00:20:53.070 --> 00:20:55.460
At this point,
we want to use a Windows administrative

00:20:55.500 --> 00:20:56.400
name and password.

00:20:56.500 --> 00:21:00.430
We're told to go ahead and bind in.

00:21:00.500 --> 00:21:02.800
And it found an existing account.

00:21:02.910 --> 00:21:06.080
We had tried this out earlier to make
sure everything was set up for the demo.

00:21:06.200 --> 00:21:08.900
We actually, when we unbind,
will remove that.

00:21:08.900 --> 00:21:11.680
So we do clean up after ourselves.

00:21:16.100 --> 00:21:18.140
Now it's going to tell us that
we can join the Kerberos realm.

00:21:18.140 --> 00:21:21.460
And we're going to show you two
different ways that you can do that.

00:21:21.460 --> 00:21:22.640
So we're going to click OK.

00:21:22.640 --> 00:21:24.990
We're going to click OK again.

00:21:26.280 --> 00:21:28.960
And the one thing that we want to double
check here right now is authentication.

00:21:28.960 --> 00:21:33.440
We want to make sure that our
Active Directory is moved to the top,

00:21:33.440 --> 00:21:37.120
since it is our primary
authentication authority here.

00:21:37.120 --> 00:21:38.990
Click on Apply.

00:21:39.710 --> 00:21:45.440
And what we're going to do in
here again is we are going to run,

00:21:45.440 --> 00:21:47.720
we're going to show you
two different ways here.

00:21:47.720 --> 00:21:50.090
In settings on Open Directory,

00:21:51.480 --> 00:21:55.160
You see there's a Curberize button
down here in the bottom middle.

00:21:55.180 --> 00:21:56.150
You could use that.

00:21:56.290 --> 00:22:00.760
Alternatively, we like using the command
line version of that,

00:22:00.790 --> 00:22:05.300
which is what we've shown
you here right this second.

00:22:05.320 --> 00:22:08.610
So we have dsconfig-ad.

00:22:09.630 --> 00:22:13.010
which is the directory service
configuration of the AD plugin

00:22:13.280 --> 00:22:21.080
and we're going to tell it to
enable the SSO environment for us.

00:22:26.660 --> 00:22:30.060
So at this point, we can go back in,
tell it to look at the Kerberos key tab,

00:22:30.060 --> 00:22:32.200
and you can see it has regenerated.

00:22:32.200 --> 00:22:34.600
You can see that our
Kerberos realm at the bottom,

00:22:34.600 --> 00:22:38.370
at the right side here, is copycat.org,
as it should be.

00:22:41.150 --> 00:22:42.960
And this is all scriptable.

00:22:42.960 --> 00:22:46.250
You can script things to bind your
machines into Active Directory,

00:22:46.260 --> 00:22:48.140
and we'll get into that more
in just a little bit when

00:22:48.140 --> 00:22:49.340
we get to the client side.

00:22:49.340 --> 00:22:53.960
I'm sorry?

00:22:59.780 --> 00:23:02.170
So the next tool we're
going to show you is DSCL,

00:23:02.170 --> 00:23:04.850
which is the
Directory Services Command Line Tool.

00:23:04.980 --> 00:23:06.930
And we're going to show you

00:23:08.400 --> 00:23:11.000
How easy it is to actually read out
information from Active Directory.

00:23:11.000 --> 00:23:13.280
And this is actually a good test,
because if you can't read

00:23:13.280 --> 00:23:15.800
out the information or
reach the Active Directory,

00:23:15.860 --> 00:23:18.100
you're not going to get much
further in the integration.

00:23:18.150 --> 00:23:22.500
And you can actually use this just like
any other terminal window at this point.

00:23:22.540 --> 00:23:26.250
So we're going to
CD into Active Directory,

00:23:26.260 --> 00:23:30.760
and get into the old domains,
and we're going to move into the users.

00:23:31.170 --> 00:23:34.190
If we do an LS on that,
we can see here are the users

00:23:34.210 --> 00:23:35.400
that are in the Active Directory.

00:23:35.400 --> 00:23:39.000
We can actually read out the
information on one of the users,

00:23:39.000 --> 00:23:42.030
read out Michael,
and here is all the information that we

00:23:42.040 --> 00:23:44.310
can get out of the Active Directory here.

00:23:44.340 --> 00:23:48.420
I'm going to kind of scroll
through this for you guys here.

00:23:52.860 --> 00:23:55.810
So the next step we want to do
is we want to show off a little

00:23:55.850 --> 00:23:59.200
bit of file sharing as well,
since we have an integrated

00:23:59.200 --> 00:24:02.260
server at this point.

00:24:02.320 --> 00:24:06.490
We can start up our favorite
file sharing service.

00:24:10.400 --> 00:24:11.590
and Michael Dahl.

00:24:11.590 --> 00:24:15.030
We're going to open up a second
tool that we commonly use.

00:24:15.050 --> 00:24:16.670
It's Workgroup Manager.

00:24:16.670 --> 00:24:20.330
If you're not familiar with it,
this is where you can actually

00:24:20.330 --> 00:24:25.310
administer your users and groups in the
ADLDAP that's on your Open Directory.

00:24:29.670 --> 00:24:32.240
And the first thing we want to do is
check up here on the left hand side,

00:24:32.240 --> 00:24:33.690
you can see what directory
you're looking at.

00:24:33.720 --> 00:24:37.280
In this case, we are looking at our local
Open Directory master.

00:24:37.280 --> 00:24:38.690
And we're going to click the lock here.

00:24:38.900 --> 00:24:41.870
And we're going to use the
diradmin username and password

00:24:41.960 --> 00:24:46.170
that we created previously when we
created the Open Directory master.

00:24:48.000 --> 00:24:51.020
So now we're authenticated
to our local LDAP,

00:24:51.020 --> 00:24:54.360
and we can actually go in
and make modifications.

00:24:54.960 --> 00:24:56.400
In this case,
what we're going to want to do

00:24:56.400 --> 00:25:01.610
is we're going to move over to
groups and create a new group,

00:25:01.610 --> 00:25:03.730
and we'll call this test group.

00:25:04.600 --> 00:25:06.960
And click on the plus sign
on the right hand side.

00:25:06.960 --> 00:25:10.800
And it's going to show you the available
users that you could put into that group.

00:25:11.010 --> 00:25:13.080
In this case,
we can actually go right into

00:25:13.080 --> 00:25:18.470
Active Directory and take myself and
Rick and place them right into the group

00:25:18.560 --> 00:25:21.580
to apply Managed Client Settings to them.

00:25:22.790 --> 00:25:24.950
Click on Save,
and now we'll go over into Preferences.

00:25:24.960 --> 00:25:28.410
This is where we can actually get
into the magic triangle where we're

00:25:28.410 --> 00:25:34.600
applying group management policy onto
Mac OS X clients using Active Directory.

00:25:36.220 --> 00:25:39.090
So we're going to go into
here and we're going to add

00:25:39.090 --> 00:25:41.640
in some important preferences.

00:25:41.670 --> 00:25:45.710
And it's been shown that
if we modify the docs,

00:25:45.710 --> 00:25:48.760
it's always very large at all times.

00:25:48.770 --> 00:25:53.280
And on the left-hand side,
you'll actually get 40% more

00:25:53.390 --> 00:25:56.190
productivity out of your end users.

00:25:58.830 --> 00:26:01.560
And we're going to make sure that it's
actually there at all times to remind

00:26:01.560 --> 00:26:02.720
them of the work they should be doing.

00:26:02.730 --> 00:26:07.850
And we'll apply that.

00:26:12.060 --> 00:26:17.690
We'll create a quick share here so
that we can test that out as well.

00:26:21.630 --> 00:26:23.480
So in this case,
we'll just go into the local hard drive.

00:26:23.480 --> 00:26:26.900
This could be an XServe RAID.

00:26:27.000 --> 00:26:31.000
And we'll go into Shared Items,
and we'll create a new folder.

00:26:32.690 --> 00:26:33.800
WWDC test.

00:26:33.810 --> 00:26:38.990
And we will tell it to share
the items in its contents.

00:26:43.270 --> 00:26:46.810
We can go over to Users and Groups
and take our Open Directory group

00:26:46.880 --> 00:26:50.020
that we just created,
drag it right in as Read&Write,

00:26:50.200 --> 00:26:51.830
and save that.

00:26:53.200 --> 00:26:57.000
One other thing I want to show is
we can actually see the MCX that we

00:26:57.140 --> 00:26:59.520
put in to that Open Directory group.

00:26:59.530 --> 00:27:02.600
And again, we can use DSCL.

00:27:04.090 --> 00:27:06.880
And this time we're going to tell
it to look at the LDAPv3 plugin,

00:27:06.880 --> 00:27:09.000
which is going to look at
our Open Directory master

00:27:09.000 --> 00:27:11.230
locally hosed on this machine.

00:27:17.140 --> 00:27:20.040
And we're going to change
directives into groups.

00:27:20.060 --> 00:27:24.010
And we can see our test group is
listed right here at the bottom.

00:27:25.620 --> 00:27:27.960
And we're going to read out test group.

00:27:28.120 --> 00:27:30.040
And there's a lot of stuff here,
so we're just going to

00:27:30.070 --> 00:27:30.920
do a search for left.

00:27:30.920 --> 00:27:33.540
Since we knew we moved the
orientation of the dock to the left,

00:27:33.560 --> 00:27:37.400
and we can see here is
the value pair right here.

00:27:38.890 --> 00:27:41.820
So that'll give you a little overview
of how you can integrate with

00:27:41.820 --> 00:27:45.200
Active Directory for file services,
for work group management,

00:27:45.200 --> 00:27:47.920
and for file service and
work group management.

00:27:47.920 --> 00:27:49.220
Thank you guys very much.

00:27:49.290 --> 00:27:50.160
We're going to turn it over to Rick now.

00:28:04.420 --> 00:28:08.680
Okay, well I'm going to be showing you
guys today how we can integrate

00:28:08.680 --> 00:28:11.840
clients into Active Directory,
what some of the options are, etc.

00:28:11.840 --> 00:28:13.560
So let me log out here.

00:28:13.560 --> 00:28:15.840
We're going to unbind the
system from Active Directory.

00:28:15.840 --> 00:28:23.210
As you can see, we're all very creative
with our accounts here.

00:28:45.110 --> 00:28:52.360
Here is the Active Directory plugin
just like Mike showed you.

00:28:52.370 --> 00:28:54.090
I'm going to go over some
of the basic options.

00:28:54.190 --> 00:28:58.470
This is pretty much what you will
see in OS X Server and OS X Clients,

00:28:58.470 --> 00:28:59.930
all the same.

00:29:00.050 --> 00:29:03.030
So obviously right here we have
our Active Directory domain,

00:29:03.110 --> 00:29:04.470
copycat.org.

00:29:04.570 --> 00:29:08.930
The computer ID I set to some dude here.

00:29:08.980 --> 00:29:11.510
You can set that to
basically whatever you want.

00:29:11.520 --> 00:29:15.060
It needs to be something unique.

00:29:15.060 --> 00:29:17.840
You can use the system serial number,
Mac address,

00:29:18.250 --> 00:29:20.830
something you want to talk to your
Active Directory administrator about,

00:29:20.890 --> 00:29:23.290
but it just needs to be something unique.

00:29:23.380 --> 00:29:25.140
So you can see some of
the options down here.

00:29:25.140 --> 00:29:28.400
We have create mobile account at login.

00:29:28.400 --> 00:29:31.620
What that's going to do is when
the user logs in with their

00:29:31.620 --> 00:29:34.630
Active Directory account for
the first time to the system,

00:29:34.660 --> 00:29:37.900
it will basically take their
Active Directory account information

00:29:37.900 --> 00:29:40.320
and cache it in the NetInfo database.

00:29:40.360 --> 00:29:43.120
So let's say this is--
this is somebody's laptop.

00:29:43.120 --> 00:29:46.840
They unplug it from your guys'
network and go on a trip someplace.

00:29:46.840 --> 00:29:48.760
They'll still be able to log
into the system with their

00:29:48.850 --> 00:29:52.230
Active Directory account since it will
keep all their information cached.

00:29:52.240 --> 00:29:55.040
Right below it you see
require confirmation before

00:29:55.040 --> 00:29:56.580
creating a mobile account.

00:29:56.580 --> 00:29:59.620
Typically I leave this turned off.

00:29:59.620 --> 00:30:02.600
The reason is when the
user first logs in,

00:30:02.600 --> 00:30:06.760
it will actually prompt the user if they
want to create a mobile account or not.

00:30:06.800 --> 00:30:10.680
About 70% of the time they're going
to freak out and not know what it is,

00:30:10.680 --> 00:30:11.400
click no.

00:30:11.400 --> 00:30:16.190
You typically want it to be creative,
so just turn off the confirmation.

00:30:16.640 --> 00:30:18.700
Force local home
directory on startup disk.

00:30:18.820 --> 00:30:22.940
You want to leave that checked
if you want the user to

00:30:22.940 --> 00:30:24.640
have a local home directory.

00:30:24.730 --> 00:30:27.760
If you have that unchecked and
you have this next option checked,

00:30:27.770 --> 00:30:31.680
there's a good chance the user
is going to get a network home.

00:30:31.780 --> 00:30:35.230
So this next option here,
use UNC path from Active Directory to

00:30:35.230 --> 00:30:38.160
derive network home location.

00:30:38.180 --> 00:30:43.360
Basically,
that will hit Active Directory and

00:30:43.370 --> 00:30:47.160
look for wherever the field
in Active Directory the user's

00:30:47.700 --> 00:30:51.440
network home directory is defined
and mount that on their desktop.

00:30:51.580 --> 00:30:54.250
Now, if you have that checked and
the option above unchecked,

00:30:54.350 --> 00:30:57.600
the user will get a
network home directory.

00:30:57.670 --> 00:31:00.760
Down here, you'll see the network
protocol to be used.

00:31:00.880 --> 00:31:03.050
You can either select SMB or AFP.

00:31:03.190 --> 00:31:07.960
If you are doing network homes,
it's probably best if you host them

00:31:07.960 --> 00:31:12.800
on an Apple file server and use
AFP simply for the reason that some

00:31:12.940 --> 00:31:18.220
applications have issues working
with SMB network home directories.

00:31:18.380 --> 00:31:22.220
And you get the benefits of AFP,
like automatic reconnects if you lose

00:31:22.220 --> 00:31:25.290
your network connection temporarily,
et cetera.

00:31:25.680 --> 00:31:28.910
So down here we have
the default user shell.

00:31:28.920 --> 00:31:32.810
Obviously, this is something that's not
natively in Active Directory.

00:31:32.900 --> 00:31:37.010
So we set it to bash,
which should be fine for most cases.

00:31:37.020 --> 00:31:39.410
But you can set it to whatever you want.

00:31:39.570 --> 00:31:41.740
So next over here we have the mappings.

00:31:41.750 --> 00:31:44.560
95% of the time you're
never going to touch this.

00:31:44.570 --> 00:31:47.410
This would be for certain
applications that,

00:31:47.410 --> 00:31:49.450
let's say,
they have an issue with the automatically

00:31:49.480 --> 00:31:53.400
generated UIDs and group IDs that
you get from Active Directory.

00:31:53.400 --> 00:31:55.150
If you needed to,
you could set them right

00:31:55.150 --> 00:31:56.780
here in the mappings.

00:31:56.780 --> 00:32:00.660
Now some interesting options here
in the administrative section.

00:32:00.670 --> 00:32:03.280
Right here you have
prefer this domain server.

00:32:03.290 --> 00:32:08.740
If you want to always point the client
to a very specific domain controller,

00:32:08.740 --> 00:32:11.100
you can specify that right here.

00:32:11.130 --> 00:32:15.400
Another really useful option
is allow administration by.

00:32:15.680 --> 00:32:19.430
Basically, any Active Directory groups
added in here,

00:32:19.430 --> 00:32:22.100
if you have this checked,
the members of those groups,

00:32:22.100 --> 00:32:25.100
if they log into your system,
will have administrative rights.

00:32:25.340 --> 00:32:28.100
The only exception to that is sudo.

00:32:28.100 --> 00:32:31.160
If they're trying to use sudo,
they won't be in the sudoers file and

00:32:31.160 --> 00:32:33.570
won't get administrative access there,
but otherwise,

00:32:33.600 --> 00:32:36.330
they'll be able to administer the system.

00:32:36.580 --> 00:32:39.900
So a very handy way to give
a set group of people admin

00:32:39.900 --> 00:32:41.930
access to all your systems.

00:32:41.940 --> 00:32:46.690
Down here we have allow authentication
from any domain in the forest.

00:32:46.880 --> 00:32:51.670
If you only want people basically
authenticating in one specific domain,

00:32:51.670 --> 00:32:53.360
you would want to leave that unchecked.

00:32:53.360 --> 00:32:56.090
Otherwise,
it will let anybody in any domain

00:32:56.100 --> 00:32:58.180
in Active Directory authenticate
to this computer.

00:32:58.180 --> 00:33:02.680
So if you don't want that,
leave this unchecked.

00:33:02.800 --> 00:33:07.150
So we're going to go ahead and bind
the system back to Active Directory.

00:33:07.250 --> 00:33:10.030
So again,
we put in an Active Directory user

00:33:10.040 --> 00:33:12.970
that has rights to bind the system.

00:33:17.260 --> 00:33:18.760
Click OK.

00:33:18.870 --> 00:33:22.940
Now, the binding time here,
it's going to vary depending

00:33:22.940 --> 00:33:26.180
on how your network's set up,
how Active Directory is set up,

00:33:26.180 --> 00:33:26.940
et cetera.

00:33:26.960 --> 00:33:28.880
So it could take a few seconds.

00:33:28.980 --> 00:33:30.520
It could take up to a minute or two.

00:33:30.520 --> 00:33:33.370
It really kind of depends on
how your network's set up.

00:33:33.470 --> 00:33:36.100
So we'll let this finish binding here.

00:33:41.000 --> 00:33:41.900
Okay, excellent.

00:33:41.900 --> 00:33:44.880
So we are on Active Directory.

00:33:44.880 --> 00:33:54.050
So also notice on authentication,
we're pointing at copycat.org here.

00:33:54.050 --> 00:33:58.380
I'm going to move that up to
make the magic triangle stuff

00:33:58.380 --> 00:34:00.480
the mic setup work correctly.

00:34:01.680 --> 00:34:03.580
Okay,
we're going to go ahead and quit that.

00:34:03.630 --> 00:34:07.080
Now I'm sure some of you might
also be interested in binding to

00:34:07.080 --> 00:34:10.200
Active Directory from the command line,
scripting this, etc.

00:34:10.200 --> 00:34:13.920
I'm going to show you guys a
really basic script I wrote.

00:34:13.920 --> 00:34:17.760
There's a lot cooler things you can
do if you get more into depth and

00:34:17.770 --> 00:34:21.700
you can talk to me afterwards and
I can give you some of these ideas,

00:34:21.700 --> 00:34:23.610
but here's a basic example.

00:34:24.290 --> 00:34:30.520
What this script basically does,
it's going to grab the computer's

00:34:30.520 --> 00:34:33.060
serial number and it's going to
use that for the computer name.

00:34:33.150 --> 00:34:35.800
So you can see right here,
it's just a basic shell script,

00:34:35.860 --> 00:34:38.190
setting a variable called computer name.

00:34:38.190 --> 00:34:41.760
I'm hitting system profiler and
grepping out the serial number,

00:34:41.760 --> 00:34:45.440
munging the text a bit,
and that's how I get the serial number.

00:34:45.440 --> 00:34:48.800
Then right here I'm running DSConfigAD,
which is the command line

00:34:48.800 --> 00:34:51.860
tool which will let you bind
a system to Active Directory.

00:34:53.260 --> 00:34:53.970
You got it.

00:35:07.800 --> 00:35:08.190
There we go.

00:35:08.200 --> 00:35:08.570
Is that better?

00:35:08.580 --> 00:35:10.760
Okay.

00:35:10.760 --> 00:35:16.320
So we can see right here we are
binding to Active Directory.

00:35:16.320 --> 00:35:20.380
We're specifying a computer name,
the domain, which is copycat.org,

00:35:20.380 --> 00:35:23.940
and the Active Directory user
that's allowed to bind.

00:35:23.940 --> 00:35:25.780
Again,
administrator in Apple is the password,

00:35:25.780 --> 00:35:27.300
so username and password's right there.

00:35:27.300 --> 00:35:29.940
So once it's bound,
we're going to set some of

00:35:29.940 --> 00:35:31.070
the options in the plug-in.

00:35:31.080 --> 00:35:34.390
You can see right here,
here's a couple of the example options.

00:35:35.000 --> 00:35:38.400
I'm enabling mobile accounts,
but I'm disabling the confirmation,

00:35:38.400 --> 00:35:44.230
and we are basically
forcing local homes here.

00:35:44.240 --> 00:35:48.490
So next, last but not least,
the system's bound to

00:35:48.490 --> 00:35:53.120
Active Directory at this point,
but you still need to add the path to

00:35:53.120 --> 00:35:58.130
Active Directory to the authentication
section in Directory Access so people

00:35:58.270 --> 00:36:01.140
can actually log into your system
with Active Directory accounts.

00:36:01.140 --> 00:36:04.010
These two commands
right here do the trick.

00:36:04.420 --> 00:36:06.480
They're pretty widely
documented on the Internet.

00:36:06.480 --> 00:36:10.650
You can find them, no problem,
but that's what actually lets

00:36:10.880 --> 00:36:14.240
you authenticate once you are
bound to Active Directory.

00:36:14.240 --> 00:36:16.400
So it's an example of the script.

00:36:16.500 --> 00:36:20.250
Again, there's a lot of other cool stuff
you can do to really trick this out,

00:36:20.350 --> 00:36:22.200
so talk to me afterwards
if you have any questions.

00:36:24.500 --> 00:36:25.630
So we won't save that.

00:36:25.740 --> 00:36:30.830
And we're going to log in with Rick,
which is one of our test accounts.

00:36:37.060 --> 00:36:38.400
Okay, so here we go.

00:36:38.400 --> 00:36:39.480
We are logged in as Rick.

00:36:39.490 --> 00:36:43.010
Notice over here,
we have the dock on the left side

00:36:43.020 --> 00:36:44.450
just like Mike set up for us.

00:36:44.450 --> 00:36:48.800
So we know that we are getting managed
references from Open Directory.

00:36:48.800 --> 00:36:52.340
Also wanted to show you another
cool script I wrote that you guys

00:36:52.350 --> 00:36:55.420
might be able to use and please
talk to me afterwards if you're

00:36:55.420 --> 00:36:58.340
interested in learning more about it.

00:36:58.340 --> 00:37:01.760
One thing that you guys
will notice is that

00:37:02.190 --> 00:37:06.400
Mac OS X isn't so good about telling
you if your Active Directory password

00:37:06.400 --> 00:37:08.560
is about to expire.

00:37:08.870 --> 00:37:10.550
So we have this.

00:37:10.670 --> 00:37:13.860
I wrote a little Apple script
that folds in some Perl scripts,

00:37:13.860 --> 00:37:16.800
et cetera, called Expire Check.

00:37:16.800 --> 00:37:20.440
You can set this to run as
a login item for your users.

00:37:21.980 --> 00:37:22.590
You get this.

00:37:22.630 --> 00:37:25.250
The way I have this set up is
that if the password's going

00:37:25.250 --> 00:37:28.350
to expire within seven days,
you'll get something like this.

00:37:28.350 --> 00:37:30.580
It says, you know,
your password will expire

00:37:30.580 --> 00:37:31.600
in X amount of days.

00:37:31.600 --> 00:37:33.320
Please open system preferences.

00:37:33.320 --> 00:37:35.320
Go to accounts and change your password.

00:37:35.390 --> 00:37:37.530
If it's going to expire
in three days or less,

00:37:37.570 --> 00:37:39.030
it gets a little bit nastier.

00:37:39.040 --> 00:37:42.760
It gives you a slightly nastier message
and opens up the accounts preferences

00:37:42.760 --> 00:37:46.560
for you and asks you to change
your password right then and there.

00:37:52.940 --> 00:37:54.980
So again,
if you're interested in how this works,

00:37:55.040 --> 00:37:56.160
come talk to me afterwards.

00:37:56.160 --> 00:37:57.840
I'd be glad to help.

00:37:57.840 --> 00:38:00.120
All right, and that's it for my
client demonstration.

00:38:00.120 --> 00:38:02.170
I'll hand it back to Ståle.

00:38:07.300 --> 00:38:10.480
Can we switch back to the
presentation station please?

00:38:10.480 --> 00:38:13.160
Good demonstrations people.

00:38:13.160 --> 00:38:18.480
What we showed here was essentially
a vanilla setup of integration.

00:38:18.580 --> 00:38:25.960
There's very little magic that we
did when we set this up this week.

00:38:25.960 --> 00:38:30.060
The only thing that was actually custom
were the login scripts that Rick showed

00:38:30.060 --> 00:38:33.520
and also the password expiration notice.

00:38:33.520 --> 00:38:36.280
Other than that,
everything is out of the box.

00:38:36.450 --> 00:38:42.030
The OS X we're running 10.4.7 and
the Active Directory Domain was a

00:38:42.030 --> 00:38:46.470
standard 2003 with Service Pack 1.

00:38:46.780 --> 00:38:49.780
Thank you Michael and thank you Rick.

00:38:52.750 --> 00:38:56.570
Real quick,
a little bit about troubleshooting.

00:38:56.900 --> 00:38:59.840
Unfortunately,
Nicole Schock from AppleCare had

00:38:59.850 --> 00:39:03.460
a very good session about
troubleshooting that started at 10:15.

00:39:03.480 --> 00:39:06.880
So if somebody has a time machine,
we can go back and she will be

00:39:06.880 --> 00:39:10.940
having some good slides at her
presentation about what to do,

00:39:10.960 --> 00:39:13.700
not only with Active Directory,
but generally with regards

00:39:13.730 --> 00:39:15.180
to troubleshooting.

00:39:15.280 --> 00:39:22.550
But there are a couple of things that we
should mention that may come in handy.

00:39:22.590 --> 00:39:26.160
MemberD,
as you guys have heard of before,

00:39:26.160 --> 00:39:27.570
is going away in Leopard.

00:39:27.680 --> 00:39:31.310
But right now,
you have the capability to dump

00:39:31.580 --> 00:39:37.900
the MemberD log and the cache
to see what MemberD contains.

00:39:38.050 --> 00:39:43.400
And that's pretty useful if
and when you have users that,

00:39:43.460 --> 00:39:46.650
for some reason,
aren't able to get to resources

00:39:47.080 --> 00:39:51.450
on an OS X server that they
should be able to get to.

00:39:51.710 --> 00:39:52.420
You issue a MemberD.

00:39:52.420 --> 00:39:54.070
You have to do a D-L.

00:39:54.070 --> 00:40:00.210
It'll dump that to a log file,
MemberD_Dump, inside of library logs.

00:40:00.960 --> 00:40:08.470
Another good way of finding out what's
going on is to use packet traces.

00:40:08.470 --> 00:40:10.490
It's not always for the faint of heart.

00:40:10.490 --> 00:40:12.660
And in order to narrow down
the scope a little bit,

00:40:12.770 --> 00:40:16.660
you have the option of specifying
some ports that you can use.

00:40:17.240 --> 00:40:25.340
Port 88, 464, 389, 32,
68 will cover LDAP, Kerberos,

00:40:25.340 --> 00:40:30.300
Global Catalog,
and it will still give you every

00:40:30.400 --> 00:40:34.350
packet that goes over the wire,
but at least you're not going to

00:40:34.390 --> 00:40:38.680
have TCP dump log every port and
every protocol that is on the wire

00:40:38.980 --> 00:40:41.060
when you're trying to do this.

00:40:41.060 --> 00:40:46.720
That command that's listed up
there will create a nice file.

00:40:47.290 --> 00:40:48.510
That will only log those files.

00:40:48.560 --> 00:40:52.420
You issue the command
before you start binding,

00:40:52.420 --> 00:40:56.180
and you see what the problem is,
and you kill it.

00:40:56.320 --> 00:40:58.000
Issue the command again.

00:40:58.000 --> 00:41:01.010
It's going to create a capture out
file that's going to be stored in

00:41:01.010 --> 00:41:04.320
the root of the home directory of
the user that issued that command.

00:41:04.320 --> 00:41:09.980
You can either look through that
file using any tool that you like.

00:41:09.980 --> 00:41:13.270
Etherpeak and Ethereal are
two that people seem to be

00:41:13.340 --> 00:41:15.120
liking more than others.

00:41:18.650 --> 00:41:23.770
Another excellent way of troubleshooting
Active Directory is to use Diskl,

00:41:23.800 --> 00:41:25.730
the
Director Services Command Line utility.

00:41:25.740 --> 00:41:30.180
If you can't read user records
or group records or anything from

00:41:30.250 --> 00:41:34.660
Active Directory using Diskl,
there's no reason for you to keep

00:41:34.660 --> 00:41:38.640
trying to authenticate users or
trying to get things to move along.

00:41:38.640 --> 00:41:42.280
Because if this right here doesn't work,
you're not bound correctly

00:41:42.600 --> 00:41:44.020
to Active Directory.

00:41:44.560 --> 00:41:47.620
So what we usually do when we're
on site or when you're trying

00:41:47.680 --> 00:41:51.680
to troubleshoot something,
when you bind a client or a server,

00:41:51.770 --> 00:41:54.340
Try and read a record
out of Active Directory.

00:41:54.340 --> 00:41:59.690
Issue an ID command to see if it's
recognizing the fact that it's bound.

00:41:59.700 --> 00:42:02.390
If that doesn't work,
anything you do from there

00:42:02.390 --> 00:42:03.970
on is also going to fail.

00:42:03.970 --> 00:42:08.400
So it's pretty important to make
sure that you do this first.

00:42:08.870 --> 00:42:13.080
If you are doing an Open Directory,
Active Directory managed

00:42:13.420 --> 00:42:18.760
client environment,
sometimes you may find that you make

00:42:18.760 --> 00:42:22.190
settings for a group or you make settings
for a user that may not always take.

00:42:22.300 --> 00:42:26.130
Like Michael said,
the productivity level of having a dock

00:42:26.130 --> 00:42:31.680
to the left may increase by 40%, but for
some reason it doesn't take for a user.

00:42:31.680 --> 00:42:33.230
What do you do at that point?

00:42:33.840 --> 00:42:34.830
You have a couple of options.

00:42:34.830 --> 00:42:39.890
You can use this command right here
that essentially tells the managed

00:42:40.310 --> 00:42:42.460
client daemon to flush the cache.

00:42:42.460 --> 00:42:46.690
And what then happens is the
next time that user logs in,

00:42:46.690 --> 00:42:51.140
it's going to go to the
Open Directory and reread the record

00:42:51.140 --> 00:42:55.360
and make sure that it has the latest,
greatest, and the most recent settings

00:42:55.360 --> 00:42:57.630
that's been defined for that user.

00:42:57.640 --> 00:43:03.630
If you're in NetInfo Manager,
you can also do it manually in NetInfo.

00:43:03.660 --> 00:43:07.520
And if you're still using Panther,
then manually doing it in NetInfo

00:43:07.520 --> 00:43:11.250
Manager is the only option you
have to kill the cache like that.

00:43:15.280 --> 00:43:19.470
Get a feel for what your
DNS settings are before you start

00:43:19.710 --> 00:43:21.440
binding to Active Directory.

00:43:21.540 --> 00:43:25.880
If DNS for some reason is
screwed up and you're trying to

00:43:25.880 --> 00:43:31.640
get Active Directory to work,
then you're going to send yourself

00:43:31.640 --> 00:43:34.820
up for a pretty interesting day.

00:43:35.520 --> 00:43:38.740
We're not going to argue with
Microsoft when they say that

00:43:38.820 --> 00:43:42.430
they recommend using Microsoft's
DNS servers for Active Directory.

00:43:42.570 --> 00:43:43.810
We play very well with that.

00:43:43.860 --> 00:43:47.160
That is not to say that you
can't use any other DNS server,

00:43:47.160 --> 00:43:48.980
and there are many other good ones.

00:43:50.200 --> 00:43:52.540
But there are a couple of things
that you have to keep in mind.

00:43:52.540 --> 00:43:56.200
The OS X client and the OS X server,
they have to be able to get to the

00:43:56.200 --> 00:43:58.690
service records for Active Directory.

00:43:58.690 --> 00:44:02.450
And those are created automatically when
you set up a DNS server for the first

00:44:02.560 --> 00:44:04.530
time when you create Active Directory.

00:44:04.660 --> 00:44:07.780
So all you do is you just point it to the
Microsoft DNS server and you're there.

00:44:07.780 --> 00:44:12.140
If you have a third-party DNS server,
then you have to make sure that you

00:44:12.140 --> 00:44:16.230
point the client and the OS X server
to a DNS server that contains the

00:44:16.230 --> 00:44:18.800
Active Directory service records.

00:44:18.800 --> 00:44:20.170
Because that's how the ADP works.

00:44:20.330 --> 00:44:24.800
The ADP plugin resolves all
the information it needs to,

00:44:24.840 --> 00:44:27.880
such as finding domain controllers.

00:44:28.070 --> 00:44:34.660
And then also, you want to probably use a
DNS server that supports dynamic DNS.

00:44:34.660 --> 00:44:37.190
That will come in very handy.

00:44:37.190 --> 00:44:41.480
If you want to look at a debug log,
a DS debug log,

00:44:42.110 --> 00:44:47.340
You kill the directory services
by issuing a -usr1 command.

00:44:47.340 --> 00:44:51.000
And what that's going to do is it's
going to create a debug log that's

00:44:51.000 --> 00:44:54.980
going to essentially log everything
that the directory services process

00:44:55.160 --> 00:44:57.210
does until you issue the command again.

00:44:57.240 --> 00:45:01.590
And that log file is stored in library
preferences directory services.

00:45:01.660 --> 00:45:04.530
And it's a very, very good log.

00:45:04.780 --> 00:45:09.450
Directory services is very chatty
and the log file will reflect that.

00:45:09.500 --> 00:45:12.160
And in this case, when you're trying to
troubleshoot something,

00:45:12.160 --> 00:45:13.500
it's actually a good thing.

00:45:13.670 --> 00:45:16.400
Open up in console,
found in the utilities folder,

00:45:16.400 --> 00:45:19.880
you have a handy little window
at the top right where you can

00:45:19.880 --> 00:45:24.240
actually sort by various variables,
sort by AD plugin.

00:45:24.350 --> 00:45:29.280
And the only thing you'll see from
then on in the log is the actual log

00:45:29.280 --> 00:45:34.990
entries that the AD plugin spits out
in the directory services debug log.

00:45:35.530 --> 00:45:38.470
Also,
when you do an integration like this,

00:45:38.470 --> 00:45:41.710
keep in mind how you want
to do the client management.

00:45:41.990 --> 00:45:44.940
Do you want to do a magic
triangle environment?

00:45:45.190 --> 00:45:47.430
Do you want to use
Open Directory for that?

00:45:47.690 --> 00:45:53.160
Do you want to do schema extensions
and extend the Active Directory schema?

00:45:53.280 --> 00:45:56.320
In that case, you need to work with your
AD administrators to do that

00:45:56.320 --> 00:46:00.820
and make sure that they are
aware of what that means.

00:46:00.880 --> 00:46:07.570
Also, DSConfig enable SSO on the
OS X Server will Kerberize the

00:46:07.570 --> 00:46:12.360
services and tell the Kerberize
services what principles to use.

00:46:12.370 --> 00:46:16.710
And that's how you pretty much
tell your OS X Server to use the

00:46:16.710 --> 00:46:19.300
Active Directory Kerberos Realm.