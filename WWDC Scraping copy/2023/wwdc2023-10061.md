# Wwdc2023 10061

## Transcript

More Videos

Streaming is available in most browsers,and in the Developer app.

About

Transcript

Code

Verify app dependencies with digital signaturesDiscover how you can help secure your app's dependencies. We'll show you how Xcode can automatically verify any signed XCFrameworks you include within a project. Learn how code signatures work, the benefits they provide to help protect your software supply chain, and how SDK developers can sign their XCFrameworks to help keep your apps secure.Chapters2:18 -Dependency signatures9:00 -App developers12:11 -SDK authorsResourcesVerifying the origin of your XCFrameworksHD VideoSD VideoRelated VideosWWDC23Get started with privacy manifestsWhat’s new in Xcode 15

Discover how you can help secure your app's dependencies. We'll show you how Xcode can automatically verify any signed XCFrameworks you include within a project. Learn how code signatures work, the benefits they provide to help protect your software supply chain, and how SDK developers can sign their XCFrameworks to help keep your apps secure.

2:18 -Dependency signatures

9:00 -App developers

12:11 -SDK authors

Verifying the origin of your XCFrameworks

HD VideoSD Video

HD Video

SD Video

Get started with privacy manifests

What’s new in Xcode 15

Search this video…♪ ♪Kay: Hey, this is Kay from Privacy Engineering.I'm here to introduce a new and exciting Privacy and Security feature in Xcodethat will help you automatically verify the integrity of your dependencies.At Apple, we believe that privacy should beat the core of everyone's development process,as much as it is at the core of our products.Dependency signature verification within Xcodewill help app developers protect their appsand dependency authors protect the SDKs they distribute.Apps are developed using a range of SDKs.For example, the iOS SDK.Some are made by Apple, some by app developersto use across all of their apps,and some that app developers obtain from other sources.These form the app's supply chain and can include frameworks,Swift source files, and other types of dependencies.Using third party SDKs can make app development significantly easierand can provide extended functionality.However, this does introduce risks.Supply chain security is the process of mitigating these risks.You have the responsibility of protecting your usersby being selective of what dependencies you includeand to ensure that you don't accidentally use a versionthat has been maliciously modified.This responsibility also extends to SDK authorswho include other SDKs as part of their development.The processes and tools available to mitigate these riskscan be burdensome or complex to do manually.Dependency signature verification is a new Xcode featurethat can make this task easy and automatic.Now that you know what supply chain security is,I will talk about the role that digital signatures playin protecting developers and in helping reduce this burden.To begin, I will give you an overviewon how Apple's code signing technology worksand what Xcode now does to verify the signaturesof your dependencies.And then I will talk about how app developers can use this featureto ensure that their dependencies haven't been compromised.And finally, I will discuss what SDK authors can doto improve the security of the ecosystem.I'll get started with how Apple's code signing technology works.When you are developing an SDK for app developers to use,you want to ensure that no one can modify or tamper with itduring its distribution to your SDK clients.Code signing is a mechanism to cryptographically linkthe final complied binary and the associated metadatasuch as the Info.plistor the privacy manifest for your frameworkor, for certain types of distribution,the source code itself, with your developer identity.At a high level, code signing worksby first generating a Code Directory hash,also known as the CDHash, of your compiled binary.To then sign this hash, you use your developer identity.This identity is represented by your developer certificate.It is made up of a private key that is used for code signingand a public key that is distributed as part of the signature.This signature can be tied back to your identity.This identity is then used to sign the hashand can be combined with a secure timestampthat is used to validate that the signature was generatedat a specific point in time.This ensures that if anyone tampers with your SDK,the signature will no longer be valid.It also allows app developers to verify that it was you who signed it,using the certificate that is embedded into the signature.A common type of dependency that you may use in your appis the xcframework.With xcframeworks, the signature resideswithin the _CodeSignature directory.The code signature protects the integrity of all the filesinside your final xcframework, including the privacy manifest filesthat are mentioned in the WWDC23 video"Get started with privacy manifests."It's possible for you to manually verify these code signaturesfor every version of every xcframework you include within your app,but this is a time-consuming processand places a burden on you in order to get the security benefits.Signature verification is a new feature in Xcodethat automatically handles the verificationof your app's dependencies and protects your supply chain integrityby alerting you if an issue is detected.Xcode 15 now has tools to help you automatically track the identitiesused to sign any xcframeworks that you include in your project.Xcode now shows a new section in the Inspectorthat displays the signature statusfor the xcframeworks you include within your app.This section includes information about the signature,such as the author's identity.It will show whether the xcframework is signedby an Apple Developer Program identity, signed by a self-signed certificate,or currently unsigned at all.In addition, Xcode will record the identitythe first time you use the xcframeworkand verify that it does not change during later builds.For different developer identities,Xcode provides differing levels of featuresbased on the trust in the identity that was usedfor a particular xcframework.For Apple Developer Program identities,Apple is able to check the validity of the certificate used,including if it's been revoked,and ensure that multiple developers can't register with the same name.If the certificate used is self-signed,app developers should confirm its validity and authenticitydirectly with the dependency author.When the xcframework author's signing certificate expires,Xcode is able to automatically validatethat a new certificate for Apple Developer Program identitiesis from the same developer.For self-signed certificates, you will need to manually verifythat this change was legitimate, as there is no attestationof the certificate by a trusted party, like Apple.When the dependency is signed by an Apple Developer Program identity,Xcode will verify it on buildand show you an alert if the signature is not valid,the identity has changed, or the xcframework was signedafter the certificate had expired.Xcode will also alert youif the Apple Developer Program certificate has been revoked by Apple.This can happen if Apple determines that the developer account is malicious.These alerts will be rareand will automatically ensure you don't build your appuntil you've resolved the issue.If this does happen, Xcode will offerto let you remove the xcframework from the project.For self-signed identities,Xcode will still compare the certificate's SHA-256 fingerprintwith the one that was previously added to the project.It will show you an alert if the identity has changedor if the contents of the dependency have been modified.You may need to contact the xcframework authorto ensure the fingerprint matches what they have used,or an xcframework author can publish this information.And that's how digital signatures work on xcframeworks.Next, let me show youhow an app developer can use this feature in Xcode.To demonstrate, I'm going to use the Backyard Birds sample app.It provides a digital birding experience where you own multiple backyards,are able to put bird food and water out,and see when bird visitors show up.I plan on using an xcframework called BirdFeederto automate the food and water refilling process.The author of the BirdFeeder xcframework has signed the most recent release.Here, I've added the BirdFeeder into my project.For xcframeworks, Xcode 15 will have a "Signature" view in the Inspector.This displays the certificate signing information,showing the team details.The xcframework developer's identity will be stored in the projectthe first time it is seen.During the build, Xcode will validate that the identity usedto sign the BirdFeeder xcframework matches the expected identity in the project.It built successfully.To simulate a supply chain attack,I'll pretend that someone gave mean updated version of the BirdFeeder xcframeworkthat they said added many new exciting featuresand gave better performance.This could also happen to you when you download an xcframeworkfrom a website that you do not fully trust.Here, I replaced my previous version with this updated one.When I build my app, Xcode verifies the signaturesof all the xcframeworks within the app.The build failed, pointing out that BirdFeeder developer's identitydoes not match what was previously recorded in the project.Selecting the error offers an alertexplaining that the developer's identity has changed,showing how the expected identity compares to what is present in the new version.In this case, it shows that the expected certificate wasan Apple Developer Program Certificate,but the one in the project uses a self-signed certificate.This could mean that the xcframework has been compromisedor the change was legitimate.For example, they might have transferred ownershipof the xcframework to another developer.It's always safe to cancel if you're unsure.This gives you time to investigate if the change was genuine.Xcode protects you and your apps by ensuring that if this change happens,you will be notified automatically.In this case, the change wasn't expected,so I will move this new version to trash in Xcode.However, if you know the change is legitimate–for example, the developer has communicated this to youvia a verified public channel– then you could accept the change.Finally, I will talk about what this feature means to SDK authors.It is important for SDK authors to cryptographically sign SDKsbecause it allows an app developer to confirm the identityand guarantees that the code has not been altered or tampered withafter it was signed.Both of these properties are extremely importantfor building trust and safely distributing SDKs.As discussed earlier, there are two types of identitythat you can use: Apple Developer Program and self-signed.Members of the Apple Developer Program should use the certificates includedas part of this program to ensure the trust of your SDK clients.You should use the Apple Distribution certificateif you publish your SDKor the Apple Development certificate if you are distributing test versions.Enterprise Program members should use their iOS Distributionor App Development certificates.When Apple issues a certificate to you, Apple is attesting to the factthat you are a legitimate member of the Apple Developer Programand have met all the necessary requirementsto obtain the certificate.This includes verifying your identity and adherence to Apple's policiesand guidelines around privacy and security.If you manually revoke the certificate used to sign an SDK,you will need to release an updated versionsigned using a valid certificate,as Xcode will no longer be able to verify the signaturewhen a developer attempts to build their app.An SDK that has been signedwith an Apple Developer Program certificatehas a baseline level of trustand ensures that the SDK has not been tampered with.On top of that, because Apple is the trusted authority,certificate validation is automatically handledwhen a new certificate is generated.At the start of this video, I discussed how code signing worksand how it includes a signature within your SDKusing your developer identity.Let's now go through how you can do this using the codesign tool.You can sign your xcframeworks using the command hereand your Apple Developer Program identity.The timestamp flag is includedto ensure that the signature contains a secure timestampthat is attested to by Apple.However, if you aren't a member of the Apple Developer Program,you can generate a self-signed certificateand use it with the codesign command.You are responsible for sharing with your SDK clientsthe fingerprint of this certificateso that you can verify the xcframework was signed by you.Developers including your SDK in their appwill be able to confirm that the xcframework was signed by youby using the new feature included in Xcode.If you always sign the SDKs you distribute,this new feature in Xcode will help your SDK clientsget more confidence in their supply chain.Doing this is simple.You can start straight away with versions of your frameworksthat you've already published with no new build required.This even works using a self-signed certificateif you are not currently a member of the Apple Developer Program.You can then do this for all new versions of your xcframeworksby including the codesign command in a build script,so that you no longer need to worry.For app developers, Xcode 15 will automatically help youensure the integrity and security of your apps' underlying SDKs.Making sure that all SDK signatures are verifiedis an important aspect of responsible app developmentand protecting your users.You can help by encouraging the developers in your supply chainto start signing the SDKs they publish.For SDK authors, start signing your SDKsto ensure their security and authenticity.By signing your code, you establish trust with your SDK clients,showing them that you take their security and privacy seriously.Happy app development!This is Kay, signing off.♪ ♪

♪ ♪Kay: Hey, this is Kay from Privacy Engineering.I'm here to introduce a new and exciting Privacy and Security feature in Xcodethat will help you automatically verify the integrity of your dependencies.At Apple, we believe that privacy should beat the core of everyone's development process,as much as it is at the core of our products.Dependency signature verification within Xcodewill help app developers protect their appsand dependency authors protect the SDKs they distribute.

Apps are developed using a range of SDKs.For example, the iOS SDK.Some are made by Apple, some by app developersto use across all of their apps,and some that app developers obtain from other sources.These form the app's supply chain and can include frameworks,Swift source files, and other types of dependencies.Using third party SDKs can make app development significantly easierand can provide extended functionality.However, this does introduce risks.

Supply chain security is the process of mitigating these risks.You have the responsibility of protecting your usersby being selective of what dependencies you includeand to ensure that you don't accidentally use a versionthat has been maliciously modified.This responsibility also extends to SDK authorswho include other SDKs as part of their development.The processes and tools available to mitigate these riskscan be burdensome or complex to do manually.

Dependency signature verification is a new Xcode featurethat can make this task easy and automatic.

Now that you know what supply chain security is,I will talk about the role that digital signatures playin protecting developers and in helping reduce this burden.To begin, I will give you an overviewon how Apple's code signing technology worksand what Xcode now does to verify the signaturesof your dependencies.And then I will talk about how app developers can use this featureto ensure that their dependencies haven't been compromised.And finally, I will discuss what SDK authors can doto improve the security of the ecosystem.I'll get started with how Apple's code signing technology works.

When you are developing an SDK for app developers to use,you want to ensure that no one can modify or tamper with itduring its distribution to your SDK clients.Code signing is a mechanism to cryptographically linkthe final complied binary and the associated metadatasuch as the Info.plistor the privacy manifest for your frameworkor, for certain types of distribution,the source code itself, with your developer identity.

At a high level, code signing worksby first generating a Code Directory hash,also known as the CDHash, of your compiled binary.

To then sign this hash, you use your developer identity.This identity is represented by your developer certificate.It is made up of a private key that is used for code signingand a public key that is distributed as part of the signature.This signature can be tied back to your identity.This identity is then used to sign the hashand can be combined with a secure timestampthat is used to validate that the signature was generatedat a specific point in time.This ensures that if anyone tampers with your SDK,the signature will no longer be valid.It also allows app developers to verify that it was you who signed it,using the certificate that is embedded into the signature.

A common type of dependency that you may use in your appis the xcframework.With xcframeworks, the signature resideswithin the _CodeSignature directory.The code signature protects the integrity of all the filesinside your final xcframework, including the privacy manifest filesthat are mentioned in the WWDC23 video"Get started with privacy manifests."It's possible for you to manually verify these code signaturesfor every version of every xcframework you include within your app,but this is a time-consuming processand places a burden on you in order to get the security benefits.Signature verification is a new feature in Xcodethat automatically handles the verificationof your app's dependencies and protects your supply chain integrityby alerting you if an issue is detected.Xcode 15 now has tools to help you automatically track the identitiesused to sign any xcframeworks that you include in your project.

Xcode now shows a new section in the Inspectorthat displays the signature statusfor the xcframeworks you include within your app.This section includes information about the signature,such as the author's identity.It will show whether the xcframework is signedby an Apple Developer Program identity, signed by a self-signed certificate,or currently unsigned at all.In addition, Xcode will record the identitythe first time you use the xcframeworkand verify that it does not change during later builds.For different developer identities,Xcode provides differing levels of featuresbased on the trust in the identity that was usedfor a particular xcframework.For Apple Developer Program identities,Apple is able to check the validity of the certificate used,including if it's been revoked,and ensure that multiple developers can't register with the same name.If the certificate used is self-signed,app developers should confirm its validity and authenticitydirectly with the dependency author.

When the xcframework author's signing certificate expires,Xcode is able to automatically validatethat a new certificate for Apple Developer Program identitiesis from the same developer.For self-signed certificates, you will need to manually verifythat this change was legitimate, as there is no attestationof the certificate by a trusted party, like Apple.When the dependency is signed by an Apple Developer Program identity,Xcode will verify it on buildand show you an alert if the signature is not valid,the identity has changed, or the xcframework was signedafter the certificate had expired.Xcode will also alert youif the Apple Developer Program certificate has been revoked by Apple.This can happen if Apple determines that the developer account is malicious.These alerts will be rareand will automatically ensure you don't build your appuntil you've resolved the issue.If this does happen, Xcode will offerto let you remove the xcframework from the project.For self-signed identities,Xcode will still compare the certificate's SHA-256 fingerprintwith the one that was previously added to the project.It will show you an alert if the identity has changedor if the contents of the dependency have been modified.You may need to contact the xcframework authorto ensure the fingerprint matches what they have used,or an xcframework author can publish this information.And that's how digital signatures work on xcframeworks.Next, let me show youhow an app developer can use this feature in Xcode.To demonstrate, I'm going to use the Backyard Birds sample app.It provides a digital birding experience where you own multiple backyards,are able to put bird food and water out,and see when bird visitors show up.I plan on using an xcframework called BirdFeederto automate the food and water refilling process.The author of the BirdFeeder xcframework has signed the most recent release.Here, I've added the BirdFeeder into my project.For xcframeworks, Xcode 15 will have a "Signature" view in the Inspector.This displays the certificate signing information,showing the team details.The xcframework developer's identity will be stored in the projectthe first time it is seen.During the build, Xcode will validate that the identity usedto sign the BirdFeeder xcframework matches the expected identity in the project.It built successfully.To simulate a supply chain attack,I'll pretend that someone gave mean updated version of the BirdFeeder xcframeworkthat they said added many new exciting featuresand gave better performance.This could also happen to you when you download an xcframeworkfrom a website that you do not fully trust.Here, I replaced my previous version with this updated one.

When I build my app, Xcode verifies the signaturesof all the xcframeworks within the app.The build failed, pointing out that BirdFeeder developer's identitydoes not match what was previously recorded in the project.Selecting the error offers an alertexplaining that the developer's identity has changed,showing how the expected identity compares to what is present in the new version.In this case, it shows that the expected certificate wasan Apple Developer Program Certificate,but the one in the project uses a self-signed certificate.This could mean that the xcframework has been compromisedor the change was legitimate.For example, they might have transferred ownershipof the xcframework to another developer.It's always safe to cancel if you're unsure.This gives you time to investigate if the change was genuine.Xcode protects you and your apps by ensuring that if this change happens,you will be notified automatically.

In this case, the change wasn't expected,so I will move this new version to trash in Xcode.However, if you know the change is legitimate–for example, the developer has communicated this to youvia a verified public channel– then you could accept the change.

Finally, I will talk about what this feature means to SDK authors.It is important for SDK authors to cryptographically sign SDKsbecause it allows an app developer to confirm the identityand guarantees that the code has not been altered or tampered withafter it was signed.Both of these properties are extremely importantfor building trust and safely distributing SDKs.As discussed earlier, there are two types of identitythat you can use: Apple Developer Program and self-signed.

Members of the Apple Developer Program should use the certificates includedas part of this program to ensure the trust of your SDK clients.

You should use the Apple Distribution certificateif you publish your SDKor the Apple Development certificate if you are distributing test versions.Enterprise Program members should use their iOS Distributionor App Development certificates.When Apple issues a certificate to you, Apple is attesting to the factthat you are a legitimate member of the Apple Developer Programand have met all the necessary requirementsto obtain the certificate.This includes verifying your identity and adherence to Apple's policiesand guidelines around privacy and security.If you manually revoke the certificate used to sign an SDK,you will need to release an updated versionsigned using a valid certificate,as Xcode will no longer be able to verify the signaturewhen a developer attempts to build their app.An SDK that has been signedwith an Apple Developer Program certificatehas a baseline level of trustand ensures that the SDK has not been tampered with.On top of that, because Apple is the trusted authority,certificate validation is automatically handledwhen a new certificate is generated.At the start of this video, I discussed how code signing worksand how it includes a signature within your SDKusing your developer identity.Let's now go through how you can do this using the codesign tool.

You can sign your xcframeworks using the command hereand your Apple Developer Program identity.The timestamp flag is includedto ensure that the signature contains a secure timestampthat is attested to by Apple.However, if you aren't a member of the Apple Developer Program,you can generate a self-signed certificateand use it with the codesign command.You are responsible for sharing with your SDK clientsthe fingerprint of this certificateso that you can verify the xcframework was signed by you.Developers including your SDK in their appwill be able to confirm that the xcframework was signed by youby using the new feature included in Xcode.If you always sign the SDKs you distribute,this new feature in Xcode will help your SDK clientsget more confidence in their supply chain.Doing this is simple.You can start straight away with versions of your frameworksthat you've already published with no new build required.This even works using a self-signed certificateif you are not currently a member of the Apple Developer Program.You can then do this for all new versions of your xcframeworksby including the codesign command in a build script,so that you no longer need to worry.For app developers, Xcode 15 will automatically help youensure the integrity and security of your apps' underlying SDKs.Making sure that all SDK signatures are verifiedis an important aspect of responsible app developmentand protecting your users.You can help by encouraging the developers in your supply chainto start signing the SDKs they publish.For SDK authors, start signing your SDKsto ensure their security and authenticity.By signing your code, you establish trust with your SDK clients,showing them that you take their security and privacy seriously.

Happy app development!This is Kay, signing off.♪ ♪

14:37 -Signing an XCFramework

## Code Samples

```swift
codesign --timestamp -v --sign 
"Apple Distribution: Truck to Table (UA527FUGW7)"
 BirdFeeder.xcframework
```

