# Wwdc2022 10045

## Transcript

More Videos

Streaming is available in most browsers,and in the Developer app.

About

Transcript

Code

What's new in managing Apple devicesExplore enhancements to device management across Apple platforms. Improve device deployment workflows using the latest version of Apple Configurator for iPhone. Learn about identity technologies and MDM protocol updates for macOS, iOS and iPadOS. We'll also share an exciting change in how we provide device management documentation.ResourcesApple Configurator User Guide for iPhoneApple Platform DeploymentApple Platform SecurityAppleSeedDevice ManagementDevice Management Client Schema on GitHubHD VideoSD VideoRelated VideosWWDC22Adopt declarative device managementDiscover Managed Device AttestationDiscover Sign in with Apple at Work & SchoolExplore Apple Business EssentialsWWDC21Manage devices with Apple ConfiguratorManage software updates in your organization

Explore enhancements to device management across Apple platforms. Improve device deployment workflows using the latest version of Apple Configurator for iPhone. Learn about identity technologies and MDM protocol updates for macOS, iOS and iPadOS. We'll also share an exciting change in how we provide device management documentation.

Apple Configurator User Guide for iPhone

Apple Platform Deployment

Apple Platform Security

AppleSeed

Device Management

Device Management Client Schema on GitHub

HD VideoSD Video

HD Video

SD Video

Adopt declarative device management

Discover Managed Device Attestation

Discover Sign in with Apple at Work & School

Explore Apple Business Essentials

Manage devices with Apple Configurator

Manage software updates in your organization

Search this video…♪ Mellow instrumental hip-hop music ♪♪Nadia Hussein: Welcome to WWDC!I'm Nadia, and my colleague Graham and I are so thrilledto tell you about all the new device management featureswe have for macOS Ventura and iOS and iPadOS 16.In the world of device management,it's our shared responsibility to enable employeesto thrive in the workforceand increase student-teacher productivity.We're continuously developing the tools and technologyto help foster this collaboration.And with macOS Ventura and iOS and iPadOS 16,there are many great enhancements and features,some of which we'll cover in this session.But first, I'd like to briefly highlighta few of the additional sessions where you can discovereven more about the enterprise and education space.During WWDC 2021,we introduced declarative device management,a new paradigm for device managementthat makes devices more autonomous and proactive,while allowing servers to be lightweight and reactive.This year we are expanding declarative device managementwith new platform support and new features.Be sure to watch the session,"Adopt declarative device management."Apple Business Essentials is one complete subscriptionthat seamlessly brings together device management,24/7 support, and cloud storage.With Apple Business Essentials,small businesses can easily manage every iPhone, iPad,Mac, and Apple TV every step of the way.Check out the session, "Explore Apple Business Essentials"to learn more.Managed device attestation is a new security featurethat uses the Secure Enclaveto provide strong assurances about a client device,such as its identity and software version.Attend the session, "Discover Managed Device Attestation"for additional information.In this session, we're going to discussnew capabilities with Apple Configurator;identity technologies across platforms;protocol modifications to macOS Ventura,iOS and iPadOS 16;and an exciting change to how we provide documentation.Let's start with Apple Configurator.At WWDC 2021, we announced Apple Configurator for iPhone.Education and enterprise customerslove having this solution to take advantageof automated device enrollment for all of their Macs.Apple Configurator for iPhone makes it easy to add a Macpurchased outside of the normal channelto their organization in Apple School Manageror Apple Business Manager.In Setup Assistant on a Mac,simply hold your iPhone running Configuratorover the animation.The Mac will then connect to the internetand add itself to your organization.Version 1.0.1 brought new, explicit supportfor taking advantage of existing network connectivityif available on the Mac.And we are excited to announce that with iOS and iPadOS 16,Apple Configurator for iPhone can now also addiPhone and iPad devices to your organization.This works just as you expect, just like adding a Mac.It's a great new alternative to the version of this featurein Configurator for Mac,which requires connecting each device via USBto the Mac running Configurator.A key difference for iOS and iPadOSis which pane in Setup Assistant you scan.On iOS and iPadOS, that's Wi-Fi,but on macOS, it's country or region.And remember, any device that requires interactive activation,such as activation lock or cellular carrier activation,must be handled manuallybefore adding it to your organization,just like Configurator for Mac.Devices running iOS or iPadOS 16can be added using the version of Apple Configurator for iPhonecurrently in the App Store.Now, lets cover identity managementfor business and education.We know identity management is important for the industryand it's a key priority for Apple as well.It enables our users to have a cohesive experience,while ensuring security of their data.Our goal for identity is for users to sign in once,and from then on,use that identity consistently across the operating system.We're working towards that goal,and there's a lot of technology that supports that,including the new features in macOS Venturaand iOS and iPadOS 16.For Federated Authentication, Apple Business Managernow integrates with Google Workspaceas an Identity Provider.This allows users to leverage their work credentialsas Managed Apple IDs for authentication to serviceson iOS, iPadOS, and macOS.And remember, use Directory Sync --which we've formerly referred to as SCIM --to create the user accounts as Managed Apple IDs automatically.Sign in with Apple can now be used at work and schoolwith Managed Apple IDs.In apps that support Sign in with Apple,this will just work!If you want to control where users can sign in,you can choose to allow all appsor add apps to an explicit allow listin Apple School Manager or Apple Business Manager.Learn more in the session,"Discover Sign in with Apple at Work & School."Another notable identity management updateis OAuth support.In iOS and iPadOS 15,we used a simple access token authorization mechanismto allow the MDM server to verify the identity of users.In iOS and iPadOS 16, we are adding OAuth 2as another authorization mechanism.OAuth opens the door for MDM serversto support a wide variety of identity providersalready using OAuth today.It also improves security via its refresh token mechanism,which allows a short-lived access token to be usedin conjunction with a silent refreshthat won't prompt the user for credentials.OAuth can be used with the existingaccount-driven user enrollment flow,but it provides an even better user experiencewhen combined with a cool new feature.We call it Enrollment Single Sign-on,or Enrollment SSO.It's a new, faster method for personal devicesto complete an MDM enrollmentand access your organization's apps and websiteswith a single authentication.This builds upon a few existing technologies.iOS 13 introduced extensible SSO as a new way to configure SSOfor an organization's apps and websites.And iOS and iPadOS 15introduced Account-Driven User Enrollment,which allows users to enroll in MDMby just entering their email address in Settings.To make enrollment even better,we combined these two technologies togetherbecause we know BYOD devicesare an important part of your deployment.Users start out by entering their email address in Settings.They are then prompted to download an appfrom the App Store.This app, which containsan Enrollment Single Sign-on extension,provides a native UI to perform the authentication steps.Because this is an app-based model,you can use any authentication technology you choose.As a user, sign in once.The app will then sign in to get you through the enrollment flowwithout having to sign in again.There are four main pieces required to bringEnrollment Single Sign-on to life.First, the app developer updates their appto support enrollment SSO.Next, MDM vendors federate MDM protocolclient authentication with an identity provider.Then administrators set up Managed Apple IDsusing Apple School Manager or Apple Business Managerand finally, configure the MDM Server to return a URLto the JSON documentin the authentication response headers.Now that we've talked about what this feature doesand who needs to do what, let's dive into the details.When the initial authentication challenge from the serveris received, there will be an HTTP header presentindicating that Enrollment Single Sign-on is availableand should be used.That header's value will be a URL that the client will useto download a JSON document.The JSON document contains all the detailsthe client needs to continue the enrollment.The value for the iTunesStoreID keymust refer to the Enrollment Single Sign-on appto be used during enrollment.The AssociatedDomains keys are the same keys availablein ApplicationAttributes and can be configured here as well.Finally, the ConfigurationProfileshould be a Base64EncodedProfilethat contains at least one Extensible SSO payloadand may contain certificate payloads if needed.And we'll be shipping this feature for customersin a later release of iOS and iPadOS 16.If you are interested in developing an appthat supports this feature,you'll need to apply for a new entitlementthough the Apple Developer Program.However, you can start developing for this nowusing test mode.This is a special versionof the Enrollment Single Sign-on processthat allows you to test your appbefore it's even offered on the App Store.To get started with test mode,head to the Developer section of Settingsand enable Enrollment Single Sign-on test mode.You'll then need to configure your authentication responsewith the new HTTP headerand the corresponding JSON document.Then, in VPN and Device Management,start the enrollment process.During the enrollment,you'll be prompted to install the Single Sign-on app.You can install the app using any method availablefrom Xcode to TestFlight or even Enterprise app distribution.After that, return to Settings and complete the enrollment.To use test mode, there is a different header requiredin the response and a modified JSON document.Here's an example of the JSON document for test mode.You'll notice the iTunesStoreID keyhas been replaced by the AppIDs keyand the value of this key is an array of stringscontaining the App IDs that can be used for enrollment.Everything else remains the same.Next, let's explore Single Sign-on extensions.In 2019, we added Single Sign-On extensionsto iOS 13 and macOS Catalinato enable identity providers to use SSO authenticationfor all the apps and websites for their users.When using SSO extensions,the user is prompted to sign in to the extensionafter they've unlocked the device,which means entering credentials twice.If an organization also uses the built-in Kerberos extension,the user may have to sign in again.In many cases, these are all identical credentials.Well, in macOS Ventura, we're introducingPlatform Single Sign-On -- or Platform SSO --to enable users to sign in once at the login windowand then automatically sign in to apps and websites.Platform SSO makes tokens from the loginavailable to third-party SSO extensionsand also works with the built-in Kerberos extension.The first login authenticates with a local account password,which also unlocks FileVault encryption on the device.This enables the user to login when offlineor when connected to captive networks.From then on, their identity provider passwordcan be used for unlock.Additionally, Platform SSO supports the use of a passwordor a Secure Enclave backed keyto authenticate with the identity provider.And regardless of the authentication method,the SSO tokens are retrieved from the identity provider,stored in the keychain,and made available to the SSO extension.Kerberos TGTs can also be retrieved,imported to a credential cache,and optionally shared with the Kerberos extension.If the identity provider password changes,Platform SSO will validate that new passwordwith the identity provider on unlock.Platform SSO is a fully integrated protocolthat is built using OAuth and OpenIDand does not use web views for authentication.Platform SSO is the modern replacement for AD bindingand mobile accounts.Note, it does not directly use directory services,or check with the identity providerfor each unlock attempt.Instead, the identity provider is only calledwhen the user is attempting to use a new password at unlockor to retrieve SSO tokens.Platform SSO also does not prevent logging in to the Macbased on the response from the identity provider.For that purpose, leverage MDMor alternative strategies to disable access.To take advantage of this feature,the identity provider needs to implement the SSO protocoland update their SSO extension,then ensure the extensible SSO profile is updatedto support the new keys on managed devices.Find more implementation detailsin the Apple Platform Deployment guide.To recap, we've introduced integrationwith Google Workspace, Enrollment SSO,OAuth support, and Platform SSO,to contribute to a simplified sign-in experience.Identity management is an ever-evolving technologyand we are just getting started.macOS Ventura brings many enhancements across OS updates,enrollment, and security.Let's start with software updates.macOS Monterey introduced fundamental changesto Managed Software Updates.My colleague Lucy covered this in the session,"Manage software updates in your organization,"where we break down OS updates into three areas:test, deploy, and enforce.This year, we focus on even more additionsto deploy and enforce.Historically, all OS Update commands would return a NotNowwhen sent while in Power Nap mode.To ensure a more consistent and robustOS Update deployment process, the device will now acknowledgeand respond to ScheduleOSUpdate, OSUpdateStatus,and AvailableOSUpdate commandseven when the device is asleep or in Power Nap mode.Since we also understand that sometimes administratorswant an OS update as soon as possible,we've introduced a new key called "priority"sent via the ScheduleOSUpdate command.Accepting a string value of High or Low,it controls the scheduling priorityfor downloading and preparing the requested update.Sending the command with a High prioritywill mimic as if the user had requested the update themselvesin system settings.Note that this key is only supported for minor OS updates.In macOS 12.3, we added even more admin visibilityinto the logs and reporting with the OSUpdateStatus command.DeferralsRemaining indicates how many notifications are leftto prompt the user to update.MaxDeferrals reveals the total number of timesa user is allowed to defer the OS update notifications.NextScheduledInstall is the date that the OSwill attempt to install the update next.And finally, PastNotifications is the exact dates and timeswhen the notification was posted to the user.All of these updates to the OSUpdateStatus commandwill be useful for administratorsto have further clarity into the compliance of their users.macOS Ventura and iOS and iPadOS 16are introducing a new mechanismto ship critical security fixes to users more quickly.It does not modify the firmware,and the user can also remove the Rapid Security Responseif necessary.We are introducing two restriction keys for this.Use allowRapidSecurity ResponseInstallationto disable this new security response mechanism,and use allowRapidSecurity ResponseRemovalto block the end userfrom being able to remove a Rapid Security Response.Now, let's cover a couple enrollment changes.Automated device enrollment provides a streamlined processfor the device to be unboxed, activated,and enrolled in the organization's MDM solution.In an upcoming release,after erasing or restoring a Mac,an internet connection will be requiredto go through Setup Assistantfor devices registered to your organizationin Apple School Manager or Apple Business Manager.Once the Mac is set up for the first timeand connected to a network,the Mac is acknowledged as owned by an organization.If later on, for example, MDM initiatesan Erase All Content and Settingsor the device is restored with Configurator,then the network --and therefore, device enrollment --cannot be bypassed in Setup Assistant.Stay tuned with the AppleSeed for ITrelease notes for timing.The profiles command line tool has been a staplefor MDM deployments, migrations, and reportingin admins' tool kits for many years now,and we have an update to how it works as of macOS Ventura.Profiles tool will startenforcing rate limiting on macOS.This will only be fororganization-owned enrollment typesand to the show, renew, and validate commands.Each command has a maximum of 10 requests per dayfrom the server, and if that number is exceeded,the results will return cached information.When you don't want to use one of the 10 requests,the show command has a new, optional flagto return cached information.Refer to the profiles manual pagefor more detailed information.In each release of macOS, we continue to improveprotection capabilities for our users.Here are a few upcoming security changes to be aware of.In iOS 10.3, we introduced a changein the default TLS trust policy for certificate payloadsto enhance overall protection for our users.In a future release, we'll be bringing it to macOS,meaning manually-installed certificate payloadswill no longer be trusted for TLS purposes,unless the user grants them that trust using Keychain Access.Note, we will still continue full certificate trustif it's a certificate embedded in an MDM profile,but be sure to update any workflowsif it involves interactive certificate installation.Next, "Allow accessories to connect" on macOSaims to protect our customers from close-access attacks.Supported on portable Macs with Apple silicon,the initial configuration is to ask the userto allow new Thunderbolt or USB accessories,even when unlocked.Approved accessories can connect to a locked Macfor up to three days.If you attach an unknown accessory to a locked Mac,you will be prompted to unlock the Mac.From an MDM perspective, we understand this mayimpact enterprise and education workflowssuch as bulk provisioning or test taking.To address this, we are leveraging the same restrictionoffered on iOS and iPadOS for macOS.The existing allowUSBRestrictedMode restrictionwill allow wired accessoriesto always connect without any limitation.It provides authorizationto bypass the requirement of user consent.Also remember,this inherently makes your user's system less secure,so please only use this restriction if you havea legitimate business need to do so.For other restrictions and payload modifications,such as the new allowUniversalControland UIConfigurationProfileInstallation,be sure to check out the documentation.Thanks for listening to the exciting changescoming to macOS Ventura.Now I'm going to hand it over to Graham to talk about iOS.Graham McLuhan: Thank you, Nadia!I'm really excited to be here today to tell you abouta ton of great new device management featuresin iOS and iPadOS 16.We know managing network traffic on devicesis an important way to improve the security of your data.There are three main waysthat you can manage traffic on Apple devices:VPN, DNS Proxy, and Web Content Filter.For many years now, we've offered per-app VPN --and in fact, for user-enrolled devices,this is the only type of VPN available to MDM.In iOS and iPadOS 16,we're expanding our per-app offeringsto include DNS Proxy and Web Content Filter.These features will be available on all enrollment typesbut we think they'll be particularly usefulfor user enrollmentsince this is the first time organizationscan secure their app traffic in this way for BYOD.Configuring these new features is a two-step processthat will feel very similar to Per-App VPN.Let's take a quick look at how it's done.First you'll need to add a new key value pairto each payload.In the Web Content Filter payload,ContentFilterUUID.And for DNS Proxy, DNSProxyUUID.There are a few things to be aware of with these keys.First, the values for these keys can be any arbitrary string.And second, when this key is added to the payload,it can only be installed via MDM.Now, we need to configure the apps to use these new features.Using either the InstallApplication commandor the Settings command,add the same UUID to the attributes of the appthat will use the per-app feature.In this example, we included both keys,but you can just include one or the other.A few additional details I'd like to point out.First, app developers don't need to do anything new!All existing DNS Proxy and Web Content Filter appswill just work.Second, you can have multiple DNS Proxiesbut you cannot mix system-wide and per-app proxies.And finally, for Web Content Filters,you can have up to seven per-app filtersand one system-wide filter.Next, I'd like to talk about managing eSIMs.eSIM has become the new standardfor carriers around the world, and over the last few years,we've added a number of MDM featuresto make managing eSIM easier than ever.We wanted to take a moment to talk about how MDM vendorscan bring all these features togetherto make for a better experience.When we talk to organizations using eSIM,some of the primary tasks they are doingare provisioning new devices,migrating devices between carriers,and supporting users with requirementssuch as multiple carriers or traveling and roaming.To accomplish these goals,they need to query data from enrolled devicesand provide that data to carriers.And second, they need the abilityto install an eSIM on a device.Let's begin by discussing the device queryand carrier data requirements.The DeviceInformation query is the easiest wayto collect data from a device.And in iOS 12, the ServiceSubscriptions keybecame the one stop shop for collecting all datarelating to cellular on iPhone and iPad.A few points you may find useful when looking at these responses.Devices that return two items in the ServiceSubscriptionssupport two active cellular plans.If the response contains an EID, it's an eSIM.Newer devices like iPhone 13 and iPhone SE (3rd generation)support dual active carrier eSIM profilesso it's possible to have more than one eSIMreturned in the ServiceSubscriptions response.Note that the EID is unique per device.Starting with iOS and iPadOS 16,otherDeviceInformation queries that return datawhich also appear in the ServiceSubscriptions responseare deprecated and will no longer be returnedin a future version of the operating system.Now that we know how to get data from the device,let's take a look at what we need to give to the carrier.In general, they require four pieces of datato get an eSIM set up for a device:IMEI, EID, serial number, and phone number.Giving your admins the ability to generate reportscontaining all this data will make it easier for themto get up and running with eSIM.Let's pull this all together and reviewhow eSIMs get provisioned.First, the MDM server uses the ServiceSubscriptions queryto collect the required data from the device.Then, the admin will send that data to the carrier.And finally, the carrier will provision eSIMs for the deviceon their eSIM server.We can now shift our focusto getting the eSIM installed on the device.The carrier will provide the customer with a server URLwhere devices can fetch an eSIMusing the RefreshCellularPlans command.The MDM server will sendthe RefreshCellularPlans command to the devicewhich will initiate a request to the carrier's eSIM serverand check if an eSIM is available.If it is, it will automatically download and install itwithout requiring any user interaction.The MDM server can then use the ServiceSubscriptions queryto confirm that the eSIM has successfully been installedwhen the query returns a nonempty phone number.Now let's talk about a few key pointsthat you should keep in mind.eSIM installation is a one-time operationand future requests to install an eSIM on the same devicerequire the carrier to provision a new eSIM.To prevent users from accidentallyremoving their eSIM,use the allowESIMModification restriction.Also note that the RefreshCellularPlans commandcan install an eSIM when the restriction is installed.And finally, MDM could also remove the eSIMwhen erasing a device.To avoid this, be sure to set the PreserveDataPlan key to Truewhen sending an EraseDevice command.We hope this information provides a more complete pictureon how to manage and deploy eSIM.Now let's talk about some updates to Shared iPad.Shared iPad is a great way for education and business customersto use iPad in a one-to-many environmentwhile still giving users a personalized experience.This year we've made a few changesthat will make Shared iPad even better.First, we added ManagedAppleIDDefaultDomainsto the SharedDeviceConfiguration Settings command.With this command, you'll be able to save users timeentering their Managed Apple ID using the QuickType keyboard.Once the user starts to enter their Managed Apple ID,a typing suggestion for your domain namewill automatically appear for the user to tap.The Settings command will accept a list of any sizebut only three will be displayed to the user.Next, we've made some changesto the requirements for remote authentication.Currently, Shared iPad requires remote authenticationapproximately every seven days.In iPadOS 16, Shared iPad will only use local verificationfor existing users on the device.If admins want to enforce remote authentication,they can set theOnlineAuthenticationGracePeriod keyin the SharedDeviceConfiguration Settings command.This key will be an integer value that representsthe number of days between remote authentications;a value of zero will require all loginsto be remotely authenticated.Both the ManagedAppleIDDefaultDomainsand OnlineAuthentication GracePeriod valuescan be retrieved via the DeviceInformation query.Finally, I wanted to help provide some clarityaround Shared iPad quotas.The SharedDeviceConfiguration commandis the best way to manage quotas on Shared iPad.There are two relevant keys that you can use to set quotas:QuotaSize and ResidentUsers.Regardless of which key you choose to set,ultimately the operating system is computing a storage quota.Let's take a look at an example.This iPad has 35 gigabytes of free space for user data.If I send the SharedDevice ConfigurationSettings commandasking the device to set ResidentUsers to three,it will compute each user's quota to 11.67 gigabytes.Alternatively, if I ask the devicefor a quota size of 10 gigabytes,each user will have a quota of 10 gigabytes.If we have three existing users on the deviceand a fourth user tries to log in,one of the existing user's data will be removed from the deviceto create enough space for the new user.In the QuotaSize example, even though there wasfive gigabytes of free space still available,that would not meet the requirementfor the fourth user, and therefore,one user still needs to be removed.Let's look at one more scenario where we seehow the number of users can be adjusted on the devicewithout changing the quota.When we started the scenario,we had 35 gigabytes of free space.Well, it turns out that 25 gigabytesof the total space on the iPad was taken up by apps and books.After doing a little research,I realized that there's a few apps on this devicethat aren't being used anymore.Now that I've trimmed down my app library,my device has an additional 10 gigabytes of free space --meaning when our fourth user comes to log in,it no longer requires another user to be removed.Also, remember that as of iOS 13.4,as long as there are no cached users on the device,quota sizes can be adjusted at any time.Keeping these points in mind should allow you to ensurethe best possible experience for your Shared iPad deployments.Let's wrap up our iOS and iPadOS updates with some MDM protocoland behavior changes that you should be aware of.Apple devices come standard with built-in accessibility featuresthat let people experience everythingthat their device has to offer.Traditionally, each user needed to enableaccessibility settings themselves.But in iOS and iPadOS 16, we're adding the ability for MDMto manage many of the most popular accessibility settings.These features include Text Size, VoiceOver, Zoom,Touch Accommodations, Bold Text,Reduce Motion, Increase Contrast,and Reduce Transparency.With all these options available,we believe admins can make devices in schools,restaurants, and hospitals more accessible for all users.Be aware that these settings are not locked after being setand a user is free to modify themto match their own unique preferences.The MDM server can also query these settingswith the DeviceInformation query.Next, starting in iOS and iPadOS 16,you'll now be able to install applicationsduring the AwaitDeviceConfigured stateduring Automated Device Enrollment.A few things to keep in mind.Is it is very likely at this stageno user will be signed in to the App Store,so we recommend using device-based app licenses.Unsupervised devices in Setup will still return a NotNowuntil they reach the Home screen.With this feature, you can now ensurea device has everything a user needs to get startedbefore exiting Setup Assistant.As we continue to improve the security of our devices,certain data types become inaccessiblebefore first unlock.Because of this, the CertificateList querywill start returning a NotNow before first unlock.Once the user unlocks the device,the query will respond as normal until the device is rebooted.MDM developers, please ensure that your serversare able to handle a NotNow response for this query.And finally, we have an exciting update for Apple TV.Starting in tvOS 16, when you erase an Apple TV --either from Settings or via MDM --the remote will now remained paired.Combined with Auto Advance, this ensures that your Apple TVsare always refreshed and ready to go.In addition to everything that we've discussed today,there are even more changes that you can check outin our documentation at developer.apple.com.Speaking of documentation, at a previous WWDC,we brought the MDM documentation to its new home.This change brought more accurateand up-to-date documentationbut also gave you the ability to highlight changesin a particular OS release.The reception to this documentation has been amazingand today I'm excited to tell you thatwe are making the source code that backs this documentationpublicly available under the MIT Open Source Licensein the new device management projecton Apple's GitHub page.Let's take a look at what you'll find when you arrive.There will be two folders:one containing all of the MDM documentationand one containing the newdeclarative device management documentation,as well as a README file and our license information.Inside the MDM folder, you'll find foldersfor checkin, commands, and profiles.And for declarative management,declarations, protocol, and status.When you dive into these folders,you'll find YAML files for each command,profile, or declaration.I'd like to highlight a few itemsto get you familiar with these files.First is the payload key.This key shows the request type for the MDM command.In this example, that's ProfileList,which returns a list of all profilesinstalled on the device.Next, supportedOS keygives you platform-specific informationlike operating system and version support,as well as things like if it requires supervisionor if it works with user enrollment.Here we find the ProfileList key was introduced in iOS 4.The payloadkeys give you informationabout additional features the query offers.Each sub-key may include an additional supportedOS keythat will override the values from the payload above.The ProfileList query was introduced in iOS 4,but the ManagedOnly feature wasn't added until iOS 13.The rest of the supportedOS information remains the same,meaning supervision is not requiredand the query works for user enrollment.In the case of the ProfileList query,it returns a response to the MDM server.The response keys detail this information.In our example, we can expect an array of dictionariesthat describe each profile installed.Inside that dictionary, you will see key value pairsincluding things like PayloadUUIDand PayloadIdentifier.This is just a quick exampleand you will find comprehensive detailsabout the schema and the structure of the repositoryin the README.Now let's talk about some details.You will find data publishedback to the initial release of iOS 15 and macOS Monterey.From there, we publish new branches for each releaseand seed as needed, meaning that the iOS 16and macOS Ventura documentationis up for you to check out right now.We think that there are a lot of exciting use casesfor this new data and we can't wait to seewhat new tools or integrations you come up with!As you start to work with this data,please use Feedback Assistant to let us know how it's going.We've covered a ton of information today,so let's take a moment to recap.Apple Configurator for iPhonenow adds iPhone and iPad to your organization,allowing you to more easily manage and deploy devices.For identity, Google Workspace integration,Enrollment SSO, and Platform SSObring a more cohesive authentication experience.From there, Nadia told us about how macOS Venturagives you more information to help youmanage software updates for your fleet.Automated Device Enrollment gets better byrequiring a network connection during Setup Assistantafter erasing or restoring a Mac.And we wrapped up with some important security changesthat will impact your deployments.In iOS and iPadOS 16,you can now manage DNS Proxy and Web Content Filteron a per-app basis.We explored the tools used to manage eSIM on iPhone and iPad.We discussed enhancements to Shared iPad,and finally, changes to the MDM protocolincluding the ability to install apps during Setup Assistant.Last, we hope that our new machine-readable documentationenables you to build new and exciting tools and integrations.Thank you for joining usand I hope you have a great WWDC!♪

♪ Mellow instrumental hip-hop music ♪♪Nadia Hussein: Welcome to WWDC!I'm Nadia, and my colleague Graham and I are so thrilledto tell you about all the new device management featureswe have for macOS Ventura and iOS and iPadOS 16.In the world of device management,it's our shared responsibility to enable employeesto thrive in the workforceand increase student-teacher productivity.We're continuously developing the tools and technologyto help foster this collaboration.And with macOS Ventura and iOS and iPadOS 16,there are many great enhancements and features,some of which we'll cover in this session.But first, I'd like to briefly highlighta few of the additional sessions where you can discovereven more about the enterprise and education space.During WWDC 2021,we introduced declarative device management,a new paradigm for device managementthat makes devices more autonomous and proactive,while allowing servers to be lightweight and reactive.This year we are expanding declarative device managementwith new platform support and new features.Be sure to watch the session,"Adopt declarative device management."Apple Business Essentials is one complete subscriptionthat seamlessly brings together device management,24/7 support, and cloud storage.With Apple Business Essentials,small businesses can easily manage every iPhone, iPad,Mac, and Apple TV every step of the way.Check out the session, "Explore Apple Business Essentials"to learn more.Managed device attestation is a new security featurethat uses the Secure Enclaveto provide strong assurances about a client device,such as its identity and software version.Attend the session, "Discover Managed Device Attestation"for additional information.In this session, we're going to discussnew capabilities with Apple Configurator;identity technologies across platforms;protocol modifications to macOS Ventura,iOS and iPadOS 16;and an exciting change to how we provide documentation.Let's start with Apple Configurator.At WWDC 2021, we announced Apple Configurator for iPhone.Education and enterprise customerslove having this solution to take advantageof automated device enrollment for all of their Macs.Apple Configurator for iPhone makes it easy to add a Macpurchased outside of the normal channelto their organization in Apple School Manageror Apple Business Manager.In Setup Assistant on a Mac,simply hold your iPhone running Configuratorover the animation.The Mac will then connect to the internetand add itself to your organization.Version 1.0.1 brought new, explicit supportfor taking advantage of existing network connectivityif available on the Mac.And we are excited to announce that with iOS and iPadOS 16,Apple Configurator for iPhone can now also addiPhone and iPad devices to your organization.This works just as you expect, just like adding a Mac.It's a great new alternative to the version of this featurein Configurator for Mac,which requires connecting each device via USBto the Mac running Configurator.A key difference for iOS and iPadOSis which pane in Setup Assistant you scan.On iOS and iPadOS, that's Wi-Fi,but on macOS, it's country or region.And remember, any device that requires interactive activation,such as activation lock or cellular carrier activation,must be handled manuallybefore adding it to your organization,just like Configurator for Mac.Devices running iOS or iPadOS 16can be added using the version of Apple Configurator for iPhonecurrently in the App Store.Now, lets cover identity managementfor business and education.We know identity management is important for the industryand it's a key priority for Apple as well.It enables our users to have a cohesive experience,while ensuring security of their data.

Our goal for identity is for users to sign in once,and from then on,use that identity consistently across the operating system.We're working towards that goal,and there's a lot of technology that supports that,including the new features in macOS Venturaand iOS and iPadOS 16.For Federated Authentication, Apple Business Managernow integrates with Google Workspaceas an Identity Provider.This allows users to leverage their work credentialsas Managed Apple IDs for authentication to serviceson iOS, iPadOS, and macOS.And remember, use Directory Sync --which we've formerly referred to as SCIM --to create the user accounts as Managed Apple IDs automatically.Sign in with Apple can now be used at work and schoolwith Managed Apple IDs.In apps that support Sign in with Apple,this will just work!If you want to control where users can sign in,you can choose to allow all appsor add apps to an explicit allow listin Apple School Manager or Apple Business Manager.Learn more in the session,"Discover Sign in with Apple at Work & School."Another notable identity management updateis OAuth support.In iOS and iPadOS 15,we used a simple access token authorization mechanismto allow the MDM server to verify the identity of users.In iOS and iPadOS 16, we are adding OAuth 2as another authorization mechanism.OAuth opens the door for MDM serversto support a wide variety of identity providersalready using OAuth today.It also improves security via its refresh token mechanism,which allows a short-lived access token to be usedin conjunction with a silent refreshthat won't prompt the user for credentials.OAuth can be used with the existingaccount-driven user enrollment flow,but it provides an even better user experiencewhen combined with a cool new feature.We call it Enrollment Single Sign-on,or Enrollment SSO.It's a new, faster method for personal devicesto complete an MDM enrollmentand access your organization's apps and websiteswith a single authentication.This builds upon a few existing technologies.iOS 13 introduced extensible SSO as a new way to configure SSOfor an organization's apps and websites.And iOS and iPadOS 15introduced Account-Driven User Enrollment,which allows users to enroll in MDMby just entering their email address in Settings.To make enrollment even better,we combined these two technologies togetherbecause we know BYOD devicesare an important part of your deployment.Users start out by entering their email address in Settings.They are then prompted to download an appfrom the App Store.This app, which containsan Enrollment Single Sign-on extension,provides a native UI to perform the authentication steps.Because this is an app-based model,you can use any authentication technology you choose.As a user, sign in once.The app will then sign in to get you through the enrollment flowwithout having to sign in again.There are four main pieces required to bringEnrollment Single Sign-on to life.First, the app developer updates their appto support enrollment SSO.Next, MDM vendors federate MDM protocolclient authentication with an identity provider.Then administrators set up Managed Apple IDsusing Apple School Manager or Apple Business Managerand finally, configure the MDM Server to return a URLto the JSON documentin the authentication response headers.Now that we've talked about what this feature doesand who needs to do what, let's dive into the details.When the initial authentication challenge from the serveris received, there will be an HTTP header presentindicating that Enrollment Single Sign-on is availableand should be used.That header's value will be a URL that the client will useto download a JSON document.The JSON document contains all the detailsthe client needs to continue the enrollment.The value for the iTunesStoreID keymust refer to the Enrollment Single Sign-on appto be used during enrollment.The AssociatedDomains keys are the same keys availablein ApplicationAttributes and can be configured here as well.Finally, the ConfigurationProfileshould be a Base64EncodedProfilethat contains at least one Extensible SSO payloadand may contain certificate payloads if needed.And we'll be shipping this feature for customersin a later release of iOS and iPadOS 16.If you are interested in developing an appthat supports this feature,you'll need to apply for a new entitlementthough the Apple Developer Program.However, you can start developing for this nowusing test mode.This is a special versionof the Enrollment Single Sign-on processthat allows you to test your appbefore it's even offered on the App Store.To get started with test mode,head to the Developer section of Settingsand enable Enrollment Single Sign-on test mode.You'll then need to configure your authentication responsewith the new HTTP headerand the corresponding JSON document.Then, in VPN and Device Management,start the enrollment process.During the enrollment,you'll be prompted to install the Single Sign-on app.You can install the app using any method availablefrom Xcode to TestFlight or even Enterprise app distribution.After that, return to Settings and complete the enrollment.To use test mode, there is a different header requiredin the response and a modified JSON document.Here's an example of the JSON document for test mode.You'll notice the iTunesStoreID keyhas been replaced by the AppIDs keyand the value of this key is an array of stringscontaining the App IDs that can be used for enrollment.Everything else remains the same.Next, let's explore Single Sign-on extensions.In 2019, we added Single Sign-On extensionsto iOS 13 and macOS Catalinato enable identity providers to use SSO authenticationfor all the apps and websites for their users.When using SSO extensions,the user is prompted to sign in to the extensionafter they've unlocked the device,which means entering credentials twice.If an organization also uses the built-in Kerberos extension,the user may have to sign in again.In many cases, these are all identical credentials.Well, in macOS Ventura, we're introducingPlatform Single Sign-On -- or Platform SSO --to enable users to sign in once at the login windowand then automatically sign in to apps and websites.Platform SSO makes tokens from the loginavailable to third-party SSO extensionsand also works with the built-in Kerberos extension.The first login authenticates with a local account password,which also unlocks FileVault encryption on the device.This enables the user to login when offlineor when connected to captive networks.From then on, their identity provider passwordcan be used for unlock.Additionally, Platform SSO supports the use of a passwordor a Secure Enclave backed keyto authenticate with the identity provider.And regardless of the authentication method,the SSO tokens are retrieved from the identity provider,stored in the keychain,and made available to the SSO extension.Kerberos TGTs can also be retrieved,imported to a credential cache,and optionally shared with the Kerberos extension.If the identity provider password changes,Platform SSO will validate that new passwordwith the identity provider on unlock.Platform SSO is a fully integrated protocolthat is built using OAuth and OpenIDand does not use web views for authentication.Platform SSO is the modern replacement for AD bindingand mobile accounts.Note, it does not directly use directory services,or check with the identity providerfor each unlock attempt.Instead, the identity provider is only calledwhen the user is attempting to use a new password at unlockor to retrieve SSO tokens.Platform SSO also does not prevent logging in to the Macbased on the response from the identity provider.For that purpose, leverage MDMor alternative strategies to disable access.To take advantage of this feature,the identity provider needs to implement the SSO protocoland update their SSO extension,then ensure the extensible SSO profile is updatedto support the new keys on managed devices.Find more implementation detailsin the Apple Platform Deployment guide.To recap, we've introduced integrationwith Google Workspace, Enrollment SSO,OAuth support, and Platform SSO,to contribute to a simplified sign-in experience.Identity management is an ever-evolving technologyand we are just getting started.macOS Ventura brings many enhancements across OS updates,enrollment, and security.Let's start with software updates.macOS Monterey introduced fundamental changesto Managed Software Updates.My colleague Lucy covered this in the session,"Manage software updates in your organization,"where we break down OS updates into three areas:test, deploy, and enforce.This year, we focus on even more additionsto deploy and enforce.Historically, all OS Update commands would return a NotNowwhen sent while in Power Nap mode.To ensure a more consistent and robustOS Update deployment process, the device will now acknowledgeand respond to ScheduleOSUpdate, OSUpdateStatus,and AvailableOSUpdate commandseven when the device is asleep or in Power Nap mode.Since we also understand that sometimes administratorswant an OS update as soon as possible,we've introduced a new key called "priority"sent via the ScheduleOSUpdate command.Accepting a string value of High or Low,it controls the scheduling priorityfor downloading and preparing the requested update.Sending the command with a High prioritywill mimic as if the user had requested the update themselvesin system settings.Note that this key is only supported for minor OS updates.In macOS 12.3, we added even more admin visibilityinto the logs and reporting with the OSUpdateStatus command.DeferralsRemaining indicates how many notifications are leftto prompt the user to update.MaxDeferrals reveals the total number of timesa user is allowed to defer the OS update notifications.NextScheduledInstall is the date that the OSwill attempt to install the update next.And finally, PastNotifications is the exact dates and timeswhen the notification was posted to the user.All of these updates to the OSUpdateStatus commandwill be useful for administratorsto have further clarity into the compliance of their users.macOS Ventura and iOS and iPadOS 16are introducing a new mechanismto ship critical security fixes to users more quickly.It does not modify the firmware,and the user can also remove the Rapid Security Responseif necessary.We are introducing two restriction keys for this.Use allowRapidSecurity ResponseInstallationto disable this new security response mechanism,and use allowRapidSecurity ResponseRemovalto block the end userfrom being able to remove a Rapid Security Response.Now, let's cover a couple enrollment changes.Automated device enrollment provides a streamlined processfor the device to be unboxed, activated,and enrolled in the organization's MDM solution.In an upcoming release,after erasing or restoring a Mac,an internet connection will be requiredto go through Setup Assistantfor devices registered to your organizationin Apple School Manager or Apple Business Manager.Once the Mac is set up for the first timeand connected to a network,the Mac is acknowledged as owned by an organization.If later on, for example, MDM initiatesan Erase All Content and Settingsor the device is restored with Configurator,then the network --and therefore, device enrollment --cannot be bypassed in Setup Assistant.Stay tuned with the AppleSeed for ITrelease notes for timing.The profiles command line tool has been a staplefor MDM deployments, migrations, and reportingin admins' tool kits for many years now,and we have an update to how it works as of macOS Ventura.Profiles tool will startenforcing rate limiting on macOS.This will only be fororganization-owned enrollment typesand to the show, renew, and validate commands.Each command has a maximum of 10 requests per dayfrom the server, and if that number is exceeded,the results will return cached information.When you don't want to use one of the 10 requests,the show command has a new, optional flagto return cached information.Refer to the profiles manual pagefor more detailed information.In each release of macOS, we continue to improveprotection capabilities for our users.Here are a few upcoming security changes to be aware of.In iOS 10.3, we introduced a changein the default TLS trust policy for certificate payloadsto enhance overall protection for our users.In a future release, we'll be bringing it to macOS,meaning manually-installed certificate payloadswill no longer be trusted for TLS purposes,unless the user grants them that trust using Keychain Access.Note, we will still continue full certificate trustif it's a certificate embedded in an MDM profile,but be sure to update any workflowsif it involves interactive certificate installation.Next, "Allow accessories to connect" on macOSaims to protect our customers from close-access attacks.Supported on portable Macs with Apple silicon,the initial configuration is to ask the userto allow new Thunderbolt or USB accessories,even when unlocked.Approved accessories can connect to a locked Macfor up to three days.If you attach an unknown accessory to a locked Mac,you will be prompted to unlock the Mac.From an MDM perspective, we understand this mayimpact enterprise and education workflowssuch as bulk provisioning or test taking.To address this, we are leveraging the same restrictionoffered on iOS and iPadOS for macOS.The existing allowUSBRestrictedMode restrictionwill allow wired accessoriesto always connect without any limitation.It provides authorizationto bypass the requirement of user consent.Also remember,this inherently makes your user's system less secure,so please only use this restriction if you havea legitimate business need to do so.For other restrictions and payload modifications,such as the new allowUniversalControland UIConfigurationProfileInstallation,be sure to check out the documentation.Thanks for listening to the exciting changescoming to macOS Ventura.Now I'm going to hand it over to Graham to talk about iOS.Graham McLuhan: Thank you, Nadia!I'm really excited to be here today to tell you abouta ton of great new device management featuresin iOS and iPadOS 16.We know managing network traffic on devicesis an important way to improve the security of your data.There are three main waysthat you can manage traffic on Apple devices:VPN, DNS Proxy, and Web Content Filter.For many years now, we've offered per-app VPN --and in fact, for user-enrolled devices,this is the only type of VPN available to MDM.In iOS and iPadOS 16,we're expanding our per-app offeringsto include DNS Proxy and Web Content Filter.These features will be available on all enrollment typesbut we think they'll be particularly usefulfor user enrollmentsince this is the first time organizationscan secure their app traffic in this way for BYOD.Configuring these new features is a two-step processthat will feel very similar to Per-App VPN.Let's take a quick look at how it's done.First you'll need to add a new key value pairto each payload.In the Web Content Filter payload,ContentFilterUUID.And for DNS Proxy, DNSProxyUUID.There are a few things to be aware of with these keys.First, the values for these keys can be any arbitrary string.And second, when this key is added to the payload,it can only be installed via MDM.Now, we need to configure the apps to use these new features.Using either the InstallApplication commandor the Settings command,add the same UUID to the attributes of the appthat will use the per-app feature.In this example, we included both keys,but you can just include one or the other.A few additional details I'd like to point out.First, app developers don't need to do anything new!All existing DNS Proxy and Web Content Filter appswill just work.Second, you can have multiple DNS Proxiesbut you cannot mix system-wide and per-app proxies.And finally, for Web Content Filters,you can have up to seven per-app filtersand one system-wide filter.Next, I'd like to talk about managing eSIMs.eSIM has become the new standardfor carriers around the world, and over the last few years,we've added a number of MDM featuresto make managing eSIM easier than ever.We wanted to take a moment to talk about how MDM vendorscan bring all these features togetherto make for a better experience.When we talk to organizations using eSIM,some of the primary tasks they are doingare provisioning new devices,migrating devices between carriers,and supporting users with requirementssuch as multiple carriers or traveling and roaming.To accomplish these goals,they need to query data from enrolled devicesand provide that data to carriers.And second, they need the abilityto install an eSIM on a device.Let's begin by discussing the device queryand carrier data requirements.The DeviceInformation query is the easiest wayto collect data from a device.And in iOS 12, the ServiceSubscriptions keybecame the one stop shop for collecting all datarelating to cellular on iPhone and iPad.A few points you may find useful when looking at these responses.Devices that return two items in the ServiceSubscriptionssupport two active cellular plans.If the response contains an EID, it's an eSIM.Newer devices like iPhone 13 and iPhone SE (3rd generation)support dual active carrier eSIM profilesso it's possible to have more than one eSIMreturned in the ServiceSubscriptions response.Note that the EID is unique per device.Starting with iOS and iPadOS 16,otherDeviceInformation queries that return datawhich also appear in the ServiceSubscriptions responseare deprecated and will no longer be returnedin a future version of the operating system.Now that we know how to get data from the device,let's take a look at what we need to give to the carrier.In general, they require four pieces of datato get an eSIM set up for a device:IMEI, EID, serial number, and phone number.Giving your admins the ability to generate reportscontaining all this data will make it easier for themto get up and running with eSIM.Let's pull this all together and reviewhow eSIMs get provisioned.First, the MDM server uses the ServiceSubscriptions queryto collect the required data from the device.Then, the admin will send that data to the carrier.And finally, the carrier will provision eSIMs for the deviceon their eSIM server.We can now shift our focusto getting the eSIM installed on the device.The carrier will provide the customer with a server URLwhere devices can fetch an eSIMusing the RefreshCellularPlans command.The MDM server will sendthe RefreshCellularPlans command to the devicewhich will initiate a request to the carrier's eSIM serverand check if an eSIM is available.If it is, it will automatically download and install itwithout requiring any user interaction.The MDM server can then use the ServiceSubscriptions queryto confirm that the eSIM has successfully been installedwhen the query returns a nonempty phone number.Now let's talk about a few key pointsthat you should keep in mind.eSIM installation is a one-time operationand future requests to install an eSIM on the same devicerequire the carrier to provision a new eSIM.To prevent users from accidentallyremoving their eSIM,use the allowESIMModification restriction.Also note that the RefreshCellularPlans commandcan install an eSIM when the restriction is installed.And finally, MDM could also remove the eSIMwhen erasing a device.To avoid this, be sure to set the PreserveDataPlan key to Truewhen sending an EraseDevice command.We hope this information provides a more complete pictureon how to manage and deploy eSIM.Now let's talk about some updates to Shared iPad.Shared iPad is a great way for education and business customersto use iPad in a one-to-many environmentwhile still giving users a personalized experience.This year we've made a few changesthat will make Shared iPad even better.First, we added ManagedAppleIDDefaultDomainsto the SharedDeviceConfiguration Settings command.With this command, you'll be able to save users timeentering their Managed Apple ID using the QuickType keyboard.Once the user starts to enter their Managed Apple ID,a typing suggestion for your domain namewill automatically appear for the user to tap.The Settings command will accept a list of any sizebut only three will be displayed to the user.Next, we've made some changesto the requirements for remote authentication.Currently, Shared iPad requires remote authenticationapproximately every seven days.In iPadOS 16, Shared iPad will only use local verificationfor existing users on the device.If admins want to enforce remote authentication,they can set theOnlineAuthenticationGracePeriod keyin the SharedDeviceConfiguration Settings command.This key will be an integer value that representsthe number of days between remote authentications;a value of zero will require all loginsto be remotely authenticated.Both the ManagedAppleIDDefaultDomainsand OnlineAuthentication GracePeriod valuescan be retrieved via the DeviceInformation query.Finally, I wanted to help provide some clarityaround Shared iPad quotas.The SharedDeviceConfiguration commandis the best way to manage quotas on Shared iPad.There are two relevant keys that you can use to set quotas:QuotaSize and ResidentUsers.Regardless of which key you choose to set,ultimately the operating system is computing a storage quota.Let's take a look at an example.This iPad has 35 gigabytes of free space for user data.If I send the SharedDevice ConfigurationSettings commandasking the device to set ResidentUsers to three,it will compute each user's quota to 11.67 gigabytes.Alternatively, if I ask the devicefor a quota size of 10 gigabytes,each user will have a quota of 10 gigabytes.If we have three existing users on the deviceand a fourth user tries to log in,one of the existing user's data will be removed from the deviceto create enough space for the new user.In the QuotaSize example, even though there wasfive gigabytes of free space still available,that would not meet the requirementfor the fourth user, and therefore,one user still needs to be removed.Let's look at one more scenario where we seehow the number of users can be adjusted on the devicewithout changing the quota.When we started the scenario,we had 35 gigabytes of free space.Well, it turns out that 25 gigabytesof the total space on the iPad was taken up by apps and books.After doing a little research,I realized that there's a few apps on this devicethat aren't being used anymore.Now that I've trimmed down my app library,my device has an additional 10 gigabytes of free space --meaning when our fourth user comes to log in,it no longer requires another user to be removed.Also, remember that as of iOS 13.4,as long as there are no cached users on the device,quota sizes can be adjusted at any time.Keeping these points in mind should allow you to ensurethe best possible experience for your Shared iPad deployments.Let's wrap up our iOS and iPadOS updates with some MDM protocoland behavior changes that you should be aware of.Apple devices come standard with built-in accessibility featuresthat let people experience everythingthat their device has to offer.Traditionally, each user needed to enableaccessibility settings themselves.But in iOS and iPadOS 16, we're adding the ability for MDMto manage many of the most popular accessibility settings.These features include Text Size, VoiceOver, Zoom,Touch Accommodations, Bold Text,Reduce Motion, Increase Contrast,and Reduce Transparency.With all these options available,we believe admins can make devices in schools,restaurants, and hospitals more accessible for all users.Be aware that these settings are not locked after being setand a user is free to modify themto match their own unique preferences.The MDM server can also query these settingswith the DeviceInformation query.Next, starting in iOS and iPadOS 16,you'll now be able to install applicationsduring the AwaitDeviceConfigured stateduring Automated Device Enrollment.A few things to keep in mind.Is it is very likely at this stageno user will be signed in to the App Store,so we recommend using device-based app licenses.Unsupervised devices in Setup will still return a NotNowuntil they reach the Home screen.With this feature, you can now ensurea device has everything a user needs to get startedbefore exiting Setup Assistant.As we continue to improve the security of our devices,certain data types become inaccessiblebefore first unlock.Because of this, the CertificateList querywill start returning a NotNow before first unlock.Once the user unlocks the device,the query will respond as normal until the device is rebooted.MDM developers, please ensure that your serversare able to handle a NotNow response for this query.And finally, we have an exciting update for Apple TV.Starting in tvOS 16, when you erase an Apple TV --either from Settings or via MDM --the remote will now remained paired.Combined with Auto Advance, this ensures that your Apple TVsare always refreshed and ready to go.In addition to everything that we've discussed today,there are even more changes that you can check outin our documentation at developer.apple.com.Speaking of documentation, at a previous WWDC,we brought the MDM documentation to its new home.This change brought more accurateand up-to-date documentationbut also gave you the ability to highlight changesin a particular OS release.The reception to this documentation has been amazingand today I'm excited to tell you thatwe are making the source code that backs this documentationpublicly available under the MIT Open Source Licensein the new device management projecton Apple's GitHub page.Let's take a look at what you'll find when you arrive.There will be two folders:one containing all of the MDM documentationand one containing the newdeclarative device management documentation,as well as a README file and our license information.Inside the MDM folder, you'll find foldersfor checkin, commands, and profiles.And for declarative management,declarations, protocol, and status.When you dive into these folders,you'll find YAML files for each command,profile, or declaration.I'd like to highlight a few itemsto get you familiar with these files.First is the payload key.This key shows the request type for the MDM command.In this example, that's ProfileList,which returns a list of all profilesinstalled on the device.Next, supportedOS keygives you platform-specific informationlike operating system and version support,as well as things like if it requires supervisionor if it works with user enrollment.Here we find the ProfileList key was introduced in iOS 4.The payloadkeys give you informationabout additional features the query offers.Each sub-key may include an additional supportedOS keythat will override the values from the payload above.The ProfileList query was introduced in iOS 4,but the ManagedOnly feature wasn't added until iOS 13.The rest of the supportedOS information remains the same,meaning supervision is not requiredand the query works for user enrollment.In the case of the ProfileList query,it returns a response to the MDM server.The response keys detail this information.In our example, we can expect an array of dictionariesthat describe each profile installed.Inside that dictionary, you will see key value pairsincluding things like PayloadUUIDand PayloadIdentifier.This is just a quick exampleand you will find comprehensive detailsabout the schema and the structure of the repositoryin the README.Now let's talk about some details.You will find data publishedback to the initial release of iOS 15 and macOS Monterey.From there, we publish new branches for each releaseand seed as needed, meaning that the iOS 16and macOS Ventura documentationis up for you to check out right now.We think that there are a lot of exciting use casesfor this new data and we can't wait to seewhat new tools or integrations you come up with!As you start to work with this data,please use Feedback Assistant to let us know how it's going.We've covered a ton of information today,so let's take a moment to recap.Apple Configurator for iPhonenow adds iPhone and iPad to your organization,allowing you to more easily manage and deploy devices.For identity, Google Workspace integration,Enrollment SSO, and Platform SSObring a more cohesive authentication experience.From there, Nadia told us about how macOS Venturagives you more information to help youmanage software updates for your fleet.Automated Device Enrollment gets better byrequiring a network connection during Setup Assistantafter erasing or restoring a Mac.And we wrapped up with some important security changesthat will impact your deployments.In iOS and iPadOS 16,you can now manage DNS Proxy and Web Content Filteron a per-app basis.We explored the tools used to manage eSIM on iPhone and iPad.We discussed enhancements to Shared iPad,and finally, changes to the MDM protocolincluding the ability to install apps during Setup Assistant.Last, we hope that our new machine-readable documentationenables you to build new and exciting tools and integrations.Thank you for joining usand I hope you have a great WWDC!♪

9:12 -Enrollment SSO

11:02 -Enrollment SSO Test Mode

16:08 -OS Update Status

22:38 -Web Content Filter Profile

22:47 -DNS Proxy Profile

23:05 -InstallApplication Command

24:56 -ServiceSubscriptions response

31:48 -Manage Accessibility Settings

32:55 -CertificateList Response

## Code Samples

```swift
{

  
"iTunesStoreID"
:
 
12345678
,

  
"AssociatedDomains"
:
 
[

    
"betterbag.com"

  
]
,

  
"AssociatedDomainsEnableDirectDownloads"
:
 
false
,

  
"ConfigurationProfile"
:
 
"Base64EncodedProfile"


}
```

```swift
{

  
"AppIDs"
:
 
[


"ABC123.com.example.singlesignonapp"

  
]
,

  
"AssociatedDomains"
:
 
[

    
"betterbag.com"

  
]
,

  
"AssociatedDomainsEnableDirectDownloads"
:
 
false
,

  
"ConfigurationProfile"
:
 
"Base64EncodedProfile"


}
```

```swift
<
key
>
DeferralsRemaining
</
key
>


<
integer
>
4
</
integer
>


<
key
>
DownloadPercentComplete
</
key
>


<
real
>
0.0
</
real
>


<
key
>
IsDownloaded
</
key
>


<
false
/>


<
key
>
MaxDeferrals
</
key
>


<
integer
>
5
</
integer
>


<
key
>
NextScheduledInstall
</
key
>


<
date
>
2022-04-19T09:00:00Z
</
date
>


<
key
>
PastNotifications
</
key
>


<
array
>

	
<
date
>
2022-04-18T17:03:51Z
</
date
>


</
array
>


<
key
>
ProductKey
</
key
>


<
string
>
MSU_UPDATE_22A240a_full_13.0_minor
</
string
>


<
key
>
ProductVersion
</
key
>


<
string
>
16.0
</
string
>
```

```swift
<
plist
 
version
=
"1.0"
>


<
dict
>

	
<
key
>
PayloadContent
</
key
>

	
<
array
>

		
<
dict
>

			
<
key
>
PayloadType
</
key
>

			
<
string
>
com.apple.webcontent-filter
</
string
>

			
<
key
>
ContentFilterUUID
</
key
>

			
<
string
>
063D927E-ACE2-445F-8024-B355A6921F50
</
string
>

			
<
key
>
FilterType
</
key
>

			
<
string
>
Plugin
</
string
>

			
<
key
>
FilterBrowsers
</
key
>

			
<
true
/>

			
<
key
>
FilterPackets
</
key
>

			
<
false
/>

			
<
key
>
FilterSockets
</
key
>

			
<
true
/>

			…
```

```swift
<
plist
 
version
=
"1.0"
>


<
dict
>

	
<
key
>
PayloadContent
</
key
>

	
<
array
>

		
<
dict
>

			
<
key
>
PayloadType
</
key
>

			
<
string
>
com.apple.dnsProxy.managed
</
string
>

			
<
key
>
DNSProxyUUID
</
key
>

			
<
string
>
063D927E-ACE2-445F-8024-B355A6921F50
</
string
>

			
<
key
>
AppBundleIdentifier
</
key
>

			
<
string
>
com.example.myDNSProxy
</
string
>

			…
```

```swift
<
plist
 
version
=
"1.0"
>


<
dict
>

	
<
key
>
RequestType
</
key
>

	
<
string
>
InstallApplication
</
string
>

	
<
key
>
iTunesStoreID
</
key
>

	
<
integer
>
361309726
</
integer
>

	
<
key
>
Attributes
</
key
>

	
<
dict
>

		
<
key
>
ContentFilterUUID
</
key
>

		
<
string
>
063D927E-ACE2-445F-8024-B355A6921F50
</
string
>

       
<
key
>
DNSProxyUUID
</
key
>

		
<
string
>
063D927E-ACE2-445F-8024-B355A6921F50
</
string
>

	
</
dict
>

	
<
key
>
ManagementFlags
</
key
>

	
<
integer
>
0
</
integer
>


</
dict
>


</
plist
>
```

```swift
{

	
"CarrierSettingsVersion"
:
 
"41.7.46"
,

	
"CurrentCarrierNetwork"
:
 
"CarrierNetwork"
,

	
"CurrentMCC"
:
 
"310"
,

	
"CurrentMNC"
:
 
"410"
,

	
"EID"
:
 
"89049032004008882600004821436874"
,

	
"ICCID"
:
 
"6905 4911 1205 0650 3488"
,

	
"IMEI"
:
 
"35 309418 464558 9"
,

	
"IsDataPreferred"
:
 
false
,

	
"IsRoaming"
:
 
false
,

	
"IsVoicePreferred"
:
 
false
,

	
"Label"
:
 
"Secondary"
,

	
"LabelID"
:
 
"FDG4225C-L9OY-89BM-JF38-36JR4JOL76B3"
,

	
"MEID"
:
 
"35745008005631"
,

	
"PhoneNumber"
:
 
"+14152739164"
,

	
"Slot"
:
 
"CTSubscriptionSlotTwo"


}
```

```swift
<
key
>
Settings
</
key
>


<
array
>

	
<
dict
>

		
<
key
>
Item
</
key
>

		
<
string
>
AccessibilitySettings
</
string
>

		
<
key
>
TextSize
</
key
>

		
<
integer
>
5
</
integer
>

		
<
key
>
VoiceOverEnabled
</
key
>

		
<
true
/>

		
<
key
>
ZoomEnabled
</
key
>

		
<
true
/>

		
<
key
>
TouchAccommodationsEnabled
</
key
>

		
<
true
/>

		
<
key
>
BoldTextEnabled
</
key
>

		
<
true
/>

		
<
key
>
ReduceMotionEnabled
</
key
>

		
<
true
/>

		
<
key
>
IncreaseContrastEnabled
</
key
>

		
<
true
/>

		
<
key
>
ReduceTransparencyEnabled
</
key
>

		
<
true
/>

	
</
dict
>


</
array
>
```

```swift
<
plist
 
version
=
"1.0"
>


<
dict
>

	
<
key
>
CommandUUID
</
key
>

	
<
string
>
0001_CertificateList
</
string
>

	
<
key
>
Status
</
key
>

	
<
string
>
NotNow
</
string
>

	
<
key
>
UDID
</
key
>

	
<
string
>
00008031-000123840A45507E
</
string
>


</
dict
>


</
plist
>
```

