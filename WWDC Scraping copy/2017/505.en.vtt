WEBVTT

00:00:20.316 --> 00:00:21.136
>> Good afternoon.

00:00:21.136 --> 00:00:21.686
Good afternoon.

00:00:21.686 --> 00:00:24.826
It's so great to see so many of

00:00:24.826 --> 00:00:25.806
you here today.

00:00:26.346 --> 00:00:28.546
for session 505, "What's New in

00:00:28.546 --> 00:00:29.446
Photos API."

00:00:29.446 --> 00:00:31.706
My name is Eric Hanson, I'm the

00:00:31.706 --> 00:00:33.936
Photos Platform evangelist and

00:00:33.936 --> 00:00:35.326
I'm joined here this afternoon

00:00:35.326 --> 00:00:36.596
by two of my colleagues from the

00:00:36.596 --> 00:00:38.736
Photos engineering team to talk

00:00:38.736 --> 00:00:39.716
to you about a whole lot of

00:00:39.716 --> 00:00:41.886
great things new in Photos for

00:00:41.886 --> 00:00:44.746
iOS and for macOS High Sierra.

00:00:46.096 --> 00:00:48.026
So, obviously, we're all here

00:00:48.156 --> 00:00:49.296
because we care about

00:00:49.296 --> 00:00:49.976
photography.

00:00:51.506 --> 00:00:53.746
And our users as I'm sure most

00:00:53.746 --> 00:00:55.656
of you know, care deeply about

00:00:55.656 --> 00:00:56.386
photography.

00:00:56.936 --> 00:00:59.916
Every day around the world

00:00:59.916 --> 00:01:01.586
millions and millions of photos

00:01:01.586 --> 00:01:03.946
are captured on iOS devices.

00:01:04.806 --> 00:01:06.906
Leading to ever-growing

00:01:06.906 --> 00:01:10.126
libraries filled with tremendous

00:01:10.126 --> 00:01:12.796
amount of memory and meaningful

00:01:12.796 --> 00:01:15.826
moments that delight users when

00:01:15.826 --> 00:01:17.076
they reexperience them.

00:01:17.886 --> 00:01:19.366
And so, we want to talk to you

00:01:19.366 --> 00:01:21.846
about creating great experiences

00:01:21.846 --> 00:01:24.106
in your apps and integrating

00:01:24.106 --> 00:01:25.386
with the Photo library.

00:01:25.386 --> 00:01:27.786
And we've got some great new API

00:01:27.886 --> 00:01:29.646
to make this easy for you.

00:01:31.066 --> 00:01:32.396
We also want to talk to you

00:01:32.396 --> 00:01:34.916
about doing this in a way that

00:01:34.916 --> 00:01:36.286
is high-performing within your

00:01:36.286 --> 00:01:36.596
app.

00:01:36.596 --> 00:01:39.306
Ensuring that the responsiveness

00:01:39.306 --> 00:01:40.986
of your application is the best

00:01:40.986 --> 00:01:42.066
it can possibly be.

00:01:42.516 --> 00:01:43.396
So, we're going to talk to you

00:01:43.396 --> 00:01:44.286
about that as well.

00:01:45.736 --> 00:01:47.886
And finally, we want to do this

00:01:47.886 --> 00:01:49.476
in a way that we're not

00:01:49.476 --> 00:01:51.306
violating the trust with the

00:01:51.306 --> 00:01:51.786
user.

00:01:52.206 --> 00:01:53.436
We're not forcing the user to

00:01:53.436 --> 00:01:55.736
give up privacy just because

00:01:55.736 --> 00:01:58.056
they want to integrate with your

00:01:58.056 --> 00:01:59.166
application and with their

00:01:59.166 --> 00:01:59.666
photos.

00:02:00.316 --> 00:02:01.296
We're going to talk to you about

00:02:01.296 --> 00:02:01.816
that too.

00:02:02.226 --> 00:02:03.916
And on this last point, I'd like

00:02:03.916 --> 00:02:05.966
to welcome to the stage, my

00:02:05.966 --> 00:02:07.206
first colleague in the Photos

00:02:07.206 --> 00:02:08.705
Engineering Team, Hasan Adil.

00:02:09.526 --> 00:02:09.985
Hasan.

00:02:11.516 --> 00:02:13.646
[ Applause ]

00:02:14.146 --> 00:02:14.686
>> Thank you, Eric.

00:02:16.566 --> 00:02:17.216
Hello, everybody.

00:02:17.356 --> 00:02:21.386
It's great to see you.

00:02:21.456 --> 00:02:23.166
UI Image Picker Controller is a

00:02:23.246 --> 00:02:25.166
simple and easy to use API for

00:02:25.166 --> 00:02:27.556
selecting photos and videos in

00:02:27.556 --> 00:02:28.386
your app.

00:02:29.176 --> 00:02:31.136
In iOS 11, we have some great

00:02:31.136 --> 00:02:33.206
improvements and new features

00:02:33.436 --> 00:02:35.056
that I'm really excited to share

00:02:35.056 --> 00:02:35.656
with you today.

00:02:38.576 --> 00:02:41.576
At Apple, we care deeply about

00:02:41.576 --> 00:02:45.606
our users' privacy and security.

00:02:46.156 --> 00:02:47.776
Therefore, whenever you

00:02:47.776 --> 00:02:48.376
presented the

00:02:48.376 --> 00:02:50.336
UIImagePickerController, we

00:02:50.336 --> 00:02:52.386
require you to get the users'

00:02:52.386 --> 00:02:54.616
authorization for their entire

00:02:54.616 --> 00:02:56.556
library in order to select a

00:02:56.556 --> 00:02:57.836
single photo or video.

00:02:59.656 --> 00:03:01.296
I'm sure you all well aware,

00:03:01.296 --> 00:03:02.346
familiar with this alert.

00:03:03.846 --> 00:03:05.496
This cause friction in your app.

00:03:05.496 --> 00:03:07.846
As well as the user giving up a

00:03:07.846 --> 00:03:09.596
level of privacy that perhaps

00:03:09.596 --> 00:03:10.516
they didn't really mean to.

00:03:11.406 --> 00:03:13.186
As well as apps that will fail

00:03:13.186 --> 00:03:14.836
to perform even though there are

00:03:14.836 --> 00:03:16.506
great features, because the user

00:03:16.506 --> 00:03:17.646
didn't want to give them access.

00:03:18.466 --> 00:03:20.066
Well, we thought we could do

00:03:20.066 --> 00:03:20.396
better.

00:03:21.356 --> 00:03:24.276
So, in iOS 11, we have revamped

00:03:24.436 --> 00:03:25.616
the privacy and security

00:03:25.616 --> 00:03:26.806
fundamentals of

00:03:26.806 --> 00:03:27.966
UIImagePickerController.

00:03:29.196 --> 00:03:30.636
We started off with three goals.

00:03:31.556 --> 00:03:33.346
Put the user in charge of their

00:03:33.346 --> 00:03:33.866
content.

00:03:35.086 --> 00:03:37.176
Create a great user experience

00:03:37.276 --> 00:03:39.636
in your apps.

00:03:39.976 --> 00:03:43.476
And third, give a higher level

00:03:43.476 --> 00:03:44.946
of privacy to our users.

00:03:45.886 --> 00:03:47.646
So, I'm happy to announce that

00:03:47.646 --> 00:03:50.686
in iOS 11, this alert is no

00:03:50.686 --> 00:03:51.336
longer needed.

00:03:52.816 --> 00:03:53.726
It just works.

00:03:54.516 --> 00:03:57.546
[ Applause ]

00:03:58.046 --> 00:03:59.186
Let's look at a demo and we'll

00:03:59.186 --> 00:04:00.286
get into it.

00:04:00.816 --> 00:04:02.446
So, here's an app I've just

00:04:02.446 --> 00:04:03.556
downloaded from the app store.

00:04:03.756 --> 00:04:05.206
I'm really excited to use it.

00:04:05.516 --> 00:04:06.406
I've filled out, I'm having a

00:04:06.406 --> 00:04:08.166
great day at WWDC, a little bit

00:04:08.166 --> 00:04:09.316
nervous, but that's OK.

00:04:09.996 --> 00:04:11.426
But I'd like to attach a photo.

00:04:12.046 --> 00:04:13.526
Now, let's see what presenting

00:04:13.526 --> 00:04:15.306
UIImagePickerController in iOS

00:04:15.306 --> 00:04:15.956
11 looks like.

00:04:17.005 --> 00:04:17.875
It just works.

00:04:18.786 --> 00:04:20.755
UIImagePickerController in iOS

00:04:20.755 --> 00:04:22.876
11 is now an out-of-process API.

00:04:23.826 --> 00:04:26.196
What that means is that we

00:04:26.196 --> 00:04:28.486
present the contents of our API

00:04:29.016 --> 00:04:31.036
from an out-of-process sandbox and

00:04:31.036 --> 00:04:31.936
secure environment.

00:04:31.936 --> 00:04:34.886
And apps no longer get access to

00:04:34.886 --> 00:04:35.886
users' photo library.

00:04:37.196 --> 00:04:38.946
Only the user is able to

00:04:38.946 --> 00:04:39.696
interact with

00:04:39.696 --> 00:04:41.176
UIImagePickerController UI.

00:04:41.966 --> 00:04:44.606
When the user makes a selection,

00:04:45.336 --> 00:04:47.876
we take that photo or video and

00:04:47.876 --> 00:04:49.566
send it over to your app.

00:04:50.666 --> 00:04:52.166
We feel that this removes

00:04:52.166 --> 00:04:53.106
friction from your app.

00:04:53.436 --> 00:04:55.356
As well as gives users a really

00:04:55.476 --> 00:04:56.496
high level of privacy.

00:04:57.396 --> 00:04:59.176
Because no authorization is

00:04:59.176 --> 00:05:00.746
granted, none is asked for.

00:05:01.996 --> 00:05:02.916
We hope you'll like it.

00:05:03.246 --> 00:05:04.376
Using it is really easy.

00:05:04.416 --> 00:05:05.886
You have to make no additions.

00:05:06.296 --> 00:05:07.196
It will just work.

00:05:09.116 --> 00:05:11.416
Photos contain rich metadata

00:05:11.416 --> 00:05:11.866
within them.

00:05:12.436 --> 00:05:14.346
This includes the created date.

00:05:14.496 --> 00:05:15.916
The format of the photo.

00:05:16.156 --> 00:05:17.316
As well as other various

00:05:17.316 --> 00:05:17.836
metadata.

00:05:18.506 --> 00:05:20.136
And we've made it really easy to

00:05:20.136 --> 00:05:21.316
get to this in iOS 11.

00:05:22.786 --> 00:05:24.556
We now provide you a brand0new

00:05:24.556 --> 00:05:25.676
key with every result of

00:05:25.676 --> 00:05:26.936
UIImagePickerController.

00:05:27.226 --> 00:05:28.016
The key is called

00:05:28.286 --> 00:05:30.576
UIImagePickerControllerImageURL.

00:05:32.556 --> 00:05:35.826
This URL is a file URL, which

00:05:35.826 --> 00:05:36.856
points to a file in the

00:05:36.856 --> 00:05:38.686
temporary of your app.

00:05:38.936 --> 00:05:40.576
So, if you would like to work

00:05:40.576 --> 00:05:42.416
with us later, we suggest you

00:05:42.416 --> 00:05:43.396
move the file to a more

00:05:43.396 --> 00:05:45.106
permanent location so it stays

00:05:45.106 --> 00:05:45.326
there.

00:05:46.736 --> 00:05:49.406
You can us a URL as is, or you

00:05:49.406 --> 00:05:50.926
can read the NSDate into your

00:05:50.926 --> 00:05:52.816
app and process as needed.

00:05:59.066 --> 00:06:00.856
In iOS 11 we have introduced a

00:06:00.856 --> 00:06:02.556
new format called HEIF for

00:06:02.556 --> 00:06:03.066
photos.

00:06:04.256 --> 00:06:05.936
Now we realize that it will take

00:06:05.936 --> 00:06:07.696
some time for the ecosystem to

00:06:07.696 --> 00:06:08.626
adopt HEIF fully.

00:06:08.996 --> 00:06:10.466
And we made it really easy to do

00:06:10.466 --> 00:06:11.976
so with UIImagePickerController.

00:06:12.896 --> 00:06:15.336
We have a new property called

00:06:15.336 --> 00:06:16.526
imageExportPresent.

00:06:17.466 --> 00:06:19.536
It could be set to two types.

00:06:19.536 --> 00:06:20.906
It could be compatible mode, or

00:06:21.086 --> 00:06:22.376
we can set it to current mode.

00:06:22.666 --> 00:06:25.356
Let's look at them.

00:06:25.556 --> 00:06:28.086
In compatible mode, if the

00:06:28.086 --> 00:06:29.676
source photo that the user

00:06:29.676 --> 00:06:31.636
selected exists as a HEIF

00:06:32.076 --> 00:06:33.946
formatted photo we will

00:06:33.946 --> 00:06:35.846
transport a Jpeg and give you a

00:06:35.846 --> 00:06:36.726
Jpeg version of it.

00:06:37.706 --> 00:06:39.636
This is also the default value

00:06:39.636 --> 00:06:40.326
for the property.

00:06:40.326 --> 00:06:42.466
And if you don't need anything

00:06:42.466 --> 00:06:43.626
different, you don't need to do

00:06:43.626 --> 00:06:44.006
anything.

00:06:45.296 --> 00:06:49.026
However, if you would like the

00:06:49.026 --> 00:06:51.116
photo as we have it, set the

00:06:51.116 --> 00:06:52.826
value to current and we'll give

00:06:52.826 --> 00:06:54.436
you the photo as we have it in

00:06:54.436 --> 00:06:55.826
Photo library and you might get

00:06:55.896 --> 00:06:58.206
HEIF and you can deal with that.

00:06:59.456 --> 00:07:02.066
We have some great changes when

00:07:02.066 --> 00:07:03.546
it comes to selecting videos.

00:07:05.116 --> 00:07:06.766
But let me step aside for a

00:07:06.766 --> 00:07:09.346
second, the AVFoundation is

00:07:09.346 --> 00:07:11.126
Apple's framework for rich

00:07:11.126 --> 00:07:12.916
editing as well as playback of

00:07:12.916 --> 00:07:13.426
photos.

00:07:14.466 --> 00:07:16.416
And AVFoundation has a rich set

00:07:17.006 --> 00:07:18.826
of export presets, or formats

00:07:18.826 --> 00:07:19.226
you can say.

00:07:19.336 --> 00:07:21.736
And I'm happy to announce

00:07:22.136 --> 00:07:24.066
UIImagePickerController supports

00:07:24.146 --> 00:07:24.686
all of them.

00:07:25.236 --> 00:07:27.596
We have a new property called

00:07:27.596 --> 00:07:28.866
videoExportPreset.

00:07:30.636 --> 00:07:32.876
You can use this as a way to

00:07:32.876 --> 00:07:35.326
tell us what format would you

00:07:35.326 --> 00:07:36.476
like selected with you to be

00:07:36.476 --> 00:07:37.666
given to you.

00:07:38.336 --> 00:07:40.086
Let's look at an example.

00:07:42.436 --> 00:07:45.086
After importAVFoundation you

00:07:45.086 --> 00:07:46.286
will create an instance of

00:07:46.286 --> 00:07:48.156
UIImagePickerController and tell

00:07:48.156 --> 00:07:49.696
us what format you like.

00:07:51.036 --> 00:07:52.846
Here, I'm asking you to give me

00:07:52.846 --> 00:07:53.876
the highest quality video.

00:07:54.376 --> 00:07:56.396
And then you present the picker.

00:07:56.476 --> 00:07:57.806
When the user makes a selection

00:07:58.146 --> 00:07:59.376
regardless of what format it

00:07:59.376 --> 00:08:02.396
was, we're cross coded to a

00:08:02.396 --> 00:08:03.516
matching format and give you

00:08:03.516 --> 00:08:04.146
back the video.

00:08:04.446 --> 00:08:06.696
This is especially great for

00:08:06.696 --> 00:08:08.236
getting the videos back in the

00:08:08.236 --> 00:08:09.456
original format that they

00:08:09.456 --> 00:08:10.636
existed in.

00:08:11.716 --> 00:08:14.126
For a full list of available

00:08:14.126 --> 00:08:16.286
presets, please see this

00:08:16.286 --> 00:08:17.226
interface called

00:08:17.226 --> 00:08:20.356
AVAssetExportSession, or come

00:08:20.356 --> 00:08:21.546
see us in the lab and we'd be

00:08:21.546 --> 00:08:24.606
happy to help you.

00:08:25.396 --> 00:08:26.846
To my earlier point about

00:08:26.846 --> 00:08:28.656
increasing the privacy, we also

00:08:28.656 --> 00:08:30.596
took a deep look at what it

00:08:30.636 --> 00:08:32.116
takes to add content into a

00:08:32.116 --> 00:08:32.726
photo library.

00:08:34.086 --> 00:08:35.265
Now, since we've made picking

00:08:35.265 --> 00:08:37.316
seamless, we thought we would

00:08:37.316 --> 00:08:38.626
make adding awesome also.

00:08:39.556 --> 00:08:43.306
So, in iOS 11, if you are to use

00:08:43.336 --> 00:08:45.186
either of these two methods for

00:08:45.186 --> 00:08:48.306
saving a photo or a video into

00:08:48.306 --> 00:08:50.036
the user's library, we have a

00:08:50.036 --> 00:08:51.876
new security model and a

00:08:51.986 --> 00:08:52.646
permission level.

00:08:54.336 --> 00:08:56.986
The permission level for either

00:08:56.986 --> 00:08:57.756
of these two methods, the

00:08:57.756 --> 00:08:59.876
UIImagePickerController one is

00:08:59.876 --> 00:09:01.936
called UIImageWriteToSave

00:09:01.936 --> 00:09:03.226
ForusAlbum.

00:09:03.226 --> 00:09:03.976
And the other one is

00:09:04.586 --> 00:09:06.366
UISaveVideoAtPath

00:09:06.426 --> 00:09:07.816
ToSavedPhotoAlbum.

00:09:08.606 --> 00:09:10.186
These require add only

00:09:10.186 --> 00:09:10.856
authorization.

00:09:11.376 --> 00:09:12.696
These are really library

00:09:12.696 --> 00:09:14.216
questions to get from the user.

00:09:14.566 --> 00:09:16.416
Because these will allow you to

00:09:16.416 --> 00:09:18.756
add in library and not read.

00:09:19.436 --> 00:09:20.786
So, we feel like users are going

00:09:20.786 --> 00:09:22.206
to be very likely, will give you

00:09:22.206 --> 00:09:23.026
this authorization.

00:09:24.546 --> 00:09:26.326
And like before, come see us in

00:09:26.326 --> 00:09:27.196
the lab if you have any

00:09:27.196 --> 00:09:27.676
questions.

00:09:29.216 --> 00:09:31.616
For our users of PhotoKit, we

00:09:31.616 --> 00:09:32.346
have something great.

00:09:33.576 --> 00:09:35.836
Now, with every result of

00:09:35.836 --> 00:09:37.916
UIImagePickerController, if

00:09:38.386 --> 00:09:42.246
you're a PhotoKit user, we also

00:09:42.246 --> 00:09:43.966
give you back PHAsset object

00:09:44.146 --> 00:09:45.336
matching the user selection.

00:09:46.406 --> 00:09:49.106
This makes it really seamless to

00:09:49.106 --> 00:09:51.096
integrate PhotoKit across APIs.

00:09:51.096 --> 00:09:53.016
Let's look at an example.

00:09:53.806 --> 00:09:54.956
So, here's I've implemented the

00:09:54.956 --> 00:09:55.966
delicate method of

00:09:55.966 --> 00:09:57.596
UImagePickerController delegate.

00:09:57.596 --> 00:09:59.906
And when I get the result

00:09:59.906 --> 00:10:01.416
dictionary, I have a brand new

00:10:01.416 --> 00:10:02.626
key, the key is called

00:10:03.096 --> 00:10:04.756
UIImagePickerController,

00:10:04.756 --> 00:10:05.196
PHAsset.

00:10:06.046 --> 00:10:07.606
You get the value of that key

00:10:07.856 --> 00:10:09.296
and this key will be the asset

00:10:09.296 --> 00:10:11.386
object and you are free to use

00:10:12.096 --> 00:10:12.196
it.

00:10:12.406 --> 00:10:16.286
Now, going along with this, we

00:10:16.286 --> 00:10:17.766
had previously deprecated the

00:10:17.766 --> 00:10:19.006
ALAssets laboratory framework

00:10:20.246 --> 00:10:22.646
and now the ALAssets Library

00:10:22.696 --> 00:10:24.256
reference URLS, which we used to

00:10:24.256 --> 00:10:26.406
pass to you using a key called

00:10:26.746 --> 00:10:28.216
UIImagePickerController

00:10:28.416 --> 00:10:29.906
referenceURL has now be

00:10:29.906 --> 00:10:30.706
deprecated also.

00:10:30.816 --> 00:10:34.126
Yeah, PhotoKit is great and you

00:10:34.126 --> 00:10:35.146
will love it.

00:10:35.996 --> 00:10:37.936
We feel that with these changes

00:10:37.936 --> 00:10:39.856
to enhance the user privacy,

00:10:40.606 --> 00:10:41.676
features to make

00:10:41.676 --> 00:10:42.906
UImagePickerController a

00:10:42.906 --> 00:10:44.996
powerful and full feature API,

00:10:45.776 --> 00:10:47.616
that this will satisfy the needs

00:10:47.616 --> 00:10:48.826
of the majority of apps out

00:10:48.826 --> 00:10:49.016
there.

00:10:50.256 --> 00:10:53.046
However, there are times when

00:10:53.046 --> 00:10:54.446
you do need deep integration

00:10:54.446 --> 00:10:55.426
with the Photos frameworks.

00:10:56.326 --> 00:10:57.636
And for that we recommend

00:10:57.636 --> 00:10:58.086
PhotoKit.

00:10:59.036 --> 00:11:00.676
To tell you what's new in

00:11:00.676 --> 00:11:02.566
PhotoKit in iOS 11, I'd like

00:11:02.566 --> 00:11:03.916
welcome my colleague, Andreas

00:11:03.916 --> 00:11:04.326
Karlsson.

00:11:05.516 --> 00:11:07.556
[ Applause ]

00:11:08.056 --> 00:11:12.116
>> Thank you Hasan.

00:11:13.016 --> 00:11:15.026
So, apps related to photography

00:11:15.026 --> 00:11:16.466
are consistently some of the

00:11:16.466 --> 00:11:17.996
most popular apps on the App

00:11:17.996 --> 00:11:18.276
Store.

00:11:19.036 --> 00:11:20.656
It takes, both great features

00:11:20.656 --> 00:11:22.646
and a great user experience to

00:11:22.646 --> 00:11:23.866
succeed in that market.

00:11:24.526 --> 00:11:25.376
I'm very excited to be here

00:11:25.376 --> 00:11:27.086
today to talk about improvements

00:11:27.086 --> 00:11:28.786
we have made in PhotoKit that we

00:11:28.786 --> 00:11:30.486
hope enable you to write both

00:11:30.486 --> 00:11:32.556
exciting new features and makes

00:11:32.556 --> 00:11:34.006
it easier to improve the user

00:11:34.006 --> 00:11:35.286
experience of your apps.

00:11:35.706 --> 00:11:37.036
So, let's jump right in.

00:11:37.036 --> 00:11:38.776
Let's look at live photo effects

00:11:39.126 --> 00:11:39.906
that were announced in the

00:11:39.906 --> 00:11:40.956
keynote on Monday.

00:11:41.646 --> 00:11:43.706
So, live photo effects include

00:11:43.706 --> 00:11:45.766
these loops, which are created

00:11:45.766 --> 00:11:47.536
by carefully analyzing the video

00:11:47.626 --> 00:11:48.806
and seamlessly stitching them

00:11:48.806 --> 00:11:51.686
together into these endless

00:11:51.686 --> 00:11:52.036
loops.

00:11:52.936 --> 00:11:55.586
Also, include bounce which works

00:11:55.586 --> 00:11:56.906
in a similar way, but as you can

00:11:56.906 --> 00:11:58.456
see, it works better with dogs.

00:11:59.426 --> 00:12:01.096
And finally, there is long

00:12:01.096 --> 00:12:03.436
exposure, which analyzes the

00:12:03.436 --> 00:12:05.396
video frames in a live photo to

00:12:05.396 --> 00:12:06.786
create these amazing looking

00:12:06.866 --> 00:12:07.216
stills.

00:12:07.796 --> 00:12:10.446
So, we believe users are going

00:12:10.446 --> 00:12:11.456
to have a lot of fun with these,

00:12:11.456 --> 00:12:12.486
and we're also really excited

00:12:12.486 --> 00:12:13.596
for what you come up with in

00:12:13.596 --> 00:12:14.996
your apps when integrating with

00:12:14.996 --> 00:12:16.356
these new kind of media types.

00:12:17.316 --> 00:12:18.186
So, let's look at how you would

00:12:18.186 --> 00:12:18.576
do that.

00:12:18.576 --> 00:12:22.256
Let's look at some code.

00:12:22.256 --> 00:12:24.216
So, these are the PhotoKit Media

00:12:24.216 --> 00:12:25.516
types that currently exist.

00:12:26.026 --> 00:12:27.556
They're great, they describe

00:12:27.556 --> 00:12:29.386
what Asset is, but what's even

00:12:29.386 --> 00:12:30.996
more important is how the asset

00:12:31.106 --> 00:12:31.886
gets presented.

00:12:32.376 --> 00:12:33.396
And let me explain what I mean

00:12:33.396 --> 00:12:34.006
by that.

00:12:34.636 --> 00:12:36.596
So, if a user shot a video, they

00:12:36.596 --> 00:12:38.226
would really like to see and use

00:12:38.226 --> 00:12:40.056
that asset as a video in your

00:12:40.056 --> 00:12:40.266
app.

00:12:41.026 --> 00:12:43.026
If they shot a live photo, they

00:12:43.026 --> 00:12:45.196
care equally about the still

00:12:45.196 --> 00:12:46.326
part and the video part.

00:12:46.326 --> 00:12:47.666
So, they would like to see that

00:12:47.666 --> 00:12:49.076
asset as a live photo in your

00:12:49.356 --> 00:12:49.806
app.

00:12:50.316 --> 00:12:51.996
To do this currently, you would

00:12:51.996 --> 00:12:53.796
look at these three media types.

00:12:53.796 --> 00:12:55.896
Image, video and photo live to

00:12:55.896 --> 00:12:56.516
do the right thing.

00:12:57.726 --> 00:12:59.176
With live photo effects this

00:12:59.176 --> 00:13:01.416
become a bit more muddy and to

00:13:01.416 --> 00:13:02.876
make this really easy to get

00:13:02.876 --> 00:13:03.946
right, since it's so important,

00:13:04.736 --> 00:13:06.136
this year in iOS 11, we're

00:13:06.136 --> 00:13:07.796
introducing a new property of

00:13:07.796 --> 00:13:10.186
PHAsset called PlaybackStyle.

00:13:11.036 --> 00:13:12.926
Now, PlaybackStyle is the single

00:13:12.926 --> 00:13:13.956
property you can look at to

00:13:13.956 --> 00:13:15.706
determine which kind of image

00:13:15.706 --> 00:13:17.746
manager API to use, what kind of

00:13:17.746 --> 00:13:19.236
view to present it in, and what

00:13:19.236 --> 00:13:20.806
kind of UI limits should

00:13:20.806 --> 00:13:21.736
accompany the view.

00:13:22.206 --> 00:13:24.756
So, the PhotoKit has been

00:13:24.756 --> 00:13:26.226
updated to cover all these new

00:13:26.226 --> 00:13:27.816
playback styles, but I'd like to

00:13:27.816 --> 00:13:29.406
go into detail on three of them

00:13:29.546 --> 00:13:31.356
that relate to life photo

00:13:31.356 --> 00:13:32.686
affects here in this session.

00:13:33.476 --> 00:13:34.606
So, let's start with image

00:13:34.606 --> 00:13:34.986
animated.

00:13:35.566 --> 00:13:38.446
So, new this year, the built in

00:13:38.446 --> 00:13:39.796
Photos app is afford for

00:13:39.796 --> 00:13:42.946
animated GIF playback.

00:13:43.516 --> 00:13:45.546
[ Applause ]

00:13:46.046 --> 00:13:47.716
To playback GIFs in your own

00:13:48.136 --> 00:13:49.196
apps, you would request the

00:13:49.236 --> 00:13:50.696
image data from the image manger

00:13:50.796 --> 00:13:52.406
and then use image iO and core

00:13:52.406 --> 00:13:53.566
graphics for playback.

00:13:53.926 --> 00:13:55.436
Now, the sample app, does

00:13:55.436 --> 00:13:56.806
include a sample of how to do

00:13:56.806 --> 00:13:57.036
this.

00:13:57.286 --> 00:13:58.966
So, please have a look there in

00:13:58.966 --> 00:14:00.326
case you would like to do GIF

00:14:00.326 --> 00:14:00.606
playback.

00:14:01.846 --> 00:14:03.856
Next, is live photo.

00:14:04.986 --> 00:14:06.316
So, live photos, users care a

00:14:06.316 --> 00:14:07.316
lot about live photos.

00:14:07.316 --> 00:14:08.376
So, getting them presented in

00:14:08.376 --> 00:14:09.866
your app in the right way is

00:14:09.866 --> 00:14:10.886
really important, but also

00:14:10.886 --> 00:14:11.596
really easy.

00:14:12.346 --> 00:14:13.476
So, in this case you would

00:14:13.636 --> 00:14:15.016
request a live photo from the

00:14:15.016 --> 00:14:16.576
image manager and then you say

00:14:16.856 --> 00:14:19.176
PHLivePhotoView for playback.

00:14:20.316 --> 00:14:21.086
You set the live photo, you'll

00:14:21.086 --> 00:14:22.566
get back on the view and users

00:14:22.566 --> 00:14:24.486
can then use three touch to

00:14:24.486 --> 00:14:25.696
playback a live photo.

00:14:25.696 --> 00:14:26.856
Users [inaudible] in the built

00:14:26.856 --> 00:14:28.586
in photo's app inside your app.

00:14:29.396 --> 00:14:30.916
PHLivePhotoView can also be used

00:14:30.916 --> 00:14:32.416
with live photos outside the

00:14:32.416 --> 00:14:33.296
user's photo library.

00:14:33.296 --> 00:14:34.606
For example, if you transfer

00:14:34.606 --> 00:14:35.856
them over web service or

00:14:35.856 --> 00:14:36.406
something similar.

00:14:38.256 --> 00:14:40.616
Finally, there is looping video.

00:14:40.716 --> 00:14:42.006
And these include both the

00:14:42.006 --> 00:14:43.426
bounds and loop live photo

00:14:43.426 --> 00:14:45.136
effects that were introduced

00:14:45.136 --> 00:14:45.486
this year.

00:14:45.786 --> 00:14:48.036
Now, to play these back in your

00:14:48.036 --> 00:14:49.376
apps, it's very similar to

00:14:49.376 --> 00:14:50.056
regular video.

00:14:50.056 --> 00:14:51.046
So, you would request the player

00:14:51.046 --> 00:14:52.676
item, and use AVFoundation for

00:14:52.676 --> 00:14:53.106
play back.

00:14:53.576 --> 00:14:54.286
But you would use an

00:14:54.436 --> 00:14:56.046
AVPlayerLooper to get the

00:14:56.046 --> 00:14:56.616
looping effect.

00:14:57.146 --> 00:15:00.366
So, I hope you have seen how

00:15:00.366 --> 00:15:02.156
easy it is to present the user's

00:15:02.156 --> 00:15:03.386
media how they really wanted to

00:15:03.386 --> 00:15:04.056
be presented.

00:15:04.396 --> 00:15:05.726
And we cannot wait to see what

00:15:05.726 --> 00:15:06.986
you guys come up with in your

00:15:06.986 --> 00:15:08.716
apps related to these new media

00:15:08.716 --> 00:15:09.166
kinds.

00:15:10.466 --> 00:15:11.966
Next, I'd like to talk about

00:15:11.966 --> 00:15:12.766
iCloud Photo Library.

00:15:14.776 --> 00:15:17.366
So, iCloud Photo Library is

00:15:17.366 --> 00:15:18.466
really great because users can

00:15:18.466 --> 00:15:20.026
now put their entire photo

00:15:20.026 --> 00:15:21.376
library in their pocket.

00:15:21.826 --> 00:15:23.106
And this is really great for

00:15:23.106 --> 00:15:24.966
some users who have really large

00:15:24.966 --> 00:15:25.476
libraries.

00:15:26.486 --> 00:15:27.366
Some users have more than

00:15:27.366 --> 00:15:29.906
100,000 photos in their photo

00:15:29.906 --> 00:15:31.296
library, and they're not that

00:15:31.296 --> 00:15:32.166
uncommon actually.

00:15:32.756 --> 00:15:34.436
So, what kind of user has that

00:15:34.436 --> 00:15:35.016
many photos?

00:15:35.016 --> 00:15:37.296
Well, to get 100,000 photos, you

00:15:37.296 --> 00:15:39.336
have to take 28 photos per day,

00:15:39.336 --> 00:15:42.046
every day for 10 years straight.

00:15:42.556 --> 00:15:44.256
So, these users obviously love

00:15:44.336 --> 00:15:46.186
to use the camera and camera

00:15:46.186 --> 00:15:47.886
apps, but they also tend to

00:15:47.886 --> 00:15:49.286
download and use a lot of

00:15:49.286 --> 00:15:50.496
photography-related apps.

00:15:51.296 --> 00:15:53.056
These users are really important

00:15:53.116 --> 00:15:56.016
to all of us in this room.

00:15:56.196 --> 00:15:57.726
Now imagine one of these users,

00:15:57.726 --> 00:15:59.736
after taking their daily 28

00:15:59.736 --> 00:16:01.616
photos, they go to the App Store

00:16:01.616 --> 00:16:02.626
to find an interesting app to

00:16:02.626 --> 00:16:02.976
use.

00:16:03.406 --> 00:16:04.896
They find your app.

00:16:05.456 --> 00:16:06.716
They decide to download it and

00:16:06.716 --> 00:16:07.276
give it a try.

00:16:07.386 --> 00:16:08.826
And the first thing they see

00:16:08.826 --> 00:16:09.946
when they start using your app,

00:16:10.416 --> 00:16:10.966
is this.

00:16:14.706 --> 00:16:15.936
Now, spinner for multiple

00:16:15.936 --> 00:16:17.626
seconds are not a great user

00:16:17.626 --> 00:16:18.256
experience.

00:16:18.606 --> 00:16:20.276
And this user might uninstall

00:16:20.276 --> 00:16:22.176
your app right away, or even

00:16:22.176 --> 00:16:23.406
worse, leave a bad review.

00:16:24.066 --> 00:16:26.626
So, you might be thinking, well

00:16:26.836 --> 00:16:28.996
my app wouldn't do that, or if

00:16:28.996 --> 00:16:31.016
it does, I'm using PhotoKit and

00:16:31.016 --> 00:16:32.116
this user has a really large

00:16:32.116 --> 00:16:32.466
library.

00:16:32.466 --> 00:16:33.636
So, maybe this is to be

00:16:33.636 --> 00:16:34.146
expected.

00:16:36.136 --> 00:16:37.566
PhotoKit was designed from the

00:16:37.566 --> 00:16:39.546
beginning to be really fast and

00:16:39.546 --> 00:16:41.286
efficient with large photo

00:16:41.286 --> 00:16:41.786
libraries.

00:16:42.446 --> 00:16:43.286
But there are some common

00:16:43.286 --> 00:16:44.946
mistakes clients make that can

00:16:44.946 --> 00:16:45.916
mean the difference between

00:16:45.916 --> 00:16:47.606
operation taking 10

00:16:47.606 --> 00:16:49.576
milliseconds, and 10 seconds.

00:16:50.876 --> 00:16:52.616
So, how do I fix this?

00:16:52.616 --> 00:16:53.876
Well, since it's so easy to end

00:16:53.876 --> 00:16:54.966
up with something taking a long

00:16:54.966 --> 00:16:58.206
time, step number 1 is to test

00:16:58.206 --> 00:16:59.826
your app with a large photo

00:16:59.826 --> 00:17:00.166
library.

00:17:01.596 --> 00:17:02.726
Now we already covered, it's

00:17:02.726 --> 00:17:03.746
kind of difficult to get that

00:17:03.746 --> 00:17:04.846
many photos using the camera

00:17:04.846 --> 00:17:05.076
app.

00:17:05.656 --> 00:17:07.195
So, this year we want to make

00:17:07.195 --> 00:17:08.116
that really easy.

00:17:08.596 --> 00:17:09.896
So, we're providing a sample app

00:17:09.896 --> 00:17:11.016
that you can download called

00:17:11.146 --> 00:17:12.096
photo library filler.

00:17:13.266 --> 00:17:14.425
Download this app and install it

00:17:14.425 --> 00:17:15.366
on your test device.

00:17:15.665 --> 00:17:17.445
It will quickly generate a large

00:17:17.445 --> 00:17:18.876
library for you to use for

00:17:18.876 --> 00:17:19.326
testing.

00:17:20.766 --> 00:17:21.516
So, great.

00:17:22.516 --> 00:17:26.175
[ Applause ]

00:17:26.675 --> 00:17:28.026
So, great you have a large

00:17:28.026 --> 00:17:29.456
library, you test your app.

00:17:30.036 --> 00:17:31.026
Chances are you might start

00:17:31.026 --> 00:17:31.766
seeing some delays.

00:17:32.666 --> 00:17:34.276
So, I'd like to talk about two

00:17:34.276 --> 00:17:35.876
common problems clients have

00:17:35.876 --> 00:17:36.926
with PhotoKit and their

00:17:36.926 --> 00:17:37.446
solutions.

00:17:38.576 --> 00:17:41.416
So, let's look at some code.

00:17:41.596 --> 00:17:43.076
So, this is how you fetch assets

00:17:43.076 --> 00:17:44.446
from the users' photos library.

00:17:44.446 --> 00:17:45.516
There are two parts to this.

00:17:45.686 --> 00:17:46.896
There is the database fetching

00:17:46.896 --> 00:17:48.296
part, and then dealing with a

00:17:48.296 --> 00:17:48.706
result.

00:17:49.976 --> 00:17:51.256
Let's focus on the database

00:17:51.256 --> 00:17:52.126
fetching part first.

00:17:52.466 --> 00:17:54.566
So, here we're fetching all

00:17:54.566 --> 00:17:55.796
assets on the library, but we're

00:17:55.796 --> 00:17:57.656
filtering with a filter

00:17:57.656 --> 00:17:59.466
predicate on favorite assets.

00:17:59.626 --> 00:18:01.176
And we're sorting by creating

00:18:02.436 --> 00:18:02.526
day.

00:18:02.576 --> 00:18:03.496
If you're doing this kind of

00:18:03.496 --> 00:18:05.096
custom fetches, they are

00:18:05.096 --> 00:18:06.906
definitely supported, but if you

00:18:06.906 --> 00:18:08.306
start seeing delays in these

00:18:08.306 --> 00:18:09.836
kind of custom fetches, it's

00:18:09.866 --> 00:18:11.316
definitely worth trying to

00:18:11.736 --> 00:18:13.076
simplify the predicate or

00:18:13.076 --> 00:18:14.426
simplify the sort descriptor.

00:18:14.816 --> 00:18:16.156
And that can mean the difference

00:18:16.156 --> 00:18:18.626
between this query taking 10

00:18:18.626 --> 00:18:20.066
milliseconds and 10 seconds.

00:18:20.806 --> 00:18:22.196
The reason for this drastic

00:18:22.196 --> 00:18:24.036
difference is that you might end

00:18:24.036 --> 00:18:26.066
up outside the optimized path in

00:18:26.066 --> 00:18:28.426
the database and trying to get

00:18:28.426 --> 00:18:29.806
back into the optimized path can

00:18:29.806 --> 00:18:30.606
really pay off.

00:18:32.126 --> 00:18:33.636
So, even better than doing these

00:18:33.636 --> 00:18:35.416
kind of custom fetches, is to

00:18:35.416 --> 00:18:36.706
avoid them if it's possible.

00:18:37.316 --> 00:18:38.556
So, in this case we can actually

00:18:38.556 --> 00:18:40.326
fetch the user's favorite smart

00:18:40.326 --> 00:18:42.236
album and then fetch the assets

00:18:42.236 --> 00:18:43.356
inside of the smart album.

00:18:43.796 --> 00:18:45.076
That gives both the predicate

00:18:45.136 --> 00:18:46.156
and the sort descriptor for

00:18:46.156 --> 00:18:46.586
free.

00:18:46.866 --> 00:18:48.546
And you're guaranteed to end up

00:18:48.546 --> 00:18:50.246
in the optimized path in

00:18:50.246 --> 00:18:50.636
PhotoKit.

00:18:53.046 --> 00:18:54.626
So, next, let's look at the

00:18:54.626 --> 00:18:56.016
result you get back from one of

00:18:56.016 --> 00:18:57.586
these kinds of fetches.

00:18:57.586 --> 00:18:59.596
So, this object is a PHFetch

00:18:59.596 --> 00:18:59.926
result.

00:19:00.896 --> 00:19:02.566
Now in a PHFetch result looks a

00:19:02.566 --> 00:19:04.186
lot like an array and you can

00:19:04.186 --> 00:19:05.306
use it a lot like an array.

00:19:05.726 --> 00:19:07.846
You can ask for object and

00:19:07.846 --> 00:19:08.396
index.

00:19:08.876 --> 00:19:10.196
You can ask for its count, and

00:19:10.196 --> 00:19:11.206
you can enumerate it.

00:19:11.956 --> 00:19:14.226
But internally, a fetch result

00:19:14.226 --> 00:19:16.216
works very differently from an

00:19:16.216 --> 00:19:17.596
array, and is part of the reason

00:19:17.596 --> 00:19:18.916
PhotoKit can be so fast and

00:19:18.916 --> 00:19:20.416
efficient with large libraries.

00:19:20.416 --> 00:19:21.816
So, let's look at how it works

00:19:21.816 --> 00:19:22.326
internally.

00:19:23.956 --> 00:19:26.496
So, initially it just contains a

00:19:26.496 --> 00:19:27.836
list of identifiers.

00:19:28.166 --> 00:19:29.386
And this means you can get back

00:19:29.386 --> 00:19:30.656
one fairly quickly.

00:19:30.996 --> 00:19:32.146
But as you start using it,

00:19:32.456 --> 00:19:33.656
additional work has to be

00:19:33.656 --> 00:19:34.126
performed.

00:19:34.736 --> 00:19:36.396
So, let's look at enumeration as

00:19:36.396 --> 00:19:36.926
an example.

00:19:37.536 --> 00:19:38.966
And here we're starting

00:19:38.966 --> 00:19:40.226
enumeration at index 0.

00:19:41.456 --> 00:19:42.776
So you only have an identifier

00:19:42.776 --> 00:19:44.186
so far, so we need to fetch

00:19:44.246 --> 00:19:46.146
metadata form the database in

00:19:46.146 --> 00:19:47.696
order to create a PHAsset object

00:19:47.696 --> 00:19:49.716
to return to you in the block.

00:19:51.036 --> 00:19:52.376
Now, the fetch result is pretty

00:19:52.596 --> 00:19:52.966
smart.

00:19:52.966 --> 00:19:54.036
It's actually going to create a

00:19:54.036 --> 00:19:55.366
batch at the same time.

00:19:55.816 --> 00:19:57.326
So, as we continue enumeration,

00:19:57.566 --> 00:19:58.906
index 1 and 2 are already in

00:19:58.906 --> 00:19:59.286
memory.

00:20:00.166 --> 00:20:01.826
And then enumeration continues

00:20:01.826 --> 00:20:02.646
and you get the idea.

00:20:03.176 --> 00:20:04.736
It's going to access the disk to

00:20:04.736 --> 00:20:06.566
get the metadata for subsequent

00:20:08.726 --> 00:20:08.906
assets.

00:20:09.096 --> 00:20:10.276
So, for this kind of small fetch

00:20:10.276 --> 00:20:11.446
result this doesn't matter.

00:20:11.796 --> 00:20:12.836
But I would image this fetch

00:20:12.836 --> 00:20:16.826
result has 100,000 assets in it.

00:20:17.056 --> 00:20:18.316
Each batch takes a couple of

00:20:18.316 --> 00:20:19.356
kilobytes of memory.

00:20:20.086 --> 00:20:21.306
But when you have 100,000 of

00:20:21.306 --> 00:20:22.466
them you're looking at hundreds

00:20:22.466 --> 00:20:24.016
of megabytes of memory usage.

00:20:24.766 --> 00:20:27.136
And even worse, each batch take

00:20:27.136 --> 00:20:28.416
a couple of milliseconds to

00:20:28.416 --> 00:20:28.836
fetch.

00:20:29.196 --> 00:20:30.306
But when you have 100,000 of

00:20:30.306 --> 00:20:31.656
them, you're looking at 10

00:20:31.656 --> 00:20:33.496
seconds to enumerate a large

00:20:33.496 --> 00:20:34.076
fetch result.

00:20:34.536 --> 00:20:36.076
So, enumeration is clearly

00:20:36.076 --> 00:20:37.776
something we should try to avoid

00:20:37.856 --> 00:20:38.636
if at all possible.

00:20:40.026 --> 00:20:41.856
We have found that it's almost

00:20:41.856 --> 00:20:43.206
always possible to avoid

00:20:43.206 --> 00:20:43.776
enumeration.

00:20:43.776 --> 00:20:45.206
And I would like to look at one

00:20:45.206 --> 00:20:46.436
example of how it can be

00:20:46.436 --> 00:20:46.766
avoided.

00:20:49.256 --> 00:20:51.026
So, in this case, we're trying

00:20:51.026 --> 00:20:52.846
to find the index of an asset

00:20:52.846 --> 00:20:54.016
that inside a fetch result.

00:20:54.786 --> 00:20:55.986
Now, we could enumerate the

00:20:55.986 --> 00:20:57.276
fetch result and compare the

00:20:57.276 --> 00:20:59.066
objects we get back using is

00:20:59.066 --> 00:20:59.486
equal.

00:20:59.916 --> 00:21:01.386
But as we saw enumeration can be

00:21:01.386 --> 00:21:01.996
quite slow.

00:21:02.706 --> 00:21:04.706
So, even better is to actually

00:21:04.706 --> 00:21:05.546
use high level API.

00:21:05.676 --> 00:21:07.016
In this case, we can use index

00:21:07.016 --> 00:21:07.496
of object.

00:21:07.606 --> 00:21:09.576
And that is able to internally,

00:21:09.576 --> 00:21:10.526
in the fetch result be really

00:21:10.526 --> 00:21:12.546
smart and compare the

00:21:12.616 --> 00:21:14.396
identifiers with the object

00:21:14.396 --> 00:21:15.066
you're looking for.

00:21:15.506 --> 00:21:17.426
And array will define this index

00:21:17.426 --> 00:21:18.816
without any additional disk

00:21:18.816 --> 00:21:20.826
access or database fetching at

00:21:20.826 --> 00:21:21.036
all.

00:21:22.016 --> 00:21:23.666
Same goes for contains object.

00:21:25.466 --> 00:21:27.196
So, I hope you have seen how

00:21:27.196 --> 00:21:29.086
easy it is to get a large

00:21:29.086 --> 00:21:30.226
library to test your app with.

00:21:30.386 --> 00:21:31.916
And how easy it can be to really

00:21:32.016 --> 00:21:33.756
make a huge different in the

00:21:33.756 --> 00:21:34.646
performance of your app.

00:21:35.356 --> 00:21:37.536
Small fixes can mean multiple

00:21:37.536 --> 00:21:38.736
seconds of time savings.

00:21:39.356 --> 00:21:41.866
If you do have questions on

00:21:41.866 --> 00:21:42.916
PhotoKit performance, please

00:21:42.916 --> 00:21:44.026
come see us in the lab tomorrow

00:21:44.026 --> 00:21:44.426
morning.

00:21:44.736 --> 00:21:46.206
If you do encounter issues that

00:21:46.206 --> 00:21:47.226
you're not able to resolve,

00:21:47.686 --> 00:21:48.156
please file [inaudible].

00:21:48.156 --> 00:21:50.456
And if there's one thing you

00:21:50.456 --> 00:21:51.416
remember from this part of the

00:21:51.416 --> 00:21:53.806
session, please test your app

00:21:53.856 --> 00:21:55.156
with the large photo library and

00:21:55.156 --> 00:21:56.776
take really good care of these

00:21:56.776 --> 00:21:57.906
really important users.

00:21:58.416 --> 00:22:01.126
Next, I'd like to welcome Eric

00:22:01.126 --> 00:22:02.826
Hanson back to the stage to talk

00:22:02.826 --> 00:22:04.196
about Photo Project Extensions.

00:22:04.656 --> 00:22:06.376
Eric [applause].

00:22:06.736 --> 00:22:07.546
>> Thank you Andreas.

00:22:09.416 --> 00:22:10.176
Thank you very much.

00:22:10.176 --> 00:22:13.046
I am really, really excited to

00:22:13.046 --> 00:22:14.176
finally be able to talk about

00:22:14.176 --> 00:22:15.126
something we've been working

00:22:15.126 --> 00:22:17.396
really hard on this year in High

00:22:17.396 --> 00:22:17.846
Sierra.

00:22:17.966 --> 00:22:19.156
So much so that I need a sip of

00:22:19.156 --> 00:22:19.746
water, sorry.

00:22:20.426 --> 00:22:20.746
All right.

00:22:21.476 --> 00:22:26.166
So, we're going to talk about

00:22:26.166 --> 00:22:27.816
Photos project extension.

00:22:28.416 --> 00:22:30.136
And I think to kick this off we

00:22:30.136 --> 00:22:31.066
have to talk about what are

00:22:31.066 --> 00:22:31.836
projects.

00:22:32.816 --> 00:22:34.906
You know Apple has been allowing

00:22:34.906 --> 00:22:38.146
users to create these really

00:22:38.146 --> 00:22:40.156
rich creative photo centric

00:22:40.186 --> 00:22:42.546
projects in the photos apps for

00:22:42.546 --> 00:22:43.466
a very long time.

00:22:43.466 --> 00:22:44.706
Actually, going all the way back

00:22:44.706 --> 00:22:46.616
to iPhoto 1.0 when we first

00:22:46.616 --> 00:22:48.266
released photobooks.

00:22:48.846 --> 00:22:51.466
But this year, we wanted to do

00:22:51.466 --> 00:22:52.236
something different.

00:22:52.736 --> 00:22:55.726
Because during that time, 14

00:22:55.726 --> 00:22:58.236
years, you as developers have

00:22:58.236 --> 00:23:00.086
been building up some really

00:23:00.086 --> 00:23:02.116
great experiences yourself with

00:23:02.116 --> 00:23:02.926
your own apps.

00:23:03.866 --> 00:23:05.526
And we thought, you know, let's

00:23:05.666 --> 00:23:06.506
bring this together.

00:23:06.506 --> 00:23:08.426
Let's give you an opportunity to

00:23:08.426 --> 00:23:10.306
actually create something that's

00:23:10.306 --> 00:23:12.636
a fantastic experience directly

00:23:12.636 --> 00:23:13.606
within the Photos app.

00:23:13.736 --> 00:23:15.376
And that's exactly what we've

00:23:15.376 --> 00:23:16.496
done with the extensions.

00:23:17.026 --> 00:23:19.716
We started working on the API,

00:23:19.716 --> 00:23:22.096
engage just a few developers to

00:23:22.096 --> 00:23:23.086
kind of see what they would do

00:23:23.086 --> 00:23:23.456
with it.

00:23:23.456 --> 00:23:25.596
Companies like Shutterfly, who

00:23:25.596 --> 00:23:26.636
are going to be launching with

00:23:26.636 --> 00:23:27.966
their own photobooks and photos

00:23:27.966 --> 00:23:28.546
in the fall.

00:23:29.796 --> 00:23:31.156
A company called WhiteWall that

00:23:31.156 --> 00:23:32.586
allows you to do these gallery

00:23:32.586 --> 00:23:34.686
quality framed prints.

00:23:35.816 --> 00:23:38.776
Wix.com that created a brand-new

00:23:38.776 --> 00:23:40.676
feature allowing users to easily

00:23:40.676 --> 00:23:42.846
create web photo albums.

00:23:43.836 --> 00:23:46.776
Animoto, that allows users to

00:23:46.776 --> 00:23:48.116
create these really beautiful

00:23:48.116 --> 00:23:49.776
movies that are server hosted

00:23:49.776 --> 00:23:50.896
and integrated with social

00:23:50.896 --> 00:23:51.366
media.

00:23:52.196 --> 00:23:56.206
And a company called ifolor that

00:23:56.596 --> 00:23:58.046
did something really novel.

00:23:58.436 --> 00:24:00.696
They kind of started from the

00:24:00.696 --> 00:24:03.076
ground floor and looked at this

00:24:03.076 --> 00:24:05.016
as an opportunity for you know

00:24:05.016 --> 00:24:06.286
what could they build that

00:24:06.286 --> 00:24:07.776
really tied into the photos

00:24:07.776 --> 00:24:09.386
ecosystem and really created

00:24:09.386 --> 00:24:10.576
some magic for the user.

00:24:11.076 --> 00:24:12.646
And I think rather than explain

00:24:12.646 --> 00:24:13.066
it.

00:24:13.066 --> 00:24:14.566
I want to show you a quick demo.

00:24:14.936 --> 00:24:17.096
So here we are in the photos app

00:24:17.096 --> 00:24:17.906
on High Sierra.

00:24:18.656 --> 00:24:19.996
And I'm in memories.

00:24:19.996 --> 00:24:21.186
And I've got this favorite

00:24:21.186 --> 00:24:22.746
memory here, together that I'm

00:24:22.746 --> 00:24:23.536
just going to select.

00:24:24.396 --> 00:24:26.386
And I can hover over my project

00:24:26.966 --> 00:24:28.266
section in the side bar and you

00:24:28.266 --> 00:24:29.526
see this little button.

00:24:30.126 --> 00:24:31.156
And you'll notice that in

00:24:31.156 --> 00:24:32.556
addition to the Apple offerings

00:24:32.556 --> 00:24:34.966
we currently have, photos has

00:24:34.966 --> 00:24:36.306
automatically discovered that I

00:24:36.306 --> 00:24:37.466
have another application

00:24:37.466 --> 00:24:40.926
installed, called ifolor wall

00:24:40.926 --> 00:24:41.286
dÃ©cor.

00:24:41.686 --> 00:24:42.836
So, this extension is now

00:24:42.836 --> 00:24:44.606
exposed to me.

00:24:44.906 --> 00:24:46.896
I simply select that and I'm

00:24:46.896 --> 00:24:48.556
presented with some choices.

00:24:48.876 --> 00:24:50.216
Now these choices are coming

00:24:50.216 --> 00:24:52.186
from the extension itself.

00:24:52.746 --> 00:24:53.976
So, before we've even loaded the

00:24:53.976 --> 00:24:55.256
extension, the extension is

00:24:55.256 --> 00:24:56.936
notifying us that you know,

00:24:56.936 --> 00:24:59.216
before you push a project to me

00:24:59.216 --> 00:25:00.886
I want the user to make a

00:25:00.886 --> 00:25:01.376
choice.

00:25:01.376 --> 00:25:03.016
I want to be able to fork my own

00:25:03.066 --> 00:25:03.366
code.

00:25:04.206 --> 00:25:05.526
So, they give us the title and

00:25:05.526 --> 00:25:06.826
the description and the image.

00:25:07.186 --> 00:25:08.336
Photos actually lays it out

00:25:08.336 --> 00:25:09.436
beautifully in the sheet.

00:25:10.356 --> 00:25:11.556
And I'm just going to pick that

00:25:11.556 --> 00:25:12.226
first option.

00:25:12.326 --> 00:25:15.156
I hit the create button, and

00:25:16.146 --> 00:25:18.816
now, their extension, their view

00:25:18.816 --> 00:25:19.966
controller is going to be pushed

00:25:19.966 --> 00:25:21.156
directly into photos.

00:25:21.446 --> 00:25:23.906
Full view, but this is their UI,

00:25:23.906 --> 00:25:25.646
this is their experience inside

00:25:25.646 --> 00:25:26.246
photos.

00:25:27.276 --> 00:25:28.276
Now, they've leveraged the

00:25:28.276 --> 00:25:30.496
memory in this case and taken

00:25:30.496 --> 00:25:32.596
the hints we provided to lay out

00:25:32.596 --> 00:25:33.246
this grid.

00:25:34.106 --> 00:25:36.736
But they've also taken hints we

00:25:36.736 --> 00:25:39.936
provided to let me get at all of

00:25:39.936 --> 00:25:41.276
the images that were considered

00:25:41.276 --> 00:25:42.486
when the memory was created.

00:25:42.906 --> 00:25:44.256
So, you'll notice over here on

00:25:44.256 --> 00:25:45.936
the bottom right, if you can see

00:25:45.936 --> 00:25:46.856
it, you can't because it's

00:25:46.886 --> 00:25:49.016
behind me, 283 images.

00:25:49.766 --> 00:25:51.676
And what's was really cool about

00:25:51.676 --> 00:25:52.716
that is I can actually

00:25:52.716 --> 00:25:53.276
customize.

00:25:53.276 --> 00:25:54.916
So, I'll switch this to unused

00:25:54.916 --> 00:25:57.646
images, because there's a photo

00:25:57.646 --> 00:25:59.426
that I like a little bit better.

00:26:00.616 --> 00:26:03.826
I'll take this one, that I think

00:26:03.826 --> 00:26:04.996
would be a really great hero

00:26:04.996 --> 00:26:05.356
shot.

00:26:05.356 --> 00:26:06.936
So, I can just drag that up and

00:26:06.936 --> 00:26:08.026
customize this layout.

00:26:08.026 --> 00:26:11.226
And they went a step further

00:26:11.226 --> 00:26:11.766
than that.

00:26:11.766 --> 00:26:13.286
They let me customize the grid

00:26:13.286 --> 00:26:15.856
itself in a really novel way.

00:26:16.186 --> 00:26:17.346
So, I want to give a little more

00:26:17.346 --> 00:26:18.636
emphasis to this row.

00:26:18.716 --> 00:26:20.706
And maybe move this down.

00:26:21.676 --> 00:26:22.986
And I'll move this down to line

00:26:22.986 --> 00:26:26.226
it up and you know let's do one

00:26:26.226 --> 00:26:26.736
more.

00:26:26.736 --> 00:26:29.446
And I really like that.

00:26:29.596 --> 00:26:30.556
So, I could just hit the buy

00:26:30.556 --> 00:26:32.516
button now, still within photos.

00:26:33.826 --> 00:26:35.276
Choose my size, this would show

00:26:35.276 --> 00:26:35.966
up in the mail.

00:26:35.966 --> 00:26:36.976
And I have this memory hanging

00:26:36.976 --> 00:26:37.966
on the wall in my den.

00:26:38.496 --> 00:26:39.216
It's pretty cool.

00:26:39.256 --> 00:26:40.626
That's just a really quick tour

00:26:41.426 --> 00:26:42.526
of ifolor.

00:26:43.516 --> 00:26:48.876
[ Applause ]

00:26:49.376 --> 00:26:51.616
So, what you want to know is how

00:26:51.616 --> 00:26:53.126
does this all work.

00:26:54.416 --> 00:26:56.726
If you're familiar with the

00:26:56.726 --> 00:26:58.966
editing extensions in Photos,

00:26:59.736 --> 00:27:02.646
you already have a good sense of

00:27:02.646 --> 00:27:03.356
how this works.

00:27:04.616 --> 00:27:05.976
We've added a new extension

00:27:05.976 --> 00:27:08.276
point to Photos;

00:27:08.496 --> 00:27:10.956
com.apple.photo-project.

00:27:12.046 --> 00:27:14.196
And we've added a new template

00:27:14.196 --> 00:27:17.116
within Xcode that lets you

00:27:17.116 --> 00:27:18.136
easily create one of these

00:27:18.136 --> 00:27:19.226
extensions in your own app.

00:27:20.256 --> 00:27:23.036
As you saw, in the demo, we

00:27:23.036 --> 00:27:24.306
automatically discovered your

00:27:24.306 --> 00:27:25.856
extension, raising the

00:27:25.856 --> 00:27:27.476
discoverability of your app on

00:27:27.476 --> 00:27:28.096
the system.

00:27:28.306 --> 00:27:30.396
But we took discoverability a

00:27:30.396 --> 00:27:31.226
step further.

00:27:32.506 --> 00:27:34.796
By offering users a direct link

00:27:34.796 --> 00:27:37.776
to the App Store that brings up

00:27:37.776 --> 00:27:39.366
the App Store window, but

00:27:39.586 --> 00:27:41.116
doesn't require them to search

00:27:41.116 --> 00:27:43.446
for an app with that extension.

00:27:43.946 --> 00:27:45.716
It automatically shows only the

00:27:45.716 --> 00:27:47.306
apps that support that extension

00:27:47.306 --> 00:27:47.616
point.

00:27:48.286 --> 00:27:49.626
And we think this is really

00:27:49.626 --> 00:27:51.886
going to heighten the ability

00:27:51.886 --> 00:27:53.776
for users to discover your apps

00:27:53.776 --> 00:27:54.896
and quickly download them, and

00:27:54.896 --> 00:27:55.896
start working with them.

00:27:56.806 --> 00:27:58.796
So much so that we put a similar

00:27:58.796 --> 00:28:00.206
App Store link in edit.

00:28:01.066 --> 00:28:02.656
And so, if you're already doing

00:28:02.926 --> 00:28:05.536
image editing extensions, users

00:28:05.536 --> 00:28:06.706
will have a direct link into the

00:28:06.706 --> 00:28:07.836
App Store to immediately

00:28:07.836 --> 00:28:10.136
discover you editing extensions.

00:28:11.196 --> 00:28:13.786
It's pretty cool.

00:28:16.706 --> 00:28:20.196
So, your extension lives within

00:28:20.196 --> 00:28:21.566
the app, within your app.

00:28:22.726 --> 00:28:23.846
And that's really a great

00:28:23.846 --> 00:28:24.776
opportunity for you.

00:28:24.776 --> 00:28:25.726
Because you may already have an

00:28:25.726 --> 00:28:27.506
app in the App Store that's got

00:28:27.506 --> 00:28:29.196
a lot of app specific code, but

00:28:29.196 --> 00:28:31.306
you probably have some resources

00:28:31.486 --> 00:28:32.946
and some other sharable code

00:28:32.946 --> 00:28:34.246
that you could easily move kind

00:28:34.246 --> 00:28:35.936
of into this extension space and

00:28:35.936 --> 00:28:37.966
leverage those.

00:28:37.966 --> 00:28:40.296
You obviously also have some

00:28:40.706 --> 00:28:42.396
extension specific code that you

00:28:42.396 --> 00:28:43.066
would need to write.

00:28:43.066 --> 00:28:44.366
A very small amount.

00:28:44.966 --> 00:28:46.316
And finally, you just need to

00:28:46.316 --> 00:28:48.376
add a view controller that

00:28:48.376 --> 00:28:50.316
implements this protocol.

00:28:50.316 --> 00:28:52.376
The PH project extension control

00:28:52.376 --> 00:28:52.896
protocol.

00:28:53.886 --> 00:28:56.516
With all that in place, Photos

00:28:56.516 --> 00:28:59.146
can immediately discover your

00:28:59.146 --> 00:28:59.676
extension.

00:29:00.626 --> 00:29:02.486
Let the user choose to you know

00:29:02.486 --> 00:29:04.846
to create a product with that

00:29:05.116 --> 00:29:07.216
and we simply call this protocol

00:29:07.216 --> 00:29:08.416
method begin project.

00:29:09.456 --> 00:29:12.806
And when we do we send over a

00:29:12.996 --> 00:29:15.026
couple bits of data.

00:29:15.796 --> 00:29:16.986
So, in addition to the photos

00:29:16.986 --> 00:29:18.246
we're sending you, the project

00:29:18.246 --> 00:29:20.166
extension context, and we're

00:29:20.166 --> 00:29:22.136
sending you an object called

00:29:22.136 --> 00:29:22.986
PHProjectInfo.

00:29:24.046 --> 00:29:25.286
You can consume that in whatever

00:29:25.286 --> 00:29:25.996
way you want.

00:29:27.156 --> 00:29:28.616
And then you just quickly call

00:29:28.616 --> 00:29:30.836
back the completion closure that

00:29:30.836 --> 00:29:31.466
we hand you.

00:29:32.196 --> 00:29:33.606
And that let's Photos know it

00:29:33.606 --> 00:29:34.586
can install your view

00:29:34.586 --> 00:29:37.066
controller, full view inside the

00:29:37.066 --> 00:29:37.636
Photos app.

00:29:37.676 --> 00:29:40.086
And from that point, as you saw,

00:29:40.306 --> 00:29:41.756
it's totally your UI.

00:29:41.756 --> 00:29:43.376
It's your experience.

00:29:43.636 --> 00:29:45.876
You have all of that API

00:29:45.876 --> 00:29:49.966
available to you on macOS to

00:29:50.276 --> 00:29:52.036
leverage from and build a really

00:29:52.036 --> 00:29:53.156
killed experience for your

00:29:53.156 --> 00:29:53.586
users.

00:29:54.146 --> 00:29:58.216
So, the protocol itself is

00:29:58.216 --> 00:29:58.876
really simple.

00:29:59.596 --> 00:30:01.856
There's an optional property for

00:30:01.856 --> 00:30:03.686
supported project types and you

00:30:03.686 --> 00:30:05.366
saw this in the demo I just did.

00:30:06.046 --> 00:30:06.976
And this lets you quickly

00:30:06.976 --> 00:30:08.316
describe the choices you want a

00:30:08.316 --> 00:30:09.006
user to make.

00:30:09.276 --> 00:30:10.746
And you can opt out of this if

00:30:10.746 --> 00:30:11.736
you want, you just want to

00:30:11.736 --> 00:30:12.796
straight into the extension.

00:30:12.796 --> 00:30:14.346
That's totally possible as well.

00:30:14.346 --> 00:30:17.036
And then there are few required

00:30:17.036 --> 00:30:18.286
functions you need to implement

00:30:18.286 --> 00:30:19.296
in your view controller.

00:30:20.236 --> 00:30:21.656
The first is begin project.

00:30:22.676 --> 00:30:23.486
That's where we hand you the

00:30:23.486 --> 00:30:24.106
context.

00:30:24.106 --> 00:30:24.956
And we hand you the product

00:30:24.956 --> 00:30:25.346
info.

00:30:26.576 --> 00:30:28.206
And that's what we call the

00:30:28.206 --> 00:30:30.196
first time a project is created

00:30:30.996 --> 00:30:32.276
with your extension.

00:30:33.206 --> 00:30:35.306
Now, if a user is coming back to

00:30:35.306 --> 00:30:36.776
your extension for a project

00:30:36.776 --> 00:30:38.786
they already created, we instead

00:30:38.786 --> 00:30:40.296
call resume project.

00:30:40.696 --> 00:30:42.086
And again, hand you this

00:30:42.086 --> 00:30:43.266
extension context.

00:30:43.716 --> 00:30:48.586
And finally, if a user is in

00:30:48.586 --> 00:30:50.596
your extension and they decide

00:30:50.596 --> 00:30:51.786
to switch away to do something

00:30:51.786 --> 00:30:53.616
else within photos, we're simply

00:30:53.616 --> 00:30:54.876
going to call finishProject.

00:30:54.876 --> 00:30:56.826
Allowing you to clean up any

00:30:56.826 --> 00:30:57.806
kind of data you're holding

00:30:57.806 --> 00:30:58.226
onto.

00:30:58.226 --> 00:31:00.476
Maybe quiet down any processor

00:31:00.476 --> 00:31:02.336
intensive tasks or animations

00:31:02.336 --> 00:31:04.286
thing like that that you might

00:31:07.496 --> 00:31:08.616
be doing.

00:31:08.616 --> 00:31:10.456
So, PHProject extension context

00:31:11.186 --> 00:31:13.156
is a container for two really

00:31:13.156 --> 00:31:14.176
important objects.

00:31:14.176 --> 00:31:17.396
One is PHProject, and the other

00:31:17.396 --> 00:31:20.436
PHPhotoLibrary, which is the

00:31:20.436 --> 00:31:21.616
library from which you're going

00:31:21.616 --> 00:31:24.066
to fetch all the assets.

00:31:26.856 --> 00:31:31.736
PHProject itself is just a

00:31:32.076 --> 00:31:34.286
subclass of PHAsset collection.

00:31:34.736 --> 00:31:37.226
You may already be familiar with

00:31:37.226 --> 00:31:38.016
PHAssetCollection.

00:31:39.296 --> 00:31:41.586
It's a container.

00:31:41.716 --> 00:31:43.946
It's got an array of assets.

00:31:44.266 --> 00:31:45.116
It's got a title.

00:31:45.456 --> 00:31:47.136
It's got a key asset, key photo.

00:31:47.846 --> 00:31:49.226
And what we've done in sub

00:31:49.226 --> 00:31:50.446
classing that, creating

00:31:50.446 --> 00:31:51.856
PHProject, is we've added just

00:31:51.856 --> 00:31:52.666
one property.

00:31:53.636 --> 00:31:54.596
But it's a really, really

00:31:54.706 --> 00:31:56.076
important property for you.

00:31:56.436 --> 00:31:56.896
And that is the

00:31:56.896 --> 00:31:58.216
projectExtensionData.

00:31:58.946 --> 00:32:00.456
So, this is where you, the

00:32:00.456 --> 00:32:02.676
extension can save any data you

00:32:02.676 --> 00:32:04.546
need to that represents the

00:32:04.546 --> 00:32:05.806
project the user created.

00:32:06.376 --> 00:32:08.036
So, it's really intended for

00:32:08.036 --> 00:32:09.516
that critical project data.

00:32:09.516 --> 00:32:11.856
That is your list of the

00:32:11.856 --> 00:32:13.696
assetIdenfiers that you're using

00:32:13.696 --> 00:32:15.786
and that maybe is some basic

00:32:15.786 --> 00:32:17.396
layout information configuration

00:32:17.396 --> 00:32:18.016
information.

00:32:18.606 --> 00:32:21.956
That's not for images and you

00:32:21.956 --> 00:32:23.136
know cache, thumbnails, and

00:32:23.136 --> 00:32:24.346
rosters, things like that.

00:32:24.346 --> 00:32:25.496
Because you can create those on

00:32:25.496 --> 00:32:26.706
the fly or cache those away

00:32:26.706 --> 00:32:27.366
somewhere else.

00:32:29.126 --> 00:32:32.386
So, we want that to be small,

00:32:32.386 --> 00:32:33.056
but useful.

00:32:33.226 --> 00:32:35.196
And we settled on this limit of

00:32:35.196 --> 00:32:35.886
1 megabyte.

00:32:36.606 --> 00:32:38.146
Because we think you know, an

00:32:38.326 --> 00:32:39.966
array of assetIdenfiers

00:32:39.966 --> 00:32:41.286
compressed is really, really

00:32:41.286 --> 00:32:41.416
easy.

00:32:41.416 --> 00:32:42.686
They're just strings.

00:32:43.276 --> 00:32:44.666
And we think you can live within

00:32:44.666 --> 00:32:45.336
1 megabyte.

00:32:45.336 --> 00:32:47.156
And by doing that, we're not

00:32:47.156 --> 00:32:48.776
bloating user's libraries as

00:32:48.776 --> 00:32:49.926
they create project after

00:32:49.926 --> 00:32:51.746
project and explore all these

00:32:51.746 --> 00:32:52.976
amazing extensions that you're

00:32:52.976 --> 00:32:56.966
going to create.

00:32:57.116 --> 00:32:58.786
So, setting the data, really

00:32:58.786 --> 00:32:59.106
easy.

00:33:00.126 --> 00:33:01.196
We have an object called

00:33:01.196 --> 00:33:03.416
PHProjectChangeRequest that you

00:33:03.416 --> 00:33:05.926
simply instantiate and then once

00:33:05.926 --> 00:33:08.196
you do, you can all this perform

00:33:08.196 --> 00:33:10.406
changes and weight function on

00:33:10.406 --> 00:33:11.276
the Photo library.

00:33:11.766 --> 00:33:13.186
Inside that, set the data to

00:33:13.186 --> 00:33:14.326
whatever you want it to be.

00:33:14.326 --> 00:33:16.416
In this case, I'm just using an

00:33:16.416 --> 00:33:19.886
NSKeyedArchiver archive an array

00:33:19.886 --> 00:33:21.186
of identifiers.

00:33:21.866 --> 00:33:26.266
And that's it, it's simple.

00:33:26.356 --> 00:33:27.526
So, let's get into some fun

00:33:27.526 --> 00:33:27.866
stuff.

00:33:28.376 --> 00:33:30.406
I want to talk about where the

00:33:30.406 --> 00:33:31.276
magic begins.

00:33:33.036 --> 00:33:35.436
So, you saw in the ifolor demo

00:33:35.506 --> 00:33:37.986
they really leveraged the

00:33:37.986 --> 00:33:38.926
memory's feature.

00:33:39.066 --> 00:33:41.496
The memory's feature is really,

00:33:41.496 --> 00:33:42.266
really popular.

00:33:43.006 --> 00:33:44.946
Users love this.

00:33:45.176 --> 00:33:46.326
Right, while you're sleeping,

00:33:46.326 --> 00:33:49.156
Photos is working hard all

00:33:49.976 --> 00:33:51.466
night, going through kind of

00:33:51.466 --> 00:33:53.136
your photo library, learning

00:33:53.136 --> 00:33:56.696
sort of about you, right on your

00:33:56.696 --> 00:33:57.156
device.

00:33:57.156 --> 00:33:58.146
It's all happening right there

00:33:58.146 --> 00:33:58.786
locally.

00:33:58.886 --> 00:34:00.426
And it's building this graph of

00:34:00.426 --> 00:34:02.826
kind of the events that are

00:34:02.826 --> 00:34:04.366
meaningful to you and the people

00:34:04.366 --> 00:34:05.656
in your life that are relevant

00:34:05.656 --> 00:34:06.116
to you.

00:34:06.566 --> 00:34:07.896
And through that it's able to

00:34:09.266 --> 00:34:11.576
serve up these great memories

00:34:11.576 --> 00:34:13.246
that users just consume on a

00:34:13.246 --> 00:34:14.166
daily basis.

00:34:14.866 --> 00:34:16.235
And so we wanted to make sure

00:34:16.235 --> 00:34:18.626
you had access to that level of

00:34:18.626 --> 00:34:19.815
data, right .

00:34:19.815 --> 00:34:20.766
These extensions aren't

00:34:20.766 --> 00:34:22.226
interesting if we just give you

00:34:22.226 --> 00:34:23.666
an array of photos.

00:34:23.956 --> 00:34:25.326
We've got to give you context

00:34:25.326 --> 00:34:26.246
from which you can create

00:34:26.246 --> 00:34:26.946
something great.

00:34:27.656 --> 00:34:29.755
And that's what we've done with

00:34:29.755 --> 00:34:30.545
PHProjectInfo.

00:34:31.146 --> 00:34:34.525
So, ProductInfo at the top level

00:34:34.835 --> 00:34:36.476
is broken into sections.

00:34:36.735 --> 00:34:38.096
We give you this array of

00:34:38.346 --> 00:34:40.306
PHProject section objects.

00:34:40.886 --> 00:34:44.226
And for a given section, we tell

00:34:44.226 --> 00:34:44.916
you the type.

00:34:45.226 --> 00:34:46.456
So, you think about a memory,

00:34:46.856 --> 00:34:48.716
we've got like a key photo at

00:34:48.716 --> 00:34:49.565
the top.

00:34:50.025 --> 00:34:51.766
And we call that type cover.

00:34:51.766 --> 00:34:53.036
And then we've got this

00:34:53.136 --> 00:34:56.036
editorial grid that we call type

00:34:56.096 --> 00:34:56.755
content.

00:34:57.656 --> 00:34:59.636
And then we give you this array

00:34:59.636 --> 00:35:00.626
of content.

00:35:01.276 --> 00:35:04.636
It will look something like

00:35:04.636 --> 00:35:05.056
this.

00:35:05.056 --> 00:35:06.346
And inside the contents we

00:35:06.346 --> 00:35:07.476
actually give you access to the

00:35:07.476 --> 00:35:08.596
elements, and the asset

00:35:08.596 --> 00:35:10.046
identifiers and some layout

00:35:10.046 --> 00:35:10.766
information.

00:35:11.716 --> 00:35:12.976
And you might be asking yourself

00:35:12.976 --> 00:35:14.016
when you look at this construct,

00:35:14.016 --> 00:35:15.746
why the array and then the

00:35:15.746 --> 00:35:16.356
array, right.

00:35:16.356 --> 00:35:17.766
Why this kind of nested

00:35:17.766 --> 00:35:18.236
structure.

00:35:19.396 --> 00:35:21.106
But if you think about the

00:35:21.106 --> 00:35:23.266
memory feature it makes sense,

00:35:23.876 --> 00:35:24.116
right.

00:35:24.116 --> 00:35:26.136
We allow users and memories to

00:35:26.136 --> 00:35:28.186
toggle between showing a summary

00:35:28.186 --> 00:35:29.546
of photos and showing all

00:35:29.546 --> 00:35:30.156
photos.

00:35:30.446 --> 00:35:32.666
The memory itself is built up

00:35:32.666 --> 00:35:34.806
from a large pool of assets.

00:35:36.296 --> 00:35:38.526
We call these curation levels.

00:35:39.026 --> 00:35:40.276
And we wanted to make sure you

00:35:40.276 --> 00:35:41.636
had access to these different

00:35:41.636 --> 00:35:43.476
levels of information, right?

00:35:43.476 --> 00:35:44.836
We've already done all this hard

00:35:44.836 --> 00:35:45.216
work.

00:35:45.216 --> 00:35:46.796
We've run all this intelligence.

00:35:46.796 --> 00:35:48.556
Let's just share it with you and

00:35:48.556 --> 00:35:49.826
let you build something on top

00:35:49.826 --> 00:35:50.046
of it.

00:35:50.876 --> 00:35:53.556
So, that section content array,

00:35:53.556 --> 00:35:55.566
is an ordered array, where you

00:35:55.566 --> 00:35:57.286
always know the object at index

00:35:57.286 --> 00:35:59.456
0 is going to be the best of the

00:35:59.456 --> 00:35:59.836
best.

00:35:59.836 --> 00:36:01.026
The most premium.

00:36:01.346 --> 00:36:04.126
The most condescended summary of

00:36:04.126 --> 00:36:06.066
that collection of assets,

00:36:06.596 --> 00:36:08.446
whereas the object at the very

00:36:08.446 --> 00:36:09.536
end of the array is going to be

00:36:09.536 --> 00:36:09.976
the most.

00:36:09.976 --> 00:36:10.736
It's going to be everything we

00:36:10.736 --> 00:36:11.256
considered.

00:36:11.846 --> 00:36:13.116
And you get to decide what you

00:36:13.116 --> 00:36:13.856
want to use.

00:36:14.596 --> 00:36:16.626
The fewest, the most, everything

00:36:16.626 --> 00:36:17.336
in between.

00:36:17.856 --> 00:36:19.026
Maybe you want to offer your

00:36:19.026 --> 00:36:20.476
users a choice.

00:36:20.476 --> 00:36:20.976
You want to give them the

00:36:20.976 --> 00:36:22.496
ability to switch between these.

00:36:22.736 --> 00:36:25.406
And you can do that with the

00:36:26.636 --> 00:36:29.346
context we're giving here.

00:36:29.396 --> 00:36:31.426
Next up, cloud asset

00:36:31.426 --> 00:36:32.256
identifiers.

00:36:33.006 --> 00:36:34.376
This is kind of a new concept.

00:36:34.376 --> 00:36:35.996
If you're familiar with PhotoKit

00:36:36.276 --> 00:36:38.406
on iOS, you've not seen this

00:36:38.406 --> 00:36:40.366
before because it's new.

00:36:40.996 --> 00:36:44.716
But, we've never had a construct

00:36:44.716 --> 00:36:46.946
where we wanted you to save data

00:36:46.946 --> 00:36:48.346
into a user's photo library.

00:36:48.346 --> 00:36:51.226
Data that represents assets but

00:36:51.226 --> 00:36:52.536
data that might be synced to

00:36:52.536 --> 00:36:53.986
other devices, that might appear

00:36:53.986 --> 00:36:55.776
somewhere else at some point.

00:36:56.176 --> 00:36:57.166
We want to make sure that the

00:36:57.166 --> 00:37:00.196
data you're saving is meaningful

00:37:00.196 --> 00:37:01.656
wherever it shows up.

00:37:01.846 --> 00:37:03.076
And so, we've introduced a new

00:37:03.076 --> 00:37:03.696
object called the

00:37:03.696 --> 00:37:05.016
PHCloudIdentifier.

00:37:06.306 --> 00:37:08.016
And you can think of this as a

00:37:08.016 --> 00:37:09.846
global identifier for the asset.

00:37:10.926 --> 00:37:13.036
But it's not as simple as just a

00:37:13.036 --> 00:37:14.326
global string.

00:37:15.026 --> 00:37:16.446
You know, dealing with the cloud

00:37:16.446 --> 00:37:17.626
and sync states and all that is

00:37:17.766 --> 00:37:19.016
really, really complicated.

00:37:19.336 --> 00:37:20.816
And we've solved all that for

00:37:20.816 --> 00:37:21.066
you.

00:37:21.856 --> 00:37:23.956
The only thing you have to do

00:37:23.956 --> 00:37:26.166
with this is just make sure

00:37:26.166 --> 00:37:27.356
you're always converting from a

00:37:27.356 --> 00:37:29.056
global identifier to a local

00:37:29.056 --> 00:37:30.916
identifier before you fetch.

00:37:31.246 --> 00:37:32.426
And for that we've just given

00:37:32.426 --> 00:37:35.156
you a convenience method inside

00:37:35.156 --> 00:37:36.616
PHPhotoLibrary to do that

00:37:36.616 --> 00:37:38.136
conversion both ways; from

00:37:38.136 --> 00:37:40.576
global, from pod identifier to

00:37:40.576 --> 00:37:42.326
local identifier, and vice

00:37:42.326 --> 00:37:42.626
versa.

00:37:43.106 --> 00:37:47.036
Next, I want to talk about

00:37:47.036 --> 00:37:47.446
layout.

00:37:48.106 --> 00:37:50.106
So, we didn't just want to give

00:37:50.106 --> 00:37:52.996
you assets and some constructs

00:37:52.996 --> 00:37:53.946
around the curation.

00:37:53.946 --> 00:37:55.556
We wanted to give you some hints

00:37:55.556 --> 00:37:58.396
about how we present those

00:37:58.396 --> 00:38:00.456
assets to a user right.

00:38:00.456 --> 00:38:02.276
Help you with some of the

00:38:02.276 --> 00:38:03.686
difficult problems of things

00:38:03.686 --> 00:38:04.666
like grid layout.

00:38:04.666 --> 00:38:06.396
All right, you look at a memory

00:38:07.626 --> 00:38:09.646
and we've done a lot of hard

00:38:09.646 --> 00:38:12.296
work already in laying out this

00:38:12.296 --> 00:38:13.526
curated grid in a really

00:38:13.526 --> 00:38:14.986
interesting way that's pleasing

00:38:14.986 --> 00:38:15.516
to the user.

00:38:16.326 --> 00:38:17.686
Wouldn't it be great if you had

00:38:17.686 --> 00:38:19.116
access to that layout.

00:38:19.856 --> 00:38:20.906
And you do.

00:38:21.566 --> 00:38:25.256
But to do that, we had to

00:38:25.256 --> 00:38:27.376
establish first kind of set of

00:38:27.376 --> 00:38:28.946
rules, a coordinate system for

00:38:28.946 --> 00:38:29.136
you.

00:38:29.136 --> 00:38:31.946
So, if you look at the memory,

00:38:32.136 --> 00:38:33.826
you notice everything aligns to

00:38:33.826 --> 00:38:35.006
a very specific grid.

00:38:35.006 --> 00:38:37.146
It's grid of 4x3 aspect ratio

00:38:37.146 --> 00:38:37.706
cells.

00:38:39.116 --> 00:38:42.556
But that's an odd, non-square

00:38:42.596 --> 00:38:44.496
kind of dimension to share back

00:38:44.496 --> 00:38:44.976
and forth.

00:38:44.976 --> 00:38:46.376
That's a weird multiplier for

00:38:46.376 --> 00:38:46.656
you.

00:38:47.426 --> 00:38:48.826
So, we simply divided that yet

00:38:48.826 --> 00:38:49.096
again.

00:38:49.096 --> 00:38:52.116
And in this case, this layout is

00:38:52.116 --> 00:38:54.826
really comprised of 20 uniform

00:38:55.606 --> 00:38:56.226
columns.

00:38:56.226 --> 00:38:58.596
What we call our grid spaces.

00:38:59.666 --> 00:39:00.946
And once we have this coordinate

00:39:00.946 --> 00:39:02.376
system established, you can

00:39:02.376 --> 00:39:03.706
scale this however you want.

00:39:03.706 --> 00:39:05.086
It's just a multiplier for you,

00:39:05.086 --> 00:39:06.366
for whatever your output is.

00:39:06.866 --> 00:39:08.126
Right? If you're rescaling on a

00:39:08.126 --> 00:39:10.766
resizable window, or working

00:39:10.936 --> 00:39:12.796
with web browsers of different

00:39:12.796 --> 00:39:14.426
size, you can use this data to

00:39:14.426 --> 00:39:16.056
know how to layout the content.

00:39:17.336 --> 00:39:19.066
And it also lets us communicate

00:39:19.066 --> 00:39:20.556
to you placement information.

00:39:21.126 --> 00:39:22.646
So, in this example, I have this

00:39:22.726 --> 00:39:24.116
photo that wants to live in the

00:39:24.116 --> 00:39:25.256
upper left-hand corner.

00:39:25.626 --> 00:39:27.206
So, I can now easily tell you

00:39:27.626 --> 00:39:29.316
it's at position 00.

00:39:29.316 --> 00:39:31.166
It's 8 grid spaces wide and it's

00:39:31.166 --> 00:39:32.386
9 grid spaces tall.

00:39:32.816 --> 00:39:37.016
Next thing I want to talk about

00:39:37.016 --> 00:39:37.826
are elements.

00:39:40.116 --> 00:39:42.066
So, inside the section constant

00:39:42.066 --> 00:39:42.836
we give you an array of

00:39:42.836 --> 00:39:43.386
elements.

00:39:43.386 --> 00:39:44.726
And all the elements are

00:39:45.426 --> 00:39:48.356
subclasses of PHProjectElement.

00:39:49.016 --> 00:39:50.176
And there's two really important

00:39:50.176 --> 00:39:50.816
properties there.

00:39:50.816 --> 00:39:52.576
One, is placement, which we just

00:39:52.576 --> 00:39:55.636
talked about and the other is

00:39:55.636 --> 00:39:57.346
something called weight.

00:39:58.416 --> 00:39:59.986
So, again going back to the

00:39:59.986 --> 00:40:00.746
memories feature.

00:40:03.236 --> 00:40:04.546
We talked to you about, like all

00:40:04.546 --> 00:40:05.616
the intelligence that we're

00:40:05.616 --> 00:40:06.236
doing, right?

00:40:06.336 --> 00:40:09.816
And ascertaining the most

00:40:09.816 --> 00:40:11.886
relevant photos in a large pool

00:40:11.886 --> 00:40:12.756
of assets.

00:40:13.866 --> 00:40:15.596
And so, our scoring system.

00:40:16.316 --> 00:40:17.666
And we wanted to share that with

00:40:17.726 --> 00:40:17.956
you.

00:40:18.576 --> 00:40:20.876
And so, we do that by given

00:40:22.126 --> 00:40:24.196
elements weight, right.

00:40:24.196 --> 00:40:25.946
it's a normalized weight from 0

00:40:25.946 --> 00:40:30.346
to 1.0, the default value is 0.5

00:40:30.346 --> 00:40:32.586
meaning it's not horribly

00:40:32.586 --> 00:40:34.126
significant, but is not horribly

00:40:34.126 --> 00:40:35.746
insignificant either, if that

00:40:35.746 --> 00:40:36.556
makes any sense.

00:40:36.556 --> 00:40:39.696
But you know it's this

00:40:39.696 --> 00:40:40.726
normalized score across the

00:40:40.726 --> 00:40:41.376
entire section.

00:40:41.376 --> 00:40:42.956
And you can do amazing things

00:40:42.956 --> 00:40:44.246
with that, right?

00:40:44.246 --> 00:40:45.726
Just really easily, right?

00:40:45.726 --> 00:40:47.656
Sort your assets by that.

00:40:47.656 --> 00:40:49.776
Decide where you want to chop

00:40:49.776 --> 00:40:51.566
off, you know a large array of

00:40:51.566 --> 00:40:52.846
assets and only work with the

00:40:52.846 --> 00:40:53.986
significant ones.

00:40:54.316 --> 00:40:56.016
Right? Present those as choices

00:40:56.016 --> 00:40:57.656
to a user where you're serving

00:40:57.656 --> 00:41:00.396
up the higher weighted assets

00:41:01.506 --> 00:41:02.746
first.

00:41:02.746 --> 00:41:04.106
And predicting that that's

00:41:04.106 --> 00:41:05.416
probably what they're looking

00:41:05.416 --> 00:41:06.236
for, what they want.

00:41:10.036 --> 00:41:11.496
And there's one other bit here.

00:41:11.566 --> 00:41:15.616
And this is specific to one of

00:41:15.616 --> 00:41:16.796
the elements, which is the

00:41:16.796 --> 00:41:18.186
PHProjectAssetElement.

00:41:18.886 --> 00:41:20.426
We have this concept of regions

00:41:20.426 --> 00:41:21.076
of interest.

00:41:21.626 --> 00:41:27.076
You know, as you know there are

00:41:27.076 --> 00:41:28.836
several ways already in the

00:41:28.986 --> 00:41:32.786
macOS API to run face detection

00:41:32.786 --> 00:41:36.276
to find faces in an image.

00:41:36.436 --> 00:41:37.796
But form that you don't know the

00:41:37.796 --> 00:41:39.446
relevancy of those faces.

00:41:39.636 --> 00:41:41.016
You don't know if those faces

00:41:41.016 --> 00:41:42.756
represent someone that is

00:41:42.756 --> 00:41:45.306
meaningful in someone's life, or

00:41:45.306 --> 00:41:46.796
it's a face in the crowd.

00:41:46.796 --> 00:41:48.856
It's the person walking behind

00:41:48.856 --> 00:41:50.626
you at a theme park, when you're

00:41:50.626 --> 00:41:52.226
trying to photograph somebody in

00:41:52.226 --> 00:41:53.446
your family.

00:41:53.446 --> 00:41:55.016
You really don't have an ability

00:41:55.016 --> 00:41:55.986
to tell the difference.

00:41:57.306 --> 00:41:59.616
We wanted to give you something

00:41:59.616 --> 00:42:01.866
that let you know, and let you

00:42:01.866 --> 00:42:04.466
trust that if we've marked, if

00:42:04.466 --> 00:42:06.276
we said it's interesting, it's

00:42:06.276 --> 00:42:07.836
interesting, right.

00:42:07.836 --> 00:42:10.006
And if you leverage this, you

00:42:10.006 --> 00:42:12.026
create magic for your users.

00:42:12.426 --> 00:42:14.026
Without necessarily even knowing

00:42:14.026 --> 00:42:14.396
why.

00:42:15.586 --> 00:42:17.206
And we went one step further.

00:42:17.236 --> 00:42:18.086
If you notice we have

00:42:18.086 --> 00:42:19.676
identifiers on these.

00:42:20.376 --> 00:42:21.996
And we actually repurposed those

00:42:21.996 --> 00:42:23.966
identifiers across images.

00:42:24.506 --> 00:42:26.116
So, if we know that this thing

00:42:26.116 --> 00:42:27.516
that's interesting in this photo

00:42:28.156 --> 00:42:30.686
is also representing this same

00:42:30.946 --> 00:42:32.306
thing, or same person in this

00:42:32.306 --> 00:42:33.986
other photo, we'll give them the

00:42:33.986 --> 00:42:34.946
same identifier .

00:42:35.406 --> 00:42:36.336
So, if you're doing like

00:42:36.336 --> 00:42:38.046
animation, slideshows, things

00:42:38.046 --> 00:42:39.876
like that, this is tremendously

00:42:39.876 --> 00:42:40.626
useful to you.

00:42:41.126 --> 00:42:42.396
Because you now can actually

00:42:42.396 --> 00:42:44.836
correlated positions of images

00:42:44.966 --> 00:42:45.956
across a large set.

00:42:46.476 --> 00:42:51.036
S, I could keep going, in a code

00:42:51.036 --> 00:42:51.376
walk.

00:42:52.896 --> 00:42:55.976
But, I'd rather give you a demo.

00:42:57.006 --> 00:42:58.876
Because I think it's really

00:42:58.876 --> 00:43:00.906
important to show you just how

00:43:00.906 --> 00:43:02.206
easy it is to create one of

00:43:02.206 --> 00:43:03.096
these extensions.

00:43:03.946 --> 00:43:05.096
So, I'm here in Xcode.

00:43:05.986 --> 00:43:07.456
And I promise I will zoom in

00:43:07.656 --> 00:43:08.906
where necessary, so you will be

00:43:08.906 --> 00:43:09.486
able to read this.

00:43:10.196 --> 00:43:11.756
So, I'm here in Xcode.

00:43:11.756 --> 00:43:13.776
And I have a project I started,

00:43:13.776 --> 00:43:15.116
but it actually does nothing

00:43:15.116 --> 00:43:15.356
yet.

00:43:15.356 --> 00:43:16.446
The only thing it has are some

00:43:16.446 --> 00:43:18.016
assets that a designed gave me.

00:43:18.936 --> 00:43:20.366
And what we're going to build

00:43:20.926 --> 00:43:23.046
right now, is a slideshow.

00:43:23.936 --> 00:43:25.176
And the slideshow is going to be

00:43:25.176 --> 00:43:27.386
the marriage of the content that

00:43:27.386 --> 00:43:29.706
Photos is providing and seenkit

00:43:29.836 --> 00:43:31.286
to do a really compelling kind

00:43:31.286 --> 00:43:32.486
of 3D animation.

00:43:34.676 --> 00:43:35.446
So, let's begin.

00:43:36.816 --> 00:43:38.126
So, the first thing I can do is

00:43:38.126 --> 00:43:40.586
just, I'm on the project and I

00:43:40.586 --> 00:43:41.526
have this little plus button

00:43:41.526 --> 00:43:42.956
here at the bottom add a target.

00:43:44.066 --> 00:43:45.446
And I'll just add a target here.

00:43:45.446 --> 00:43:47.726
And you'll notice we've got this

00:43:47.726 --> 00:43:50.826
new template, right for

00:43:50.826 --> 00:43:52.096
PhotoProject extension.

00:43:52.096 --> 00:43:53.346
So, I'm going to select that and

00:43:53.346 --> 00:43:54.606
I'm going to give this a name.

00:43:56.516 --> 00:43:57.346
Picture show.

00:43:57.906 --> 00:44:00.426
Hit the finished button.

00:44:01.386 --> 00:44:03.046
And yes, I want to activate that

00:44:03.046 --> 00:44:04.506
as a scheme it makes it really

00:44:04.506 --> 00:44:05.456
easy to run later.

00:44:06.646 --> 00:44:08.046
And then, I mentioned that my

00:44:08.046 --> 00:44:09.126
designer is going to need these

00:44:09.126 --> 00:44:09.796
assets.

00:44:09.796 --> 00:44:11.566
So, they're already in the

00:44:11.566 --> 00:44:12.936
project, I just want them,

00:44:12.936 --> 00:44:14.296
basically referenced from within

00:44:14.516 --> 00:44:15.586
the extension as well.

00:44:15.586 --> 00:44:17.536
So, I'm just going to add those

00:44:17.806 --> 00:44:18.996
via the copy phase.

00:44:19.576 --> 00:44:23.256
And that's the whole set of

00:44:23.256 --> 00:44:24.066
assets.

00:44:24.406 --> 00:44:26.026
I just hit add and with that

00:44:26.026 --> 00:44:27.226
we're ready to write some code.

00:44:29.546 --> 00:44:32.506
Now, if you're looking closely,

00:44:32.506 --> 00:44:34.766
you'll notice that Xcode has

00:44:34.766 --> 00:44:36.596
already added this group for me

00:44:36.596 --> 00:44:38.276
for Picture Show for my target.

00:44:38.786 --> 00:44:40.596
And inside of it, it's already

00:44:40.596 --> 00:44:42.566
laid down a view controller for

00:44:42.566 --> 00:44:44.796
me that conforms to the protocol

00:44:44.796 --> 00:44:47.566
that we have to implement.

00:44:47.996 --> 00:44:51.066
So, I'm going to go into that

00:44:51.066 --> 00:44:53.116
and first going to add some

00:44:53.116 --> 00:44:53.736
properties.

00:44:54.196 --> 00:44:58.236
So, just a very small set of

00:44:58.236 --> 00:44:59.076
properties here.

00:44:59.176 --> 00:45:01.046
I'm holding on to the context

00:45:01.046 --> 00:45:01.876
that's handed to me.

00:45:02.446 --> 00:45:04.176
I have some arrays to

00:45:04.176 --> 00:45:05.446
differentiate landscape and

00:45:05.446 --> 00:45:06.386
portrait assets for my

00:45:06.386 --> 00:45:07.096
slideshow.

00:45:07.596 --> 00:45:08.986
I have an outlet for my scene

00:45:08.986 --> 00:45:09.346
view.

00:45:09.426 --> 00:45:11.216
And I have an animator.

00:45:12.546 --> 00:45:14.426
And I have two expected

00:45:14.426 --> 00:45:15.346
compilers.

00:45:15.346 --> 00:45:16.786
I have not imported seenkit.

00:45:17.756 --> 00:45:21.986
So, that's an easy one to fix.

00:45:22.176 --> 00:45:24.206
And animator is my own class.

00:45:24.206 --> 00:45:25.496
I just haven't created it yet.

00:45:25.496 --> 00:45:27.936
So, let's go ahead and do that

00:45:28.546 --> 00:45:30.096
right now.

00:45:31.346 --> 00:45:34.146
So, I hit new, I want a Swift

00:45:34.146 --> 00:45:34.556
file.

00:45:34.606 --> 00:45:38.426
And we will call this animator.

00:45:42.776 --> 00:45:49.276
And there's my animator.

00:45:50.126 --> 00:45:51.886
I'm not going to walk you

00:45:51.886 --> 00:45:52.516
through all of this.

00:45:52.516 --> 00:45:53.816
But it's really, really simple.

00:45:54.186 --> 00:45:55.076
So, I'll just tell you a few

00:45:55.076 --> 00:45:56.156
things it's doing.

00:45:56.966 --> 00:45:57.996
When I'm initializing the

00:45:57.996 --> 00:45:59.446
animation I want to kind of

00:45:59.446 --> 00:46:01.776
reach into the scene and get out

00:46:01.776 --> 00:46:03.116
some specific elements of the

00:46:03.116 --> 00:46:03.466
scene.

00:46:03.466 --> 00:46:04.936
I want to find these tagged

00:46:04.936 --> 00:46:06.786
photo frames in this 3D scene.

00:46:07.376 --> 00:46:09.276
And then reach kind of inside

00:46:09.276 --> 00:46:11.026
them, behind the glass and get

00:46:11.026 --> 00:46:12.626
at the material that is going to

00:46:12.626 --> 00:46:14.096
be the photo I'm showing behind

00:46:14.096 --> 00:46:16.056
the glass of these frames.

00:46:16.586 --> 00:46:17.786
So, that's really all I'm doing

00:46:17.786 --> 00:46:18.696
in the initialize.

00:46:19.276 --> 00:46:22.476
And then from that point, the

00:46:22.476 --> 00:46:23.856
scene, I know it's just going to

00:46:23.856 --> 00:46:24.666
be spinning around.

00:46:24.666 --> 00:46:26.276
It's just this kind of rotation

00:46:26.276 --> 00:46:29.226
on a table and I have a little

00:46:29.226 --> 00:46:31.056
trickery that you're like a good

00:46:31.056 --> 00:46:32.796
magician when you're not looking

00:46:32.796 --> 00:46:33.726
on switching photos.

00:46:33.726 --> 00:46:35.206
And so, I'm just doing that

00:46:35.206 --> 00:46:36.186
through a couple of timers.

00:46:37.006 --> 00:46:38.256
And that's basically the

00:46:38.256 --> 00:46:38.766
animation.

00:46:39.436 --> 00:46:41.976
So, we'll go back to the

00:46:41.976 --> 00:46:43.666
controller and start filling in

00:46:43.666 --> 00:46:44.536
the interesting bits.

00:46:45.936 --> 00:46:47.876
When a user creates one of these

00:46:47.876 --> 00:46:51.356
projects, I want to save the

00:46:51.356 --> 00:46:51.476
data.

00:46:51.476 --> 00:46:53.006
Because I want them to be able

00:46:53.006 --> 00:46:54.586
to come back to this slide show

00:46:54.586 --> 00:46:55.476
at any point in time.

00:46:55.476 --> 00:46:57.146
So, I'm just going to add some

00:46:57.146 --> 00:46:57.926
data methods.

00:46:57.926 --> 00:46:59.956
And what I've got here is a

00:46:59.956 --> 00:47:02.886
SaveProjectDataFunction that

00:47:02.886 --> 00:47:04.096
does exactly what you saw on the

00:47:04.096 --> 00:47:05.156
slide, right?

00:47:05.156 --> 00:47:05.936
So, this should look very

00:47:05.936 --> 00:47:07.146
familiar with what we just

00:47:07.146 --> 00:47:07.746
talked about.

00:47:08.996 --> 00:47:10.786
And then load data, I'm simply

00:47:10.786 --> 00:47:11.746
reading that back.

00:47:12.986 --> 00:47:14.126
I'm getting the Cloud asset

00:47:14.126 --> 00:47:15.776
identifiers by unarchiving my

00:47:15.776 --> 00:47:16.156
data.

00:47:16.896 --> 00:47:18.286
And I'm just converting to local

00:47:18.286 --> 00:47:19.216
identifiers.

00:47:19.526 --> 00:47:22.476
And from that point, I'm able to

00:47:22.736 --> 00:47:25.746
do a PHAsset fetch assets

00:47:25.746 --> 00:47:26.826
request with those local

00:47:26.826 --> 00:47:27.456
identifiers.

00:47:27.956 --> 00:47:29.706
All right.

00:47:29.966 --> 00:47:32.176
Let's go back up to the top and

00:47:32.176 --> 00:47:33.536
start filling in the rest.

00:47:33.716 --> 00:47:34.636
So, viewDidLoad.

00:47:35.486 --> 00:47:41.206
I just need to initialize my

00:47:41.206 --> 00:47:41.616
animator.

00:47:41.616 --> 00:47:42.506
We talked about that.

00:47:43.906 --> 00:47:45.156
Supported project types.

00:47:45.156 --> 00:47:46.786
In this case, I don't need to

00:47:46.786 --> 00:47:48.096
ask the user for anything.

00:47:48.206 --> 00:47:49.506
So, I won't fill that in.

00:47:50.106 --> 00:47:51.106
It's just a slide show.

00:47:51.726 --> 00:47:54.196
But begin project, obviously,

00:47:54.196 --> 00:47:55.306
I've got some work I want to do

00:47:55.306 --> 00:47:55.546
here.

00:47:56.916 --> 00:47:57.876
So, we'll fill that in.

00:47:57.876 --> 00:48:00.666
And what I'm doing in this case

00:48:00.666 --> 00:48:03.946
is I'm getting at the actual

00:48:03.946 --> 00:48:04.986
sections array.

00:48:06.036 --> 00:48:07.586
And I'm looking for the first

00:48:07.586 --> 00:48:09.406
section of typed content.

00:48:10.026 --> 00:48:11.156
Right? I'm really designing this

00:48:11.156 --> 00:48:12.636
around a memory, like we just

00:48:12.636 --> 00:48:13.176
talk about.

00:48:13.946 --> 00:48:15.856
And form that, I want the most

00:48:15.856 --> 00:48:16.796
curated assets.

00:48:16.796 --> 00:48:18.696
I want the top-level summary.

00:48:19.146 --> 00:48:20.556
And so, I asked for the first

00:48:20.556 --> 00:48:21.486
object in that array.

00:48:22.576 --> 00:48:23.506
From that, get the

00:48:23.506 --> 00:48:26.636
cloudAssetIdentifiers and I'm

00:48:26.636 --> 00:48:27.166
good to go.

00:48:28.526 --> 00:48:30.006
Now, in the background, I am

00:48:30.186 --> 00:48:32.826
just saving the project data so

00:48:32.826 --> 00:48:33.936
that it's there later if the

00:48:33.936 --> 00:48:35.136
user comes back to the slide

00:48:35.136 --> 00:48:35.356
show.

00:48:36.836 --> 00:48:40.096
Get into resume project, and

00:48:40.096 --> 00:48:41.736
that's really easy.

00:48:43.616 --> 00:48:46.936
I simply hold on to my context

00:48:47.276 --> 00:48:49.186
load my project data, initialize

00:48:49.186 --> 00:48:49.806
the animation.

00:48:50.416 --> 00:48:53.396
And finally, in finish project,

00:48:57.896 --> 00:48:59.706
I'm just suspending animation.

00:48:59.796 --> 00:49:00.766
I don't want these timers

00:49:00.766 --> 00:49:01.906
firing, I don't want the fans

00:49:01.906 --> 00:49:03.076
running while user's doing

00:49:03.076 --> 00:49:03.766
something else.

00:49:03.766 --> 00:49:05.486
I just suspend it.

00:49:06.356 --> 00:49:07.816
And believe it or not, that is

00:49:07.816 --> 00:49:09.186
the entirety of the code for

00:49:09.186 --> 00:49:09.846
this extension.

00:49:09.846 --> 00:49:10.836
That is my slide show.

00:49:11.356 --> 00:49:12.416
Now, what I haven't don't is

00:49:12.416 --> 00:49:14.796
wire up the UI, which I can do

00:49:14.796 --> 00:49:15.386
really quickly.

00:49:15.386 --> 00:49:16.486
So, the template gives me the

00:49:16.486 --> 00:49:18.386
view for my view controlled.

00:49:18.816 --> 00:49:19.866
I'll just delete the default

00:49:19.866 --> 00:49:20.296
string.

00:49:21.236 --> 00:49:22.636
And I'm going to add a scene to

00:49:22.636 --> 00:49:23.296
this.

00:49:28.476 --> 00:49:30.056
And so, we add a seenkit view.

00:49:30.236 --> 00:49:34.186
I'll just resize that and just

00:49:35.446 --> 00:49:37.446
pop in here, set my auto resize

00:49:37.446 --> 00:49:39.426
and I just want this to be full

00:49:39.426 --> 00:49:39.756
view.

00:49:40.356 --> 00:49:44.076
And the only other thing you

00:49:44.076 --> 00:49:46.456
need to do to that is choose the

00:49:46.456 --> 00:49:47.786
scene itself, which I already

00:49:47.786 --> 00:49:48.856
have in the assets that we

00:49:48.856 --> 00:49:49.426
loaded in.

00:49:50.236 --> 00:49:51.676
And I just need to wire it to my

00:49:51.676 --> 00:49:52.306
view controller.

00:49:53.116 --> 00:49:54.416
So, I'll control drag form

00:49:54.416 --> 00:49:56.886
file's owner and I see the

00:49:56.886 --> 00:49:58.036
outlet that we've already added

00:49:58.036 --> 00:49:59.116
in properties.

00:50:00.026 --> 00:50:00.806
And that's it.

00:50:01.906 --> 00:50:04.176
We're ready to run.

00:50:04.366 --> 00:50:05.516
So, I'll hit play.

00:50:05.516 --> 00:50:06.946
It's going to ask me to choose

00:50:06.946 --> 00:50:08.466
the app, obviously, it's Photos

00:50:08.466 --> 00:50:08.976
in this case.

00:50:14.336 --> 00:50:16.546
And that will build, and

00:50:16.546 --> 00:50:17.086
succeed.

00:50:17.236 --> 00:50:20.786
Photos launches, and I'm just

00:50:20.786 --> 00:50:21.536
going to pick a memory.

00:50:21.676 --> 00:50:23.916
In this case, I want to use,

00:50:24.226 --> 00:50:25.556
I've got this really cool trip

00:50:25.606 --> 00:50:27.566
to Hong Kong I'm going to

00:50:27.566 --> 00:50:28.416
choose.

00:50:28.956 --> 00:50:30.216
Hit the plus button and look at

00:50:30.216 --> 00:50:31.566
that, there's the extension

00:50:31.636 --> 00:50:32.716
showing up in Photos.

00:50:32.716 --> 00:50:34.736
I choose that.

00:50:34.736 --> 00:50:37.486
Now, when I do, this is the very

00:50:37.486 --> 00:50:38.876
first time I run this extension,

00:50:39.386 --> 00:50:41.816
so I don't have permission as an

00:50:41.816 --> 00:50:43.446
extension to the entire photo

00:50:43.446 --> 00:50:43.916
library.

00:50:43.916 --> 00:50:45.936
You remember the our API is

00:50:46.026 --> 00:50:47.306
handing the entire photo library

00:50:47.306 --> 00:50:48.056
to the extension.

00:50:48.566 --> 00:50:50.476
So, user does have to grant that

00:50:50.476 --> 00:50:51.586
access once.

00:50:52.166 --> 00:50:52.946
And just hit okay.

00:50:53.026 --> 00:50:55.456
And then the slideshow loads.

00:50:57.516 --> 00:51:03.576
[ Applause ]

00:51:04.076 --> 00:51:06.316
And I'm just going to show you

00:51:06.316 --> 00:51:08.056
one additional detail, if you

00:51:08.056 --> 00:51:10.066
look in the sidebar, there's the

00:51:10.066 --> 00:51:11.356
project we just created, Hong

00:51:11.356 --> 00:51:13.346
Kong Island.

00:51:13.346 --> 00:51:14.656
This is saved inside that

00:51:14.656 --> 00:51:16.036
library right next to all the

00:51:16.036 --> 00:51:16.776
other projects.

00:51:17.436 --> 00:51:20.566
So, I choose that and I can see

00:51:20.826 --> 00:51:22.716
this was created by an extension

00:51:22.716 --> 00:51:23.566
called Picture Show.

00:51:24.256 --> 00:51:25.216
And I can open that.

00:51:25.216 --> 00:51:27.806
And it will pop right back into

00:51:27.806 --> 00:51:28.506
the same slideshow.

00:51:30.396 --> 00:51:33.186
So, that is PhotosPojects

00:51:33.186 --> 00:51:33.766
Extensions [applause].

00:51:35.656 --> 00:51:41.976
Thank you.

00:51:42.206 --> 00:51:43.836
So, we've talked about a lot in

00:51:43.836 --> 00:51:46.426
the past 55 minutes or so.

00:51:46.766 --> 00:51:49.856
Talking about the frictionless

00:51:49.856 --> 00:51:51.236
photo picker in iOS.

00:51:51.386 --> 00:51:52.876
Really, really nice advancements

00:51:52.876 --> 00:51:54.586
there, allowing you to get at

00:51:54.586 --> 00:51:55.766
original URLs.

00:51:55.766 --> 00:51:57.116
Having the video quality.

00:51:57.496 --> 00:51:58.876
Some great, great stuff there

00:51:58.876 --> 00:51:59.306
for you.

00:51:59.796 --> 00:52:01.446
Andreas took you through the new

00:52:01.446 --> 00:52:03.806
media presentation types, I

00:52:03.806 --> 00:52:05.336
can't wait to see how you're

00:52:05.336 --> 00:52:06.716
going to consume those and the

00:52:06.716 --> 00:52:07.806
kind of things you do within

00:52:07.806 --> 00:52:08.506
your apps.

00:52:08.936 --> 00:52:11.046
Allowing users to see their

00:52:11.046 --> 00:52:12.226
content played back the way

00:52:12.226 --> 00:52:12.896
they'd expect.

00:52:13.706 --> 00:52:15.036
He also talked about testing

00:52:15.036 --> 00:52:16.846
with large image libraries.

00:52:17.326 --> 00:52:19.366
And just a reminder there is a

00:52:19.366 --> 00:52:21.156
sample app now to let you fill

00:52:21.156 --> 00:52:22.876
out a library with tens of

00:52:22.876 --> 00:52:25.256
thousands of assets so that you

00:52:25.256 --> 00:52:26.066
can test that way.

00:52:26.066 --> 00:52:27.866
And then, finally we talked

00:52:27.866 --> 00:52:29.256
about the project extensions.

00:52:29.256 --> 00:52:30.636
And I'm really, really excited

00:52:30.636 --> 00:52:33.596
to see what your all going to

00:52:33.686 --> 00:52:35.466
create and have in the App Store

00:52:35.896 --> 00:52:37.706
when macOS High Sierra ships

00:52:37.706 --> 00:52:38.146
this fall.

00:52:39.456 --> 00:52:40.666
So, for more information please

00:52:40.666 --> 00:52:42.076
check out this link, the

00:52:42.306 --> 00:52:44.096
developer.apple.com website.

00:52:45.106 --> 00:52:46.236
And I want to talk about some

00:52:46.236 --> 00:52:47.446
related sessions.

00:52:47.576 --> 00:52:50.266
Right after this in this hall is

00:52:50.266 --> 00:52:52.656
going to be a killer, killer

00:52:52.656 --> 00:52:54.056
session introducing you to

00:52:54.056 --> 00:52:55.376
vision framework.

00:52:55.536 --> 00:52:56.766
I know you want to stick around

00:52:56.766 --> 00:52:57.726
for that.

00:52:57.726 --> 00:52:59.846
Later tonight over in the

00:52:59.846 --> 00:53:02.116
executive ballroom is the first

00:53:02.116 --> 00:53:04.756
of two sessions covering depth

00:53:04.876 --> 00:53:07.516
in iPhone photography with some

00:53:07.556 --> 00:53:09.906
amazing demos and you really,

00:53:09.906 --> 00:53:10.976
really want to be there for that

00:53:10.976 --> 00:53:11.386
as well.

00:53:11.386 --> 00:53:13.376
And finally, tonight we're doing

00:53:13.376 --> 00:53:14.746
something we've never done that

00:53:14.746 --> 00:53:15.386
WWDC.

00:53:15.506 --> 00:53:17.786
We're hosting a photography get

00:53:17.786 --> 00:53:18.306
together.

00:53:18.406 --> 00:53:19.716
It's going to be downstairs in

00:53:19.716 --> 00:53:20.896
technology lab area,

00:53:20.966 --> 00:53:22.626
specifically lab J.

00:53:23.226 --> 00:53:25.836
And I'll be there, the other 2

00:53:25.836 --> 00:53:27.076
speakers in this session will be

00:53:27.076 --> 00:53:27.396
there.

00:53:27.456 --> 00:53:28.906
All of the speakers today

00:53:28.906 --> 00:53:30.176
talking about Cameron Photos

00:53:30.176 --> 00:53:31.406
will be there as well as a ton

00:53:31.406 --> 00:53:34.726
of engineers, management, and we

00:53:34.726 --> 00:53:36.166
hope to see all of you there.

00:53:36.596 --> 00:53:37.716
Enjoy the rest of your show.

00:53:37.716 --> 00:53:38.466
Thank you so much.

00:53:39.516 --> 00:53:44.500
[ Applause ]