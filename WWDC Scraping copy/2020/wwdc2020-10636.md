# Wwdc2020 10636

## Transcript

More Videos

Streaming is available in most browsers,and in the Developer app.

About

Transcript

What's new in streaming audio for Apple WatchDeliver a smooth streaming audio experience straight to the wrist. We'll talk about some of the new things for building great streaming apps unique to Apple Watch. Learn how to integrate more audio formats, deliver streams more efficiently through new codecs, and add encrypted content to expand your app's media library.

This session builds on techniques introduced in “Streaming Audio on watchOS 6” from WWDC19. If you're new to audio on Apple Watch, we recommend you watch that video for a primer.ResourcesHD VideoSD VideoRelated VideosWWDC20Deliver a better HLS audio experienceWWDC19Streaming Audio on watchOS 6

Deliver a smooth streaming audio experience straight to the wrist. We'll talk about some of the new things for building great streaming apps unique to Apple Watch. Learn how to integrate more audio formats, deliver streams more efficiently through new codecs, and add encrypted content to expand your app's media library.

This session builds on techniques introduced in “Streaming Audio on watchOS 6” from WWDC19. If you're new to audio on Apple Watch, we recommend you watch that video for a primer.

HD VideoSD Video

HD Video

SD Video

Deliver a better HLS audio experience

Streaming Audio on watchOS 6

Search this video…Hello and welcome to WWDC.My name is Suresh Koppisetty and I'm an engineer on the Streaming Media team.Today, I'm going to give you some updates on What's New in Streaming Audioon Apple Watch. Last year in watchOS 6, we introduced the ability to stream audiocontent directly on Apple Watch. As a developer, you could use Apple's veryown AVPlayer or your own custom audio protocols for streaming audio contenton Apple Watch. This year with watchOS 7, we are bringing the support fornew audio codec in AVPLayer. Extended high efficiency advanced audiocoding xHE-AAC gives us the ability to deliver equivalent qualityat lower bitrate or you can choose to deliver higher quality at equivalentbitrate as compared to other codecs in AAC family. Now given that Watch hashighly variable network conditions, we should aim to deliver high qualityaudio content with as low bitrate as possible. Hence, we recommendusing xHE-AAC for encoding all your audio assets. Having said thatfor interoperability reasons, we also want you to include AAC-LC, HE-AACor HE-AACv2 variants in the manifest and let the AVPlayerdecide what's the best variant to play. That's all about new codecs on watchOS.In case you want to learn more, we have an amazing talk, Deliver a betterHLS Audio Experience by my colleague Simon. OK great.Now you got streaming audio on Apple Watch working and you also have thisnew highly efficient codec to help you improve user experience, but thereis still one thing missing.That's access to protected content. Developers have these vast, ever growingcatalog of protected content that they would love to be able to deliver onApple Watch. To support this, we are happy to bring FairPlay Streamingto watchOS 7. FairPlay Streaming was first introduced on iOS in 2015. It's aspecification which describes the set of steps an app needs to follow inorder to securely deliver content decryption keys so the platform coulddecrypt and playback encrypted media. While delivering FairPlay Streaming keysyour app works as a liaison between the platform and your key server.AVContentKeySession is an AVFoundation class designed specifically forhandling decryption keys. When the application receives an on demand keyloading request from AVFoundation, it handles the various steps in keyloading process and responds back to AVFoundation with an encrypted key response.With this, AVFoundation can start decryption and playback. Now watchOS 7,we are bringing support for AVContentKeySession for all yourkey handling needs. AVContentKeySession is not tied to lifecycleof an asset. This decouples key loading from media loading and playback.Hence, applications can have better control on the lifecycle of keys.AVContentKeySession allows applications to initiate key loading on their ownat any point in time. This gives applications the ability to optimize keydelivery and improve different aspects of playback experience. To knowmore about AVContentKeySession please refer to AVContentKeySessionbest practices doc. That's all about the new things and watchOS 7.Next, I would like to highlight some of the best practices specific to streamingon Apple Watch for improving the user experience even further.Streaming on watchOS is not the same as streaming on iOS. Watch is alow-power wearable device and due to its increased user mobility the networkconditions on what are highly variable. This presents us with some interestingchallenges for building streaming applications. With that in mind, we recommendavoiding unnecessary network round trips including HTTP redirects on anyof the resources needed for playback. Any additional HTTP redirectswould directly contribute to start up time.Pre-fetch resources like keys and certificates -- this will reduce the numberof network requests during critical part of playback start. You could usethe newly introduced AVContentKeySession for pre-fetching content keys.It also helps if you cache the certificate. You could use the expiry tagfrom HTTP responses to decide how long to cache. Since Watch is only dealingwith audio-only content, we recommend using a higher target durationof around 20 seconds to be more resilient to network mobility and battery performancewithout having a drastic impact on playback startup time.To summarize, we have introduced a new audio codec that helps you deliveraudio content more efficiently. We have added the ability to stream protectedcontent on Watch with FairPlay Streaming. We also talked about some of thebest practices specific to streaming on Apple Watch for improving streaming performance.I hope you use these new additions and tips to build amazing audio appson Watch and bring normal audio content to our customers. If you need moreinformation on best practices for building audio streaming apps on watchOS,please refer to these other sessions as well. Thank you. And enjoy therest of WWDC.

Hello and welcome to WWDC.

My name is Suresh Koppisetty and I'm an engineer on the Streaming Media team.

Today, I'm going to give you some updates on What's New in Streaming Audioon Apple Watch. Last year in watchOS 6, we introduced the ability to stream audiocontent directly on Apple Watch. As a developer, you could use Apple's veryown AVPlayer or your own custom audio protocols for streaming audio contenton Apple Watch. This year with watchOS 7, we are bringing the support fornew audio codec in AVPLayer. Extended high efficiency advanced audiocoding xHE-AAC gives us the ability to deliver equivalent qualityat lower bitrate or you can choose to deliver higher quality at equivalentbitrate as compared to other codecs in AAC family. Now given that Watch hashighly variable network conditions, we should aim to deliver high qualityaudio content with as low bitrate as possible. Hence, we recommendusing xHE-AAC for encoding all your audio assets. Having said thatfor interoperability reasons, we also want you to include AAC-LC, HE-AACor HE-AACv2 variants in the manifest and let the AVPlayerdecide what's the best variant to play. That's all about new codecs on watchOS.In case you want to learn more, we have an amazing talk, Deliver a betterHLS Audio Experience by my colleague Simon. OK great.Now you got streaming audio on Apple Watch working and you also have thisnew highly efficient codec to help you improve user experience, but thereis still one thing missing.

That's access to protected content. Developers have these vast, ever growingcatalog of protected content that they would love to be able to deliver onApple Watch. To support this, we are happy to bring FairPlay Streamingto watchOS 7. FairPlay Streaming was first introduced on iOS in 2015. It's aspecification which describes the set of steps an app needs to follow inorder to securely deliver content decryption keys so the platform coulddecrypt and playback encrypted media. While delivering FairPlay Streaming keysyour app works as a liaison between the platform and your key server.AVContentKeySession is an AVFoundation class designed specifically forhandling decryption keys. When the application receives an on demand keyloading request from AVFoundation, it handles the various steps in keyloading process and responds back to AVFoundation with an encrypted key response.

With this, AVFoundation can start decryption and playback. Now watchOS 7,we are bringing support for AVContentKeySession for all yourkey handling needs. AVContentKeySession is not tied to lifecycleof an asset. This decouples key loading from media loading and playback.Hence, applications can have better control on the lifecycle of keys.AVContentKeySession allows applications to initiate key loading on their ownat any point in time. This gives applications the ability to optimize keydelivery and improve different aspects of playback experience. To knowmore about AVContentKeySession please refer to AVContentKeySessionbest practices doc. That's all about the new things and watchOS 7.

Next, I would like to highlight some of the best practices specific to streamingon Apple Watch for improving the user experience even further.Streaming on watchOS is not the same as streaming on iOS. Watch is alow-power wearable device and due to its increased user mobility the networkconditions on what are highly variable. This presents us with some interestingchallenges for building streaming applications. With that in mind, we recommendavoiding unnecessary network round trips including HTTP redirects on anyof the resources needed for playback. Any additional HTTP redirectswould directly contribute to start up time.

Pre-fetch resources like keys and certificates -- this will reduce the numberof network requests during critical part of playback start. You could usethe newly introduced AVContentKeySession for pre-fetching content keys.It also helps if you cache the certificate. You could use the expiry tagfrom HTTP responses to decide how long to cache. Since Watch is only dealingwith audio-only content, we recommend using a higher target durationof around 20 seconds to be more resilient to network mobility and battery performancewithout having a drastic impact on playback startup time.To summarize, we have introduced a new audio codec that helps you deliveraudio content more efficiently. We have added the ability to stream protectedcontent on Watch with FairPlay Streaming. We also talked about some of thebest practices specific to streaming on Apple Watch for improving streaming performance.

I hope you use these new additions and tips to build amazing audio appson Watch and bring normal audio content to our customers. If you need moreinformation on best practices for building audio streaming apps on watchOS,please refer to these other sessions as well. Thank you. And enjoy therest of WWDC.

## Code Samples

