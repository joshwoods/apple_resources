# Wwdc2020 10117

## Transcript

More Videos

Streaming is available in most browsers,and in the Developer app.

About

Transcript

Code

Accessibility design for Mac CatalystMake your Mac Catalyst app accessible to all — and bring those improvements back to your iPad app. Discover how a great accessible iPad app automatically becomes a great accessible Mac app when adding support for Mac Catalyst. Learn how to further augment your experience with support for mouse and keyboard actions and accessibility element grouping and navigation. And explore how to use new Accessibility Inspector features to test your app and iterate to create a truly great experience for everyone.

To get the most out of this session, you should be familiar with Mac Catalyst, UIKit, and basic accessibility APIs for iOS. To get started, check out “Introducing iPad apps for Mac” and "Auditing your apps for accessibility."ResourcesAccessibility design for Mac CatalystDelivering an exceptional accessibility experienceHD VideoSD VideoRelated VideosWWDC19Accessibility in SwiftUIAccessibility InspectorIntroducing iPad Apps for MacWriting Great Accessibility Labels

Make your Mac Catalyst app accessible to all — and bring those improvements back to your iPad app. Discover how a great accessible iPad app automatically becomes a great accessible Mac app when adding support for Mac Catalyst. Learn how to further augment your experience with support for mouse and keyboard actions and accessibility element grouping and navigation. And explore how to use new Accessibility Inspector features to test your app and iterate to create a truly great experience for everyone.

To get the most out of this session, you should be familiar with Mac Catalyst, UIKit, and basic accessibility APIs for iOS. To get started, check out “Introducing iPad apps for Mac” and "Auditing your apps for accessibility."

Accessibility design for Mac Catalyst

Delivering an exceptional accessibility experience

HD VideoSD Video

HD Video

SD Video

Accessibility in SwiftUI

Accessibility Inspector

Introducing iPad Apps for Mac

Writing Great Accessibility Labels

Search this video…Hello and welcome to WWDC.Hello, everyone. My name is Eric, and I'll be joined by my colleague Nathanto talk about accessibility design for Mac Catalyst.Mac Catalyst has been a huge success for Apple.It is incredibly easy to use,and the developer communities absolutely love it.And we already have some of the best apps on the App Storethat are made of Mac Catalyst.And with all that great work out there,it is important to make your app usable for all of your customers.And this is what brings us here today to talk about accessibility.At Apple, accessibility is one of our core values.We have an array of assistive technologies on all of our platformsto help people with disabilities.Our accessibility team has been working so hardto make sure that all the great work you've done for iOS accessibilityare converted to Mac Catalyst.So, if you make your iOS app accessible,it is automatically accessible when bringing it to the Mac.This is so that you can continue to think in terms of iOSwhen working on Mac Catalyst apps.We'll first talk about how to optimize your app experience for keyboard usageby improving focus behavior and adding keyboard shortcuts.Then we'll walk through what you can doto enhance your app's navigation efficiency for assistive technologies.And finally, we'll give you some tips to test accessibilityon macOS for Mac Catalyst apps.So let's start with keyboard usage.On macOS, the keyboard isn't just a supplementary interaction methodlike it is on iPadOS.Instead, it's the primary medium users will interact with your app.So the goal is to make as many functionalities of your appaccessible with the keyboard.And the first thing you could do is to check keyboard focus.Keyboard focus determines which UI elementis currently receiving inputs from the keyboard,and we want to make sure that all UI elements of appthat could be interacted by the user can become focused.To demonstrate this, we will look at a sample app called Roasted Beans.It is a spin-off of the Peanut Butter app that we made accessible in previous years.While our Peanut Butter app was a great success,many were asking for a way to find the ideal cup of coffeeto enjoy with their peanut butter toast.So having finished building the iOS app and making it accessible,we now want to bring it to the macOS using Mac Catalyst.Let's see how this app interacts with the keyboard.To test this, we first need to turn on a system settingthat enables keyboard interaction with controls.It is located in the System Preferences app...the Keyboard section, and under Shortcuts menu.With the checkbox, use keyboard navigation to move focus between controls.So go back to our app, and see what happens if we press tabs.We'll see that the add button on the right of the navigation barnow has a focus ring around it.This means that the add button has the keyboard focus,and if you press the space bar, the button will be activated.The next tab highlights the first item of the sidebar.The users could press up and down arrow keysto change the selection of the table view.And subsequent tabs highlightsthe rest of the interactable controls of the app,the Share button, the Favorite button and the Gift button.Wow, that is awesome!Without us doing any work,UIKit already makes all of our controls accessible with keyboard,with tab keys looping us through the controls of the appand arrow keys changing the selection of the table view.Now, if you have a UITableView or a UICollectionViewelsewhere in your app,you might notice that arrow keys don't move the selection.And all you need to do for arrow keys to change the selectionis to set this new API selectionFollowsFocus to trueon your UITableView or CollectionView.In our sample app, because our tableView is a sidebar of a UISplitView,UIKit sets this to true for us so we don't need to do this step.To learn more about how to further customize your keyboard experience,please check out the sample appand watch the session "What's New in Mac Catalyst."Now we've made surethat all of the interactable controls of the app can take focus.We can talk about the next thing you could do about keyboard usage.Add keyboard shortcuts.Right now, in order for our users to add a new coffee or rate a coffee,they can only do so by clicking on the screen.For people who use assistive technologies,finding on-screen UIs to interact can become tedious.So it would be nice if they are able to perform actionsthrough a quick keyboard shortcut.So let's see what we need to do if we were to add a keyboard shortcutfor sharing a roast with friends.To do that, I first need to find out the best keyboard combination to usebecause we want it to be as intuitive as possible for the customers.You can first check out the Apple guidelinefor a list of commonly used keyboard shortcuts.If your app has similar functionalities,you could consider using these keyboard combinations for the shortcutsbecause users are already familiar with them.For us, sharing isn't on the list here,so another way is to check out the existing apps on the Macto see if they have something similar.So I checked out the Safari app on the Mac that everybody loves.It uses Command-I as a shortcut for sharing.And I've just decided to do the same.To do this, we first need to override the buildMenu function in AppDelegate.We need to create a UIKeyCommand that responds to the keyboard shortcut.We assign a localized string as the title,because this would show up in the menu bar.Then we assign the action that gets triggered for the command.We need to create a UIKeyCommand that responds to the keyboard shortcut.We assign a localized string as the title,because this would show up in the menu bar.Then we assign the action that gets triggered for the commandand set the input to letter "I" for modifierFlags command.Then we need to create a UIMenu that takes the shareCommandas the only child for the menu,and insert this new menu item to an appropriate place on the menu bar.For this demo, I chose to insert it at the end of the edit menu.Now if you open the edit menu,you would see that our new keyboard shortcut, Share,appears nicely under the edit menu,and it can be accessed by pressing Command-I.And don't forget that all the great work you are optimizing for Mac Catalystare also great optimizations for full keyboard access on iOS,which is a feature that allows users to use the device with just the keyboard.In addition, your app can get the exact keyCodefrom a UIPress object starting in iOS 13.4.This is useful if you're developing a game, for example,because this API gives you the full control of the keyboard.And don't forget to check out our sample app for these usages.For a quick recap,a great app designed for the keyboard is a great app for accessibility.It is important to make sure that interactable controlsare accessible with keyboard focus.And we recommend you to add some useful keyboard shortcuts for your app.So that's it for keyboard usage.Next, I will hand it over to my colleague, Nathan,to talk about how you can improve navigation efficiencyfor assistive technologies.Thanks, Eric. Hey, folks, my name is Nathan.I'm a software engineer on the Accessibility Team.My team and I have been working really hardto improve how our macOS assistive technologiesare going to interact with your Catalyst apps.Like Eric touched on earlier,making your app accessible is to make it usable for everyone.Part of making your app usableis to give users an efficient way to access content.Today we'll focus on VoiceOver.It's a screen reader that exists on all of our platforms,and it allows users with low or no vision to interact with your appby reading out content on screen.VoiceOver does this through interacting with a tree of accessibility elementsbased off of your user interface.On macOS, you might be delivering a more complex appwith a bigger user interface,to take advantage of the additional screen real estate.With a more complex interface,it means there's even more accessibility elements for VoiceOver to navigate.This means users need an efficient way to navigateor they could begin to feel overwhelmed.That's why today, I'm very excited to talk to you about accessibility groups.It's a strategy you can use to improve your app's navigation for VoiceOver users.We've made it possible to use grouping to deliver a more native macOS experience.But before we can talk about improving navigation efficiency,it's important to first understand how VoiceOver sees your app.This is how VoiceOver sees your app. It's what we call the accessibility tree.It's a collection of elements that are visibleby all of our assistive technologies.Views that are accessibility elementsare determined by the isAccessibilityElement property.Each element is a leaf node,which results in a single-level tree of elements.This model works great on iOS.Users navigate with a touchscreen,which means they can navigate elements one by oneor quickly jump to them by tapping them on screen.However, on macOS,VoiceOver users navigate using a keyboard.Without a touchscreen, they cannot quickly jump between elements.So if we were to use the same model,all accessibility elements would have to be navigated one by one.To illustrate this navigation challenge,let's take a look at the accessibility elementsin our Roasted Beans app.Here you can see there are 26 visible accessibility elements.That means there's at least 26 elementsa user would have to navigate through at any given time.Imagine if it took you 26 keystrokes in Xcodeto reach that Compile button.You would probably find programming quite a bit more challenging.While a keyboard shortcut could be addedso that navigation to a specific element isn't required,it won't solve every use case.So what can we do to improve this experience?What if we were to take inspiration from a dinner menu?Instead of the menu presenting a long list of every dish,they are categorized into relatable sections,such as salads, main course and side dishes.This would allow a VoiceOver user to navigate between groupsbefore navigating individual elements in a specific group.We can apply this same idea to the accessibility tree.You can define a relation between elementsthrough the use of accessibility containers.When you set accessibilityContainerType on an element,our assistive technologies will be able to use that informationto provide a better navigation experiencefor the accessibility elements it contains.You may have already known about the accessibility container APIand how it helps users on iOS navigate.For example, it allows them to perform a touch gestureto navigate to the first accessibility element in the next container.VoiceOver would then focus on elements like this.Since our goal here was to improve navigation efficiency for Mac Catalyst,VoiceOver on macOS will leverage this same API,but adapt the behavior.Accessibility containers on macOS will behave as an accessibility element.This means VoiceOver can navigate focus to the container itself.From here, users can choose to skip past the container to the next elementor interact with a container,allowing for exclusive navigation of the containers' accessibility elements.So when I say accessibility containers will behave as an accessibility element,this is because when we build the accessibility treefor a Mac Catalyst app,the container becomes its own node on the treeand its accessibility elements become their own subtree.This structure closely aligns with the accessibility API built around AppKit.Its model works great for macOSbecause it significantly reduces the number of accessibility elementsa user needs to navigate at any given time.The key takeaway here is that accessibility containersare an accessibility element on Mac Catalyst,so ensuring you have set standard accessibility propertiessuch as accessibility label on your containers is essential.Looking back to our Roasted Beans app,what would we see now that the accessibility containersbehave as an independent node in the accessibility tree?Here you can see a dramatic efficiency improvement.This reduces the number of visible elements from 26 to 8.Now that we've seen how much of an impactaccessibility containers have on navigation,let's take a few moments to discuss the different typesand when you should use them.Data tables are specifically for when your container,such as a graph,adopts the UIAccessibilityContainer DataTable protocol.Lists are for ordered content.These are primarily used in web pages or in a PDF's table of contents.Landmarks are containers used specifically for web pages and tvOS.Lastly, semanticGroups are a general container type on iOS.On iOS, their accessibility label will be spoken the first timeVoiceOver users focus on an element within that container.On macOS, their label will be spoken when VoiceOver focuses on the container itself.So in our case, we want to be using the semanticGroup typeto improve the navigation experience.While grouping can greatly improve the navigation experience,I want to be sure that you understandthat too much grouping can overcomplicate the navigation of your app.Since each accessibility container becomes a node in the accessibility tree,elements within the container are not discoverableunless a VoiceOver user explicitly interacts with the group.So let's take a look at a few examples to see when we should group elements.To start things off, elements belonging to the same functional sectionshould be grouped.But how do we discover these functional sections?Let's take a look at Swift Playgrounds, a recent Mac Catalyst app.Imagine you have a friend who just started learning how to code.They open up Swift Playgrounds and start one of their first lessonsand unfortunately, they get stuck on one of the problems.But luckily for them, they have you to call upon.Imagine yourself talking to them over the phone.How would you help them navigate the app?You might ask, "Do you see a list of chapters on the left?Which chapter are you on?In the world view on your right,which tile is your character byte standing on?"Or maybe you're trying to teach them more about writing code,in which case you could separate the middle into two functional groups,the top being the editor where you write codeand the bottom being the auto-complete suggestions.By walking through how you might verbally describe your app,you can more easily identify these functional sectionsthat should be placed into accessibility containers.Another instance of when you should use accessibility containersare when they are related by type or functional purpose.For example, UINavigationBar, UITabBar,UICollectionView and UITableVieware some of the standard UIKit viewsthat are accessibility containers of type semanticGroup by default.So if you have created your own custom UI elementsthat act as tab bars or navigation bars,please follow the expected default behaviorby configuring it as an accessibility container.Now let's step through an example in our Roasted Beans appto see how easy it to improve the navigation experience in your own apps.Starting on the left, we have a UITableView.It's an accessibility container of type semanticGroup by default.Recall that accessibility containers are an independent accessibility elementfor our Mac Catalyst app.Which means that just like any other accessibility element,we recommend giving the container a localized accessibility label.In this case, "Coffee list" would be appropriate.Since our UITableView maintains some stateabout which coffee is selected,we could make this label even betterby adding which coffee is selected to the label.Here is a great time to take a moment to pause and remind everyoneof the importance of adding great accessibility labels to their apps.To learn how to make great accessibility labels,we have a presentation from 2019 which I encourage for you to watch.Coming back to our app, what about the details view on the right?It's a functional section that holds all the informationrelated to the select coffee.Because the details view isn't already grouped,because we did not use a UITableView or UICollectionView,we have to manually define these accessibility containers.Today I'll show you how easy it can beto take something like our availability UI and make it a container.We implemented this as a series of UILabelsin a vertical UIStackView.This means a user would have to navigate through each element.We could make this navigation experience betterby adding an accessibility container,so the VoiceOver users can quickly navigate past the entire list.From here, in just a few lines,we can make the UIStackView an accessibility containerand give it an accessibility label that describes the group.These are some fantastic improvements to our app.By placing these related elements into groups,we can greatly improve how VoiceOver users will navigate our Mac Catalyst app.And so I hope you take away the importanceof adding accessibility containers to your app.It's a small change you can make that will greatly improvethe navigation experience on macOS and on iOS.Please ensure that your accessibility containershave a concise localized label that describes the groupand includes any important details regarding the containers' state.That's all I have for you today regarding navigation efficiency.I'll now pass things back to Eric, where he will show youhow to test your Mac Catalyst app for accessibility.Thank you, Nathan.With all the great work that you've doneto improve your accessibility app experience,now is a great time to talk about testing on the macOS platform.When bringing apps from iOS to the Mac,you think of the app as an iOS app from the inside,but a Mac app on the outside,because it is running on the macOS platform.As it happens, when you work with accessibility APIs from UIKit,our team automatically converts your iOS accessibility code to macOSwithout you having to do any work,so that you can continue to think about iOS.To help you better understand what's going on under the hood,we've improved the Accessibility Inspector for Mac Catalyst apps,and now it shows you the iOS APIs when running on macOS.If you have not used Accessibility Inspector before,I highly recommend you to watch these two videos,"Auditing Your Apps for Accessibility" and "Accessibility Inspector."Together they will give you a complete guideon how Accessibility Inspector can help youfind and fix accessibility issues for your appsacross all Apple platforms.So now let's see how to use the Accessibility Inspectorto audit your app accessibility on Mac Catalyst.If we use the Inspector to inspect the elements for the cell,we can see the element has a proper label that describes the title of the coffeeand a proper value that describes the rating.We also see that there's a new Catalyst sectionthat shows accessibility traits, container types from iOS.If we then use the Command-Control-Up,the Inspector would then inspect the parent of the cell element,which serves as the container.We could verify that this is the correct element to inspectby checking the element class.In this case, the class name shows that this is the elementthat we translated for the tableView class.All classes from UIKitwill be eventually translated to a Mac platform element.In addition, Inspector tells you the view controller of the viewif it has one.In this case, it is the RBListViewController from the app.To make sure that VoiceOver reads the container,we can make sure that the tableView containerhas a proper label which is a localized coffee list.It also has the correct container type which is a semanticGroup.And starting this year,Accessibility Inspector would tell you the automation type for all elements.In this case, it is a table,so that you know exactly how to find it in XCUI tests.So that's a brief overview of some of the additional thingsyou can do with Accessibility Inspector for Mac Catalyst apps.We hope you enjoyed it.So we've covered a lot today for accessibility in Mac Catalyst.To wrap up, we first discussed how a great keyboard appis a great app for accessibilityby making sure the controls of the app is accessible by keyboard focusand adding keyboard shortcuts.Then we showed you how you can improve navigation efficiencyfor assistive technologies for Mac Catalyst apps.We learned how the existing iOS API accessibilityContainerTypecan make a much bigger impact on the Mac, and how you should adopt it in your app.And our last piece of advice is to use the Accessibility Inspector.This is a great tool that we created to help developers like you.So thank you for joining us,and we hope this presentation will help you createa better accessibility experience
for Mac Catalyst apps.

Hello and welcome to WWDC.

Hello, everyone. My name is Eric, and I'll be joined by my colleague Nathanto talk about accessibility design for Mac Catalyst.

Mac Catalyst has been a huge success for Apple.It is incredibly easy to use,and the developer communities absolutely love it.And we already have some of the best apps on the App Storethat are made of Mac Catalyst.And with all that great work out there,it is important to make your app usable for all of your customers.

And this is what brings us here today to talk about accessibility.

At Apple, accessibility is one of our core values.We have an array of assistive technologies on all of our platformsto help people with disabilities.Our accessibility team has been working so hardto make sure that all the great work you've done for iOS accessibilityare converted to Mac Catalyst.So, if you make your iOS app accessible,it is automatically accessible when bringing it to the Mac.This is so that you can continue to think in terms of iOSwhen working on Mac Catalyst apps.We'll first talk about how to optimize your app experience for keyboard usageby improving focus behavior and adding keyboard shortcuts.

Then we'll walk through what you can doto enhance your app's navigation efficiency for assistive technologies.And finally, we'll give you some tips to test accessibilityon macOS for Mac Catalyst apps.

So let's start with keyboard usage.

On macOS, the keyboard isn't just a supplementary interaction methodlike it is on iPadOS.Instead, it's the primary medium users will interact with your app.So the goal is to make as many functionalities of your appaccessible with the keyboard.

And the first thing you could do is to check keyboard focus.

Keyboard focus determines which UI elementis currently receiving inputs from the keyboard,and we want to make sure that all UI elements of appthat could be interacted by the user can become focused.To demonstrate this, we will look at a sample app called Roasted Beans.It is a spin-off of the Peanut Butter app that we made accessible in previous years.While our Peanut Butter app was a great success,many were asking for a way to find the ideal cup of coffeeto enjoy with their peanut butter toast.

So having finished building the iOS app and making it accessible,we now want to bring it to the macOS using Mac Catalyst.

Let's see how this app interacts with the keyboard.To test this, we first need to turn on a system settingthat enables keyboard interaction with controls.It is located in the System Preferences app...

the Keyboard section, and under Shortcuts menu.

With the checkbox, use keyboard navigation to move focus between controls.

So go back to our app, and see what happens if we press tabs.We'll see that the add button on the right of the navigation barnow has a focus ring around it.

This means that the add button has the keyboard focus,and if you press the space bar, the button will be activated.The next tab highlights the first item of the sidebar.

The users could press up and down arrow keysto change the selection of the table view.

And subsequent tabs highlightsthe rest of the interactable controls of the app,the Share button, the Favorite button and the Gift button.

Wow, that is awesome!Without us doing any work,UIKit already makes all of our controls accessible with keyboard,with tab keys looping us through the controls of the appand arrow keys changing the selection of the table view.

Now, if you have a UITableView or a UICollectionViewelsewhere in your app,you might notice that arrow keys don't move the selection.And all you need to do for arrow keys to change the selectionis to set this new API selectionFollowsFocus to trueon your UITableView or CollectionView.In our sample app, because our tableView is a sidebar of a UISplitView,UIKit sets this to true for us so we don't need to do this step.

To learn more about how to further customize your keyboard experience,please check out the sample appand watch the session "What's New in Mac Catalyst."Now we've made surethat all of the interactable controls of the app can take focus.We can talk about the next thing you could do about keyboard usage.Add keyboard shortcuts.

Right now, in order for our users to add a new coffee or rate a coffee,they can only do so by clicking on the screen.

For people who use assistive technologies,finding on-screen UIs to interact can become tedious.

So it would be nice if they are able to perform actionsthrough a quick keyboard shortcut.

So let's see what we need to do if we were to add a keyboard shortcutfor sharing a roast with friends.

To do that, I first need to find out the best keyboard combination to usebecause we want it to be as intuitive as possible for the customers.

You can first check out the Apple guidelinefor a list of commonly used keyboard shortcuts.If your app has similar functionalities,you could consider using these keyboard combinations for the shortcutsbecause users are already familiar with them.

For us, sharing isn't on the list here,so another way is to check out the existing apps on the Macto see if they have something similar.So I checked out the Safari app on the Mac that everybody loves.It uses Command-I as a shortcut for sharing.And I've just decided to do the same.

To do this, we first need to override the buildMenu function in AppDelegate.

We need to create a UIKeyCommand that responds to the keyboard shortcut.We assign a localized string as the title,because this would show up in the menu bar.Then we assign the action that gets triggered for the command.We need to create a UIKeyCommand that responds to the keyboard shortcut.We assign a localized string as the title,because this would show up in the menu bar.Then we assign the action that gets triggered for the commandand set the input to letter "I" for modifierFlags command.

Then we need to create a UIMenu that takes the shareCommandas the only child for the menu,and insert this new menu item to an appropriate place on the menu bar.For this demo, I chose to insert it at the end of the edit menu.Now if you open the edit menu,you would see that our new keyboard shortcut, Share,appears nicely under the edit menu,and it can be accessed by pressing Command-I.

And don't forget that all the great work you are optimizing for Mac Catalystare also great optimizations for full keyboard access on iOS,which is a feature that allows users to use the device with just the keyboard.

In addition, your app can get the exact keyCodefrom a UIPress object starting in iOS 13.4.This is useful if you're developing a game, for example,because this API gives you the full control of the keyboard.And don't forget to check out our sample app for these usages.For a quick recap,a great app designed for the keyboard is a great app for accessibility.

It is important to make sure that interactable controlsare accessible with keyboard focus.

And we recommend you to add some useful keyboard shortcuts for your app.

So that's it for keyboard usage.Next, I will hand it over to my colleague, Nathan,to talk about how you can improve navigation efficiencyfor assistive technologies.

Thanks, Eric. Hey, folks, my name is Nathan.I'm a software engineer on the Accessibility Team.My team and I have been working really hardto improve how our macOS assistive technologiesare going to interact with your Catalyst apps.Like Eric touched on earlier,making your app accessible is to make it usable for everyone.Part of making your app usableis to give users an efficient way to access content.

Today we'll focus on VoiceOver.It's a screen reader that exists on all of our platforms,and it allows users with low or no vision to interact with your appby reading out content on screen.VoiceOver does this through interacting with a tree of accessibility elementsbased off of your user interface.

On macOS, you might be delivering a more complex appwith a bigger user interface,to take advantage of the additional screen real estate.With a more complex interface,it means there's even more accessibility elements for VoiceOver to navigate.This means users need an efficient way to navigateor they could begin to feel overwhelmed.

That's why today, I'm very excited to talk to you about accessibility groups.It's a strategy you can use to improve your app's navigation for VoiceOver users.We've made it possible to use grouping to deliver a more native macOS experience.But before we can talk about improving navigation efficiency,it's important to first understand how VoiceOver sees your app.

This is how VoiceOver sees your app. It's what we call the accessibility tree.It's a collection of elements that are visibleby all of our assistive technologies.

Views that are accessibility elementsare determined by the isAccessibilityElement property.Each element is a leaf node,which results in a single-level tree of elements.This model works great on iOS.Users navigate with a touchscreen,which means they can navigate elements one by oneor quickly jump to them by tapping them on screen.

However, on macOS,VoiceOver users navigate using a keyboard.Without a touchscreen, they cannot quickly jump between elements.

So if we were to use the same model,all accessibility elements would have to be navigated one by one.

To illustrate this navigation challenge,let's take a look at the accessibility elementsin our Roasted Beans app.Here you can see there are 26 visible accessibility elements.That means there's at least 26 elementsa user would have to navigate through at any given time.

Imagine if it took you 26 keystrokes in Xcodeto reach that Compile button.You would probably find programming quite a bit more challenging.While a keyboard shortcut could be addedso that navigation to a specific element isn't required,it won't solve every use case.So what can we do to improve this experience?What if we were to take inspiration from a dinner menu?Instead of the menu presenting a long list of every dish,they are categorized into relatable sections,such as salads, main course and side dishes.This would allow a VoiceOver user to navigate between groupsbefore navigating individual elements in a specific group.We can apply this same idea to the accessibility tree.You can define a relation between elementsthrough the use of accessibility containers.

When you set accessibilityContainerType on an element,our assistive technologies will be able to use that informationto provide a better navigation experiencefor the accessibility elements it contains.

You may have already known about the accessibility container APIand how it helps users on iOS navigate.For example, it allows them to perform a touch gestureto navigate to the first accessibility element in the next container.VoiceOver would then focus on elements like this.

Since our goal here was to improve navigation efficiency for Mac Catalyst,VoiceOver on macOS will leverage this same API,but adapt the behavior.Accessibility containers on macOS will behave as an accessibility element.This means VoiceOver can navigate focus to the container itself.From here, users can choose to skip past the container to the next elementor interact with a container,allowing for exclusive navigation of the containers' accessibility elements.

So when I say accessibility containers will behave as an accessibility element,this is because when we build the accessibility treefor a Mac Catalyst app,the container becomes its own node on the treeand its accessibility elements become their own subtree.This structure closely aligns with the accessibility API built around AppKit.

Its model works great for macOSbecause it significantly reduces the number of accessibility elementsa user needs to navigate at any given time.

The key takeaway here is that accessibility containersare an accessibility element on Mac Catalyst,so ensuring you have set standard accessibility propertiessuch as accessibility label on your containers is essential.Looking back to our Roasted Beans app,what would we see now that the accessibility containersbehave as an independent node in the accessibility tree?Here you can see a dramatic efficiency improvement.This reduces the number of visible elements from 26 to 8.Now that we've seen how much of an impactaccessibility containers have on navigation,let's take a few moments to discuss the different typesand when you should use them.Data tables are specifically for when your container,such as a graph,adopts the UIAccessibilityContainer DataTable protocol.Lists are for ordered content.These are primarily used in web pages or in a PDF's table of contents.Landmarks are containers used specifically for web pages and tvOS.Lastly, semanticGroups are a general container type on iOS.On iOS, their accessibility label will be spoken the first timeVoiceOver users focus on an element within that container.On macOS, their label will be spoken when VoiceOver focuses on the container itself.

So in our case, we want to be using the semanticGroup typeto improve the navigation experience.While grouping can greatly improve the navigation experience,I want to be sure that you understandthat too much grouping can overcomplicate the navigation of your app.Since each accessibility container becomes a node in the accessibility tree,elements within the container are not discoverableunless a VoiceOver user explicitly interacts with the group.

So let's take a look at a few examples to see when we should group elements.To start things off, elements belonging to the same functional sectionshould be grouped.But how do we discover these functional sections?Let's take a look at Swift Playgrounds, a recent Mac Catalyst app.Imagine you have a friend who just started learning how to code.They open up Swift Playgrounds and start one of their first lessonsand unfortunately, they get stuck on one of the problems.But luckily for them, they have you to call upon.Imagine yourself talking to them over the phone.How would you help them navigate the app?You might ask, "Do you see a list of chapters on the left?Which chapter are you on?In the world view on your right,which tile is your character byte standing on?"Or maybe you're trying to teach them more about writing code,in which case you could separate the middle into two functional groups,the top being the editor where you write codeand the bottom being the auto-complete suggestions.By walking through how you might verbally describe your app,you can more easily identify these functional sectionsthat should be placed into accessibility containers.

Another instance of when you should use accessibility containersare when they are related by type or functional purpose.

For example, UINavigationBar, UITabBar,UICollectionView and UITableVieware some of the standard UIKit viewsthat are accessibility containers of type semanticGroup by default.So if you have created your own custom UI elementsthat act as tab bars or navigation bars,please follow the expected default behaviorby configuring it as an accessibility container.

Now let's step through an example in our Roasted Beans appto see how easy it to improve the navigation experience in your own apps.Starting on the left, we have a UITableView.It's an accessibility container of type semanticGroup by default.

Recall that accessibility containers are an independent accessibility elementfor our Mac Catalyst app.Which means that just like any other accessibility element,we recommend giving the container a localized accessibility label.In this case, "Coffee list" would be appropriate.Since our UITableView maintains some stateabout which coffee is selected,we could make this label even betterby adding which coffee is selected to the label.

Here is a great time to take a moment to pause and remind everyoneof the importance of adding great accessibility labels to their apps.To learn how to make great accessibility labels,we have a presentation from 2019 which I encourage for you to watch.Coming back to our app, what about the details view on the right?It's a functional section that holds all the informationrelated to the select coffee.Because the details view isn't already grouped,because we did not use a UITableView or UICollectionView,we have to manually define these accessibility containers.Today I'll show you how easy it can beto take something like our availability UI and make it a container.We implemented this as a series of UILabelsin a vertical UIStackView.This means a user would have to navigate through each element.We could make this navigation experience betterby adding an accessibility container,so the VoiceOver users can quickly navigate past the entire list.

From here, in just a few lines,we can make the UIStackView an accessibility containerand give it an accessibility label that describes the group.

These are some fantastic improvements to our app.By placing these related elements into groups,we can greatly improve how VoiceOver users will navigate our Mac Catalyst app.And so I hope you take away the importanceof adding accessibility containers to your app.It's a small change you can make that will greatly improvethe navigation experience on macOS and on iOS.

Please ensure that your accessibility containershave a concise localized label that describes the groupand includes any important details regarding the containers' state.

That's all I have for you today regarding navigation efficiency.I'll now pass things back to Eric, where he will show youhow to test your Mac Catalyst app for accessibility.

Thank you, Nathan.With all the great work that you've doneto improve your accessibility app experience,now is a great time to talk about testing on the macOS platform.When bringing apps from iOS to the Mac,you think of the app as an iOS app from the inside,but a Mac app on the outside,because it is running on the macOS platform.

As it happens, when you work with accessibility APIs from UIKit,our team automatically converts your iOS accessibility code to macOSwithout you having to do any work,so that you can continue to think about iOS.To help you better understand what's going on under the hood,we've improved the Accessibility Inspector for Mac Catalyst apps,and now it shows you the iOS APIs when running on macOS.

If you have not used Accessibility Inspector before,I highly recommend you to watch these two videos,"Auditing Your Apps for Accessibility" and "Accessibility Inspector."Together they will give you a complete guideon how Accessibility Inspector can help youfind and fix accessibility issues for your appsacross all Apple platforms.So now let's see how to use the Accessibility Inspectorto audit your app accessibility on Mac Catalyst.

If we use the Inspector to inspect the elements for the cell,we can see the element has a proper label that describes the title of the coffeeand a proper value that describes the rating.

We also see that there's a new Catalyst sectionthat shows accessibility traits, container types from iOS.If we then use the Command-Control-Up,the Inspector would then inspect the parent of the cell element,which serves as the container.

We could verify that this is the correct element to inspectby checking the element class.In this case, the class name shows that this is the elementthat we translated for the tableView class.All classes from UIKitwill be eventually translated to a Mac platform element.

In addition, Inspector tells you the view controller of the viewif it has one.In this case, it is the RBListViewController from the app.To make sure that VoiceOver reads the container,we can make sure that the tableView containerhas a proper label which is a localized coffee list.

It also has the correct container type which is a semanticGroup.

And starting this year,Accessibility Inspector would tell you the automation type for all elements.In this case, it is a table,so that you know exactly how to find it in XCUI tests.So that's a brief overview of some of the additional thingsyou can do with Accessibility Inspector for Mac Catalyst apps.We hope you enjoyed it.

So we've covered a lot today for accessibility in Mac Catalyst.

To wrap up, we first discussed how a great keyboard appis a great app for accessibilityby making sure the controls of the app is accessible by keyboard focusand adding keyboard shortcuts.

Then we showed you how you can improve navigation efficiencyfor assistive technologies for Mac Catalyst apps.

We learned how the existing iOS API accessibilityContainerTypecan make a much bigger impact on the Mac, and how you should adopt it in your app.And our last piece of advice is to use the Accessibility Inspector.This is a great tool that we created to help developers like you.

So thank you for joining us,and we hope this presentation will help you createa better accessibility experience
for Mac Catalyst apps.

4:11 -Ensuring selection automatically triggers when focus moves to a different cell

6:01 -Creating a keyboard shortcut

7:20 -Responding to raw key codes

15:45 -Adding accessibility labels to containers, such as UITableView and UICollectionView

15:50 -Making great accessibility labels that include state

16:45 -Adding accessibility containers to improve the navigation experience

## Code Samples

```swift
myTableView.selectionFollowsFocus 
=
 
true
```

```swift
extension
 
AppDelegate
 
{
  
override
 
func
 
buildMenu
(
with
 
builder
: 
UIMenuBuilder
)
 {
    
super
.buildMenu(with: builder)
    
let
 shareCommand 
=
 
UIKeyCommand
(title: 
NSLocalizedString
(
"Share"
, comment: 
""
),
                                    action: #selector(
Self
.handleShareMenuAction),
                                    input: 
"I"
,
                                    modifierFlags: [.command])
    
let
 shareMenu 
=
 
UIMenu
(title: 
""
,
                           identifier: 
UIMenu
.
Identifier
(
"com.example.apple-samplecode.RoastedBeans.share"
),
                           options: .displayInline,
                           children: [shareCommand])
    builder.insertChild(shareMenu, atEndOfMenu: .edit)
  }
  
  
@objc
 
func
 
handleShareMenuAction
()
 {
  }
}
```

```swift
extension
 
MyViewController
 
{
  
override
 
func
 
pressesBegan
(
_
 
presses
: 
Set
<
UIPress
>, 
with
 
event
: 
UIPressesEvent
?)
 {
    
switch
 presses.first
?
.key
?
.keyCode {
    
case
 .keyboardLeftGUI:
      
// Handle command key pressed

    
case
 .keyboardB:
      
// Handle B key pressed

    
default
:
    }
  }
}
```

```swift
tableView.accessibilityLabel 
=
 
NSLocalizedString
(
"Coffee list"
, comment: 
""
)
```

```swift
extension
 
RBListViewController
 
{
    
    
override
 
func
 
tableView
(
_
 
tableView
: 
UITableView
, 
didSelectRowAt
 
indexPath
: 
IndexPath
)
 {
        
let
 data 
=
 tableData[indexPath.row]
        
let
 label 
=
 
NSLocalizedString
(
"Coffee list"
, comment: 
""
)
        
let
 selectedLabel 
=
 
NSLocalizedString
(
"%@ selected"
, comment: 
""
)
        tableView.accessibilityLabel 
=
 label 
+
 
", "
 
+
 
String
(format: selectedLabel, data.coffee.brand)
    }

}
```

```swift
let
 stackView 
=
 
UIStackView
()
stackView.axis 
=
 .vertical
stackView.translatesAutoresizingMaskIntoConstraints 
=
 
false



let
 locationsAvailable 
=
 viewModel.locationsAvailable


let
 titleLabel 
=
 
UILabel
()
titleLabel.font 
=
 
UIFont
.preferredFont(forTextStyle: .body).bold()
titleLabel.text 
=
 
NSLocalizedString
(
"Availability: "
, comment: 
""
)
stackView.addArrangedSubview(titleLabel)


for
 location 
in
 locationsAvailable {
  
let
 label 
=
 
UILabel
()
  label.font 
=
 
UIFont
.preferredFont(forTextStyle: .body)
  label.text 
=
 
"• "
 
+
 location
  label.accessibilityLabel 
=
 location
  stackView.addArrangedSubview(label)
}

stackView.accessibilityLabel 
=
 
String
(format: 
NSLocalizedString
(
"Available at %@ locations"
, comment: 
""
), 
String
(locationsAvailable.count))
stackView.accessibilityContainerType 
=
 .semanticGroup
```

